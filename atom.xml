<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Tianyao&#39; s BLOG</title>
  
  <subtitle>Tianyao</subtitle>
  <link href="https://atffang.github.io/atom.xml" rel="self"/>
  
  <link href="https://atffang.github.io/"/>
  <updated>2026-01-10T07:45:51.901Z</updated>
  <id>https://atffang.github.io/</id>
  
  <author>
    <name>Fang Tianyao</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title></title>
    <link href="https://atffang.github.io/2026/01/10/langchainAgent/Agents01/"/>
    <id>https://atffang.github.io/2026/01/10/langchainAgent/Agents01/</id>
    <published>2026-01-10T07:45:51.877Z</published>
    <updated>2026-01-10T07:45:51.901Z</updated>
    
    <content type="html"><![CDATA[<!DOCTYPE html><!-- saved from url=(0054)https://docs.langchain.com/oss/python/langchain/agents --><html lang="en" class="__variable_47c970 __variable_3bbdad lg:[--scroll-mt:9.5rem] light" data-banner-state="hidden" data-page-mode="custom" style="color-scheme: light; --assistant-sheet-width: 0px; --sidenav-move-up: 0px;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link rel="preload" href="https://docs.langchain.com/mintlify-assets/_next/static/media/bb3ef058b751a6ad-s.p.woff2" as="font" crossorigin="" type="font/woff2"><link rel="preload" href="https://docs.langchain.com/mintlify-assets/_next/static/media/c4b700dcb2187787-s.p.woff2" as="font" crossorigin="" type="font/woff2"><link rel="preload" href="https://docs.langchain.com/mintlify-assets/_next/static/media/e4af272ccee01ff0-s.p.woff2" as="font" crossorigin="" type="font/woff2"><link rel="preload" as="image" href="./Agents01_files/langchain-docs-teal.svg"><link rel="preload" as="image" href="./Agents01_files/langchain-docs-lilac.svg"><link rel="stylesheet" href="./Agents01_files/ca7d6eb2a816651f.css" data-precedence="next"><link rel="stylesheet" href="./Agents01_files/9e8832c8599d2dba.css" data-precedence="next"><link rel="stylesheet" href="./Agents01_files/5b8c8e3125ac4cdb.css" data-precedence="next"><link rel="preload" as="script" fetchpriority="low" href="./Agents01_files/webpack-605f4630efb20cbf.js"><script src="https://js-na2.hs-analytics.net/analytics/1768025400000/242623570.js" type="text/javascript" id="hs-analytics"></script><script src="./Agents01_files/banner.js" type="text/javascript" id="cookieBanner-242623570" data-cookieconsent="ignore" data-hs-ignore="true" data-loader="hs-scriptloader" data-hsjs-portal="242623570" data-hsjs-env="prod" data-hsjs-hublet="na2"></script><script type="text/javascript" async="" data-global-segment-analytics-key="analytics" src="https://cdn.segment.com/analytics.js/v1/fN405MKyizQ5ye7K0GkpDW2nYXQcjaeA/analytics.min.js"></script><script type="text/javascript" async="" src="./Agents01_files/insight.min.js"></script><script type="text/javascript" async="" src="./Agents01_files/js"></script><script type="text/javascript" async="" src="./Agents01_files/js(1)"></script><script type="text/javascript" async="" src="./Agents01_files/script.js"></script><script async="" src="./Agents01_files/gtm.js"></script><script src="./Agents01_files/87c73c54-dd8d81ac9604067c.js" async=""></script><script src="./Agents01_files/90018-5fa46b9e0fd0490c.js" async=""></script><script src="./Agents01_files/main-app-76ddd9525ef90e67.js" async=""></script><script src="./Agents01_files/82431-a3e0a126611457bf.js" async=""></script><script src="./Agents01_files/43881-67920a24b626c850.js" async=""></script><script src="./Agents01_files/98816-4875194b6205382d.js" async=""></script><link rel="preconnect" href="https://fonts.googleapis.com/"><link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="anonymous"><link rel="stylesheet" href="https://d4tuoctqmanu0.cloudfront.net/katex.min.css" as="style"><script type="text/javascript">(function(a,b){try{let c=document.getElementById("banner")?.innerText;if(c){for(let d=0;d<localStorage.length;d++){let e=localStorage.key(d);if(e?.endsWith(a)&&localStorage.getItem(e)===c)return void document.documentElement.setAttribute(b,"hidden")}document.documentElement.setAttribute(b,"visible");return}for(let c=0;c<localStorage.length;c++){let d=localStorage.key(c);if(d?.endsWith(a)&&localStorage.getItem(d))return void document.documentElement.setAttribute(b,"hidden")}document.documentElement.setAttribute(b,"visible")}catch(a){document.documentElement.setAttribute(b,"hidden")}})(  "bannerDismissed",  "data-banner-state",)</script><script src="./Agents01_files/polyfills-42372ed130431b0a.js" nomodule=""></script><script id="_mintlify-banner-script">(function j(a,b,c,d,e){try{let f,g,h=[];try{h=window.location.pathname.split("/").filter(a=>""!==a&&"global"!==a).slice(0,2)}catch{h=[]}let i=h.find(a=>c.includes(a)),j=[];for(let c of(i?j.push(i):j.push(b),j.push("global"),j)){if(!c)continue;let b=a[c];if(b?.content){f=b.content,g=c;break}}if(!f)return void document.documentElement.setAttribute(d,"hidden");let k=!0,l=0;for(;l<localStorage.length;){let a=localStorage.key(l);if(l++,!a?.endsWith(e))continue;let b=localStorage.getItem(a);if(b&&b===f){k=!1;break}g&&(a.startsWith(`lang:${g}_`)||!a.startsWith("lang:"))&&(localStorage.removeItem(a),l--)}document.documentElement.setAttribute(d,k?"visible":"hidden")}catch(a){console.error(a),document.documentElement.setAttribute(d,"hidden")}})(  {},  "en",  [],  "data-banner-state",  "bannerDismissed",)</script><script suppresshydrationwarning="true" id="_mintlify-scroll-top-script">(function(a,b,c,d){var e;let f,g="mint"===d||"linden"===d?"sidebar":"sidebar-content",h=(e=d,f="navbar-transition","maple"===e&&(f+="-maple"),"willow"===e&&(f+="-willow"),f);function i(){document.documentElement.classList.add("lg:[--scroll-mt:9.5rem]")}function j(a){document.getElementById(g)?.style.setProperty("top",`${a}rem`)}function k(a){document.getElementById(g)?.style.setProperty("height",`calc(100vh - ${a}rem)`)}function l(a,b){!a&&b||a&&!b?(i(),document.documentElement.classList.remove("lg:[--scroll-mt:12rem]")):a&&b&&(document.documentElement.classList.add("lg:[--scroll-mt:12rem]"),document.documentElement.classList.remove("lg:[--scroll-mt:9.5rem]"))}let m=document.documentElement.getAttribute("data-banner-state"),n=null!=m?"visible"===m:b;switch(d){case"mint":j(c),l(a,n);break;case"palm":case"aspen":j(c),k(c),l(a,n);break;case"linden":j(c),n&&i();break;case"almond":document.documentElement.style.setProperty("--scroll-mt","2.5rem"),j(c),k(c)}let o=function(){let a=document.createElement("style");return a.appendChild(document.createTextNode("*,*::before,*::after{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(a),function(){window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(a)},1)}}();("requestAnimationFrame"in globalThis?requestAnimationFrame:setTimeout)(()=>{let a;a=!1,a=window.scrollY>50,document.getElementById(h)?.setAttribute("data-is-opaque",`${!!a}`),o()})})(  false,  false,  (function m(a,b,c){let d=document.documentElement.getAttribute("data-banner-state"),e=2.5*!!(null!=d?"visible"===d:b),f=3*!!a,g=4,h=e+g+f;switch(c){case"mint":case"palm":break;case"aspen":f=2.5*!!a,g=3.5,h=e+f+g;break;case"linden":g=4,h=e+g;break;case"almond":g=3.5,h=e+g}return h})(false, false, "aspen"),  "aspen",)</script><script id="_mintlify-page-mode-script">document.documentElement.setAttribute('data-page-mode', 'custom');</script><script suppresshydrationwarning="true" id="_mintlify-footer-and-sidebar-scroll-script">(function n(a,b){if(!document.getElementById("footer")?.classList.contains("advanced-footer")||"maple"===b||"willow"===b||"almond"===b)return;let c=document.documentElement.getAttribute("data-page-mode"),d=document.getElementById("navbar"),e=document.getElementById("navigation-items"),f=document.getElementById("sidebar"),g=document.getElementById("footer"),h=document.getElementById("table-of-contents-content"),i=(e?.clientHeight??0)+16*a+32*("mint"===b||"linden"===b);if(!g||"center"===c)return;let j=g.getBoundingClientRect().top,k=window.innerHeight-j;f&&e&&(i>j?(f.style.top=`-${k}px`,f.style.height=`${window.innerHeight}px`):(f.style.top=`${a}rem`,f.style.height="auto")),h&&d&&(k>0?h.style.top="custom"===c?`${d.clientHeight-k}px`:`${40+d.clientHeight-k}px`:h.style.top="")})(  (function m(a,b,c){let d=document.documentElement.getAttribute("data-banner-state"),e=2.5*!!(null!=d?"visible"===d:b),f=3*!!a,g=4,h=e+g+f;switch(c){case"mint":case"palm":break;case"aspen":f=2.5*!!a,g=3.5,h=e+f+g;break;case"linden":g=4,h=e+g;break;case"almond":g=3.5,h=e+g}return h})(false, false, "aspen"),  "aspen",)</script><link rel="preload" href="https://d4tuoctqmanu0.cloudfront.net/katex.min.css" as="style"><script src="./Agents01_files/banner(1).js" async="" id="cookieyes-banner"></script><script src="./Agents01_files/reo.js" defer=""></script><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover"><meta name="next-size-adjust" content=""><title>Agents - Docs by LangChain</title><meta name="application-name" content="Docs by LangChain"><meta name="generator" content="Mintlify"><meta name="msapplication-config" content="/mintlify-assets/_mintlify/favicons/langchain-5e9cc07a/6qGJdyFkFFvLiKlZ/_generated/favicon/browserconfig.xml"><meta name="apple-mobile-web-app-title" content="Docs by LangChain"><meta name="msapplication-TileColor" content="#2F6868"><meta name="charset" content="utf-8"><meta name="og:site_name" content="Docs by LangChain"><meta name="canonical" content="https://docs.langchain.com/oss/python/langchain/agents"><meta name="google-site-verification" content="9_2KHeJwmEdwgncBRk1MsKxriZz7Sc21EJdbfCxkTEo"><link rel="canonical" href="https://docs.langchain.com/oss/python/langchain/agents"><link rel="alternate" type="application/xml" href="https://docs.langchain.com/sitemap.xml"><meta property="og:title" content="Agents - Docs by LangChain"><meta property="og:url" content="https://docs.langchain.com/oss/python/langchain/agents"><meta property="og:image" content="https://langchain-5e9cc07a.mintlify.app/mintlify-assets/_next/image?url=%2F_mintlify%2Fapi%2Fog%3Fdivision%3DCore%2Bcomponents%26appearance%3Dsystem%26title%3DAgents%26logoLight%3Dhttps%253A%252F%252Fmintcdn.com%252Flangchain-5e9cc07a%252FXbr8HuVd9jPi6qTU%252Fimages%252Fbrand%252Flangchain-docs-teal.svg%253Ffit%253Dmax%2526auto%253Dformat%2526n%253DXbr8HuVd9jPi6qTU%2526q%253D85%2526s%253D16111530672bf976cb54ef2143478342%26logoDark%3Dhttps%253A%252F%252Fmintcdn.com%252Flangchain-5e9cc07a%252FXbr8HuVd9jPi6qTU%252Fimages%252Fbrand%252Flangchain-docs-lilac.svg%253Ffit%253Dmax%2526auto%253Dformat%2526n%253DXbr8HuVd9jPi6qTU%2526q%253D85%2526s%253Db70fb1a2208670492ef94aef14b680be%26primaryColor%3D%25232F6868%26lightColor%3D%252384C4C0%26darkColor%3D%25231C3C3C%26backgroundLight%3D%2523ffffff%26backgroundDark%3D%25230b0d0f&amp;w=1200&amp;q=100"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta property="og:type" content="website"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="Agents - Docs by LangChain"><meta name="twitter:image" content="https://langchain-5e9cc07a.mintlify.app/mintlify-assets/_next/image?url=%2F_mintlify%2Fapi%2Fog%3Fdivision%3DCore%2Bcomponents%26appearance%3Dsystem%26title%3DAgents%26logoLight%3Dhttps%253A%252F%252Fmintcdn.com%252Flangchain-5e9cc07a%252FXbr8HuVd9jPi6qTU%252Fimages%252Fbrand%252Flangchain-docs-teal.svg%253Ffit%253Dmax%2526auto%253Dformat%2526n%253DXbr8HuVd9jPi6qTU%2526q%253D85%2526s%253D16111530672bf976cb54ef2143478342%26logoDark%3Dhttps%253A%252F%252Fmintcdn.com%252Flangchain-5e9cc07a%252FXbr8HuVd9jPi6qTU%252Fimages%252Fbrand%252Flangchain-docs-lilac.svg%253Ffit%253Dmax%2526auto%253Dformat%2526n%253DXbr8HuVd9jPi6qTU%2526q%253D85%2526s%253Db70fb1a2208670492ef94aef14b680be%26primaryColor%3D%25232F6868%26lightColor%3D%252384C4C0%26darkColor%3D%25231C3C3C%26backgroundLight%3D%2523ffffff%26backgroundDark%3D%25230b0d0f&amp;w=1200&amp;q=100"><meta name="twitter:image:width" content="1200"><meta name="twitter:image:height" content="630"><link rel="apple-touch-icon" href="https://docs.langchain.com/mintlify-assets/_mintlify/favicons/langchain-5e9cc07a/6qGJdyFkFFvLiKlZ/_generated/favicon/apple-touch-icon.png" type="image/png" sizes="180x180"><link rel="icon" href="https://docs.langchain.com/mintlify-assets/_mintlify/favicons/langchain-5e9cc07a/6qGJdyFkFFvLiKlZ/_generated/favicon/favicon-16x16.png" type="image/png" sizes="16x16" media="(prefers-color-scheme: light)"><link rel="icon" href="https://docs.langchain.com/mintlify-assets/_mintlify/favicons/langchain-5e9cc07a/6qGJdyFkFFvLiKlZ/_generated/favicon/favicon-32x32.png" type="image/png" sizes="32x32" media="(prefers-color-scheme: light)"><link rel="shortcut icon" href="https://docs.langchain.com/mintlify-assets/_mintlify/favicons/langchain-5e9cc07a/6qGJdyFkFFvLiKlZ/_generated/favicon/favicon.ico" type="image/x-icon" media="(prefers-color-scheme: light)"><link rel="icon" href="https://docs.langchain.com/mintlify-assets/_mintlify/favicons/langchain-5e9cc07a/6qGJdyFkFFvLiKlZ/_generated/favicon-dark/favicon-16x16.png" type="image/png" sizes="16x16" media="(prefers-color-scheme: dark)"><link rel="icon" href="https://docs.langchain.com/mintlify-assets/_mintlify/favicons/langchain-5e9cc07a/6qGJdyFkFFvLiKlZ/_generated/favicon-dark/favicon-32x32.png" type="image/png" sizes="32x32" media="(prefers-color-scheme: dark)"><link rel="shortcut icon" href="https://docs.langchain.com/mintlify-assets/_mintlify/favicons/langchain-5e9cc07a/6qGJdyFkFFvLiKlZ/_generated/favicon-dark/favicon.ico" type="image/x-icon" media="(prefers-color-scheme: dark)"></head><body><div hidden=""></div><script>((e,t,n,r,i,a,o,s)=>{let l=document.documentElement,u=["light","dark"];function c(t){(Array.isArray(e)?e:[e]).forEach(e=>{let n="class"===e,r=n&&a?i.map(e=>a[e]||e):i;n?(l.classList.remove(...r),l.classList.add(a&&a[t]?a[t]:t)):l.setAttribute(e,t)}),d(t)}function d(e){s&&u.includes(e)&&(l.style.colorScheme=e)}function f(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(r)c(r);else try{let e=localStorage.getItem(t)||n,r=o&&"system"===e?f():e;c(r)}catch(e){}})("class","isDarkMode","system",null,["dark","light","true","false","system"],{"true":"dark","false":"light","dark":"dark","light":"light"},true,true)</script><script>(self.__next_s=self.__next_s||[]).push([0,{"children":"(function j(a,b,c,d,e){try{let f,g,h=[];try{h=window.location.pathname.split(\"/\").filter(a=>\"\"!==a&&\"global\"!==a).slice(0,2)}catch{h=[]}let i=h.find(a=>c.includes(a)),j=[];for(let c of(i?j.push(i):j.push(b),j.push(\"global\"),j)){if(!c)continue;let b=a[c];if(b?.content){f=b.content,g=c;break}}if(!f)return void document.documentElement.setAttribute(d,\"hidden\");let k=!0,l=0;for(;l<localStorage.length;){let a=localStorage.key(l);if(l++,!a?.endsWith(e))continue;let b=localStorage.getItem(a);if(b&&b===f){k=!1;break}g&&(a.startsWith(`lang:${g}_`)||!a.startsWith(\"lang:\"))&&(localStorage.removeItem(a),l--)}document.documentElement.setAttribute(d,k?\"visible\":\"hidden\")}catch(a){console.error(a),document.documentElement.setAttribute(d,\"hidden\")}})(\n  {},\n  \"en\",\n  [],\n  \"data-banner-state\",\n  \"bannerDismissed\",\n)","id":"_mintlify-banner-script"}])</script><link href="./Agents01_files/css2" rel="stylesheet"><style>:root {  --font-family-headings-custom: "Manrope", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;      }</style><style>:root {    --primary: 47 104 104;    --primary-light: 132 196 192;    --primary-dark: 28 60 60;    --tooltip-foreground: 255 255 255;    --background-light: 255 255 255;    --background-dark: 11 13 15;    --gray-50: 244 246 246;    --gray-100: 239 241 241;    --gray-200: 223 225 225;    --gray-300: 207 209 209;    --gray-400: 159 161 161;    --gray-500: 113 115 115;    --gray-600: 81 83 83;    --gray-700: 63 65 65;    --gray-800: 38 40 40;    --gray-900: 24 25 25;    --gray-950: 11 13 13;  }</style><script type="text/javascript">          (function() {            function loadKatex() {              const link = document.querySelector('link[href="https://d4tuoctqmanu0.cloudfront.net/katex.min.css"]');              if (link) link.rel = 'stylesheet';            }            if (document.readyState === 'loading') {              document.addEventListener('DOMContentLoaded', loadKatex);            } else {              loadKatex();            }          })();        </script><div class="relative antialiased text-gray-500 dark:text-gray-400"><script>(self.__next_s=self.__next_s||[]).push([0,{"suppressHydrationWarning":true,"children":"(function(e,t,n,r){var s;let a,i=\"mint\"===r||\"linden\"===r?\"sidebar\":\"sidebar-content\",o=(a=\"navbar-transition\",\"maple\"===(s=r)&&(a+=\"-maple\"),\"willow\"===s&&(a+=\"-willow\"),a);function l(){document.documentElement.classList.add(\"lg:[--scroll-mt:9.5rem]\")}function c(e){document.getElementById(i)?.style.setProperty(\"top\",`${e}rem`)}function d(e){document.getElementById(i)?.style.setProperty(\"height\",`calc(100vh - ${e}rem)`)}function u(e,t){!e&&t||e&&!t?(l(),document.documentElement.classList.remove(\"lg:[--scroll-mt:12rem]\")):e&&t&&(document.documentElement.classList.add(\"lg:[--scroll-mt:12rem]\"),document.documentElement.classList.remove(\"lg:[--scroll-mt:9.5rem]\"))}let h=document.documentElement.getAttribute(\"data-banner-state\"),g=null!=h?\"visible\"===h:t;switch(r){case\"mint\":c(n),u(e,g);break;case\"palm\":case\"aspen\":c(n),d(n),u(e,g);break;case\"linden\":c(n),g&&l();break;case\"almond\":document.documentElement.style.setProperty(\"--scroll-mt\",\"2.5rem\"),c(n),d(n)}let m=function(){let e=document.createElement(\"style\");return e.appendChild(document.createTextNode(\"*,*::before,*::after{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}\")),document.head.appendChild(e),function(){window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(e)},1)}}();(\"requestAnimationFrame\"in globalThis?requestAnimationFrame:setTimeout)(()=>{let e;e=!1,e=window.scrollY>50,document.getElementById(o)?.setAttribute(\"data-is-opaque\",`${!!e}`),m()})})(\n  true,\n  false,\n  (function d(e,t,n){let r=document.documentElement.getAttribute(\"data-banner-state\"),s=2.5*!!(null!=r?\"visible\"===r:t),a=3*!!e,i=4,o=s+4+a;switch(n){case\"mint\":case\"palm\":break;case\"aspen\":i=3.5,o=s+(a=2.5*!!e)+i;break;case\"linden\":o=s+(i=4);break;case\"almond\":o=s+(i=3.5)}return o})(true, false, \"aspen\"),\n  \"aspen\",\n)","id":"_mintlify-scroll-top-script"}])</script><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MBBX68ST" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><a href="https://docs.langchain.com/oss/python/langchain/agents#content-area" class="sr-only focus:not-sr-only focus:fixed focus:top-2 focus:left-2 focus:z-50 focus:p-2 focus:text-sm focus:bg-background-light dark:focus:bg-background-dark focus:rounded-md focus:outline-primary dark:focus:outline-primary-light">Skip to main content</a><div class="max-lg:contents lg:flex lg:w-full"><div class="max-lg:contents lg:flex-1 lg:min-w-0 lg:overflow-x-clip"><div id="navbar" class="z-30 fixed lg:sticky top-0 w-full peer is-not-custom peer is-not-center peer is-not-wide peer is-not-frame"><div class="z-10 absolute w-full h-full border-b border-gray-100 dark:border-gray-800"></div><div class="z-0 absolute inset-0 bg-background-light dark:bg-background-dark"></div><div class="z-10 mx-auto relative max-w-8xl px-0 lg:px-5"><div class="relative"><div class="flex items-center lg:px-4 h-14 min-w-0 mx-4 lg:mx-0"><div class="h-full relative flex-1 flex items-center gap-x-4 min-w-0"><div class="flex-1 flex items-center gap-x-4"><a class="" href="https://docs.langchain.com/"><span class="sr-only">Docs by LangChain home page</span><img class="nav-logo w-auto relative object-contain block dark:hidden h-6" alt="light logo" src="./Agents01_files/langchain-docs-teal.svg"><img class="nav-logo w-auto relative object-contain hidden dark:block h-6" alt="dark logo" src="./Agents01_files/langchain-docs-lilac.svg"></a><div class="hidden lg:flex items-center gap-x-2"></div><button type="button" id="radix-_r_16_" aria-haspopup="menu" aria-expanded="false" data-state="closed" class="group disabled:pointer-events-none [&amp;&gt;span]:line-clamp-1 overflow-hidden group group-hover:text-gray-950/70 dark:group-hover:text-white/70 nav-dropdown-products-selector-trigger py-1.5 px-2.5 rounded-xl hover:!bg-gray-600/5 dark:hover:!bg-gray-200/5 aria-[expanded=true]:bg-gray-600/5 dark:aria-[expanded=true]:bg-gray-200/5 text-sm font-medium text-gray-900 h-8 focus:outline-primary dark:text-gray-300 group/trigger flex items-center gap-2 whitespace-nowrap max-lg:hidden"><svg class="size-4 shrink-0 bg-gray-800 dark:bg-gray-100" style="mask-image: url(&quot;https://d3gk2c5xim1je2.cloudfront.net/v7.1.0/regular/link.svg&quot;); mask-repeat: no-repeat; mask-position: center center;"></svg><span class="truncate max-w-[12.5rem]" title="LangChain + LangGraph">LangChain + LangGraph</span><svg width="8" height="24" viewBox="0 -9 3 24" class="transition-transform text-gray-400 overflow-visible group-hover:text-gray-600 dark:text-gray-600 dark:group-hover:text-gray-400 rotate-90 ml-auto group-aria-[expanded=true]/trigger:rotate-[270deg]"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></button></div><div class="relative hidden lg:flex items-center flex-1 z-20 justify-center"><button type="button" class="flex pointer-events-auto w-full items-center text-sm leading-6 h-9 pl-3.5 pr-3 text-gray-500 dark:text-white/50 dark:brightness-[1.1] dark:hover:brightness-[1.25] ring-gray-400/30 hover:ring-gray-600/30 dark:ring-gray-600/30 dark:hover:ring-gray-500/30 justify-between truncate gap-2 min-w-[43px] max-w-sm bg-gray-950/[0.03] dark:bg-white/[0.03] hover:bg-gray-950/10 dark:hover:bg-white/10 rounded-full shadow-none border-none ring-0 dark:ring-0" id="search-bar-entry" aria-label="Open search"><div class="flex items-center gap-2 min-w-[42px]"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search min-w-4 flex-none text-gray-700 hover:text-gray-800 dark:text-gray-400 hover:dark:text-gray-200"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.3-4.3"></path></svg><div class="truncate min-w-0">Search...</div></div><span class="flex-none text-xs font-semibold">âŒ˜K</span></button></div><div class="topbar-right-container hidden lg:flex flex-1 items-center gap-2 ml-auto justify-end"><div class="flex relative items-center justify-end space-x-4"><nav class="text-sm"><ul class="flex gap-2 items-center"><li class="navbar-link"><a href="https://support.langchain.com/" class="flex items-center gap-2 whitespace-nowrap font-medium text-gray-800 dark:text-gray-50 bg-gray-950/[0.03] dark:bg-white/[0.03] hover:bg-gray-950/10 dark:hover:bg-white/10 rounded-xl px-[14px] py-2" target="_blank">Support</a></li><li class="navbar-link"><a href="https://github.com/langchain-ai" class="flex items-center gap-2 whitespace-nowrap font-medium text-gray-800 dark:text-gray-50 bg-gray-950/[0.03] dark:bg-white/[0.03] hover:bg-gray-950/10 dark:hover:bg-white/10 rounded-xl px-[14px] py-2" target="_blank"><svg class="h-4 w-4 bg-gray-800 dark:bg-gray-100" style="mask-image: url(&quot;https://d3gk2c5xim1je2.cloudfront.net/v7.1.0/brands/github.svg&quot;); mask-repeat: no-repeat; mask-position: center center;"></svg>GitHub</a></li><li class="block lg:hidden"><a class="flex items-center gap-2 whitespace-nowrap font-medium text-gray-800 dark:text-gray-50 bg-gray-950/[0.03] dark:bg-white/[0.03] hover:bg-gray-950/10 dark:hover:bg-white/10 rounded-xl px-[14px] py-2" href="https://smith.langchain.com/">Try LangSmith</a></li><li class="whitespace-nowrap hidden lg:flex" id="topbar-cta-button"><a target="_blank" class="group px-4 py-1.5 relative inline-flex items-center text-sm font-medium" href="https://smith.langchain.com/"><span class="absolute inset-0 bg-primary-dark rounded-xl group-hover:opacity-[0.9]"></span><div class="mr-0.5 space-x-2.5 flex items-center"><span class="z-10 text-white">Try LangSmith</span><svg width="3" height="24" viewBox="0 -9 3 24" class="h-5 rotate-0 overflow-visible text-white/90"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></div></a></li></ul></nav></div><button class="group p-2 flex items-center justify-center w-[30px] h-[30px] rounded-full bg-gray-800/[0.04] dark:bg-white/10" aria-label="Toggle dark mode"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 block dark:hidden text-gray-600 group-hover:text-gray-800"><g clip-path="url(#clip0_2880_7340)"><path d="M8 1.11133V2.00022" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12.8711 3.12891L12.2427 3.75735" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M14.8889 8H14" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12.8711 12.8711L12.2427 12.2427" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M8 14.8889V14" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M3.12891 12.8711L3.75735 12.2427" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M1.11133 8H2.00022" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M3.12891 3.12891L3.75735 3.75735" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M8.00043 11.7782C10.0868 11.7782 11.7782 10.0868 11.7782 8.00043C11.7782 5.91402 10.0868 4.22266 8.00043 4.22266C5.91402 4.22266 4.22266 5.91402 4.22266 8.00043C4.22266 10.0868 5.91402 11.7782 8.00043 11.7782Z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></g><defs><clippath id="clip0_2880_7340"><rect width="16" height="16" fill="white"></rect></clippath></defs></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon h-4 w-4 hidden dark:block text-gray-300 dark:group-hover:text-gray-100"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path></svg></button></div><div class="flex lg:hidden items-center gap-3"><button type="button" class="text-gray-500 w-8 h-8 flex items-center justify-center hover:text-gray-600 dark:text-gray-400 dark:hover:text-gray-300" id="search-bar-entry-mobile" aria-label="Open search"><span class="sr-only">Search...</span><svg class="h-4 w-4 bg-gray-500 dark:bg-gray-400 hover:bg-gray-600 dark:hover:bg-gray-300" style="mask-image: url(&quot;https://d3gk2c5xim1je2.cloudfront.net/v7.1.0/solid/magnifying-glass.svg&quot;); mask-repeat: no-repeat; mask-position: center center;"></svg></button><button aria-label="More actions" class="h-7 w-5 flex items-center justify-end"><svg class="h-4 w-4 bg-gray-500 dark:bg-gray-400 hover:bg-gray-600 dark:hover:bg-gray-300" style="mask-image: url(&quot;https://d3gk2c5xim1je2.cloudfront.net/v7.1.0/solid/ellipsis-vertical.svg&quot;); mask-repeat: no-repeat; mask-position: center center;"></svg></button></div></div></div><button type="button" class="flex items-center h-14 py-4 px-5 lg:hidden focus:outline-0 w-full text-left"><div class="text-gray-500 hover:text-gray-600 dark:text-gray-400 dark:hover:text-gray-300"><span class="sr-only">Navigation</span><svg class="h-4" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"></path></svg></div><div class="ml-4 flex text-sm leading-6 whitespace-nowrap min-w-0 space-x-3 overflow-hidden"><div class="flex items-center space-x-3 flex-shrink-0"><span>Core components</span><svg width="3" height="24" viewBox="0 -9 3 24" class="h-5 rotate-0 overflow-visible fill-gray-400"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></div><div class="font-semibold text-gray-900 truncate dark:text-gray-200 min-w-0 flex-1">Agents</div></div></button></div><div class="hidden lg:flex px-4 h-10"><div class="nav-tabs h-full flex text-sm gap-x-6"><a class="link nav-tabs-item group relative h-full gap-2 flex items-center font-medium [text-shadow:-0.2px_0_0_currentColor,0.2px_0_0_currentColor] text-primary dark:text-primary-light hover:text-primary dark:hover:text-primary-light" href="https://docs.langchain.com/oss/python/langchain/overview">LangChain<div class="absolute bottom-0 w-full left-0 bg-primary dark:bg-primary-light h-px"></div></a><a class="link nav-tabs-item group relative h-full gap-2 flex items-center font-medium hover:text-gray-800 dark:hover:text-gray-300 text-gray-800 dark:text-gray-200" href="https://docs.langchain.com/oss/python/langgraph/overview">LangGraph<div class="absolute bottom-0 w-full left-0 group-hover:bg-gray-200 dark:group-hover:bg-gray-700 h-px"></div></a><a class="link nav-tabs-item group relative h-full gap-2 flex items-center font-medium hover:text-gray-800 dark:hover:text-gray-300 text-gray-800 dark:text-gray-200" href="https://docs.langchain.com/oss/python/deepagents/overview">Deep Agents<div class="absolute bottom-0 w-full left-0 group-hover:bg-gray-200 dark:group-hover:bg-gray-700 h-px"></div></a><a class="link nav-tabs-item group relative h-full gap-2 flex items-center font-medium hover:text-gray-800 dark:hover:text-gray-300 text-gray-800 dark:text-gray-200" href="https://docs.langchain.com/oss/python/integrations/providers/overview">Integrations<div class="absolute bottom-0 w-full left-0 group-hover:bg-gray-200 dark:group-hover:bg-gray-700 h-px"></div></a><a class="link nav-tabs-item group relative h-full gap-2 flex items-center font-medium hover:text-gray-800 dark:hover:text-gray-300 text-gray-800 dark:text-gray-200" href="https://docs.langchain.com/oss/python/learn">Learn<div class="absolute bottom-0 w-full left-0 group-hover:bg-gray-200 dark:group-hover:bg-gray-700 h-px"></div></a><a class="link nav-tabs-item group relative h-full gap-2 flex items-center font-medium hover:text-gray-800 dark:hover:text-gray-300 text-gray-800 dark:text-gray-200" href="https://docs.langchain.com/oss/python/reference/overview">Reference<div class="absolute bottom-0 w-full left-0 group-hover:bg-gray-200 dark:group-hover:bg-gray-700 h-px"></div></a><a class="link nav-tabs-item group relative h-full gap-2 flex items-center font-medium hover:text-gray-800 dark:hover:text-gray-300 text-gray-800 dark:text-gray-200" href="https://docs.langchain.com/oss/python/contributing/overview">Contribute<div class="absolute bottom-0 w-full left-0 group-hover:bg-gray-200 dark:group-hover:bg-gray-700 h-px"></div></a></div></div></div></div><div id="body-content" class="peer-[.is-custom]:max-w-none peer-[.is-not-custom]:max-w-8xl peer-[.is-not-custom]:lg:flex peer-[.is-not-custom]:mx-auto peer-[.is-not-custom]:px-0 peer-[.is-not-custom]:lg:px-5 peer-[.is-custom]:[&amp;&gt;div:first-child]:!hidden peer-[.is-custom]:[&amp;&gt;div:first-child]:sm:!hidden peer-[.is-custom]:[&amp;&gt;div:first-child]:md:!hidden peer-[.is-custom]:[&amp;&gt;div:first-child]:lg:!hidden peer-[.is-custom]:[&amp;&gt;div:first-child]:xl:!hidden"><div id="sidebar-content" class="hidden sticky shrink-0 w-[18rem] lg:flex flex-col left-0 top-[7rem] bottom-0 right-auto border-r border-gray-100 dark:border-white/10 transition-transform duration-100" style="top: 6rem; height: calc(-6rem + 100vh);"><div class="flex-1 pr-5 pt-5 pb-4 overflow-y-auto stable-scrollbar-gutter" id="navigation-items" style=""><div class="text-sm relative"><div class="pl-2"><button type="button" id="radix-_r_2_" aria-haspopup="menu" aria-expanded="false" data-state="closed" class="group disabled:pointer-events-none [&amp;&gt;span]:line-clamp-1 overflow-hidden group text-sm text-gray-950/50 dark:text-white/50 group-hover:text-gray-950/70 dark:group-hover:text-white/70 nav-dropdown-trigger mb-4 z-10 group flex w-full items-center pl-2 pr-3.5 py-1.5 rounded-[0.85rem] border border-gray-200/70 dark:border-white/[0.07] hover:bg-gray-600/5 dark:hover:bg-gray-200/5 gap-1"><div class="nav-dropdown-item-icon h-8 w-8 flex items-center justify-center rounded-lg flex-shrink-0 border border-gray-200/70 dark:border-white/[0.07]"><svg class="h-4 w-4 bg-primary dark:bg-primary-light" style="mask-image: url(&quot;https://d3gk2c5xim1je2.cloudfront.net/v7.1.0/brands/python.svg&quot;); mask-repeat: no-repeat; mask-position: center center;"></svg></div><div class="nav-dropdown-item-text-container flex-1 px-1 flex flex-col grow text-left"><p class="nav-dropdown-item-title text-base lg:text-sm font-medium text-gray-800 dark:text-gray-300">Python</p></div><svg width="8" height="24" viewBox="0 -9 3 24" class="transition-transform text-gray-400 overflow-visible group-hover:text-gray-600 dark:text-gray-600 dark:group-hover:text-gray-400 rotate-90"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></button></div><ul class="list-none"></ul><ul class="sidebar-group mt-6 lg:mt-8"><li id="/oss/python/langchain/overview" class="relative scroll-m-4 first:scroll-m-20" data-title="Overview"><a class="group flex items-center pr-3 py-1.5 cursor-pointer gap-x-3 text-left break-words hyphens-auto rounded-xl w-full outline-offset-[-1px] hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="https://docs.langchain.com/oss/python/langchain/overview" style="padding-left: 1rem;"><div class="flex-1 flex items-center space-x-2.5"><div class="">Overview</div></div></a></li></ul><div class="px-1 py-3"><div class="sidebar-nav-group-divider h-px w-full bg-gray-100 dark:bg-white/10"></div></div><div class="my-2"><div class="sidebar-group-header flex items-center gap-2.5 pl-4 mb-3.5 lg:mb-2.5 font-semibold text-gray-700 dark:text-gray-300 text-xs"><h5 id="sidebar-title">Get started</h5></div><ul id="sidebar-group" class="sidebar-group space-y-px"><li id="/oss/python/langchain/install" class="relative scroll-m-4 first:scroll-m-20" data-title="Install"><a class="group flex items-center pr-3 py-1.5 cursor-pointer gap-x-3 text-left break-words hyphens-auto rounded-xl w-full outline-offset-[-1px] hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="https://docs.langchain.com/oss/python/langchain/install" style="padding-left: 1rem;"><div class="flex-1 flex items-center space-x-2.5"><div class="">Install</div></div></a></li><li id="/oss/python/langchain/quickstart" class="relative scroll-m-4 first:scroll-m-20" data-title="Quickstart"><a class="group flex items-center pr-3 py-1.5 cursor-pointer gap-x-3 text-left break-words hyphens-auto rounded-xl w-full outline-offset-[-1px] hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="https://docs.langchain.com/oss/python/langchain/quickstart" style="padding-left: 1rem;"><div class="flex-1 flex items-center space-x-2.5"><div class="">Quickstart</div></div></a></li><li id="https://docs.langchain.com/oss/python/releases/changelog" class="relative scroll-m-4 first:scroll-m-20" data-title="Changelog"><a class="group flex items-center pr-3 py-1.5 cursor-pointer gap-x-3 text-left break-words hyphens-auto rounded-xl w-full outline-offset-[-1px] hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" target="_blank" href="https://docs.langchain.com/oss/python/releases/changelog" style="padding-left: 1rem;"><div class="flex-1 flex items-center space-x-2.5"><div class="">Changelog</div><div class="flex-1 flex justify-end"><svg class="h-2.5 text-gray-400 overflow-visible group-hover:text-gray-600 dark:text-gray-600 dark:group-hover:text-gray-400 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" fill="currentColor"><path d="M328 96c13.3 0 24 10.7 24 24V360c0 13.3-10.7 24-24 24s-24-10.7-24-24V177.9L73 409c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l231-231H88c-13.3 0-24-10.7-24-24s10.7-24 24-24H328z"></path></svg></div></div></a></li><li id="/oss/python/langchain/philosophy" class="relative scroll-m-4 first:scroll-m-20" data-title="Philosophy"><a class="group flex items-center pr-3 py-1.5 cursor-pointer gap-x-3 text-left break-words hyphens-auto rounded-xl w-full outline-offset-[-1px] hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="https://docs.langchain.com/oss/python/langchain/philosophy" style="padding-left: 1rem;"><div class="flex-1 flex items-center space-x-2.5"><div class="">Philosophy</div></div></a></li></ul></div><div class="px-1 py-3"><div class="sidebar-nav-group-divider h-px w-full bg-gray-100 dark:bg-white/10"></div></div><div class="my-2"><div class="sidebar-group-header flex items-center gap-2.5 pl-4 mb-3.5 lg:mb-2.5 font-semibold text-gray-700 dark:text-gray-300 text-xs"><h5 id="sidebar-title">Core components</h5></div><ul id="sidebar-group" class="sidebar-group space-y-px"><li id="/oss/python/langchain/agents" class="relative scroll-m-4 first:scroll-m-20" data-title="Agents"><a class="group flex items-center pr-3 py-1.5 cursor-pointer gap-x-3 text-left break-words hyphens-auto rounded-xl w-full outline-offset-[-1px] bg-primary/10 text-primary [text-shadow:-0.2px_0_0_currentColor,0.2px_0_0_currentColor] dark:text-primary-light dark:bg-primary-light/10" href="https://docs.langchain.com/oss/python/langchain/agents" style="padding-left: 1rem;"><div class="flex-1 flex items-center space-x-2.5"><div class="">Agents</div></div></a></li><li id="/oss/python/langchain/models" class="relative scroll-m-4 first:scroll-m-20" data-title="Models"><a class="group flex items-center pr-3 py-1.5 cursor-pointer gap-x-3 text-left break-words hyphens-auto rounded-xl w-full outline-offset-[-1px] hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="https://docs.langchain.com/oss/python/langchain/models" style="padding-left: 1rem;"><div class="flex-1 flex items-center space-x-2.5"><div class="">Models</div></div></a></li><li id="/oss/python/langchain/messages" class="relative scroll-m-4 first:scroll-m-20" data-title="Messages"><a class="group flex items-center pr-3 py-1.5 cursor-pointer gap-x-3 text-left break-words hyphens-auto rounded-xl w-full outline-offset-[-1px] hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="https://docs.langchain.com/oss/python/langchain/messages" style="padding-left: 1rem;"><div class="flex-1 flex items-center space-x-2.5"><div class="">Messages</div></div></a></li><li id="/oss/python/langchain/tools" class="relative scroll-m-4 first:scroll-m-20" data-title="Tools"><a class="group flex items-center pr-3 py-1.5 cursor-pointer gap-x-3 text-left break-words hyphens-auto rounded-xl w-full outline-offset-[-1px] hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="https://docs.langchain.com/oss/python/langchain/tools" style="padding-left: 1rem;"><div class="flex-1 flex items-center space-x-2.5"><div class="">Tools</div></div></a></li><li id="/oss/python/langchain/short-term-memory" class="relative scroll-m-4 first:scroll-m-20" data-title="Short-term memory"><a class="group flex items-center pr-3 py-1.5 cursor-pointer gap-x-3 text-left rounded-xl w-full outline-offset-[-1px] hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="https://docs.langchain.com/oss/python/langchain/short-term-memory" style="padding-left: 1rem;"><div class="flex-1 flex items-center space-x-2.5"><div class="">Short-term memory</div></div></a></li><li id="/oss/python/langchain/streaming" class="relative scroll-m-4 first:scroll-m-20" data-title="Streaming"><a class="group flex items-center pr-3 py-1.5 cursor-pointer gap-x-3 text-left break-words hyphens-auto rounded-xl w-full outline-offset-[-1px] hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="https://docs.langchain.com/oss/python/langchain/streaming" style="padding-left: 1rem;"><div class="flex-1 flex items-center space-x-2.5"><div class="">Streaming</div></div></a></li><li id="/oss/python/langchain/structured-output" class="relative scroll-m-4 first:scroll-m-20" data-title="Structured output"><a class="group flex items-center pr-3 py-1.5 cursor-pointer gap-x-3 text-left rounded-xl w-full outline-offset-[-1px] hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="https://docs.langchain.com/oss/python/langchain/structured-output" style="padding-left: 1rem;"><div class="flex-1 flex items-center space-x-2.5"><div class="">Structured output</div></div></a></li></ul></div><div class="px-1 py-3"><div class="sidebar-nav-group-divider h-px w-full bg-gray-100 dark:bg-white/10"></div></div><div class="my-2"><div class="sidebar-group-header flex items-center gap-2.5 pl-4 mb-3.5 lg:mb-2.5 font-semibold text-gray-700 dark:text-gray-300 text-xs"><h5 id="sidebar-title">Middleware</h5></div><ul id="sidebar-group" class="sidebar-group space-y-px"><li id="/oss/python/langchain/middleware/overview" class="relative scroll-m-4 first:scroll-m-20" data-title="Overview"><a class="group flex items-center pr-3 py-1.5 cursor-pointer gap-x-3 text-left break-words hyphens-auto rounded-xl w-full outline-offset-[-1px] hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="https://docs.langchain.com/oss/python/langchain/middleware/overview" style="padding-left: 1rem;"><div class="flex-1 flex items-center space-x-2.5"><div class="">Overview</div></div></a></li><li id="/oss/python/langchain/middleware/built-in" class="relative scroll-m-4 first:scroll-m-20" data-title="Built-in middleware"><a class="group flex items-center pr-3 py-1.5 cursor-pointer gap-x-3 text-left rounded-xl w-full outline-offset-[-1px] hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="https://docs.langchain.com/oss/python/langchain/middleware/built-in" style="padding-left: 1rem;"><div class="flex-1 flex items-center space-x-2.5"><div class="">Built-in middleware</div></div></a></li><li id="/oss/python/langchain/middleware/custom" class="relative scroll-m-4 first:scroll-m-20" data-title="Custom middleware"><a class="group flex items-center pr-3 py-1.5 cursor-pointer gap-x-3 text-left rounded-xl w-full outline-offset-[-1px] hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="https://docs.langchain.com/oss/python/langchain/middleware/custom" style="padding-left: 1rem;"><div class="flex-1 flex items-center space-x-2.5"><div class="">Custom middleware</div></div></a></li></ul></div><div class="px-1 py-3"><div class="sidebar-nav-group-divider h-px w-full bg-gray-100 dark:bg-white/10"></div></div><div class="my-2"><div class="sidebar-group-header flex items-center gap-2.5 pl-4 mb-3.5 lg:mb-2.5 font-semibold text-gray-700 dark:text-gray-300 text-xs"><h5 id="sidebar-title">Advanced usage</h5></div><ul id="sidebar-group" class="sidebar-group space-y-px"><li id="/oss/python/langchain/guardrails" class="relative scroll-m-4 first:scroll-m-20" data-title="Guardrails"><a class="group flex items-center pr-3 py-1.5 cursor-pointer gap-x-3 text-left break-words hyphens-auto rounded-xl w-full outline-offset-[-1px] hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="https://docs.langchain.com/oss/python/langchain/guardrails" style="padding-left: 1rem;"><div class="flex-1 flex items-center space-x-2.5"><div class="">Guardrails</div></div></a></li><li id="/oss/python/langchain/runtime" class="relative scroll-m-4 first:scroll-m-20" data-title="Runtime"><a class="group flex items-center pr-3 py-1.5 cursor-pointer gap-x-3 text-left break-words hyphens-auto rounded-xl w-full outline-offset-[-1px] hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="https://docs.langchain.com/oss/python/langchain/runtime" style="padding-left: 1rem;"><div class="flex-1 flex items-center space-x-2.5"><div class="">Runtime</div></div></a></li><li id="/oss/python/langchain/context-engineering" class="relative scroll-m-4 first:scroll-m-20" data-title="Context engineering"><a class="group flex items-center pr-3 py-1.5 cursor-pointer gap-x-3 text-left rounded-xl w-full outline-offset-[-1px] hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="https://docs.langchain.com/oss/python/langchain/context-engineering" style="padding-left: 1rem;"><div class="flex-1 flex items-center space-x-2.5"><div class="">Context engineering</div></div></a></li><li id="/oss/python/langchain/mcp" class="relative scroll-m-4 first:scroll-m-20" data-title="Model Context Protocol (MCP)"><a class="group flex items-center pr-3 py-1.5 cursor-pointer gap-x-3 text-left rounded-xl w-full outline-offset-[-1px] hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="https://docs.langchain.com/oss/python/langchain/mcp" style="padding-left: 1rem;"><div class="flex-1 flex items-center space-x-2.5"><div class="">Model Context Protocol (MCP)</div></div></a></li><li id="/oss/python/langchain/human-in-the-loop" class="relative scroll-m-4 first:scroll-m-20" data-title="Human-in-the-loop"><a class="group flex items-center pr-3 py-1.5 cursor-pointer gap-x-3 text-left break-words hyphens-auto rounded-xl w-full outline-offset-[-1px] hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="https://docs.langchain.com/oss/python/langchain/human-in-the-loop" style="padding-left: 1rem;"><div class="flex-1 flex items-center space-x-2.5"><div class="">Human-in-the-loop</div></div></a></li><li data-title="Multi-agent" data-group-tag="" class="space-y-px"><button class="group flex items-center pr-3 py-1.5 cursor-pointer gap-x-3 text-left break-words hyphens-auto rounded-xl w-full outline-offset-[-1px] hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" aria-label="Toggle Multi-agent section" aria-expanded="false" style="padding-left: 1rem;"><div class="flex-1 flex items-center gap-2 justify-start">Multi-agent</div><svg width="8" height="24" viewBox="0 -9 3 24" class="transition-transform text-gray-400 overflow-visible group-hover:text-gray-600 dark:text-gray-600 dark:group-hover:text-gray-400 w-2 h-5 -mr-0.5"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></button></li><li id="/oss/python/langchain/retrieval" class="relative scroll-m-4 first:scroll-m-20" data-title="Retrieval"><a class="group flex items-center pr-3 py-1.5 cursor-pointer gap-x-3 text-left break-words hyphens-auto rounded-xl w-full outline-offset-[-1px] hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="https://docs.langchain.com/oss/python/langchain/retrieval" style="padding-left: 1rem;"><div class="flex-1 flex items-center space-x-2.5"><div class="">Retrieval</div></div></a></li><li id="/oss/python/langchain/long-term-memory" class="relative scroll-m-4 first:scroll-m-20" data-title="Long-term memory"><a class="group flex items-center pr-3 py-1.5 cursor-pointer gap-x-3 text-left rounded-xl w-full outline-offset-[-1px] hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="https://docs.langchain.com/oss/python/langchain/long-term-memory" style="padding-left: 1rem;"><div class="flex-1 flex items-center space-x-2.5"><div class="">Long-term memory</div></div></a></li></ul></div><div class="px-1 py-3"><div class="sidebar-nav-group-divider h-px w-full bg-gray-100 dark:bg-white/10"></div></div><div class="my-2"><div class="sidebar-group-header flex items-center gap-2.5 pl-4 mb-3.5 lg:mb-2.5 font-semibold text-gray-700 dark:text-gray-300 text-xs"><h5 id="sidebar-title">Agent development</h5></div><ul id="sidebar-group" class="sidebar-group space-y-px"><li id="/oss/python/langchain/studio" class="relative scroll-m-4 first:scroll-m-20" data-title="LangSmith Studio"><a class="group flex items-center pr-3 py-1.5 cursor-pointer gap-x-3 text-left rounded-xl w-full outline-offset-[-1px] hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="https://docs.langchain.com/oss/python/langchain/studio" style="padding-left: 1rem;"><div class="flex-1 flex items-center space-x-2.5"><div class="">LangSmith Studio</div></div></a></li><li id="/oss/python/langchain/test" class="relative scroll-m-4 first:scroll-m-20" data-title="Test"><a class="group flex items-center pr-3 py-1.5 cursor-pointer gap-x-3 text-left break-words hyphens-auto rounded-xl w-full outline-offset-[-1px] hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="https://docs.langchain.com/oss/python/langchain/test" style="padding-left: 1rem;"><div class="flex-1 flex items-center space-x-2.5"><div class="">Test</div></div></a></li><li id="/oss/python/langchain/ui" class="relative scroll-m-4 first:scroll-m-20" data-title="Agent Chat UI"><a class="group flex items-center pr-3 py-1.5 cursor-pointer gap-x-3 text-left rounded-xl w-full outline-offset-[-1px] hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="https://docs.langchain.com/oss/python/langchain/ui" style="padding-left: 1rem;"><div class="flex-1 flex items-center space-x-2.5"><div class="">Agent Chat UI</div></div></a></li></ul></div><div class="px-1 py-3"><div class="sidebar-nav-group-divider h-px w-full bg-gray-100 dark:bg-white/10"></div></div><div class="my-2"><div class="sidebar-group-header flex items-center gap-2.5 pl-4 mb-3.5 lg:mb-2.5 font-semibold text-gray-700 dark:text-gray-300 text-xs"><h5 id="sidebar-title">Deploy with LangSmith</h5></div><ul id="sidebar-group" class="sidebar-group space-y-px"><li id="/oss/python/langchain/deploy" class="relative scroll-m-4 first:scroll-m-20" data-title="Deployment"><a class="group flex items-center pr-3 py-1.5 cursor-pointer gap-x-3 text-left break-words hyphens-auto rounded-xl w-full outline-offset-[-1px] hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="https://docs.langchain.com/oss/python/langchain/deploy" style="padding-left: 1rem;"><div class="flex-1 flex items-center space-x-2.5"><div class="">Deployment</div></div></a></li><li id="/oss/python/langchain/observability" class="relative scroll-m-4 first:scroll-m-20" data-title="Observability"><a class="group flex items-center pr-3 py-1.5 cursor-pointer gap-x-3 text-left break-words hyphens-auto rounded-xl w-full outline-offset-[-1px] hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="https://docs.langchain.com/oss/python/langchain/observability" style="padding-left: 1rem;"><div class="flex-1 flex items-center space-x-2.5"><div class="">Observability</div></div></a></li></ul></div></div></div></div><!--$--><!--/$--><script>(self.__next_s=self.__next_s||[]).push([0,{"children":"document.documentElement.setAttribute('data-page-mode', 'none');","id":"_mintlify-page-mode-script"}])</script><script>(self.__next_s=self.__next_s||[]).push([0,{"suppressHydrationWarning":true,"children":"(function h(e,t){if(!document.getElementById(\"footer\")?.classList.contains(\"advanced-footer\")||\"maple\"===t||\"willow\"===t||\"almond\"===t)return;let n=document.documentElement.getAttribute(\"data-page-mode\"),r=document.getElementById(\"navbar\"),s=document.getElementById(\"navigation-items\"),a=document.getElementById(\"sidebar\"),i=document.getElementById(\"footer\"),o=document.getElementById(\"table-of-contents-content\"),l=(s?.clientHeight??0)+16*e+32*(\"mint\"===t||\"linden\"===t);if(!i||\"center\"===n)return;let c=i.getBoundingClientRect().top,d=window.innerHeight-c;a&&s&&(l>c?(a.style.top=`-${d}px`,a.style.height=`${window.innerHeight}px`):(a.style.top=`${e}rem`,a.style.height=\"auto\")),o&&r&&(d>0?o.style.top=\"custom\"===n?`${r.clientHeight-d}px`:`${40+r.clientHeight-d}px`:o.style.top=\"\")})(\n  (function d(e,t,n){let r=document.documentElement.getAttribute(\"data-banner-state\"),s=2.5*!!(null!=r?\"visible\"===r:t),a=3*!!e,i=4,o=s+4+a;switch(n){case\"mint\":case\"palm\":break;case\"aspen\":i=3.5,o=s+(a=2.5*!!e)+i;break;case\"linden\":o=s+(i=4);break;case\"almond\":o=s+(i=3.5)}return o})(true, false, \"aspen\"),\n  \"aspen\",\n)","id":"_mintlify-footer-and-sidebar-scroll-script"}])</script><span class="fixed inset-0 bg-background-light dark:bg-background-dark -z-10 pointer-events-none" id="almond-background-color"></span><style data-custom-css-index="0" data-custom-css-path="style.css">/* Make sidebar title heavier weight */#sidebar-title {    font-weight: 600 !important;  }/* Inline code links have same color and underline as regular links */a code,a[href] code {  color: inherit !important;  text-decoration: none !important; /* Remove underline from code itself */  padding: 0 !important; /* Remove padding to prevent gaps in parent link underline */}/* Ensure callout links and lists match callout text formatting */.callout a,[class*="callout"] a {  font-size: inherit !important; /* Match callout text size */  color: inherit !important; /* Match callout text color */}.callout ul,.callout ol,.callout li,[class*="callout"] ul,[class*="callout"] ol,[class*="callout"] li {  font-size: inherit !important; /* Match callout text size */  color: inherit !important; /* Match callout text color */  line-height: inherit !important; /* Match callout line height */}.callout p,[class*="callout"] p {  font-size: inherit !important; /* Match callout text size */  color: inherit !important; /* Match callout text color */}/* Ensure bold and italic text inherit callout formatting */.callout strong,.callout b,.callout em,.callout i,[class*="callout"] strong,[class*="callout"] b,[class*="callout"] em,[class*="callout"] i {  font-size: inherit !important; /* Match callout text size */  color: inherit !important; /* Match callout text color */}/* Ensure mermaid diagrams are centered */.mermaid {    text-align: center;    display: flex;    justify-content: center;  }.mermaid .labelBkg {  background-color: white !important;  border: 1px solid #2F6868 !important;  border-radius: 4px !important;  padding: 0 4px !important;}.mermaid .labelBkg:not(:has(p)) {  display: none !important;}.mermaid .edgeLabel {  color: #1C3C3C !important;}.dark .mermaid .labelBkg {  background-color: #1C3C3C !important;  border-color: #84C4C0 !important;}.dark .mermaid .edgeLabel {  color: #84C4C0 !important;}/* Fix vertical alignment in table cells with mixed content (text and images) */.prose table td, article table td, .markdown table td, .content table td, [class*="prose"] table td,.prose table th, article table th, .markdown table th, .content table th, [class*="prose"] table th {  vertical-align: middle !important; /* Center align content vertically */  line-height: 1.5 !important; /* Consistent line height */}/* Hide pagination */#pagination {    display: none;  }/* Improve banner link readability in light mode */#banner a {  color: inherit !important;  text-decoration: none !important;}/* Compact first column for multi agent pattern comparison tables (no horizontal scroll) */.compact-first-col [data-table-wrapper] {  overflow-x: visible !important;}.compact-first-col table {  table-layout: auto !important;  width: 100% !important;}.compact-first-col table td,.compact-first-col table th {  min-width: 0 !important;}.compact-first-col table td:first-child,.compact-first-col table th:first-child {  width: 1% !important;  white-space: nowrap !important;}/* Hide auto-generated callouts on home page */.home-page ~ :is(.callout, [data-callout-type]) {  display: none !important;}</style><div class="w-full"><div class="px-5 lg:pr-10 lg:pl-[5.5rem] lg:pt-10 mx-auto max-w-6xl flex flex-row-reverse gap-x-12 w-full pt-36" id="content-container"><div class="hidden xl:flex self-start sticky xl:flex-col max-w-[28rem] z-[21] h-[calc(100vh-9.5rem)] top-[calc(9.5rem-var(--sidenav-move-up,0px))]" id="content-side-layout"><div class="z-10 hidden xl:flex pl-10 box-border w-[19rem] max-h-full" id="table-of-contents-layout"><div class="text-gray-600 text-sm leading-6 w-[16.5rem] overflow-y-auto space-y-2 pb-4 -mt-10 pt-10" id="table-of-contents"><button class="text-gray-700 dark:text-gray-300 font-medium flex items-center space-x-2 hover:text-gray-900 dark:hover:text-gray-100 transition-colors cursor-pointer"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="2" xmlns="http://www.w3.org/2000/svg" class="h-3 w-3"><path d="M2.44434 12.6665H13.5554" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.44434 3.3335H13.5554" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.44434 8H7.33323" stroke-linecap="round" stroke-linejoin="round"></path></svg><span>On this page</span></button><ul id="table-of-contents-content" class="toc"><li class="toc-item relative" data-depth="0"><a href="https://docs.langchain.com/oss/python/langchain/agents#core-components" class="py-1 block border-l pl-4 font-medium text-primary dark:text-primary-light border-primary dark:border-primary-light hover:border-primary dark:hover:border-primary-light">Core components</a></li><li class="toc-item relative border-l pl-4 border-gray-950/5 dark:border-white/10 hover:border-gray-950/20 dark:hover:border-white/20" data-depth="1"><a href="https://docs.langchain.com/oss/python/langchain/agents#model" class="group flex items-start py-1 whitespace-pre-wrap text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" style="padding-left: 1rem;">Model</a></li><li class="toc-item relative border-l pl-4 border-gray-950/5 dark:border-white/10 hover:border-gray-950/20 dark:hover:border-white/20" data-depth="2"><a href="https://docs.langchain.com/oss/python/langchain/agents#static-model" class="group flex items-start py-1 whitespace-pre-wrap text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" style="padding-left: 2rem;">Static model</a></li><li class="toc-item relative border-l pl-4 border-gray-950/5 dark:border-white/10 hover:border-gray-950/20 dark:hover:border-white/20" data-depth="2"><a href="https://docs.langchain.com/oss/python/langchain/agents#dynamic-model" class="group flex items-start py-1 whitespace-pre-wrap text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" style="padding-left: 2rem;">Dynamic model</a></li><li class="toc-item relative border-l pl-4 border-gray-950/5 dark:border-white/10 hover:border-gray-950/20 dark:hover:border-white/20" data-depth="1"><a href="https://docs.langchain.com/oss/python/langchain/agents#tools" class="group flex items-start py-1 whitespace-pre-wrap text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" style="padding-left: 1rem;">Tools</a></li><li class="toc-item relative border-l pl-4 border-gray-950/5 dark:border-white/10 hover:border-gray-950/20 dark:hover:border-white/20" data-depth="2"><a href="https://docs.langchain.com/oss/python/langchain/agents#defining-tools" class="group flex items-start py-1 whitespace-pre-wrap text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" style="padding-left: 2rem;">Defining tools</a></li><li class="toc-item relative border-l pl-4 border-gray-950/5 dark:border-white/10 hover:border-gray-950/20 dark:hover:border-white/20" data-depth="2"><a href="https://docs.langchain.com/oss/python/langchain/agents#tool-error-handling" class="group flex items-start py-1 whitespace-pre-wrap text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" style="padding-left: 2rem;">Tool error handling</a></li><li class="toc-item relative border-l pl-4 border-gray-950/5 dark:border-white/10 hover:border-gray-950/20 dark:hover:border-white/20" data-depth="2"><a href="https://docs.langchain.com/oss/python/langchain/agents#tool-use-in-the-react-loop" class="group flex items-start py-1 whitespace-pre-wrap text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" style="padding-left: 2rem;">Tool use in the ReAct loop</a></li><li class="toc-item relative border-l pl-4 border-gray-950/5 dark:border-white/10 hover:border-gray-950/20 dark:hover:border-white/20" data-depth="1"><a href="https://docs.langchain.com/oss/python/langchain/agents#system-prompt" class="group flex items-start py-1 whitespace-pre-wrap text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" style="padding-left: 1rem;">System prompt</a></li><li class="toc-item relative border-l pl-4 border-gray-950/5 dark:border-white/10 hover:border-gray-950/20 dark:hover:border-white/20" data-depth="2"><a href="https://docs.langchain.com/oss/python/langchain/agents#dynamic-system-prompt" class="group flex items-start py-1 whitespace-pre-wrap text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" style="padding-left: 2rem;">Dynamic system prompt</a></li><li class="toc-item relative" data-depth="0"><a href="https://docs.langchain.com/oss/python/langchain/agents#invocation" class="py-1 block font-medium border-l pl-4 border-gray-950/5 dark:border-white/10 hover:border-gray-950/20 dark:hover:border-white/20 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300">Invocation</a></li><li class="toc-item relative" data-depth="0"><a href="https://docs.langchain.com/oss/python/langchain/agents#advanced-concepts" class="py-1 block font-medium border-l pl-4 border-gray-950/5 dark:border-white/10 hover:border-gray-950/20 dark:hover:border-white/20 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300">Advanced concepts</a></li><li class="toc-item relative border-l pl-4 border-gray-950/5 dark:border-white/10 hover:border-gray-950/20 dark:hover:border-white/20" data-depth="1"><a href="https://docs.langchain.com/oss/python/langchain/agents#structured-output" class="group flex items-start py-1 whitespace-pre-wrap text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" style="padding-left: 1rem;">Structured output</a></li><li class="toc-item relative border-l pl-4 border-gray-950/5 dark:border-white/10 hover:border-gray-950/20 dark:hover:border-white/20" data-depth="2"><a href="https://docs.langchain.com/oss/python/langchain/agents#toolstrategy" class="group flex items-start py-1 whitespace-pre-wrap text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" style="padding-left: 2rem;">ToolStrategy</a></li><li class="toc-item relative border-l pl-4 border-gray-950/5 dark:border-white/10 hover:border-gray-950/20 dark:hover:border-white/20" data-depth="2"><a href="https://docs.langchain.com/oss/python/langchain/agents#providerstrategy" class="group flex items-start py-1 whitespace-pre-wrap text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" style="padding-left: 2rem;">ProviderStrategy</a></li><li class="toc-item relative border-l pl-4 border-gray-950/5 dark:border-white/10 hover:border-gray-950/20 dark:hover:border-white/20" data-depth="1"><a href="https://docs.langchain.com/oss/python/langchain/agents#memory" class="group flex items-start py-1 whitespace-pre-wrap text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" style="padding-left: 1rem;">Memory</a></li><li class="toc-item relative border-l pl-4 border-gray-950/5 dark:border-white/10 hover:border-gray-950/20 dark:hover:border-white/20" data-depth="2"><a href="https://docs.langchain.com/oss/python/langchain/agents#defining-state-via-middleware" class="group flex items-start py-1 whitespace-pre-wrap text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" style="padding-left: 2rem;">Defining state via middleware</a></li><li class="toc-item relative border-l pl-4 border-gray-950/5 dark:border-white/10 hover:border-gray-950/20 dark:hover:border-white/20" data-depth="2"><a href="https://docs.langchain.com/oss/python/langchain/agents#defining-state-via-state_schema" class="group flex items-start py-1 whitespace-pre-wrap text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" style="padding-left: 2rem;">Defining state via state_schema</a></li><li class="toc-item relative border-l pl-4 border-gray-950/5 dark:border-white/10 hover:border-gray-950/20 dark:hover:border-white/20" data-depth="1"><a href="https://docs.langchain.com/oss/python/langchain/agents#streaming" class="group flex items-start py-1 whitespace-pre-wrap text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" style="padding-left: 1rem;">Streaming</a></li><li class="toc-item relative border-l pl-4 border-gray-950/5 dark:border-white/10 hover:border-gray-950/20 dark:hover:border-white/20" data-depth="1"><a href="https://docs.langchain.com/oss/python/langchain/agents#middleware" class="group flex items-start py-1 whitespace-pre-wrap text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" style="padding-left: 1rem;">Middleware</a></li></ul></div></div></div><div class="grow w-full mx-auto [contain:inline-size] xl:w-[calc(100%-28rem)]" id="content-area"><header id="header" class="relative"><div class="mt-0.5 space-y-2.5"><div class="breadcrumb-list flex flex-row items-center gap-1.5"><div class="breadcrumb-item inline-flex items-center gap-1.5 text-sm text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" data-breadcrumb-title="Core components"><a href="https://docs.langchain.com/oss/python/langchain/agents">Core components</a></div></div><div class="flex flex-col sm:flex-row items-start sm:items-center relative gap-2 min-w-0"><h1 id="page-title" class="text-2xl sm:text-3xl font-bold text-gray-900 tracking-tight dark:text-gray-200 [overflow-wrap:anywhere] break-all">Agents</h1><div id="page-context-menu" class="items-center shrink-0 min-w-[156px] justify-end ml-auto sm:flex hidden"><button id="page-context-menu-button" class="rounded-l-xl px-3 text-gray-700 dark:text-gray-300 py-1.5 border border-gray-200 dark:border-white/[0.07] bg-background-light dark:bg-background-dark hover:bg-gray-600/5 dark:hover:bg-gray-200/5 border-r-0" aria-label="Copy page"><div class="flex items-center gap-2 text-sm text-center font-medium"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4"><path d="M14.25 5.25H7.25C6.14543 5.25 5.25 6.14543 5.25 7.25V14.25C5.25 15.3546 6.14543 16.25 7.25 16.25H14.25C15.3546 16.25 16.25 15.3546 16.25 14.25V7.25C16.25 6.14543 15.3546 5.25 14.25 5.25Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.80103 11.998L1.77203 5.07397C1.61003 3.98097 2.36403 2.96397 3.45603 2.80197L10.38 1.77297C11.313 1.63397 12.19 2.16297 12.528 3.00097" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg><span>Copy page</span></div></button><button class="group disabled:pointer-events-none [&amp;&gt;span]:line-clamp-1 overflow-hidden group flex items-center py-0.5 gap-1 text-sm text-gray-950/50 dark:text-white/50 group-hover:text-gray-950/70 dark:group-hover:text-white/70 rounded-none rounded-r-xl border px-3 border-gray-200 aspect-square dark:border-white/[0.07] bg-background-light dark:bg-background-dark hover:bg-gray-600/5 dark:hover:bg-gray-200/5" aria-label="More actions" type="button" id="radix-_r_18_" aria-haspopup="menu" aria-expanded="false" data-state="closed"><svg width="8" height="24" viewBox="0 -9 3 24" class="transition-transform text-gray-400 overflow-visible group-hover:text-gray-600 dark:text-gray-600 dark:group-hover:text-gray-400 rotate-90"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></button></div></div></div><div id="page-context-menu" class="flex items-center shrink-0 min-w-[156px] mt-3 sm:hidden"><button id="page-context-menu-button" class="rounded-l-xl px-3 text-gray-700 dark:text-gray-300 py-1.5 border border-gray-200 dark:border-white/[0.07] bg-background-light dark:bg-background-dark hover:bg-gray-600/5 dark:hover:bg-gray-200/5 border-r-0" aria-label="Copy page"><div class="flex items-center gap-2 text-sm text-center font-medium"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4"><path d="M14.25 5.25H7.25C6.14543 5.25 5.25 6.14543 5.25 7.25V14.25C5.25 15.3546 6.14543 16.25 7.25 16.25H14.25C15.3546 16.25 16.25 15.3546 16.25 14.25V7.25C16.25 6.14543 15.3546 5.25 14.25 5.25Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.80103 11.998L1.77203 5.07397C1.61003 3.98097 2.36403 2.96397 3.45603 2.80197L10.38 1.77297C11.313 1.63397 12.19 2.16297 12.528 3.00097" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg><span>Copy page</span></div></button><button class="group disabled:pointer-events-none [&amp;&gt;span]:line-clamp-1 overflow-hidden group flex items-center py-0.5 gap-1 text-sm text-gray-950/50 dark:text-white/50 group-hover:text-gray-950/70 dark:group-hover:text-white/70 rounded-none rounded-r-xl border px-3 border-gray-200 aspect-square dark:border-white/[0.07] bg-background-light dark:bg-background-dark hover:bg-gray-600/5 dark:hover:bg-gray-200/5" aria-label="More actions" type="button" id="radix-_r_1a_" aria-haspopup="menu" aria-expanded="false" data-state="closed"><svg width="8" height="24" viewBox="0 -9 3 24" class="transition-transform text-gray-400 overflow-visible group-hover:text-gray-600 dark:text-gray-600 dark:group-hover:text-gray-400 rotate-90"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></button></div></header><div class="mdx-content relative mt-8 mb-14 prose prose-gray dark:prose-invert [contain:inline-size] isolate" data-page-title="Agents" data-page-href="/oss/python/langchain/agents" id="content"><span data-as="p">Agents combine language models with <a class="link" href="https://docs.langchain.com/oss/python/langchain/tools">tools</a> to create systems that can reason about tasks, decide which tools to use, and iteratively work towards solutions.</span><span data-as="p"><a href="https://reference.langchain.com/python/langchain/agents/#langchain.agents.create_agent" target="_blank" rel="noreferrer" class="link"><code>create_agent</code></a> provides a production-ready agent implementation.</span><span data-as="p"><a href="https://simonwillison.net/2025/Sep/18/agents/" target="_blank" rel="noreferrer" class="link">An LLM Agent runs tools in a loop to achieve a goal</a>.An agent runs until a stop condition is met - i.e., when the model emits a final output or an iteration limit is reached.</span><div class="group relative overflow-hidden"><div class="absolute bottom-2 right-2 z-10 grid grid-cols-3 gap-1"><div aria-hidden="true" class="pointer-events-none"></div><button type="button" class="flex items-center [&amp;_svg]:size-4 justify-center size-7 rounded-md bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800 text-gray-900 dark:text-white border border-gray-200 dark:border-white/10 transition-[transform] duration-100 active:scale-95" aria-label="Pan up" title="Pan up"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-up"><path d="m18 15-6-6-6 6"></path></svg></button><button type="button" class="flex items-center [&amp;_svg]:size-4 justify-center size-7 rounded-md bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800 text-gray-900 dark:text-white border border-gray-200 dark:border-white/10 transition-[transform] duration-100 active:scale-95" aria-label="Zoom in" title="Zoom in"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-zoom-in"><circle cx="11" cy="11" r="8"></circle><line x1="21" x2="16.65" y1="21" y2="16.65"></line><line x1="11" x2="11" y1="8" y2="14"></line><line x1="8" x2="14" y1="11" y2="11"></line></svg></button><button type="button" class="flex items-center [&amp;_svg]:size-4 justify-center size-7 rounded-md bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800 text-gray-900 dark:text-white border border-gray-200 dark:border-white/10 transition-[transform] duration-100 active:scale-95" aria-label="Pan left" title="Pan left"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-left"><path d="m15 18-6-6 6-6"></path></svg></button><button type="button" class="flex items-center [&amp;_svg]:size-4 justify-center size-7 rounded-md bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800 text-gray-900 dark:text-white border border-gray-200 dark:border-white/10 transition-[transform] duration-100 active:scale-95" aria-label="Reset view" title="Reset view"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button><button type="button" class="flex items-center [&amp;_svg]:size-4 justify-center size-7 rounded-md bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800 text-gray-900 dark:text-white border border-gray-200 dark:border-white/10 transition-[transform] duration-100 active:scale-95" aria-label="Pan right" title="Pan right"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right"><path d="m9 18 6-6-6-6"></path></svg></button><div aria-hidden="true" class="pointer-events-none"></div><button type="button" class="flex items-center [&amp;_svg]:size-4 justify-center size-7 rounded-md bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800 text-gray-900 dark:text-white border border-gray-200 dark:border-white/10 transition-[transform] duration-100 active:scale-95" aria-label="Pan down" title="Pan down"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down"><path d="m6 9 6 6 6-6"></path></svg></button><button type="button" class="flex items-center [&amp;_svg]:size-4 justify-center size-7 rounded-md bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800 text-gray-900 dark:text-white border border-gray-200 dark:border-white/10 transition-[transform] duration-100 active:scale-95" aria-label="Zoom out" title="Zoom out"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-zoom-out"><circle cx="11" cy="11" r="8"></circle><line x1="21" x2="16.65" y1="21" y2="16.65"></line><line x1="8" x2="14" y1="11" y2="11"></line></svg></button></div><div class="mermaid" style="transform: translate(0px, 0px) scale(1); transform-origin: center center; transition: transform 0.15s ease-out;"><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 324.16796875 337.1640625" style="max-width: 324.16796875px;" class="flowchart" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="100%" id="_r_1h_"><style>#_r_1h_{font-family:monospace;font-size:16px;fill:#333;}#_r_1h_ .error-icon{fill:#552222;}#_r_1h_ .error-text{fill:#552222;stroke:#552222;}#_r_1h_ .edge-thickness-normal{stroke-width:1px;}#_r_1h_ .edge-thickness-thick{stroke-width:3.5px;}#_r_1h_ .edge-pattern-solid{stroke-dasharray:0;}#_r_1h_ .edge-thickness-invisible{stroke-width:0;fill:none;}#_r_1h_ .edge-pattern-dashed{stroke-dasharray:3;}#_r_1h_ .edge-pattern-dotted{stroke-dasharray:2;}#_r_1h_ .marker{fill:#333333;stroke:#333333;}#_r_1h_ .marker.cross{stroke:#333333;}#_r_1h_ svg{font-family:monospace;font-size:16px;}#_r_1h_ p{margin:0;}#_r_1h_ .label{font-family:monospace;color:#333;}#_r_1h_ .cluster-label text{fill:#333;}#_r_1h_ .cluster-label span{color:#333;}#_r_1h_ .cluster-label span p{background-color:transparent;}#_r_1h_ .label text,#_r_1h_ span{fill:#333;color:#333;}#_r_1h_ .node rect,#_r_1h_ .node circle,#_r_1h_ .node ellipse,#_r_1h_ .node polygon,#_r_1h_ .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#_r_1h_ .rough-node .label text,#_r_1h_ .node .label text,#_r_1h_ .image-shape .label,#_r_1h_ .icon-shape .label{text-anchor:middle;}#_r_1h_ .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#_r_1h_ .rough-node .label,#_r_1h_ .node .label,#_r_1h_ .image-shape .label,#_r_1h_ .icon-shape .label{text-align:center;}#_r_1h_ .node.clickable{cursor:pointer;}#_r_1h_ .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#_r_1h_ .arrowheadPath{fill:#333333;}#_r_1h_ .edgePath .path{stroke:#333333;stroke-width:2.0px;}#_r_1h_ .flowchart-link{stroke:#333333;fill:none;}#_r_1h_ .edgeLabel{background-color:transparent;text-align:center;}#_r_1h_ .edgeLabel p{background-color:transparent;}#_r_1h_ .edgeLabel rect{opacity:0.5;background-color:transparent;fill:transparent;}#_r_1h_ .labelBkg{background-color:rgba(0, 0, 0, 0.5);}#_r_1h_ .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#_r_1h_ .cluster text{fill:#333;}#_r_1h_ .cluster span{color:#333;}#_r_1h_ div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:monospace;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#_r_1h_ .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#_r_1h_ rect.text{fill:none;stroke-width:0;}#_r_1h_ .icon-shape,#_r_1h_ .image-shape{background-color:transparent;text-align:center;}#_r_1h_ .icon-shape p,#_r_1h_ .image-shape p{background-color:transparent;padding:2px;}#_r_1h_ .icon-shape rect,#_r_1h_ .image-shape rect{opacity:0.5;background-color:transparent;fill:transparent;}#_r_1h_ :root{--mermaid-font-family:monospace;}#_r_1h_ .blueHighlight&gt;*{fill:#0a1c25!important;stroke:#0a455f!important;color:#bae6fd!important;}#_r_1h_ .blueHighlight span{fill:#0a1c25!important;stroke:#0a455f!important;color:#bae6fd!important;}#_r_1h_ .blueHighlight tspan{fill:#bae6fd!important;}#_r_1h_ .greenHighlight&gt;*{fill:#0b1e1a!important;stroke:#0c4c39!important;color:#9ce4c4!important;}#_r_1h_ .greenHighlight span{fill:#0b1e1a!important;stroke:#0c4c39!important;color:#9ce4c4!important;}#_r_1h_ .greenHighlight tspan{fill:#9ce4c4!important;}</style><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="_r_1h__flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="_r_1h__flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="_r_1h__flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="_r_1h__flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="_r_1h__flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="_r_1h__flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#_r_1h__flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_QUERY_LLM_0" d="M153.777,47L153.777,51.167C153.777,55.333,153.777,63.667,153.848,71.417C153.918,79.167,154.058,86.334,154.129,89.917L154.199,93.501"></path><path marker-end="url(#_r_1h__flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_LLM_TOOL_1" d="M125.839,171.226L111.849,182.215C97.859,193.205,69.879,215.185,60.904,232.002C51.93,248.82,61.961,260.476,66.977,266.304L71.992,272.132"></path><path marker-end="url(#_r_1h__flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_TOOL_LLM_2" d="M121.074,275.164L126.525,268.831C131.975,262.497,142.876,249.831,148.401,237.914C153.926,225.997,154.075,214.83,154.15,209.247L154.224,203.664"></path><path marker-end="url(#_r_1h__flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_LLM_ANSWER_3" d="M183.711,170.23L198.908,181.386C214.105,192.542,244.5,214.853,259.697,232.925C274.895,250.997,274.895,264.831,274.895,271.747L274.895,278.664"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignobject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g><g transform="translate(41.8984375, 237.1640625)" class="edgeLabel"><g transform="translate(-33.8984375, -13)" class="label"><foreignobject height="26" width="67.796875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>action</p></span></div></foreignobject></g></g><g transform="translate(153.77734375, 237.1640625)" class="edgeLabel"><g transform="translate(-57.98046875, -13)" class="label"><foreignobject height="26" width="115.9609375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>observation</p></span></div></foreignobject></g></g><g transform="translate(274.89453125, 237.1640625)" class="edgeLabel"><g transform="translate(-33.8984375, -13)" class="label"><foreignobject height="26" width="67.796875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>finish</p></span></div></foreignobject></g></g></g><g class="nodes"><g transform="translate(153.77734375, 27.5)" id="flowchart-QUERY-30" class="node default blueHighlight"><rect height="39" width="72.9140625" y="-19.5" x="-36.45703125" ry="19.5" rx="19.5" style="fill:#0a1c25 !important;stroke:#0a455f !important" class="basic label-container"></rect><g transform="translate(-24.08203125, -12)" style="color:#bae6fd !important" class="label"><rect></rect><foreignobject height="24" width="48.1640625"><div xmlns="http://www.w3.org/1999/xhtml" style="color: rgb(186, 230, 253) !important; display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel" style="color:#bae6fd !important"><p>input</p></span></div></foreignobject></g></g><g transform="translate(153.77734375, 148.08203125)" id="flowchart-LLM-31" class="node default"><polygon transform="translate(-51.08203125,51.08203125)" class="label-container" points="51.08203125,0 102.1640625,-51.08203125 51.08203125,-102.1640625 0,-51.08203125"></polygon><g transform="translate(-24.08203125, -12)" style="" class="label"><rect></rect><foreignobject height="24" width="48.1640625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>model</p></span></div></foreignobject></g></g><g transform="translate(97.837890625, 302.1640625)" id="flowchart-TOOL-32" class="node default"><rect height="54" width="78.1640625" y="-27" x="-39.08203125" ry="5" rx="5" style="" class="basic label-container"></rect><g transform="translate(-24.08203125, -12)" style="" class="label"><rect></rect><foreignobject height="24" width="48.1640625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>tools</p></span></div></foreignobject></g></g><g transform="translate(274.89453125, 302.1640625)" id="flowchart-ANSWER-33" class="node default blueHighlight"><rect height="39" width="82.546875" y="-19.5" x="-41.2734375" ry="19.5" rx="19.5" style="fill:#0a1c25 !important;stroke:#0a455f !important" class="basic label-container"></rect><g transform="translate(-28.8984375, -12)" style="color:#bae6fd !important" class="label"><rect></rect><foreignobject height="24" width="57.796875"><div xmlns="http://www.w3.org/1999/xhtml" style="color: rgb(186, 230, 253) !important; display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel" style="color:#bae6fd !important"><p>output</p></span></div></foreignobject></g></g></g></g></g></svg></div></div><div class="callout my-4 px-5 py-4 overflow-hidden rounded-2xl flex gap-3 border border-zinc-500/20 bg-zinc-50/50 dark:border-zinc-500/30 dark:bg-zinc-500/10" data-callout-type="info"><div class="mt-0.5 w-4" data-component-part="callout-icon"><svg viewBox="0 0 20 20" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="flex-none w-5 h-5 text-zinc-400 dark:text-zinc-300" aria-label="Info"><path d="M8 0C3.58125 0 0 3.58125 0 8C0 12.4187 3.58125 16 8 16C12.4187 16 16 12.4187 16 8C16 3.58125 12.4187 0 8 0ZM8 14.5C4.41563 14.5 1.5 11.5841 1.5 8C1.5 4.41594 4.41563 1.5 8 1.5C11.5844 1.5 14.5 4.41594 14.5 8C14.5 11.5841 11.5844 14.5 8 14.5ZM9.25 10.5H8.75V7.75C8.75 7.3375 8.41563 7 8 7H7C6.5875 7 6.25 7.3375 6.25 7.75C6.25 8.1625 6.5875 8.5 7 8.5H7.25V10.5H6.75C6.3375 10.5 6 10.8375 6 11.25C6 11.6625 6.3375 12 6.75 12H9.25C9.66406 12 10 11.6641 10 11.25C10 10.8359 9.66563 10.5 9.25 10.5ZM8 6C8.55219 6 9 5.55219 9 5C9 4.44781 8.55219 4 8 4C7.44781 4 7 4.44687 7 5C7 5.55313 7.44687 6 8 6Z"></path></svg></div><div class="text-sm prose dark:prose-invert min-w-0 w-full [&amp;_kbd]:bg-background-light dark:[&amp;_kbd]:bg-background-dark [&amp;_code]:!text-current [&amp;_kbd]:!text-current [&amp;_a]:!text-current [&amp;_a]:border-current text-zinc-900 dark:text-zinc-200" data-component-part="callout-content"><span data-as="p"><a href="https://reference.langchain.com/python/langchain/agents/#langchain.agents.create_agent" target="_blank" rel="noreferrer" class="link"><code>create_agent</code></a> builds a <strong>graph</strong>-based agent runtime using <a class="link" href="https://docs.langchain.com/oss/python/langgraph/overview">LangGraph</a>. A graph consists of nodes (steps) and edges (connections) that define how your agent processes information. The agent moves through this graph, executing nodes like the model node (which calls the model), the tools node (which executes tools), or middleware.</span><span data-as="p">Learn more about the <a class="link" href="https://docs.langchain.com/oss/python/langgraph/graph-api">Graph API</a>.</span></div></div><h2 class="flex whitespace-pre-wrap group font-semibold" id="core-components"><div class="absolute" tabindex="-1"><a href="https://docs.langchain.com/oss/python/langchain/agents#core-components" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100 focus:opacity-100 focus:outline-0 group/link" aria-label="Navigate to header">â€‹<div class="w-6 h-6 rounded-md flex items-center justify-center shadow-sm text-gray-400 dark:text-white/50 dark:bg-background-dark dark:brightness-[1.35] dark:ring-1 dark:hover:brightness-150 bg-white ring-1 ring-gray-400/30 dark:ring-gray-700/25 hover:ring-gray-400/60 dark:hover:ring-white/20 group-focus/link:border-2 group-focus/link:border-primary dark:group-focus/link:border-primary-light"><svg xmlns="http://www.w3.org/2000/svg" fill="gray" height="12px" viewBox="0 0 576 512"><path d="M0 256C0 167.6 71.6 96 160 96h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C98.1 144 48 194.1 48 256s50.1 112 112 112h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C71.6 416 0 344.4 0 256zm576 0c0 88.4-71.6 160-160 160H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c61.9 0 112-50.1 112-112s-50.1-112-112-112H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c88.4 0 160 71.6 160 160zM184 232H392c13.3 0 24 10.7 24 24s-10.7 24-24 24H184c-13.3 0-24-10.7-24-24s10.7-24 24-24z"></path></svg></div></a></div><span class="cursor-pointer">Core components</span></h2><h3 class="flex whitespace-pre-wrap group font-semibold" id="model"><div class="absolute" tabindex="-1"><a href="https://docs.langchain.com/oss/python/langchain/agents#model" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100 focus:opacity-100 focus:outline-0 group/link" aria-label="Navigate to header">â€‹<div class="w-6 h-6 rounded-md flex items-center justify-center shadow-sm text-gray-400 dark:text-white/50 dark:bg-background-dark dark:brightness-[1.35] dark:ring-1 dark:hover:brightness-150 bg-white ring-1 ring-gray-400/30 dark:ring-gray-700/25 hover:ring-gray-400/60 dark:hover:ring-white/20 group-focus/link:border-2 group-focus/link:border-primary dark:group-focus/link:border-primary-light"><svg xmlns="http://www.w3.org/2000/svg" fill="gray" height="12px" viewBox="0 0 576 512"><path d="M0 256C0 167.6 71.6 96 160 96h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C98.1 144 48 194.1 48 256s50.1 112 112 112h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C71.6 416 0 344.4 0 256zm576 0c0 88.4-71.6 160-160 160H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c61.9 0 112-50.1 112-112s-50.1-112-112-112H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c88.4 0 160 71.6 160 160zM184 232H392c13.3 0 24 10.7 24 24s-10.7 24-24 24H184c-13.3 0-24-10.7-24-24s10.7-24 24-24z"></path></svg></div></a></div><span class="cursor-pointer">Model</span></h3><span data-as="p">The <a class="link" href="https://docs.langchain.com/oss/python/langchain/models">model</a> is the reasoning engine of your agent. It can be specified in multiple ways, supporting both static and dynamic model selection.</span><h4 class="flex whitespace-pre-wrap group font-semibold" id="static-model"><div class="absolute" tabindex="-1"><a href="https://docs.langchain.com/oss/python/langchain/agents#static-model" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100 focus:opacity-100 focus:outline-0 group/link" aria-label="Navigate to header">â€‹<div class="w-6 h-6 rounded-md flex items-center justify-center shadow-sm text-gray-400 dark:text-white/50 dark:bg-background-dark dark:brightness-[1.35] dark:ring-1 dark:hover:brightness-150 bg-white ring-1 ring-gray-400/30 dark:ring-gray-700/25 hover:ring-gray-400/60 dark:hover:ring-white/20 group-focus/link:border-2 group-focus/link:border-primary dark:group-focus/link:border-primary-light"><svg xmlns="http://www.w3.org/2000/svg" fill="gray" height="12px" viewBox="0 0 576 512"><path d="M0 256C0 167.6 71.6 96 160 96h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C98.1 144 48 194.1 48 256s50.1 112 112 112h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C71.6 416 0 344.4 0 256zm576 0c0 88.4-71.6 160-160 160H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c61.9 0 112-50.1 112-112s-50.1-112-112-112H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c88.4 0 160 71.6 160 160zM184 232H392c13.3 0 24 10.7 24 24s-10.7 24-24 24H184c-13.3 0-24-10.7-24-24s10.7-24 24-24z"></path></svg></div></a></div><span class="cursor-pointer">Static model</span></h4><span data-as="p">Static models are configured once when creating the agent and remain unchanged throughout execution. This is the most common and straightforward approach.</span><span data-as="p">To initialize a static model from a <button data-state="closed" aria-label="A string that follows the format `provider:model` (e.g. openai:gpt-5)"><span class="tooltip underline decoration-dotted decoration-2 underline-offset-4 decoration-gray-400 dark:decoration-gray-500">model identifier string</span></button>:</span><div class="code-block mt-5 mb-8 not-prose rounded-2xl relative group text-gray-950 dark:text-gray-50 codeblock-light border border-gray-950/10 dark:border-white/10 dark:twoslash-dark bg-transparent dark:bg-transparent" wrap="true" numberoflines="3" language="python"><div data-floating-buttons="true" class="absolute top-3 right-4 flex items-center gap-1.5"><div class="z-10 relative select-none"><button class="h-[26px] w-[26px] flex items-center justify-center rounded-md backdrop-blur peer group/copy-button " data-testid="copy-code-button" aria-label="Copy the contents from the code block"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-400 group-hover/copy-button:text-gray-500 dark:text-white/40 dark:group-hover/copy-button:text-white/60"><path d="M14.25 5.25H7.25C6.14543 5.25 5.25 6.14543 5.25 7.25V14.25C5.25 15.3546 6.14543 16.25 7.25 16.25H14.25C15.3546 16.25 16.25 15.3546 16.25 14.25V7.25C16.25 6.14543 15.3546 5.25 14.25 5.25Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.80103 11.998L1.77203 5.07397C1.61003 3.98097 2.36403 2.96397 3.45603 2.80197L10.38 1.77297C11.313 1.63397 12.19 2.16297 12.528 3.00097" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div aria-hidden="true" class="absolute top-11 left-1/2 transform whitespace-nowrap -translate-x-1/2 -translate-y-1/2 peer-hover:opacity-100 opacity-0 text-tooltip-foreground rounded-lg px-1.5 py-0.5 text-xs bg-primary-dark">Copy</div></div></div><div class="w-0 min-w-full max-w-full py-3.5 px-4 h-full dark:bg-codeblock relative text-sm leading-6 children:!my-0 children:!shadow-none children:!bg-transparent transition-[height] duration-300 ease-in-out code-block-background [&amp;_*]:ring-0 [&amp;_*]:outline-0 [&amp;_*]:focus:ring-0 [&amp;_*]:focus:outline-0 rounded-2xl bg-white code-block-wrap overflow-x-hidden whitespace-pre-wrap scrollbar-thin scrollbar-thumb-rounded scrollbar-thumb-black/15 hover:scrollbar-thumb-black/20 active:scrollbar-thumb-black/20 dark:scrollbar-thumb-white/20 dark:hover:scrollbar-thumb-white/25 dark:active:scrollbar-thumb-white/25" data-component-part="code-block-root" tabindex="0" style="font-variant-ligatures: none; height: auto; background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E;"><div class="font-mono whitespace-pre-wrap leading-6"><pre class="shiki shiki-themes github-light-default dark-plus" language="python" style="background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E; color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"><code language="python" numberoflines="3"><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">from</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> langchain.agents </span><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">import</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> create_agent</span></span><span class="line"></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">agent </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> create_agent(</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"openai:gpt-5"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">, </span><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">tools</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">tools)</span></span></code></pre></div></div></div><div class="callout my-4 px-5 py-4 overflow-hidden rounded-2xl flex gap-3 border border-emerald-500/20 bg-emerald-50/50 dark:border-emerald-500/30 dark:bg-emerald-500/10 [&amp;_[data-component-part=&#39;callout-icon&#39;]]:mt-px" data-callout-type="tip"><div class="mt-0.5 w-4" data-component-part="callout-icon"><svg width="11" height="14" viewBox="0 0 11 14" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="text-emerald-600 dark:text-emerald-400/80 w-3.5 h-auto" aria-label="Tip"><path d="M3.12794 12.4232C3.12794 12.5954 3.1776 12.7634 3.27244 12.907L3.74114 13.6095C3.88471 13.8248 4.21067 14 4.46964 14H6.15606C6.41415 14 6.74017 13.825 6.88373 13.6095L7.3508 12.9073C7.43114 12.7859 7.49705 12.569 7.49705 12.4232L7.50055 11.3513H3.12521L3.12794 12.4232ZM5.31288 0C2.52414 0.00875889 0.5 2.26889 0.5 4.78826C0.5 6.00188 0.949566 7.10829 1.69119 7.95492C2.14321 8.47011 2.84901 9.54727 3.11919 10.4557C3.12005 10.4625 3.12175 10.4698 3.12261 10.4771H7.50342C7.50427 10.4698 7.50598 10.463 7.50684 10.4557C7.77688 9.54727 8.48281 8.47011 8.93484 7.95492C9.67728 7.13181 10.1258 6.02703 10.1258 4.78826C10.1258 2.15486 7.9709 0.000106649 5.31288 0ZM7.94902 7.11267C7.52078 7.60079 6.99082 8.37878 6.6077 9.18794H4.02051C3.63739 8.37878 3.10743 7.60079 2.67947 7.11294C2.11997 6.47551 1.8126 5.63599 1.8126 4.78826C1.8126 3.09829 3.12794 1.31944 5.28827 1.3126C7.2435 1.3126 8.81315 2.88226 8.81315 4.78826C8.81315 5.63599 8.50688 6.47551 7.94902 7.11267ZM4.87534 2.18767C3.66939 2.18767 2.68767 3.16939 2.68767 4.37534C2.68767 4.61719 2.88336 4.81288 3.12521 4.81288C3.36705 4.81288 3.56274 4.61599 3.56274 4.37534C3.56274 3.6515 4.1515 3.06274 4.87534 3.06274C5.11719 3.06274 5.31288 2.86727 5.31288 2.62548C5.31288 2.38369 5.11599 2.18767 4.87534 2.18767Z"></path></svg></div><div class="text-sm prose dark:prose-invert min-w-0 w-full [&amp;_kbd]:bg-background-light dark:[&amp;_kbd]:bg-background-dark [&amp;_code]:!text-current [&amp;_kbd]:!text-current [&amp;_a]:!text-current [&amp;_a]:border-current text-emerald-900 dark:text-emerald-200" data-component-part="callout-content"><span data-as="p">Model identifier strings support automatic inference (e.g., <code>"gpt-5"</code> will be inferred as <code>"openai:gpt-5"</code>). Refer to the <a href="https://reference.langchain.com/python/langchain/models/#langchain.chat_models.init_chat_model(model)" target="_blank" rel="noreferrer" class="link">reference</a> to see a full list of model identifier string mappings.</span></div></div><span data-as="p">For more control over the model configuration, initialize a model instance directly using the provider package. In this example, we use <a href="https://reference.langchain.com/python/integrations/langchain_openai/ChatOpenAI" target="_blank" rel="noreferrer" class="link"><code>ChatOpenAI</code></a>. See <a class="link" href="https://docs.langchain.com/oss/python/integrations/chat">Chat models</a> for other available chat model classes.</span><div class="code-block mt-5 mb-8 not-prose rounded-2xl relative group text-gray-950 dark:text-gray-50 codeblock-light border border-gray-950/10 dark:border-white/10 dark:twoslash-dark bg-transparent dark:bg-transparent" wrap="true" numberoflines="11" language="python"><div data-floating-buttons="true" class="absolute top-3 right-4 flex items-center gap-1.5"><div class="z-10 relative select-none"><button class="h-[26px] w-[26px] flex items-center justify-center rounded-md backdrop-blur peer group/copy-button " data-testid="copy-code-button" aria-label="Copy the contents from the code block"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-400 group-hover/copy-button:text-gray-500 dark:text-white/40 dark:group-hover/copy-button:text-white/60"><path d="M14.25 5.25H7.25C6.14543 5.25 5.25 6.14543 5.25 7.25V14.25C5.25 15.3546 6.14543 16.25 7.25 16.25H14.25C15.3546 16.25 16.25 15.3546 16.25 14.25V7.25C16.25 6.14543 15.3546 5.25 14.25 5.25Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.80103 11.998L1.77203 5.07397C1.61003 3.98097 2.36403 2.96397 3.45603 2.80197L10.38 1.77297C11.313 1.63397 12.19 2.16297 12.528 3.00097" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div aria-hidden="true" class="absolute top-11 left-1/2 transform whitespace-nowrap -translate-x-1/2 -translate-y-1/2 peer-hover:opacity-100 opacity-0 text-tooltip-foreground rounded-lg px-1.5 py-0.5 text-xs bg-primary-dark">Copy</div></div></div><div class="w-0 min-w-full max-w-full py-3.5 px-4 h-full dark:bg-codeblock relative text-sm leading-6 children:!my-0 children:!shadow-none children:!bg-transparent transition-[height] duration-300 ease-in-out code-block-background [&amp;_*]:ring-0 [&amp;_*]:outline-0 [&amp;_*]:focus:ring-0 [&amp;_*]:focus:outline-0 rounded-2xl bg-white code-block-wrap overflow-x-hidden whitespace-pre-wrap scrollbar-thin scrollbar-thumb-rounded scrollbar-thumb-black/15 hover:scrollbar-thumb-black/20 active:scrollbar-thumb-black/20 dark:scrollbar-thumb-white/20 dark:hover:scrollbar-thumb-white/25 dark:active:scrollbar-thumb-white/25" data-component-part="code-block-root" tabindex="0" style="font-variant-ligatures: none; height: auto; background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E;"><div class="font-mono whitespace-pre-wrap leading-6"><pre class="shiki shiki-themes github-light-default dark-plus" language="python" style="background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E; color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"><code language="python" numberoflines="11"><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">from</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> langchain.agents </span><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">import</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> create_agent</span></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">from</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> langchain_openai </span><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">import</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> ChatOpenAI</span></span><span class="line"></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">model </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> ChatOpenAI(</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">    model</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"gpt-5"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">,</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">    temperature</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(5, 80, 174); --shiki-dark: #B5CEA8;">0.1</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">,</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">    max_tokens</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(5, 80, 174); --shiki-dark: #B5CEA8;">1000</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">,</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">    timeout</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(5, 80, 174); --shiki-dark: #B5CEA8;">30</span></span><span class="line"><span style="color: rgb(110, 119, 129); --shiki-dark: #6A9955;">    # ... (other params)</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">)</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">agent </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> create_agent(model, </span><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">tools</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">tools)</span></span></code></pre></div></div></div><span data-as="p">Model instances give you complete control over configuration. Use them when you need to set specific <a class="link" href="https://docs.langchain.com/oss/python/langchain/models#parameters">parameters</a> like <code>temperature</code>, <code>max_tokens</code>, <code>timeouts</code>, <code>base_url</code>, and other provider-specific settings. Refer to the <a class="link" href="https://docs.langchain.com/oss/python/integrations/providers/all_providers">reference</a> to see available params and methods on your model.</span><h4 class="flex whitespace-pre-wrap group font-semibold" id="dynamic-model"><div class="absolute" tabindex="-1"><a href="https://docs.langchain.com/oss/python/langchain/agents#dynamic-model" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100 focus:opacity-100 focus:outline-0 group/link" aria-label="Navigate to header">â€‹<div class="w-6 h-6 rounded-md flex items-center justify-center shadow-sm text-gray-400 dark:text-white/50 dark:bg-background-dark dark:brightness-[1.35] dark:ring-1 dark:hover:brightness-150 bg-white ring-1 ring-gray-400/30 dark:ring-gray-700/25 hover:ring-gray-400/60 dark:hover:ring-white/20 group-focus/link:border-2 group-focus/link:border-primary dark:group-focus/link:border-primary-light"><svg xmlns="http://www.w3.org/2000/svg" fill="gray" height="12px" viewBox="0 0 576 512"><path d="M0 256C0 167.6 71.6 96 160 96h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C98.1 144 48 194.1 48 256s50.1 112 112 112h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C71.6 416 0 344.4 0 256zm576 0c0 88.4-71.6 160-160 160H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c61.9 0 112-50.1 112-112s-50.1-112-112-112H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c88.4 0 160 71.6 160 160zM184 232H392c13.3 0 24 10.7 24 24s-10.7 24-24 24H184c-13.3 0-24-10.7-24-24s10.7-24 24-24z"></path></svg></div></a></div><span class="cursor-pointer">Dynamic model</span></h4><span data-as="p">Dynamic models are selected at <button data-state="closed" aria-label="The execution environment of your agent, containing immutable configuration and contextual data that persists throughout the agent&#39;s execution (e.g., user IDs, session details, or application-specific configuration)."><span class="tooltip underline decoration-dotted decoration-2 underline-offset-4 decoration-gray-400 dark:decoration-gray-500">runtime</span></button> based on the current <button data-state="closed" aria-label="The data that flows through your agent&#39;s execution, including messages, custom fields, and any information that needs to be tracked and potentially modified during processing (e.g., user preferences or tool usage stats)."><span class="tooltip underline decoration-dotted decoration-2 underline-offset-4 decoration-gray-400 dark:decoration-gray-500">state</span></button> and context. This enables sophisticated routing logic and cost optimization.</span><span data-as="p">To use a dynamic model, create middleware using the <a href="https://reference.langchain.com/python/langchain/middleware/#langchain.agents.middleware.wrap_model_call" target="_blank" rel="noreferrer" class="link"><code>@wrap_model_call</code></a> decorator that modifies the model in the request:</span><div class="code-block mt-5 mb-8 not-prose rounded-2xl relative group text-gray-950 dark:text-gray-50 codeblock-light border border-gray-950/10 dark:border-white/10 dark:twoslash-dark bg-transparent dark:bg-transparent" numberoflines="26" language="python"><div data-floating-buttons="true" class="absolute top-3 right-4 flex items-center gap-1.5"><div class="z-10 relative select-none"><button class="h-[26px] w-[26px] flex items-center justify-center rounded-md backdrop-blur peer group/copy-button " data-testid="copy-code-button" aria-label="Copy the contents from the code block"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-400 group-hover/copy-button:text-gray-500 dark:text-white/40 dark:group-hover/copy-button:text-white/60"><path d="M14.25 5.25H7.25C6.14543 5.25 5.25 6.14543 5.25 7.25V14.25C5.25 15.3546 6.14543 16.25 7.25 16.25H14.25C15.3546 16.25 16.25 15.3546 16.25 14.25V7.25C16.25 6.14543 15.3546 5.25 14.25 5.25Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.80103 11.998L1.77203 5.07397C1.61003 3.98097 2.36403 2.96397 3.45603 2.80197L10.38 1.77297C11.313 1.63397 12.19 2.16297 12.528 3.00097" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div aria-hidden="true" class="absolute top-11 left-1/2 transform whitespace-nowrap -translate-x-1/2 -translate-y-1/2 peer-hover:opacity-100 opacity-0 text-tooltip-foreground rounded-lg px-1.5 py-0.5 text-xs bg-primary-dark">Copy</div></div></div><div class="w-0 min-w-full max-w-full py-3.5 px-4 h-full dark:bg-codeblock relative text-sm leading-6 children:!my-0 children:!shadow-none children:!bg-transparent transition-[height] duration-300 ease-in-out code-block-background [&amp;_*]:ring-0 [&amp;_*]:outline-0 [&amp;_*]:focus:ring-0 [&amp;_*]:focus:outline-0 rounded-2xl bg-white overflow-x-auto scrollbar-thin scrollbar-thumb-rounded scrollbar-thumb-black/15 hover:scrollbar-thumb-black/20 active:scrollbar-thumb-black/20 dark:scrollbar-thumb-white/20 dark:hover:scrollbar-thumb-white/25 dark:active:scrollbar-thumb-white/25" data-component-part="code-block-root" tabindex="0" style="font-variant-ligatures: none; height: auto; background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E;"><div class="font-mono whitespace-pre leading-6"><pre class="shiki shiki-themes github-light-default dark-plus" language="python" style="background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E; color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"><code language="python" numberoflines="26"><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">from</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> langchain_openai </span><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">import</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> ChatOpenAI</span></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">from</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> langchain.agents </span><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">import</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> create_agent</span></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">from</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> langchain.agents.middleware </span><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">import</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> wrap_model_call, ModelRequest, ModelResponse</span></span><span class="line"></span><span class="line"></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">basic_model </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> ChatOpenAI(</span><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">model</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"gpt-4o-mini"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">)</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">advanced_model </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> ChatOpenAI(</span><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">model</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"gpt-4o"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">)</span></span><span class="line"></span><span class="line"><span style="color: rgb(130, 80, 223); --shiki-dark: #DCDCAA;">@wrap_model_call</span></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;">def</span><span style="color: rgb(130, 80, 223); --shiki-dark: #DCDCAA;"> dynamic_model_selection</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">(</span><span style="color: rgb(31, 35, 40); --shiki-dark: #9CDCFE;">request</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: ModelRequest, </span><span style="color: rgb(31, 35, 40); --shiki-dark: #9CDCFE;">handler</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">) -&gt; ModelResponse:</span></span><span class="line"><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">    """Choose model based on conversation complexity."""</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">    message_count </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(5, 80, 174); --shiki-dark: #DCDCAA;"> len</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">(request.state[</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"messages"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">])</span></span><span class="line"></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">    if</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> message_count </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">&gt;</span><span style="color: rgb(5, 80, 174); --shiki-dark: #B5CEA8;"> 10</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">:</span></span><span class="line"><span style="color: rgb(110, 119, 129); --shiki-dark: #6A9955;">        # Use an advanced model for longer conversations</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">        model </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> advanced_model</span></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">    else</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">:</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">        model </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> basic_model</span></span><span class="line"></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">    return</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> handler(request.override(</span><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">model</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">model))</span></span><span class="line"></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">agent </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> create_agent(</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">    model</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">basic_model,  </span><span style="color: rgb(110, 119, 129); --shiki-dark: #6A9955;"># Default model</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">    tools</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">tools,</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">    middleware</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">[dynamic_model_selection]</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">)</span></span></code></pre></div></div><div data-fade-overlay="true" aria-hidden="true" style="--fade-color-light: #ffffff; --fade-color-dark: #0B0C0E;"></div></div><div class="callout my-4 px-5 py-4 overflow-hidden rounded-2xl flex gap-3 border border-amber-500/20 bg-amber-50/50 dark:border-amber-500/30 dark:bg-amber-500/10 [&amp;_[data-component-part=&#39;callout-icon&#39;]]:mt-px" data-callout-type="warning"><div class="mt-0.5 w-4" data-component-part="callout-icon"><svg class="flex-none w-5 h-5 text-amber-400 dark:text-amber-300/80" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" aria-label="Warning"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg></div><div class="text-sm prose dark:prose-invert min-w-0 w-full [&amp;_kbd]:bg-background-light dark:[&amp;_kbd]:bg-background-dark [&amp;_code]:!text-current [&amp;_kbd]:!text-current [&amp;_a]:!text-current [&amp;_a]:border-current text-amber-900 dark:text-amber-200" data-component-part="callout-content"><span data-as="p">Pre-bound models (models with <a href="https://reference.langchain.com/python/langchain_core/language_models/#langchain_core.language_models.chat_models.BaseChatModel.bind_tools" target="_blank" rel="noreferrer" class="link"><code>bind_tools</code></a> already called) are not supported when using structured output. If you need dynamic model selection with structured output, ensure the models passed to the middleware are not pre-bound.</span></div></div><div class="callout my-4 px-5 py-4 overflow-hidden rounded-2xl flex gap-3 border border-emerald-500/20 bg-emerald-50/50 dark:border-emerald-500/30 dark:bg-emerald-500/10 [&amp;_[data-component-part=&#39;callout-icon&#39;]]:mt-px" data-callout-type="tip"><div class="mt-0.5 w-4" data-component-part="callout-icon"><svg width="11" height="14" viewBox="0 0 11 14" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="text-emerald-600 dark:text-emerald-400/80 w-3.5 h-auto" aria-label="Tip"><path d="M3.12794 12.4232C3.12794 12.5954 3.1776 12.7634 3.27244 12.907L3.74114 13.6095C3.88471 13.8248 4.21067 14 4.46964 14H6.15606C6.41415 14 6.74017 13.825 6.88373 13.6095L7.3508 12.9073C7.43114 12.7859 7.49705 12.569 7.49705 12.4232L7.50055 11.3513H3.12521L3.12794 12.4232ZM5.31288 0C2.52414 0.00875889 0.5 2.26889 0.5 4.78826C0.5 6.00188 0.949566 7.10829 1.69119 7.95492C2.14321 8.47011 2.84901 9.54727 3.11919 10.4557C3.12005 10.4625 3.12175 10.4698 3.12261 10.4771H7.50342C7.50427 10.4698 7.50598 10.463 7.50684 10.4557C7.77688 9.54727 8.48281 8.47011 8.93484 7.95492C9.67728 7.13181 10.1258 6.02703 10.1258 4.78826C10.1258 2.15486 7.9709 0.000106649 5.31288 0ZM7.94902 7.11267C7.52078 7.60079 6.99082 8.37878 6.6077 9.18794H4.02051C3.63739 8.37878 3.10743 7.60079 2.67947 7.11294C2.11997 6.47551 1.8126 5.63599 1.8126 4.78826C1.8126 3.09829 3.12794 1.31944 5.28827 1.3126C7.2435 1.3126 8.81315 2.88226 8.81315 4.78826C8.81315 5.63599 8.50688 6.47551 7.94902 7.11267ZM4.87534 2.18767C3.66939 2.18767 2.68767 3.16939 2.68767 4.37534C2.68767 4.61719 2.88336 4.81288 3.12521 4.81288C3.36705 4.81288 3.56274 4.61599 3.56274 4.37534C3.56274 3.6515 4.1515 3.06274 4.87534 3.06274C5.11719 3.06274 5.31288 2.86727 5.31288 2.62548C5.31288 2.38369 5.11599 2.18767 4.87534 2.18767Z"></path></svg></div><div class="text-sm prose dark:prose-invert min-w-0 w-full [&amp;_kbd]:bg-background-light dark:[&amp;_kbd]:bg-background-dark [&amp;_code]:!text-current [&amp;_kbd]:!text-current [&amp;_a]:!text-current [&amp;_a]:border-current text-emerald-900 dark:text-emerald-200" data-component-part="callout-content"><span data-as="p">For model configuration details, see <a class="link" href="https://docs.langchain.com/oss/python/langchain/models">Models</a>. For dynamic model selection patterns, see <a class="link" href="https://docs.langchain.com/oss/python/langchain/middleware#dynamic-model">Dynamic model in middleware</a>.</span></div></div><h3 class="flex whitespace-pre-wrap group font-semibold" id="tools"><div class="absolute" tabindex="-1"><a href="https://docs.langchain.com/oss/python/langchain/agents#tools" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100 focus:opacity-100 focus:outline-0 group/link" aria-label="Navigate to header">â€‹<div class="w-6 h-6 rounded-md flex items-center justify-center shadow-sm text-gray-400 dark:text-white/50 dark:bg-background-dark dark:brightness-[1.35] dark:ring-1 dark:hover:brightness-150 bg-white ring-1 ring-gray-400/30 dark:ring-gray-700/25 hover:ring-gray-400/60 dark:hover:ring-white/20 group-focus/link:border-2 group-focus/link:border-primary dark:group-focus/link:border-primary-light"><svg xmlns="http://www.w3.org/2000/svg" fill="gray" height="12px" viewBox="0 0 576 512"><path d="M0 256C0 167.6 71.6 96 160 96h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C98.1 144 48 194.1 48 256s50.1 112 112 112h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C71.6 416 0 344.4 0 256zm576 0c0 88.4-71.6 160-160 160H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c61.9 0 112-50.1 112-112s-50.1-112-112-112H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c88.4 0 160 71.6 160 160zM184 232H392c13.3 0 24 10.7 24 24s-10.7 24-24 24H184c-13.3 0-24-10.7-24-24s10.7-24 24-24z"></path></svg></div></a></div><span class="cursor-pointer">Tools</span></h3><span data-as="p">Tools give agents the ability to take actions. Agents go beyond simple model-only tool binding by facilitating:</span><ul><li>Multiple tool calls in sequence (triggered by a single prompt)</li><li>Parallel tool calls when appropriate</li><li>Dynamic tool selection based on previous results</li><li>Tool retry logic and error handling</li><li>State persistence across tool calls</li></ul><span data-as="p">For more information, see <a class="link" href="https://docs.langchain.com/oss/python/langchain/tools">Tools</a>.</span><h4 class="flex whitespace-pre-wrap group font-semibold" id="defining-tools"><div class="absolute" tabindex="-1"><a href="https://docs.langchain.com/oss/python/langchain/agents#defining-tools" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100 focus:opacity-100 focus:outline-0 group/link" aria-label="Navigate to header">â€‹<div class="w-6 h-6 rounded-md flex items-center justify-center shadow-sm text-gray-400 dark:text-white/50 dark:bg-background-dark dark:brightness-[1.35] dark:ring-1 dark:hover:brightness-150 bg-white ring-1 ring-gray-400/30 dark:ring-gray-700/25 hover:ring-gray-400/60 dark:hover:ring-white/20 group-focus/link:border-2 group-focus/link:border-primary dark:group-focus/link:border-primary-light"><svg xmlns="http://www.w3.org/2000/svg" fill="gray" height="12px" viewBox="0 0 576 512"><path d="M0 256C0 167.6 71.6 96 160 96h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C98.1 144 48 194.1 48 256s50.1 112 112 112h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C71.6 416 0 344.4 0 256zm576 0c0 88.4-71.6 160-160 160H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c61.9 0 112-50.1 112-112s-50.1-112-112-112H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c88.4 0 160 71.6 160 160zM184 232H392c13.3 0 24 10.7 24 24s-10.7 24-24 24H184c-13.3 0-24-10.7-24-24s10.7-24 24-24z"></path></svg></div></a></div><span class="cursor-pointer">Defining tools</span></h4><span data-as="p">Pass a list of tools to the agent.</span><div class="callout my-4 px-5 py-4 overflow-hidden rounded-2xl flex gap-3 border border-emerald-500/20 bg-emerald-50/50 dark:border-emerald-500/30 dark:bg-emerald-500/10 [&amp;_[data-component-part=&#39;callout-icon&#39;]]:mt-px" data-callout-type="tip"><div class="mt-0.5 w-4" data-component-part="callout-icon"><svg width="11" height="14" viewBox="0 0 11 14" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="text-emerald-600 dark:text-emerald-400/80 w-3.5 h-auto" aria-label="Tip"><path d="M3.12794 12.4232C3.12794 12.5954 3.1776 12.7634 3.27244 12.907L3.74114 13.6095C3.88471 13.8248 4.21067 14 4.46964 14H6.15606C6.41415 14 6.74017 13.825 6.88373 13.6095L7.3508 12.9073C7.43114 12.7859 7.49705 12.569 7.49705 12.4232L7.50055 11.3513H3.12521L3.12794 12.4232ZM5.31288 0C2.52414 0.00875889 0.5 2.26889 0.5 4.78826C0.5 6.00188 0.949566 7.10829 1.69119 7.95492C2.14321 8.47011 2.84901 9.54727 3.11919 10.4557C3.12005 10.4625 3.12175 10.4698 3.12261 10.4771H7.50342C7.50427 10.4698 7.50598 10.463 7.50684 10.4557C7.77688 9.54727 8.48281 8.47011 8.93484 7.95492C9.67728 7.13181 10.1258 6.02703 10.1258 4.78826C10.1258 2.15486 7.9709 0.000106649 5.31288 0ZM7.94902 7.11267C7.52078 7.60079 6.99082 8.37878 6.6077 9.18794H4.02051C3.63739 8.37878 3.10743 7.60079 2.67947 7.11294C2.11997 6.47551 1.8126 5.63599 1.8126 4.78826C1.8126 3.09829 3.12794 1.31944 5.28827 1.3126C7.2435 1.3126 8.81315 2.88226 8.81315 4.78826C8.81315 5.63599 8.50688 6.47551 7.94902 7.11267ZM4.87534 2.18767C3.66939 2.18767 2.68767 3.16939 2.68767 4.37534C2.68767 4.61719 2.88336 4.81288 3.12521 4.81288C3.36705 4.81288 3.56274 4.61599 3.56274 4.37534C3.56274 3.6515 4.1515 3.06274 4.87534 3.06274C5.11719 3.06274 5.31288 2.86727 5.31288 2.62548C5.31288 2.38369 5.11599 2.18767 4.87534 2.18767Z"></path></svg></div><div class="text-sm prose dark:prose-invert min-w-0 w-full [&amp;_kbd]:bg-background-light dark:[&amp;_kbd]:bg-background-dark [&amp;_code]:!text-current [&amp;_kbd]:!text-current [&amp;_a]:!text-current [&amp;_a]:border-current text-emerald-900 dark:text-emerald-200" data-component-part="callout-content"><span data-as="p">Tools can be specified as plain Python functions or <button data-state="closed" aria-label="A method that can suspend execution and resume at a later time"><span class="tooltip underline decoration-dotted decoration-2 underline-offset-4 decoration-gray-400 dark:decoration-gray-500">coroutines</span></button>.</span><span data-as="p">The <a class="link" href="https://docs.langchain.com/oss/python/langchain/tools#create-tools">tool decorator</a> can be used to customize tool names, descriptions, argument schemas, and other properties.</span></div></div><div class="code-block mt-5 mb-8 not-prose rounded-2xl relative group text-gray-950 dark:text-gray-50 codeblock-light border border-gray-950/10 dark:border-white/10 dark:twoslash-dark bg-transparent dark:bg-transparent" wrap="true" numberoflines="15" language="python"><div data-floating-buttons="true" class="absolute top-3 right-4 flex items-center gap-1.5"><div class="z-10 relative select-none"><button class="h-[26px] w-[26px] flex items-center justify-center rounded-md backdrop-blur peer group/copy-button " data-testid="copy-code-button" aria-label="Copy the contents from the code block"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-400 group-hover/copy-button:text-gray-500 dark:text-white/40 dark:group-hover/copy-button:text-white/60"><path d="M14.25 5.25H7.25C6.14543 5.25 5.25 6.14543 5.25 7.25V14.25C5.25 15.3546 6.14543 16.25 7.25 16.25H14.25C15.3546 16.25 16.25 15.3546 16.25 14.25V7.25C16.25 6.14543 15.3546 5.25 14.25 5.25Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.80103 11.998L1.77203 5.07397C1.61003 3.98097 2.36403 2.96397 3.45603 2.80197L10.38 1.77297C11.313 1.63397 12.19 2.16297 12.528 3.00097" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div aria-hidden="true" class="absolute top-11 left-1/2 transform whitespace-nowrap -translate-x-1/2 -translate-y-1/2 peer-hover:opacity-100 opacity-0 text-tooltip-foreground rounded-lg px-1.5 py-0.5 text-xs bg-primary-dark">Copy</div></div></div><div class="w-0 min-w-full max-w-full py-3.5 px-4 h-full dark:bg-codeblock relative text-sm leading-6 children:!my-0 children:!shadow-none children:!bg-transparent transition-[height] duration-300 ease-in-out code-block-background [&amp;_*]:ring-0 [&amp;_*]:outline-0 [&amp;_*]:focus:ring-0 [&amp;_*]:focus:outline-0 rounded-2xl bg-white code-block-wrap overflow-x-hidden whitespace-pre-wrap scrollbar-thin scrollbar-thumb-rounded scrollbar-thumb-black/15 hover:scrollbar-thumb-black/20 active:scrollbar-thumb-black/20 dark:scrollbar-thumb-white/20 dark:hover:scrollbar-thumb-white/25 dark:active:scrollbar-thumb-white/25" data-component-part="code-block-root" tabindex="0" style="font-variant-ligatures: none; height: auto; background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E;"><div class="font-mono whitespace-pre-wrap leading-6"><pre class="shiki shiki-themes github-light-default dark-plus" language="python" style="background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E; color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"><code language="python" numberoflines="15"><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">from</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> langchain.tools </span><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">import</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> tool</span></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">from</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> langchain.agents </span><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">import</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> create_agent</span></span><span class="line"></span><span class="line"></span><span class="line"><span style="color: rgb(130, 80, 223); --shiki-dark: #DCDCAA;">@tool</span></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;">def</span><span style="color: rgb(130, 80, 223); --shiki-dark: #DCDCAA;"> search</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">(</span><span style="color: rgb(31, 35, 40); --shiki-dark: #9CDCFE;">query</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: </span><span style="color: rgb(5, 80, 174); --shiki-dark: #4EC9B0;">str</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">) -&gt; </span><span style="color: rgb(5, 80, 174); --shiki-dark: #4EC9B0;">str</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">:</span></span><span class="line"><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">    """Search for information."""</span></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">    return</span><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;"> f</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"Results for: </span><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;">&#123;</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">query</span><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;">&#125;</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"</span></span><span class="line"></span><span class="line"><span style="color: rgb(130, 80, 223); --shiki-dark: #DCDCAA;">@tool</span></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;">def</span><span style="color: rgb(130, 80, 223); --shiki-dark: #DCDCAA;"> get_weather</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">(</span><span style="color: rgb(31, 35, 40); --shiki-dark: #9CDCFE;">location</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: </span><span style="color: rgb(5, 80, 174); --shiki-dark: #4EC9B0;">str</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">) -&gt; </span><span style="color: rgb(5, 80, 174); --shiki-dark: #4EC9B0;">str</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">:</span></span><span class="line"><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">    """Get weather information for a location."""</span></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">    return</span><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;"> f</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"Weather in </span><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;">&#123;</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">location</span><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;">&#125;</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">: Sunny, 72Â°F"</span></span><span class="line"></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">agent </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> create_agent(model, </span><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">tools</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">[search, get_weather])</span></span></code></pre></div></div></div><span data-as="p">If an empty tool list is provided, the agent will consist of a single LLM node without tool-calling capabilities.</span><h4 class="flex whitespace-pre-wrap group font-semibold" id="tool-error-handling"><div class="absolute" tabindex="-1"><a href="https://docs.langchain.com/oss/python/langchain/agents#tool-error-handling" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100 focus:opacity-100 focus:outline-0 group/link" aria-label="Navigate to header">â€‹<div class="w-6 h-6 rounded-md flex items-center justify-center shadow-sm text-gray-400 dark:text-white/50 dark:bg-background-dark dark:brightness-[1.35] dark:ring-1 dark:hover:brightness-150 bg-white ring-1 ring-gray-400/30 dark:ring-gray-700/25 hover:ring-gray-400/60 dark:hover:ring-white/20 group-focus/link:border-2 group-focus/link:border-primary dark:group-focus/link:border-primary-light"><svg xmlns="http://www.w3.org/2000/svg" fill="gray" height="12px" viewBox="0 0 576 512"><path d="M0 256C0 167.6 71.6 96 160 96h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C98.1 144 48 194.1 48 256s50.1 112 112 112h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C71.6 416 0 344.4 0 256zm576 0c0 88.4-71.6 160-160 160H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c61.9 0 112-50.1 112-112s-50.1-112-112-112H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c88.4 0 160 71.6 160 160zM184 232H392c13.3 0 24 10.7 24 24s-10.7 24-24 24H184c-13.3 0-24-10.7-24-24s10.7-24 24-24z"></path></svg></div></a></div><span class="cursor-pointer">Tool error handling</span></h4><span data-as="p">To customize how tool errors are handled, use the <a href="https://reference.langchain.com/python/langchain/middleware/#langchain.agents.middleware.wrap_tool_call" target="_blank" rel="noreferrer" class="link"><code>@wrap_tool_call</code></a> decorator to create middleware:</span><div class="code-block mt-5 mb-8 not-prose rounded-2xl relative group text-gray-950 dark:text-gray-50 codeblock-light border border-gray-950/10 dark:border-white/10 dark:twoslash-dark bg-transparent dark:bg-transparent" wrap="true" numberoflines="22" language="python"><div data-floating-buttons="true" class="absolute top-3 right-4 flex items-center gap-1.5"><div class="z-10 relative select-none"><button class="h-[26px] w-[26px] flex items-center justify-center rounded-md backdrop-blur peer group/copy-button " data-testid="copy-code-button" aria-label="Copy the contents from the code block"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-400 group-hover/copy-button:text-gray-500 dark:text-white/40 dark:group-hover/copy-button:text-white/60"><path d="M14.25 5.25H7.25C6.14543 5.25 5.25 6.14543 5.25 7.25V14.25C5.25 15.3546 6.14543 16.25 7.25 16.25H14.25C15.3546 16.25 16.25 15.3546 16.25 14.25V7.25C16.25 6.14543 15.3546 5.25 14.25 5.25Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.80103 11.998L1.77203 5.07397C1.61003 3.98097 2.36403 2.96397 3.45603 2.80197L10.38 1.77297C11.313 1.63397 12.19 2.16297 12.528 3.00097" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div aria-hidden="true" class="absolute top-11 left-1/2 transform whitespace-nowrap -translate-x-1/2 -translate-y-1/2 peer-hover:opacity-100 opacity-0 text-tooltip-foreground rounded-lg px-1.5 py-0.5 text-xs bg-primary-dark">Copy</div></div></div><div class="w-0 min-w-full max-w-full py-3.5 px-4 h-full dark:bg-codeblock relative text-sm leading-6 children:!my-0 children:!shadow-none children:!bg-transparent transition-[height] duration-300 ease-in-out code-block-background [&amp;_*]:ring-0 [&amp;_*]:outline-0 [&amp;_*]:focus:ring-0 [&amp;_*]:focus:outline-0 rounded-2xl bg-white code-block-wrap overflow-x-hidden whitespace-pre-wrap scrollbar-thin scrollbar-thumb-rounded scrollbar-thumb-black/15 hover:scrollbar-thumb-black/20 active:scrollbar-thumb-black/20 dark:scrollbar-thumb-white/20 dark:hover:scrollbar-thumb-white/25 dark:active:scrollbar-thumb-white/25" data-component-part="code-block-root" tabindex="0" style="font-variant-ligatures: none; height: auto; background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E;"><div class="font-mono whitespace-pre-wrap leading-6"><pre class="shiki shiki-themes github-light-default dark-plus" language="python" style="background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E; color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"><code language="python" numberoflines="22"><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">from</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> langchain.agents </span><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">import</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> create_agent</span></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">from</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> langchain.agents.middleware </span><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">import</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> wrap_tool_call</span></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">from</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> langchain.messages </span><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">import</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> ToolMessage</span></span><span class="line"></span><span class="line"></span><span class="line"><span style="color: rgb(130, 80, 223); --shiki-dark: #DCDCAA;">@wrap_tool_call</span></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;">def</span><span style="color: rgb(130, 80, 223); --shiki-dark: #DCDCAA;"> handle_tool_errors</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">(</span><span style="color: rgb(31, 35, 40); --shiki-dark: #9CDCFE;">request</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">, </span><span style="color: rgb(31, 35, 40); --shiki-dark: #9CDCFE;">handler</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">):</span></span><span class="line"><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">    """Handle tool execution errors with custom messages."""</span></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">    try</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">:</span></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">        return</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> handler(request)</span></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">    except</span><span style="color: rgb(5, 80, 174); --shiki-dark: #4EC9B0;"> Exception</span><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;"> as</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> e:</span></span><span class="line"><span style="color: rgb(110, 119, 129); --shiki-dark: #6A9955;">        # Return a custom error message to the model</span></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">        return</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> ToolMessage(</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">            content</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;">f</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"Tool error: Please check your input and try again. (</span><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;">&#123;</span><span style="color: rgb(5, 80, 174); --shiki-dark: #4EC9B0;">str</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">(e)</span><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;">&#125;</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">)"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">,</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">            tool_call_id</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">request.tool_call[</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"id"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">]</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">        )</span></span><span class="line"></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">agent </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> create_agent(</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">    model</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"gpt-4o"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">,</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">    tools</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">[search, get_weather],</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">    middleware</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">[handle_tool_errors]</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">)</span></span></code></pre></div></div></div><span data-as="p">The agent will return a <a href="https://reference.langchain.com/python/langchain/messages/#langchain.messages.ToolMessage" target="_blank" rel="noreferrer" class="link"><code>ToolMessage</code></a> with the custom error message when a tool fails:</span><div class="code-block mt-5 mb-8 not-prose rounded-2xl relative group text-gray-950 dark:text-gray-50 codeblock-light border border-gray-950/10 dark:border-white/10 dark:twoslash-dark bg-transparent dark:bg-transparent" numberoflines="8" language="python"><div data-floating-buttons="true" class="absolute top-3 right-4 flex items-center gap-1.5"><div class="z-10 relative select-none"><button class="h-[26px] w-[26px] flex items-center justify-center rounded-md backdrop-blur peer group/copy-button " data-testid="copy-code-button" aria-label="Copy the contents from the code block"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-400 group-hover/copy-button:text-gray-500 dark:text-white/40 dark:group-hover/copy-button:text-white/60"><path d="M14.25 5.25H7.25C6.14543 5.25 5.25 6.14543 5.25 7.25V14.25C5.25 15.3546 6.14543 16.25 7.25 16.25H14.25C15.3546 16.25 16.25 15.3546 16.25 14.25V7.25C16.25 6.14543 15.3546 5.25 14.25 5.25Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.80103 11.998L1.77203 5.07397C1.61003 3.98097 2.36403 2.96397 3.45603 2.80197L10.38 1.77297C11.313 1.63397 12.19 2.16297 12.528 3.00097" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div aria-hidden="true" class="absolute top-11 left-1/2 transform whitespace-nowrap -translate-x-1/2 -translate-y-1/2 peer-hover:opacity-100 opacity-0 text-tooltip-foreground rounded-lg px-1.5 py-0.5 text-xs bg-primary-dark">Copy</div></div></div><div class="w-0 min-w-full max-w-full py-3.5 px-4 h-full dark:bg-codeblock relative text-sm leading-6 children:!my-0 children:!shadow-none children:!bg-transparent transition-[height] duration-300 ease-in-out code-block-background [&amp;_*]:ring-0 [&amp;_*]:outline-0 [&amp;_*]:focus:ring-0 [&amp;_*]:focus:outline-0 rounded-2xl bg-white overflow-x-auto scrollbar-thin scrollbar-thumb-rounded scrollbar-thumb-black/15 hover:scrollbar-thumb-black/20 active:scrollbar-thumb-black/20 dark:scrollbar-thumb-white/20 dark:hover:scrollbar-thumb-white/25 dark:active:scrollbar-thumb-white/25" data-component-part="code-block-root" tabindex="0" style="font-variant-ligatures: none; height: auto; background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E;"><div class="font-mono whitespace-pre leading-6"><pre class="shiki shiki-themes github-light-default dark-plus" language="python" style="background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E; color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"><code language="python" numberoflines="8"><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">[</span></span><span class="line"><span style="color: rgb(5, 80, 174); --shiki-dark: #D4D4D4;">    ...</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">    ToolMessage(</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">        content</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"Tool error: Please check your input and try again. (division by zero)"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">,</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">        tool_call_id</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"..."</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">    ),</span></span><span class="line"><span style="color: rgb(5, 80, 174); --shiki-dark: #D4D4D4;">    ...</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">]</span></span></code></pre></div></div><div data-fade-overlay="true" aria-hidden="true" style="--fade-color-light: #ffffff; --fade-color-dark: #0B0C0E;"></div></div><h4 class="flex whitespace-pre-wrap group font-semibold" id="tool-use-in-the-react-loop"><div class="absolute" tabindex="-1"><a href="https://docs.langchain.com/oss/python/langchain/agents#tool-use-in-the-react-loop" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100 focus:opacity-100 focus:outline-0 group/link" aria-label="Navigate to header">â€‹<div class="w-6 h-6 rounded-md flex items-center justify-center shadow-sm text-gray-400 dark:text-white/50 dark:bg-background-dark dark:brightness-[1.35] dark:ring-1 dark:hover:brightness-150 bg-white ring-1 ring-gray-400/30 dark:ring-gray-700/25 hover:ring-gray-400/60 dark:hover:ring-white/20 group-focus/link:border-2 group-focus/link:border-primary dark:group-focus/link:border-primary-light"><svg xmlns="http://www.w3.org/2000/svg" fill="gray" height="12px" viewBox="0 0 576 512"><path d="M0 256C0 167.6 71.6 96 160 96h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C98.1 144 48 194.1 48 256s50.1 112 112 112h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C71.6 416 0 344.4 0 256zm576 0c0 88.4-71.6 160-160 160H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c61.9 0 112-50.1 112-112s-50.1-112-112-112H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c88.4 0 160 71.6 160 160zM184 232H392c13.3 0 24 10.7 24 24s-10.7 24-24 24H184c-13.3 0-24-10.7-24-24s10.7-24 24-24z"></path></svg></div></a></div><span class="cursor-pointer">Tool use in the ReAct loop</span></h4><span data-as="p">Agents follow the ReAct (â€œReasoning + Actingâ€) pattern, alternating between brief reasoning steps with targeted tool calls and feeding the resulting observations into subsequent decisions until they can deliver a final answer.</span><details class="accordion border-standard rounded-2xl mb-3 overflow-hidden bg-background-light dark:bg-codeblock cursor-default"><summary class="relative not-prose flex flex-row items-center content-center w-full cursor-pointer list-none [&amp;::-webkit-details-marker]:hidden py-4 px-5 space-x-2 hover:bg-gray-100 hover:dark:bg-gray-800 rounded-t-xl" aria-controls="example-of-react-loop accordion children" aria-expanded="false" data-component-part="accordion-button"><div id="example-of-react-loop" class="absolute -top-[8rem]"></div><div class="mr-0.5" data-component-part="accordion-caret-right"><svg class="h-3 w-3 transition bg-gray-700 dark:bg-gray-400 duration-75" style="mask-image: url(&quot;https://d3gk2c5xim1je2.cloudfront.net/v7.1.0/solid/caret-right.svg&quot;); mask-repeat: no-repeat; mask-position: center center;"></svg></div><div class="leading-tight text-left" contenteditable="false" data-component-part="accordion-title-container"><p class="m-0 font-medium text-gray-900 dark:text-gray-200" data-component-part="accordion-title">Example of ReAct loop</p></div></summary><div id="example-of-react-loop accordion children" role="region" aria-labelledby="example-of-react-loop" class="mt-2 mb-4 mx-6 prose prose-gray dark:prose-invert overflow-x-auto cursor-default" data-component-part="accordion-content"><span data-as="p"><strong>Prompt:</strong> Identify the current most popular wireless headphones and verify availability.</span><div class="code-block mt-5 mb-8 not-prose rounded-2xl relative group text-gray-950 dark:text-gray-50 codeblock-light border border-gray-950/10 dark:border-white/10 dark:twoslash-dark bg-transparent dark:bg-transparent" numberoflines="4" language="text"><div data-floating-buttons="true" class="absolute top-3 right-4 flex items-center gap-1.5"><div class="z-10 relative select-none"><button class="h-[26px] w-[26px] flex items-center justify-center rounded-md backdrop-blur peer group/copy-button " data-testid="copy-code-button" aria-label="Copy the contents from the code block"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-400 group-hover/copy-button:text-gray-500 dark:text-white/40 dark:group-hover/copy-button:text-white/60"><path d="M14.25 5.25H7.25C6.14543 5.25 5.25 6.14543 5.25 7.25V14.25C5.25 15.3546 6.14543 16.25 7.25 16.25H14.25C15.3546 16.25 16.25 15.3546 16.25 14.25V7.25C16.25 6.14543 15.3546 5.25 14.25 5.25Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.80103 11.998L1.77203 5.07397C1.61003 3.98097 2.36403 2.96397 3.45603 2.80197L10.38 1.77297C11.313 1.63397 12.19 2.16297 12.528 3.00097" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div aria-hidden="true" class="absolute top-11 left-1/2 transform whitespace-nowrap -translate-x-1/2 -translate-y-1/2 peer-hover:opacity-100 opacity-0 text-tooltip-foreground rounded-lg px-1.5 py-0.5 text-xs bg-primary-dark">Copy</div></div></div><div class="w-0 min-w-full max-w-full py-3.5 px-4 h-full dark:bg-codeblock relative text-sm leading-6 children:!my-0 children:!shadow-none children:!bg-transparent transition-[height] duration-300 ease-in-out code-block-background [&amp;_*]:ring-0 [&amp;_*]:outline-0 [&amp;_*]:focus:ring-0 [&amp;_*]:focus:outline-0 rounded-2xl bg-white overflow-x-auto scrollbar-thin scrollbar-thumb-rounded scrollbar-thumb-black/15 hover:scrollbar-thumb-black/20 active:scrollbar-thumb-black/20 dark:scrollbar-thumb-white/20 dark:hover:scrollbar-thumb-white/25 dark:active:scrollbar-thumb-white/25" data-component-part="code-block-root" tabindex="0" style="font-variant-ligatures: none; height: auto; background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E;"><div class="font-mono whitespace-pre leading-6"><pre class="shiki shiki-themes github-light-default dark-plus" language="text" style="background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E; color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"><code language="text" numberoflines="4"><span class="line"><span>================================ Human Message =================================</span></span><span class="line"><span></span></span><span class="line"><span>Find the most popular wireless headphones right now and check if they're in stock</span></span><span class="line"><span></span></span></code></pre></div></div><div data-fade-overlay="true" aria-hidden="true" style="--fade-color-light: #ffffff; --fade-color-dark: #0B0C0E;"></div></div><ul><li><strong>Reasoning</strong>: â€œPopularity is time-sensitive, I need to use the provided search tool.â€</li><li><strong>Acting</strong>: Call <code>search_products("wireless headphones")</code></li></ul><div class="code-block mt-5 mb-8 not-prose rounded-2xl relative group text-gray-950 dark:text-gray-50 codeblock-light border border-gray-950/10 dark:border-white/10 dark:twoslash-dark bg-transparent dark:bg-transparent" numberoflines="7" language="text"><div data-floating-buttons="true" class="absolute top-3 right-4 flex items-center gap-1.5"><div class="z-10 relative select-none"><button class="h-[26px] w-[26px] flex items-center justify-center rounded-md backdrop-blur peer group/copy-button " data-testid="copy-code-button" aria-label="Copy the contents from the code block"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-400 group-hover/copy-button:text-gray-500 dark:text-white/40 dark:group-hover/copy-button:text-white/60"><path d="M14.25 5.25H7.25C6.14543 5.25 5.25 6.14543 5.25 7.25V14.25C5.25 15.3546 6.14543 16.25 7.25 16.25H14.25C15.3546 16.25 16.25 15.3546 16.25 14.25V7.25C16.25 6.14543 15.3546 5.25 14.25 5.25Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.80103 11.998L1.77203 5.07397C1.61003 3.98097 2.36403 2.96397 3.45603 2.80197L10.38 1.77297C11.313 1.63397 12.19 2.16297 12.528 3.00097" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div aria-hidden="true" class="absolute top-11 left-1/2 transform whitespace-nowrap -translate-x-1/2 -translate-y-1/2 peer-hover:opacity-100 opacity-0 text-tooltip-foreground rounded-lg px-1.5 py-0.5 text-xs bg-primary-dark">Copy</div></div></div><div class="w-0 min-w-full max-w-full py-3.5 px-4 h-full dark:bg-codeblock relative text-sm leading-6 children:!my-0 children:!shadow-none children:!bg-transparent transition-[height] duration-300 ease-in-out code-block-background [&amp;_*]:ring-0 [&amp;_*]:outline-0 [&amp;_*]:focus:ring-0 [&amp;_*]:focus:outline-0 rounded-2xl bg-white overflow-x-auto scrollbar-thin scrollbar-thumb-rounded scrollbar-thumb-black/15 hover:scrollbar-thumb-black/20 active:scrollbar-thumb-black/20 dark:scrollbar-thumb-white/20 dark:hover:scrollbar-thumb-white/25 dark:active:scrollbar-thumb-white/25" data-component-part="code-block-root" tabindex="0" style="font-variant-ligatures: none; height: auto; background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E;"><div class="font-mono whitespace-pre leading-6"><pre class="shiki shiki-themes github-light-default dark-plus" language="text" style="background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E; color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"><code language="text" numberoflines="7"><span class="line"><span>================================== Ai Message ==================================</span></span><span class="line"><span>Tool Calls:</span></span><span class="line"><span>  search_products (call_abc123)</span></span><span class="line"><span> Call ID: call_abc123</span></span><span class="line"><span>  Args:</span></span><span class="line"><span>    query: wireless headphones</span></span><span class="line"><span></span></span></code></pre></div></div><div data-fade-overlay="true" aria-hidden="true" style="--fade-color-light: #ffffff; --fade-color-dark: #0B0C0E;"></div></div><div class="code-block mt-5 mb-8 not-prose rounded-2xl relative group text-gray-950 dark:text-gray-50 codeblock-light border border-gray-950/10 dark:border-white/10 dark:twoslash-dark bg-transparent dark:bg-transparent" numberoflines="4" language="text"><div data-floating-buttons="true" class="absolute top-3 right-4 flex items-center gap-1.5"><div class="z-10 relative select-none"><button class="h-[26px] w-[26px] flex items-center justify-center rounded-md backdrop-blur peer group/copy-button " data-testid="copy-code-button" aria-label="Copy the contents from the code block"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-400 group-hover/copy-button:text-gray-500 dark:text-white/40 dark:group-hover/copy-button:text-white/60"><path d="M14.25 5.25H7.25C6.14543 5.25 5.25 6.14543 5.25 7.25V14.25C5.25 15.3546 6.14543 16.25 7.25 16.25H14.25C15.3546 16.25 16.25 15.3546 16.25 14.25V7.25C16.25 6.14543 15.3546 5.25 14.25 5.25Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.80103 11.998L1.77203 5.07397C1.61003 3.98097 2.36403 2.96397 3.45603 2.80197L10.38 1.77297C11.313 1.63397 12.19 2.16297 12.528 3.00097" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div aria-hidden="true" class="absolute top-11 left-1/2 transform whitespace-nowrap -translate-x-1/2 -translate-y-1/2 peer-hover:opacity-100 opacity-0 text-tooltip-foreground rounded-lg px-1.5 py-0.5 text-xs bg-primary-dark">Copy</div></div></div><div class="w-0 min-w-full max-w-full py-3.5 px-4 h-full dark:bg-codeblock relative text-sm leading-6 children:!my-0 children:!shadow-none children:!bg-transparent transition-[height] duration-300 ease-in-out code-block-background [&amp;_*]:ring-0 [&amp;_*]:outline-0 [&amp;_*]:focus:ring-0 [&amp;_*]:focus:outline-0 rounded-2xl bg-white overflow-x-auto scrollbar-thin scrollbar-thumb-rounded scrollbar-thumb-black/15 hover:scrollbar-thumb-black/20 active:scrollbar-thumb-black/20 dark:scrollbar-thumb-white/20 dark:hover:scrollbar-thumb-white/25 dark:active:scrollbar-thumb-white/25" data-component-part="code-block-root" tabindex="0" style="font-variant-ligatures: none; height: auto; background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E;"><div class="font-mono whitespace-pre leading-6"><pre class="shiki shiki-themes github-light-default dark-plus" language="text" style="background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E; color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"><code language="text" numberoflines="4"><span class="line"><span>================================= Tool Message =================================</span></span><span class="line"><span></span></span><span class="line"><span>Found 5 products matching "wireless headphones". Top 5 results: WH-1000XM5, ...</span></span><span class="line"><span></span></span></code></pre></div></div><div data-fade-overlay="true" aria-hidden="true" style="--fade-color-light: #ffffff; --fade-color-dark: #0B0C0E;"></div></div><ul><li><strong>Reasoning</strong>: â€œI need to confirm availability for the top-ranked item before answering.â€</li><li><strong>Acting</strong>: Call <code>check_inventory("WH-1000XM5")</code></li></ul><div class="code-block mt-5 mb-8 not-prose rounded-2xl relative group text-gray-950 dark:text-gray-50 codeblock-light border border-gray-950/10 dark:border-white/10 dark:twoslash-dark bg-transparent dark:bg-transparent" numberoflines="7" language="text"><div data-floating-buttons="true" class="absolute top-3 right-4 flex items-center gap-1.5"><div class="z-10 relative select-none"><button class="h-[26px] w-[26px] flex items-center justify-center rounded-md backdrop-blur peer group/copy-button " data-testid="copy-code-button" aria-label="Copy the contents from the code block"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-400 group-hover/copy-button:text-gray-500 dark:text-white/40 dark:group-hover/copy-button:text-white/60"><path d="M14.25 5.25H7.25C6.14543 5.25 5.25 6.14543 5.25 7.25V14.25C5.25 15.3546 6.14543 16.25 7.25 16.25H14.25C15.3546 16.25 16.25 15.3546 16.25 14.25V7.25C16.25 6.14543 15.3546 5.25 14.25 5.25Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.80103 11.998L1.77203 5.07397C1.61003 3.98097 2.36403 2.96397 3.45603 2.80197L10.38 1.77297C11.313 1.63397 12.19 2.16297 12.528 3.00097" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div aria-hidden="true" class="absolute top-11 left-1/2 transform whitespace-nowrap -translate-x-1/2 -translate-y-1/2 peer-hover:opacity-100 opacity-0 text-tooltip-foreground rounded-lg px-1.5 py-0.5 text-xs bg-primary-dark">Copy</div></div></div><div class="w-0 min-w-full max-w-full py-3.5 px-4 h-full dark:bg-codeblock relative text-sm leading-6 children:!my-0 children:!shadow-none children:!bg-transparent transition-[height] duration-300 ease-in-out code-block-background [&amp;_*]:ring-0 [&amp;_*]:outline-0 [&amp;_*]:focus:ring-0 [&amp;_*]:focus:outline-0 rounded-2xl bg-white overflow-x-auto scrollbar-thin scrollbar-thumb-rounded scrollbar-thumb-black/15 hover:scrollbar-thumb-black/20 active:scrollbar-thumb-black/20 dark:scrollbar-thumb-white/20 dark:hover:scrollbar-thumb-white/25 dark:active:scrollbar-thumb-white/25" data-component-part="code-block-root" tabindex="0" style="font-variant-ligatures: none; height: auto; background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E;"><div class="font-mono whitespace-pre leading-6"><pre class="shiki shiki-themes github-light-default dark-plus" language="text" style="background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E; color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"><code language="text" numberoflines="7"><span class="line"><span>================================== Ai Message ==================================</span></span><span class="line"><span>Tool Calls:</span></span><span class="line"><span>  check_inventory (call_def456)</span></span><span class="line"><span> Call ID: call_def456</span></span><span class="line"><span>  Args:</span></span><span class="line"><span>    product_id: WH-1000XM5</span></span><span class="line"><span></span></span></code></pre></div></div><div data-fade-overlay="true" aria-hidden="true" style="--fade-color-light: #ffffff; --fade-color-dark: #0B0C0E;"></div></div><div class="code-block mt-5 mb-8 not-prose rounded-2xl relative group text-gray-950 dark:text-gray-50 codeblock-light border border-gray-950/10 dark:border-white/10 dark:twoslash-dark bg-transparent dark:bg-transparent" numberoflines="4" language="text"><div data-floating-buttons="true" class="absolute top-3 right-4 flex items-center gap-1.5"><div class="z-10 relative select-none"><button class="h-[26px] w-[26px] flex items-center justify-center rounded-md backdrop-blur peer group/copy-button " data-testid="copy-code-button" aria-label="Copy the contents from the code block"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-400 group-hover/copy-button:text-gray-500 dark:text-white/40 dark:group-hover/copy-button:text-white/60"><path d="M14.25 5.25H7.25C6.14543 5.25 5.25 6.14543 5.25 7.25V14.25C5.25 15.3546 6.14543 16.25 7.25 16.25H14.25C15.3546 16.25 16.25 15.3546 16.25 14.25V7.25C16.25 6.14543 15.3546 5.25 14.25 5.25Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.80103 11.998L1.77203 5.07397C1.61003 3.98097 2.36403 2.96397 3.45603 2.80197L10.38 1.77297C11.313 1.63397 12.19 2.16297 12.528 3.00097" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div aria-hidden="true" class="absolute top-11 left-1/2 transform whitespace-nowrap -translate-x-1/2 -translate-y-1/2 peer-hover:opacity-100 opacity-0 text-tooltip-foreground rounded-lg px-1.5 py-0.5 text-xs bg-primary-dark">Copy</div></div></div><div class="w-0 min-w-full max-w-full py-3.5 px-4 h-full dark:bg-codeblock relative text-sm leading-6 children:!my-0 children:!shadow-none children:!bg-transparent transition-[height] duration-300 ease-in-out code-block-background [&amp;_*]:ring-0 [&amp;_*]:outline-0 [&amp;_*]:focus:ring-0 [&amp;_*]:focus:outline-0 rounded-2xl bg-white overflow-x-auto scrollbar-thin scrollbar-thumb-rounded scrollbar-thumb-black/15 hover:scrollbar-thumb-black/20 active:scrollbar-thumb-black/20 dark:scrollbar-thumb-white/20 dark:hover:scrollbar-thumb-white/25 dark:active:scrollbar-thumb-white/25" data-component-part="code-block-root" tabindex="0" style="font-variant-ligatures: none; height: auto; background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E;"><div class="font-mono whitespace-pre leading-6"><pre class="shiki shiki-themes github-light-default dark-plus" language="text" style="background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E; color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"><code language="text" numberoflines="4"><span class="line"><span>================================= Tool Message =================================</span></span><span class="line"><span></span></span><span class="line"><span>Product WH-1000XM5: 10 units in stock</span></span><span class="line"><span></span></span></code></pre></div></div><div data-fade-overlay="true" aria-hidden="true" style="--fade-color-light: #ffffff; --fade-color-dark: #0B0C0E;"></div></div><ul><li><strong>Reasoning</strong>: â€œI have the most popular model and its stock status. I can now answer the userâ€™s question.â€</li><li><strong>Acting</strong>: Produce final answer</li></ul><div class="code-block mt-5 mb-8 not-prose rounded-2xl relative group text-gray-950 dark:text-gray-50 codeblock-light border border-gray-950/10 dark:border-white/10 dark:twoslash-dark bg-transparent dark:bg-transparent" numberoflines="4" language="text"><div data-floating-buttons="true" class="absolute top-3 right-4 flex items-center gap-1.5"><div class="z-10 relative select-none"><button class="h-[26px] w-[26px] flex items-center justify-center rounded-md backdrop-blur peer group/copy-button " data-testid="copy-code-button" aria-label="Copy the contents from the code block"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-400 group-hover/copy-button:text-gray-500 dark:text-white/40 dark:group-hover/copy-button:text-white/60"><path d="M14.25 5.25H7.25C6.14543 5.25 5.25 6.14543 5.25 7.25V14.25C5.25 15.3546 6.14543 16.25 7.25 16.25H14.25C15.3546 16.25 16.25 15.3546 16.25 14.25V7.25C16.25 6.14543 15.3546 5.25 14.25 5.25Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.80103 11.998L1.77203 5.07397C1.61003 3.98097 2.36403 2.96397 3.45603 2.80197L10.38 1.77297C11.313 1.63397 12.19 2.16297 12.528 3.00097" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div aria-hidden="true" class="absolute top-11 left-1/2 transform whitespace-nowrap -translate-x-1/2 -translate-y-1/2 peer-hover:opacity-100 opacity-0 text-tooltip-foreground rounded-lg px-1.5 py-0.5 text-xs bg-primary-dark">Copy</div></div></div><div class="w-0 min-w-full max-w-full py-3.5 px-4 h-full dark:bg-codeblock relative text-sm leading-6 children:!my-0 children:!shadow-none children:!bg-transparent transition-[height] duration-300 ease-in-out code-block-background [&amp;_*]:ring-0 [&amp;_*]:outline-0 [&amp;_*]:focus:ring-0 [&amp;_*]:focus:outline-0 rounded-2xl bg-white overflow-x-auto scrollbar-thin scrollbar-thumb-rounded scrollbar-thumb-black/15 hover:scrollbar-thumb-black/20 active:scrollbar-thumb-black/20 dark:scrollbar-thumb-white/20 dark:hover:scrollbar-thumb-white/25 dark:active:scrollbar-thumb-white/25" data-component-part="code-block-root" tabindex="0" style="font-variant-ligatures: none; height: auto; background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E;"><div class="font-mono whitespace-pre leading-6"><pre class="shiki shiki-themes github-light-default dark-plus" language="text" style="background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E; color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"><code language="text" numberoflines="4"><span class="line"><span>================================== Ai Message ==================================</span></span><span class="line"><span></span></span><span class="line"><span>I found wireless headphones (model WH-1000XM5) with 10 units in stock...</span></span><span class="line"><span></span></span></code></pre></div></div><div data-fade-overlay="true" aria-hidden="true" style="--fade-color-light: #ffffff; --fade-color-dark: #0B0C0E;"></div></div></div></details><div class="callout my-4 px-5 py-4 overflow-hidden rounded-2xl flex gap-3 border border-emerald-500/20 bg-emerald-50/50 dark:border-emerald-500/30 dark:bg-emerald-500/10 [&amp;_[data-component-part=&#39;callout-icon&#39;]]:mt-px" data-callout-type="tip"><div class="mt-0.5 w-4" data-component-part="callout-icon"><svg width="11" height="14" viewBox="0 0 11 14" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="text-emerald-600 dark:text-emerald-400/80 w-3.5 h-auto" aria-label="Tip"><path d="M3.12794 12.4232C3.12794 12.5954 3.1776 12.7634 3.27244 12.907L3.74114 13.6095C3.88471 13.8248 4.21067 14 4.46964 14H6.15606C6.41415 14 6.74017 13.825 6.88373 13.6095L7.3508 12.9073C7.43114 12.7859 7.49705 12.569 7.49705 12.4232L7.50055 11.3513H3.12521L3.12794 12.4232ZM5.31288 0C2.52414 0.00875889 0.5 2.26889 0.5 4.78826C0.5 6.00188 0.949566 7.10829 1.69119 7.95492C2.14321 8.47011 2.84901 9.54727 3.11919 10.4557C3.12005 10.4625 3.12175 10.4698 3.12261 10.4771H7.50342C7.50427 10.4698 7.50598 10.463 7.50684 10.4557C7.77688 9.54727 8.48281 8.47011 8.93484 7.95492C9.67728 7.13181 10.1258 6.02703 10.1258 4.78826C10.1258 2.15486 7.9709 0.000106649 5.31288 0ZM7.94902 7.11267C7.52078 7.60079 6.99082 8.37878 6.6077 9.18794H4.02051C3.63739 8.37878 3.10743 7.60079 2.67947 7.11294C2.11997 6.47551 1.8126 5.63599 1.8126 4.78826C1.8126 3.09829 3.12794 1.31944 5.28827 1.3126C7.2435 1.3126 8.81315 2.88226 8.81315 4.78826C8.81315 5.63599 8.50688 6.47551 7.94902 7.11267ZM4.87534 2.18767C3.66939 2.18767 2.68767 3.16939 2.68767 4.37534C2.68767 4.61719 2.88336 4.81288 3.12521 4.81288C3.36705 4.81288 3.56274 4.61599 3.56274 4.37534C3.56274 3.6515 4.1515 3.06274 4.87534 3.06274C5.11719 3.06274 5.31288 2.86727 5.31288 2.62548C5.31288 2.38369 5.11599 2.18767 4.87534 2.18767Z"></path></svg></div><div class="text-sm prose dark:prose-invert min-w-0 w-full [&amp;_kbd]:bg-background-light dark:[&amp;_kbd]:bg-background-dark [&amp;_code]:!text-current [&amp;_kbd]:!text-current [&amp;_a]:!text-current [&amp;_a]:border-current text-emerald-900 dark:text-emerald-200" data-component-part="callout-content"><span data-as="p">To learn more about tools, see <a class="link" href="https://docs.langchain.com/oss/python/langchain/tools">Tools</a>.</span></div></div><h3 class="flex whitespace-pre-wrap group font-semibold" id="system-prompt"><div class="absolute" tabindex="-1"><a href="https://docs.langchain.com/oss/python/langchain/agents#system-prompt" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100 focus:opacity-100 focus:outline-0 group/link" aria-label="Navigate to header">â€‹<div class="w-6 h-6 rounded-md flex items-center justify-center shadow-sm text-gray-400 dark:text-white/50 dark:bg-background-dark dark:brightness-[1.35] dark:ring-1 dark:hover:brightness-150 bg-white ring-1 ring-gray-400/30 dark:ring-gray-700/25 hover:ring-gray-400/60 dark:hover:ring-white/20 group-focus/link:border-2 group-focus/link:border-primary dark:group-focus/link:border-primary-light"><svg xmlns="http://www.w3.org/2000/svg" fill="gray" height="12px" viewBox="0 0 576 512"><path d="M0 256C0 167.6 71.6 96 160 96h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C98.1 144 48 194.1 48 256s50.1 112 112 112h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C71.6 416 0 344.4 0 256zm576 0c0 88.4-71.6 160-160 160H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c61.9 0 112-50.1 112-112s-50.1-112-112-112H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c88.4 0 160 71.6 160 160zM184 232H392c13.3 0 24 10.7 24 24s-10.7 24-24 24H184c-13.3 0-24-10.7-24-24s10.7-24 24-24z"></path></svg></div></a></div><span class="cursor-pointer">System prompt</span></h3><span data-as="p">You can shape how your agent approaches tasks by providing a prompt. The <a href="https://reference.langchain.com/python/langchain/agents/#langchain.agents.create_agent(system_prompt)" target="_blank" rel="noreferrer" class="link"><code>system_prompt</code></a> parameter can be provided as a string:</span><div class="code-block mt-5 mb-8 not-prose rounded-2xl relative group text-gray-950 dark:text-gray-50 codeblock-light border border-gray-950/10 dark:border-white/10 dark:twoslash-dark bg-transparent dark:bg-transparent" wrap="true" numberoflines="5" language="python"><div data-floating-buttons="true" class="absolute top-3 right-4 flex items-center gap-1.5"><div class="z-10 relative select-none"><button class="h-[26px] w-[26px] flex items-center justify-center rounded-md backdrop-blur peer group/copy-button " data-testid="copy-code-button" aria-label="Copy the contents from the code block"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-400 group-hover/copy-button:text-gray-500 dark:text-white/40 dark:group-hover/copy-button:text-white/60"><path d="M14.25 5.25H7.25C6.14543 5.25 5.25 6.14543 5.25 7.25V14.25C5.25 15.3546 6.14543 16.25 7.25 16.25H14.25C15.3546 16.25 16.25 15.3546 16.25 14.25V7.25C16.25 6.14543 15.3546 5.25 14.25 5.25Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.80103 11.998L1.77203 5.07397C1.61003 3.98097 2.36403 2.96397 3.45603 2.80197L10.38 1.77297C11.313 1.63397 12.19 2.16297 12.528 3.00097" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div aria-hidden="true" class="absolute top-11 left-1/2 transform whitespace-nowrap -translate-x-1/2 -translate-y-1/2 peer-hover:opacity-100 opacity-0 text-tooltip-foreground rounded-lg px-1.5 py-0.5 text-xs bg-primary-dark">Copy</div></div></div><div class="w-0 min-w-full max-w-full py-3.5 px-4 h-full dark:bg-codeblock relative text-sm leading-6 children:!my-0 children:!shadow-none children:!bg-transparent transition-[height] duration-300 ease-in-out code-block-background [&amp;_*]:ring-0 [&amp;_*]:outline-0 [&amp;_*]:focus:ring-0 [&amp;_*]:focus:outline-0 rounded-2xl bg-white code-block-wrap overflow-x-hidden whitespace-pre-wrap scrollbar-thin scrollbar-thumb-rounded scrollbar-thumb-black/15 hover:scrollbar-thumb-black/20 active:scrollbar-thumb-black/20 dark:scrollbar-thumb-white/20 dark:hover:scrollbar-thumb-white/25 dark:active:scrollbar-thumb-white/25" data-component-part="code-block-root" tabindex="0" style="font-variant-ligatures: none; height: auto; background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E;"><div class="font-mono whitespace-pre-wrap leading-6"><pre class="shiki shiki-themes github-light-default dark-plus" language="python" style="background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E; color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"><code language="python" numberoflines="5"><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">agent </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> create_agent(</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">    model,</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">    tools,</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">    system_prompt</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"You are a helpful assistant. Be concise and accurate."</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">)</span></span></code></pre></div></div></div><span data-as="p">When no <a href="https://reference.langchain.com/python/langchain/agents/#langchain.agents.create_agent(system_prompt)" target="_blank" rel="noreferrer" class="link"><code>system_prompt</code></a> is provided, the agent will infer its task from the messages directly.</span><span data-as="p">The <a href="https://reference.langchain.com/python/langchain/agents/#langchain.agents.create_agent(system_prompt)" target="_blank" rel="noreferrer" class="link"><code>system_prompt</code></a> parameter accepts either a <code>str</code> or a <a href="https://reference.langchain.com/python/langchain/messages/#langchain.messages.SystemMessage" target="_blank" rel="noreferrer" class="link"><code>SystemMessage</code></a>. Using a <code>SystemMessage</code> gives you more control over the prompt structure, which is useful for provider-specific features like <a class="link" href="https://docs.langchain.com/oss/python/integrations/chat/anthropic#prompt-caching">Anthropicâ€™s prompt caching</a>:</span><div class="code-block mt-5 mb-8 not-prose rounded-2xl relative group text-gray-950 dark:text-gray-50 codeblock-light border border-gray-950/10 dark:border-white/10 dark:twoslash-dark bg-transparent dark:bg-transparent" wrap="true" numberoflines="23" language="python"><div data-floating-buttons="true" class="absolute top-3 right-4 flex items-center gap-1.5"><div class="z-10 relative select-none"><button class="h-[26px] w-[26px] flex items-center justify-center rounded-md backdrop-blur peer group/copy-button " data-testid="copy-code-button" aria-label="Copy the contents from the code block"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-400 group-hover/copy-button:text-gray-500 dark:text-white/40 dark:group-hover/copy-button:text-white/60"><path d="M14.25 5.25H7.25C6.14543 5.25 5.25 6.14543 5.25 7.25V14.25C5.25 15.3546 6.14543 16.25 7.25 16.25H14.25C15.3546 16.25 16.25 15.3546 16.25 14.25V7.25C16.25 6.14543 15.3546 5.25 14.25 5.25Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.80103 11.998L1.77203 5.07397C1.61003 3.98097 2.36403 2.96397 3.45603 2.80197L10.38 1.77297C11.313 1.63397 12.19 2.16297 12.528 3.00097" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div aria-hidden="true" class="absolute top-11 left-1/2 transform whitespace-nowrap -translate-x-1/2 -translate-y-1/2 peer-hover:opacity-100 opacity-0 text-tooltip-foreground rounded-lg px-1.5 py-0.5 text-xs bg-primary-dark">Copy</div></div></div><div class="w-0 min-w-full max-w-full py-3.5 px-4 h-full dark:bg-codeblock relative text-sm leading-6 children:!my-0 children:!shadow-none children:!bg-transparent transition-[height] duration-300 ease-in-out code-block-background [&amp;_*]:ring-0 [&amp;_*]:outline-0 [&amp;_*]:focus:ring-0 [&amp;_*]:focus:outline-0 rounded-2xl bg-white code-block-wrap overflow-x-hidden whitespace-pre-wrap scrollbar-thin scrollbar-thumb-rounded scrollbar-thumb-black/15 hover:scrollbar-thumb-black/20 active:scrollbar-thumb-black/20 dark:scrollbar-thumb-white/20 dark:hover:scrollbar-thumb-white/25 dark:active:scrollbar-thumb-white/25" data-component-part="code-block-root" tabindex="0" style="font-variant-ligatures: none; height: auto; background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E;"><div class="font-mono whitespace-pre-wrap leading-6"><pre class="shiki shiki-themes github-light-default dark-plus" language="python" style="background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E; color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"><code language="python" numberoflines="23"><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">from</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> langchain.agents </span><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">import</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> create_agent</span></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">from</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> langchain.messages </span><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">import</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> SystemMessage, HumanMessage</span></span><span class="line"></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">literary_agent </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> create_agent(</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">    model</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"anthropic:claude-sonnet-4-5"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">,</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">    system_prompt</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">SystemMessage(</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">        content</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">[</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">            &#123;</span></span><span class="line"><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">                "type"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"text"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">,</span></span><span class="line"><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">                "text"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"You are an AI assistant tasked with analyzing literary works."</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">,</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">            &#125;,</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">            &#123;</span></span><span class="line"><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">                "type"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"text"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">,</span></span><span class="line"><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">                "text"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"&lt;the entire contents of 'Pride and Prejudice'&gt;"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">,</span></span><span class="line"><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">                "cache_control"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: &#123;</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"type"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"ephemeral"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">&#125;</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">            &#125;</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">        ]</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">    )</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">)</span></span><span class="line"></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">result </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> literary_agent.invoke(</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">    &#123;</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"messages"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: [HumanMessage(</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"Analyze the major themes in 'Pride and Prejudice'."</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">)]&#125;</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">)</span></span></code></pre></div></div></div><span data-as="p">The <code>cache_control</code> field with <code>&#123;"type": "ephemeral"&#125;</code> tells Anthropic to cache that content block, reducing latency and costs for repeated requests that use the same system prompt.</span><h4 class="flex whitespace-pre-wrap group font-semibold" id="dynamic-system-prompt"><div class="absolute" tabindex="-1"><a href="https://docs.langchain.com/oss/python/langchain/agents#dynamic-system-prompt" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100 focus:opacity-100 focus:outline-0 group/link" aria-label="Navigate to header">â€‹<div class="w-6 h-6 rounded-md flex items-center justify-center shadow-sm text-gray-400 dark:text-white/50 dark:bg-background-dark dark:brightness-[1.35] dark:ring-1 dark:hover:brightness-150 bg-white ring-1 ring-gray-400/30 dark:ring-gray-700/25 hover:ring-gray-400/60 dark:hover:ring-white/20 group-focus/link:border-2 group-focus/link:border-primary dark:group-focus/link:border-primary-light"><svg xmlns="http://www.w3.org/2000/svg" fill="gray" height="12px" viewBox="0 0 576 512"><path d="M0 256C0 167.6 71.6 96 160 96h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C98.1 144 48 194.1 48 256s50.1 112 112 112h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C71.6 416 0 344.4 0 256zm576 0c0 88.4-71.6 160-160 160H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c61.9 0 112-50.1 112-112s-50.1-112-112-112H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c88.4 0 160 71.6 160 160zM184 232H392c13.3 0 24 10.7 24 24s-10.7 24-24 24H184c-13.3 0-24-10.7-24-24s10.7-24 24-24z"></path></svg></div></a></div><span class="cursor-pointer">Dynamic system prompt</span></h4><span data-as="p">For more advanced use cases where you need to modify the system prompt based on runtime context or agent state, you can use <a class="link" href="https://docs.langchain.com/oss/python/langchain/middleware">middleware</a>.</span><span data-as="p">The <a href="https://reference.langchain.com/python/langchain/middleware/#langchain.agents.middleware.dynamic_prompt" target="_blank" rel="noreferrer" class="link"><code>@dynamic_prompt</code></a> decorator creates middleware that generates system prompts based on the model request:</span><div class="code-block mt-5 mb-8 not-prose rounded-2xl relative group text-gray-950 dark:text-gray-50 codeblock-light border border-gray-950/10 dark:border-white/10 dark:twoslash-dark bg-transparent dark:bg-transparent" wrap="true" numberoflines="34" language="python"><div data-floating-buttons="true" class="absolute top-3 right-4 flex items-center gap-1.5"><div class="z-10 relative select-none"><button class="h-[26px] w-[26px] flex items-center justify-center rounded-md backdrop-blur peer group/copy-button " data-testid="copy-code-button" aria-label="Copy the contents from the code block"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-400 group-hover/copy-button:text-gray-500 dark:text-white/40 dark:group-hover/copy-button:text-white/60"><path d="M14.25 5.25H7.25C6.14543 5.25 5.25 6.14543 5.25 7.25V14.25C5.25 15.3546 6.14543 16.25 7.25 16.25H14.25C15.3546 16.25 16.25 15.3546 16.25 14.25V7.25C16.25 6.14543 15.3546 5.25 14.25 5.25Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.80103 11.998L1.77203 5.07397C1.61003 3.98097 2.36403 2.96397 3.45603 2.80197L10.38 1.77297C11.313 1.63397 12.19 2.16297 12.528 3.00097" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div aria-hidden="true" class="absolute top-11 left-1/2 transform whitespace-nowrap -translate-x-1/2 -translate-y-1/2 peer-hover:opacity-100 opacity-0 text-tooltip-foreground rounded-lg px-1.5 py-0.5 text-xs bg-primary-dark">Copy</div></div></div><div class="w-0 min-w-full max-w-full py-3.5 px-4 h-full dark:bg-codeblock relative text-sm leading-6 children:!my-0 children:!shadow-none children:!bg-transparent transition-[height] duration-300 ease-in-out code-block-background [&amp;_*]:ring-0 [&amp;_*]:outline-0 [&amp;_*]:focus:ring-0 [&amp;_*]:focus:outline-0 rounded-2xl bg-white code-block-wrap overflow-x-hidden whitespace-pre-wrap scrollbar-thin scrollbar-thumb-rounded scrollbar-thumb-black/15 hover:scrollbar-thumb-black/20 active:scrollbar-thumb-black/20 dark:scrollbar-thumb-white/20 dark:hover:scrollbar-thumb-white/25 dark:active:scrollbar-thumb-white/25" data-component-part="code-block-root" tabindex="0" style="font-variant-ligatures: none; height: auto; background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E;"><div class="font-mono whitespace-pre-wrap leading-6"><pre class="shiki shiki-themes github-light-default dark-plus" language="python" style="background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E; color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"><code language="python" numberoflines="34"><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">from</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> typing </span><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">import</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> TypedDict</span></span><span class="line"></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">from</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> langchain.agents </span><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">import</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> create_agent</span></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">from</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> langchain.agents.middleware </span><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">import</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> dynamic_prompt, ModelRequest</span></span><span class="line"></span><span class="line"></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;">class</span><span style="color: rgb(149, 56, 0); --shiki-dark: #4EC9B0;"> Context</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">(</span><span style="color: rgb(5, 80, 174); --shiki-dark: #4EC9B0;">TypedDict</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">):</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">    user_role: </span><span style="color: rgb(5, 80, 174); --shiki-dark: #4EC9B0;">str</span></span><span class="line"></span><span class="line"><span style="color: rgb(130, 80, 223); --shiki-dark: #DCDCAA;">@dynamic_prompt</span></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;">def</span><span style="color: rgb(130, 80, 223); --shiki-dark: #DCDCAA;"> user_role_prompt</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">(</span><span style="color: rgb(31, 35, 40); --shiki-dark: #9CDCFE;">request</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: ModelRequest) -&gt; </span><span style="color: rgb(5, 80, 174); --shiki-dark: #4EC9B0;">str</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">:</span></span><span class="line"><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">    """Generate system prompt based on user role."""</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">    user_role </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> request.runtime.context.get(</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"user_role"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">, </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"user"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">)</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">    base_prompt </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;"> "You are a helpful assistant."</span></span><span class="line"></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">    if</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> user_role </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">==</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;"> "expert"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">:</span></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">        return</span><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;"> f</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"</span><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;">&#123;</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">base_prompt</span><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;">&#125;</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;"> Provide detailed technical responses."</span></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">    elif</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> user_role </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">==</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;"> "beginner"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">:</span></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">        return</span><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;"> f</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"</span><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;">&#123;</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">base_prompt</span><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;">&#125;</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;"> Explain concepts simply and avoid jargon."</span></span><span class="line"></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">    return</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> base_prompt</span></span><span class="line"></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">agent </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> create_agent(</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">    model</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"gpt-4o"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">,</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">    tools</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">[web_search],</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">    middleware</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">[user_role_prompt],</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">    context_schema</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">Context</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">)</span></span><span class="line"></span><span class="line"><span style="color: rgb(110, 119, 129); --shiki-dark: #6A9955;"># The system prompt will be set dynamically based on context</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">result </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> agent.invoke(</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">    &#123;</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"messages"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: [&#123;</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"role"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"user"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">, </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"content"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"Explain machine learning"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">&#125;]&#125;,</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">    context</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">&#123;</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"user_role"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"expert"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">&#125;</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">)</span></span></code></pre></div></div></div><div class="callout my-4 px-5 py-4 overflow-hidden rounded-2xl flex gap-3 border border-emerald-500/20 bg-emerald-50/50 dark:border-emerald-500/30 dark:bg-emerald-500/10 [&amp;_[data-component-part=&#39;callout-icon&#39;]]:mt-px" data-callout-type="tip"><div class="mt-0.5 w-4" data-component-part="callout-icon"><svg width="11" height="14" viewBox="0 0 11 14" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="text-emerald-600 dark:text-emerald-400/80 w-3.5 h-auto" aria-label="Tip"><path d="M3.12794 12.4232C3.12794 12.5954 3.1776 12.7634 3.27244 12.907L3.74114 13.6095C3.88471 13.8248 4.21067 14 4.46964 14H6.15606C6.41415 14 6.74017 13.825 6.88373 13.6095L7.3508 12.9073C7.43114 12.7859 7.49705 12.569 7.49705 12.4232L7.50055 11.3513H3.12521L3.12794 12.4232ZM5.31288 0C2.52414 0.00875889 0.5 2.26889 0.5 4.78826C0.5 6.00188 0.949566 7.10829 1.69119 7.95492C2.14321 8.47011 2.84901 9.54727 3.11919 10.4557C3.12005 10.4625 3.12175 10.4698 3.12261 10.4771H7.50342C7.50427 10.4698 7.50598 10.463 7.50684 10.4557C7.77688 9.54727 8.48281 8.47011 8.93484 7.95492C9.67728 7.13181 10.1258 6.02703 10.1258 4.78826C10.1258 2.15486 7.9709 0.000106649 5.31288 0ZM7.94902 7.11267C7.52078 7.60079 6.99082 8.37878 6.6077 9.18794H4.02051C3.63739 8.37878 3.10743 7.60079 2.67947 7.11294C2.11997 6.47551 1.8126 5.63599 1.8126 4.78826C1.8126 3.09829 3.12794 1.31944 5.28827 1.3126C7.2435 1.3126 8.81315 2.88226 8.81315 4.78826C8.81315 5.63599 8.50688 6.47551 7.94902 7.11267ZM4.87534 2.18767C3.66939 2.18767 2.68767 3.16939 2.68767 4.37534C2.68767 4.61719 2.88336 4.81288 3.12521 4.81288C3.36705 4.81288 3.56274 4.61599 3.56274 4.37534C3.56274 3.6515 4.1515 3.06274 4.87534 3.06274C5.11719 3.06274 5.31288 2.86727 5.31288 2.62548C5.31288 2.38369 5.11599 2.18767 4.87534 2.18767Z"></path></svg></div><div class="text-sm prose dark:prose-invert min-w-0 w-full [&amp;_kbd]:bg-background-light dark:[&amp;_kbd]:bg-background-dark [&amp;_code]:!text-current [&amp;_kbd]:!text-current [&amp;_a]:!text-current [&amp;_a]:border-current text-emerald-900 dark:text-emerald-200" data-component-part="callout-content"><span data-as="p">For more details on message types and formatting, see <a class="link" href="https://docs.langchain.com/oss/python/langchain/messages">Messages</a>. For comprehensive middleware documentation, see <a class="link" href="https://docs.langchain.com/oss/python/langchain/middleware">Middleware</a>.</span></div></div><h2 class="flex whitespace-pre-wrap group font-semibold" id="invocation"><div class="absolute" tabindex="-1"><a href="https://docs.langchain.com/oss/python/langchain/agents#invocation" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100 focus:opacity-100 focus:outline-0 group/link" aria-label="Navigate to header">â€‹<div class="w-6 h-6 rounded-md flex items-center justify-center shadow-sm text-gray-400 dark:text-white/50 dark:bg-background-dark dark:brightness-[1.35] dark:ring-1 dark:hover:brightness-150 bg-white ring-1 ring-gray-400/30 dark:ring-gray-700/25 hover:ring-gray-400/60 dark:hover:ring-white/20 group-focus/link:border-2 group-focus/link:border-primary dark:group-focus/link:border-primary-light"><svg xmlns="http://www.w3.org/2000/svg" fill="gray" height="12px" viewBox="0 0 576 512"><path d="M0 256C0 167.6 71.6 96 160 96h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C98.1 144 48 194.1 48 256s50.1 112 112 112h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C71.6 416 0 344.4 0 256zm576 0c0 88.4-71.6 160-160 160H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c61.9 0 112-50.1 112-112s-50.1-112-112-112H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c88.4 0 160 71.6 160 160zM184 232H392c13.3 0 24 10.7 24 24s-10.7 24-24 24H184c-13.3 0-24-10.7-24-24s10.7-24 24-24z"></path></svg></div></a></div><span class="cursor-pointer">Invocation</span></h2><span data-as="p">You can invoke an agent by passing an update to its <a class="link" href="https://docs.langchain.com/oss/python/langgraph/graph-api#state"><code>State</code></a>. All agents include a <a class="link" href="https://docs.langchain.com/oss/python/langgraph/use-graph-api#messagesstate">sequence of messages</a> in their state; to invoke the agent, pass a new message:</span><div class="code-block mt-5 mb-8 not-prose rounded-2xl relative group text-gray-950 dark:text-gray-50 codeblock-light border border-gray-950/10 dark:border-white/10 dark:twoslash-dark bg-transparent dark:bg-transparent" numberoflines="3" language="python"><div data-floating-buttons="true" class="absolute top-3 right-4 flex items-center gap-1.5"><div class="z-10 relative select-none"><button class="h-[26px] w-[26px] flex items-center justify-center rounded-md backdrop-blur peer group/copy-button " data-testid="copy-code-button" aria-label="Copy the contents from the code block"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-400 group-hover/copy-button:text-gray-500 dark:text-white/40 dark:group-hover/copy-button:text-white/60"><path d="M14.25 5.25H7.25C6.14543 5.25 5.25 6.14543 5.25 7.25V14.25C5.25 15.3546 6.14543 16.25 7.25 16.25H14.25C15.3546 16.25 16.25 15.3546 16.25 14.25V7.25C16.25 6.14543 15.3546 5.25 14.25 5.25Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.80103 11.998L1.77203 5.07397C1.61003 3.98097 2.36403 2.96397 3.45603 2.80197L10.38 1.77297C11.313 1.63397 12.19 2.16297 12.528 3.00097" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div aria-hidden="true" class="absolute top-11 left-1/2 transform whitespace-nowrap -translate-x-1/2 -translate-y-1/2 peer-hover:opacity-100 opacity-0 text-tooltip-foreground rounded-lg px-1.5 py-0.5 text-xs bg-primary-dark">Copy</div></div></div><div class="w-0 min-w-full max-w-full py-3.5 px-4 h-full dark:bg-codeblock relative text-sm leading-6 children:!my-0 children:!shadow-none children:!bg-transparent transition-[height] duration-300 ease-in-out code-block-background [&amp;_*]:ring-0 [&amp;_*]:outline-0 [&amp;_*]:focus:ring-0 [&amp;_*]:focus:outline-0 rounded-2xl bg-white overflow-x-auto scrollbar-thin scrollbar-thumb-rounded scrollbar-thumb-black/15 hover:scrollbar-thumb-black/20 active:scrollbar-thumb-black/20 dark:scrollbar-thumb-white/20 dark:hover:scrollbar-thumb-white/25 dark:active:scrollbar-thumb-white/25" data-component-part="code-block-root" tabindex="0" style="font-variant-ligatures: none; height: auto; background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E;"><div class="font-mono whitespace-pre leading-6"><pre class="shiki shiki-themes github-light-default dark-plus" language="python" style="background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E; color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"><code language="python" numberoflines="3"><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">result </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> agent.invoke(</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">    &#123;</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"messages"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: [&#123;</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"role"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"user"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">, </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"content"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"What's the weather in San Francisco?"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">&#125;]&#125;</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">)</span></span></code></pre></div></div><div data-fade-overlay="true" aria-hidden="true" style="--fade-color-light: #ffffff; --fade-color-dark: #0B0C0E;"></div></div><span data-as="p">For streaming steps and / or tokens from the agent, refer to the <a class="link" href="https://docs.langchain.com/oss/python/langchain/streaming">streaming</a> guide.</span><span data-as="p">Otherwise, the agent follows the LangGraph <a class="link" href="https://docs.langchain.com/oss/python/langgraph/use-graph-api">Graph API</a> and supports all associated methods, such as <code>stream</code> and <code>invoke</code>.</span><h2 class="flex whitespace-pre-wrap group font-semibold" id="advanced-concepts"><div class="absolute" tabindex="-1"><a href="https://docs.langchain.com/oss/python/langchain/agents#advanced-concepts" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100 focus:opacity-100 focus:outline-0 group/link" aria-label="Navigate to header">â€‹<div class="w-6 h-6 rounded-md flex items-center justify-center shadow-sm text-gray-400 dark:text-white/50 dark:bg-background-dark dark:brightness-[1.35] dark:ring-1 dark:hover:brightness-150 bg-white ring-1 ring-gray-400/30 dark:ring-gray-700/25 hover:ring-gray-400/60 dark:hover:ring-white/20 group-focus/link:border-2 group-focus/link:border-primary dark:group-focus/link:border-primary-light"><svg xmlns="http://www.w3.org/2000/svg" fill="gray" height="12px" viewBox="0 0 576 512"><path d="M0 256C0 167.6 71.6 96 160 96h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C98.1 144 48 194.1 48 256s50.1 112 112 112h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C71.6 416 0 344.4 0 256zm576 0c0 88.4-71.6 160-160 160H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c61.9 0 112-50.1 112-112s-50.1-112-112-112H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c88.4 0 160 71.6 160 160zM184 232H392c13.3 0 24 10.7 24 24s-10.7 24-24 24H184c-13.3 0-24-10.7-24-24s10.7-24 24-24z"></path></svg></div></a></div><span class="cursor-pointer">Advanced concepts</span></h2><h3 class="flex whitespace-pre-wrap group font-semibold" id="structured-output"><div class="absolute" tabindex="-1"><a href="https://docs.langchain.com/oss/python/langchain/agents#structured-output" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100 focus:opacity-100 focus:outline-0 group/link" aria-label="Navigate to header">â€‹<div class="w-6 h-6 rounded-md flex items-center justify-center shadow-sm text-gray-400 dark:text-white/50 dark:bg-background-dark dark:brightness-[1.35] dark:ring-1 dark:hover:brightness-150 bg-white ring-1 ring-gray-400/30 dark:ring-gray-700/25 hover:ring-gray-400/60 dark:hover:ring-white/20 group-focus/link:border-2 group-focus/link:border-primary dark:group-focus/link:border-primary-light"><svg xmlns="http://www.w3.org/2000/svg" fill="gray" height="12px" viewBox="0 0 576 512"><path d="M0 256C0 167.6 71.6 96 160 96h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C98.1 144 48 194.1 48 256s50.1 112 112 112h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C71.6 416 0 344.4 0 256zm576 0c0 88.4-71.6 160-160 160H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c61.9 0 112-50.1 112-112s-50.1-112-112-112H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c88.4 0 160 71.6 160 160zM184 232H392c13.3 0 24 10.7 24 24s-10.7 24-24 24H184c-13.3 0-24-10.7-24-24s10.7-24 24-24z"></path></svg></div></a></div><span class="cursor-pointer">Structured output</span></h3><span data-as="p">In some situations, you may want the agent to return an output in a specific format. LangChain provides strategies for structured output via the <a href="https://reference.langchain.com/python/langchain/agents/#langchain.agents.create_agent(response_format)" target="_blank" rel="noreferrer" class="link"><code>response_format</code></a> parameter.</span><h4 class="flex whitespace-pre-wrap group font-semibold" id="toolstrategy"><div class="absolute" tabindex="-1"><a href="https://docs.langchain.com/oss/python/langchain/agents#toolstrategy" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100 focus:opacity-100 focus:outline-0 group/link" aria-label="Navigate to header">â€‹<div class="w-6 h-6 rounded-md flex items-center justify-center shadow-sm text-gray-400 dark:text-white/50 dark:bg-background-dark dark:brightness-[1.35] dark:ring-1 dark:hover:brightness-150 bg-white ring-1 ring-gray-400/30 dark:ring-gray-700/25 hover:ring-gray-400/60 dark:hover:ring-white/20 group-focus/link:border-2 group-focus/link:border-primary dark:group-focus/link:border-primary-light"><svg xmlns="http://www.w3.org/2000/svg" fill="gray" height="12px" viewBox="0 0 576 512"><path d="M0 256C0 167.6 71.6 96 160 96h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C98.1 144 48 194.1 48 256s50.1 112 112 112h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C71.6 416 0 344.4 0 256zm576 0c0 88.4-71.6 160-160 160H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c61.9 0 112-50.1 112-112s-50.1-112-112-112H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c88.4 0 160 71.6 160 160zM184 232H392c13.3 0 24 10.7 24 24s-10.7 24-24 24H184c-13.3 0-24-10.7-24-24s10.7-24 24-24z"></path></svg></div></a></div><span class="cursor-pointer">ToolStrategy</span></h4><span data-as="p"><code>ToolStrategy</code> uses artificial tool calling to generate structured output. This works with any model that supports tool calling. <code>ToolStrategy</code> should be used when provider-native structured output (via <a href="https://docs.langchain.com/oss/python/langchain/agents#ProviderStrategy" class="link"><code>ProviderStrategy</code></a>) is not available or reliable.</span><div class="code-block mt-5 mb-8 not-prose rounded-2xl relative group text-gray-950 dark:text-gray-50 codeblock-light border border-gray-950/10 dark:border-white/10 dark:twoslash-dark bg-transparent dark:bg-transparent" wrap="true" numberoflines="22" language="python"><div data-floating-buttons="true" class="absolute top-3 right-4 flex items-center gap-1.5"><div class="z-10 relative select-none"><button class="h-[26px] w-[26px] flex items-center justify-center rounded-md backdrop-blur peer group/copy-button " data-testid="copy-code-button" aria-label="Copy the contents from the code block"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-400 group-hover/copy-button:text-gray-500 dark:text-white/40 dark:group-hover/copy-button:text-white/60"><path d="M14.25 5.25H7.25C6.14543 5.25 5.25 6.14543 5.25 7.25V14.25C5.25 15.3546 6.14543 16.25 7.25 16.25H14.25C15.3546 16.25 16.25 15.3546 16.25 14.25V7.25C16.25 6.14543 15.3546 5.25 14.25 5.25Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.80103 11.998L1.77203 5.07397C1.61003 3.98097 2.36403 2.96397 3.45603 2.80197L10.38 1.77297C11.313 1.63397 12.19 2.16297 12.528 3.00097" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div aria-hidden="true" class="absolute top-11 left-1/2 transform whitespace-nowrap -translate-x-1/2 -translate-y-1/2 peer-hover:opacity-100 opacity-0 text-tooltip-foreground rounded-lg px-1.5 py-0.5 text-xs bg-primary-dark">Copy</div></div></div><div class="w-0 min-w-full max-w-full py-3.5 px-4 h-full dark:bg-codeblock relative text-sm leading-6 children:!my-0 children:!shadow-none children:!bg-transparent transition-[height] duration-300 ease-in-out code-block-background [&amp;_*]:ring-0 [&amp;_*]:outline-0 [&amp;_*]:focus:ring-0 [&amp;_*]:focus:outline-0 rounded-2xl bg-white code-block-wrap overflow-x-hidden whitespace-pre-wrap scrollbar-thin scrollbar-thumb-rounded scrollbar-thumb-black/15 hover:scrollbar-thumb-black/20 active:scrollbar-thumb-black/20 dark:scrollbar-thumb-white/20 dark:hover:scrollbar-thumb-white/25 dark:active:scrollbar-thumb-white/25" data-component-part="code-block-root" tabindex="0" style="font-variant-ligatures: none; height: auto; background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E;"><div class="font-mono whitespace-pre-wrap leading-6"><pre class="shiki shiki-themes github-light-default dark-plus" language="python" style="background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E; color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"><code language="python" numberoflines="22"><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">from</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> pydantic </span><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">import</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> BaseModel</span></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">from</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> langchain.agents </span><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">import</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> create_agent</span></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">from</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> langchain.agents.structured_output </span><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">import</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> ToolStrategy</span></span><span class="line"></span><span class="line"></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;">class</span><span style="color: rgb(149, 56, 0); --shiki-dark: #4EC9B0;"> ContactInfo</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">(</span><span style="color: rgb(5, 80, 174); --shiki-dark: #4EC9B0;">BaseModel</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">):</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">    name: </span><span style="color: rgb(5, 80, 174); --shiki-dark: #4EC9B0;">str</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">    email: </span><span style="color: rgb(5, 80, 174); --shiki-dark: #4EC9B0;">str</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">    phone: </span><span style="color: rgb(5, 80, 174); --shiki-dark: #4EC9B0;">str</span></span><span class="line"></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">agent </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> create_agent(</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">    model</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"gpt-4o-mini"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">,</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">    tools</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">[search_tool],</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">    response_format</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">ToolStrategy(ContactInfo)</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">)</span></span><span class="line"></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">result </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> agent.invoke(&#123;</span></span><span class="line"><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">    "messages"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: [&#123;</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"role"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"user"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">, </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"content"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"Extract contact info from: John Doe, john@example.com, (555) 123-4567"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">&#125;]</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">&#125;)</span></span><span class="line"></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">result[</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"structured_response"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">]</span></span><span class="line"><span style="color: rgb(110, 119, 129); --shiki-dark: #6A9955;"># ContactInfo(name='John Doe', email='john@example.com', phone='(555) 123-4567')</span></span></code></pre></div></div></div><h4 class="flex whitespace-pre-wrap group font-semibold" id="providerstrategy"><div class="absolute" tabindex="-1"><a href="https://docs.langchain.com/oss/python/langchain/agents#providerstrategy" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100 focus:opacity-100 focus:outline-0 group/link" aria-label="Navigate to header">â€‹<div class="w-6 h-6 rounded-md flex items-center justify-center shadow-sm text-gray-400 dark:text-white/50 dark:bg-background-dark dark:brightness-[1.35] dark:ring-1 dark:hover:brightness-150 bg-white ring-1 ring-gray-400/30 dark:ring-gray-700/25 hover:ring-gray-400/60 dark:hover:ring-white/20 group-focus/link:border-2 group-focus/link:border-primary dark:group-focus/link:border-primary-light"><svg xmlns="http://www.w3.org/2000/svg" fill="gray" height="12px" viewBox="0 0 576 512"><path d="M0 256C0 167.6 71.6 96 160 96h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C98.1 144 48 194.1 48 256s50.1 112 112 112h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C71.6 416 0 344.4 0 256zm576 0c0 88.4-71.6 160-160 160H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c61.9 0 112-50.1 112-112s-50.1-112-112-112H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c88.4 0 160 71.6 160 160zM184 232H392c13.3 0 24 10.7 24 24s-10.7 24-24 24H184c-13.3 0-24-10.7-24-24s10.7-24 24-24z"></path></svg></div></a></div><span class="cursor-pointer">ProviderStrategy</span></h4><span data-as="p"><code>ProviderStrategy</code> uses the model providerâ€™s native structured output generation. This is more reliable but only works with providers that support native structured output:</span><div class="code-block mt-5 mb-8 not-prose rounded-2xl relative group text-gray-950 dark:text-gray-50 codeblock-light border border-gray-950/10 dark:border-white/10 dark:twoslash-dark bg-transparent dark:bg-transparent" wrap="true" numberoflines="6" language="python"><div data-floating-buttons="true" class="absolute top-3 right-4 flex items-center gap-1.5"><div class="z-10 relative select-none"><button class="h-[26px] w-[26px] flex items-center justify-center rounded-md backdrop-blur peer group/copy-button " data-testid="copy-code-button" aria-label="Copy the contents from the code block"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-400 group-hover/copy-button:text-gray-500 dark:text-white/40 dark:group-hover/copy-button:text-white/60"><path d="M14.25 5.25H7.25C6.14543 5.25 5.25 6.14543 5.25 7.25V14.25C5.25 15.3546 6.14543 16.25 7.25 16.25H14.25C15.3546 16.25 16.25 15.3546 16.25 14.25V7.25C16.25 6.14543 15.3546 5.25 14.25 5.25Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.80103 11.998L1.77203 5.07397C1.61003 3.98097 2.36403 2.96397 3.45603 2.80197L10.38 1.77297C11.313 1.63397 12.19 2.16297 12.528 3.00097" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div aria-hidden="true" class="absolute top-11 left-1/2 transform whitespace-nowrap -translate-x-1/2 -translate-y-1/2 peer-hover:opacity-100 opacity-0 text-tooltip-foreground rounded-lg px-1.5 py-0.5 text-xs bg-primary-dark">Copy</div></div></div><div class="w-0 min-w-full max-w-full py-3.5 px-4 h-full dark:bg-codeblock relative text-sm leading-6 children:!my-0 children:!shadow-none children:!bg-transparent transition-[height] duration-300 ease-in-out code-block-background [&amp;_*]:ring-0 [&amp;_*]:outline-0 [&amp;_*]:focus:ring-0 [&amp;_*]:focus:outline-0 rounded-2xl bg-white code-block-wrap overflow-x-hidden whitespace-pre-wrap scrollbar-thin scrollbar-thumb-rounded scrollbar-thumb-black/15 hover:scrollbar-thumb-black/20 active:scrollbar-thumb-black/20 dark:scrollbar-thumb-white/20 dark:hover:scrollbar-thumb-white/25 dark:active:scrollbar-thumb-white/25" data-component-part="code-block-root" tabindex="0" style="font-variant-ligatures: none; height: auto; background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E;"><div class="font-mono whitespace-pre-wrap leading-6"><pre class="shiki shiki-themes github-light-default dark-plus" language="python" style="background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E; color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"><code language="python" numberoflines="6"><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">from</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> langchain.agents.structured_output </span><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">import</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> ProviderStrategy</span></span><span class="line"></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">agent </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> create_agent(</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">    model</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"gpt-4o"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">,</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">    response_format</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">ProviderStrategy(ContactInfo)</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">)</span></span></code></pre></div></div></div><div class="callout my-4 px-5 py-4 overflow-hidden rounded-2xl flex gap-3 border border-sky-500/20 bg-sky-50/50 dark:border-sky-500/30 dark:bg-sky-500/10" data-callout-type="note"><div class="mt-0.5 w-4" data-component-part="callout-icon"><svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-sky-500" aria-label="Note"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 1.3C10.14 1.3 12.7 3.86 12.7 7C12.7 10.14 10.14 12.7 7 12.7C5.48908 12.6974 4.0408 12.096 2.97241 11.0276C1.90403 9.9592 1.30264 8.51092 1.3 7C1.3 3.86 3.86 1.3 7 1.3ZM7 0C3.14 0 0 3.14 0 7C0 10.86 3.14 14 7 14C10.86 14 14 10.86 14 7C14 3.14 10.86 0 7 0ZM8 3H6V8H8V3ZM8 9H6V11H8V9Z"></path></svg></div><div class="text-sm prose dark:prose-invert min-w-0 w-full [&amp;_kbd]:bg-background-light dark:[&amp;_kbd]:bg-background-dark [&amp;_code]:!text-current [&amp;_kbd]:!text-current [&amp;_a]:!text-current [&amp;_a]:border-current text-sky-900 dark:text-sky-200" data-component-part="callout-content"><span data-as="p">As of <code>langchain 1.0</code>, simply passing a schema (e.g., <code>response_format=ContactInfo</code>) is no longer supported. You must explicitly use <code>ToolStrategy</code> or <code>ProviderStrategy</code>.</span></div></div><div class="callout my-4 px-5 py-4 overflow-hidden rounded-2xl flex gap-3 border border-emerald-500/20 bg-emerald-50/50 dark:border-emerald-500/30 dark:bg-emerald-500/10 [&amp;_[data-component-part=&#39;callout-icon&#39;]]:mt-px" data-callout-type="tip"><div class="mt-0.5 w-4" data-component-part="callout-icon"><svg width="11" height="14" viewBox="0 0 11 14" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="text-emerald-600 dark:text-emerald-400/80 w-3.5 h-auto" aria-label="Tip"><path d="M3.12794 12.4232C3.12794 12.5954 3.1776 12.7634 3.27244 12.907L3.74114 13.6095C3.88471 13.8248 4.21067 14 4.46964 14H6.15606C6.41415 14 6.74017 13.825 6.88373 13.6095L7.3508 12.9073C7.43114 12.7859 7.49705 12.569 7.49705 12.4232L7.50055 11.3513H3.12521L3.12794 12.4232ZM5.31288 0C2.52414 0.00875889 0.5 2.26889 0.5 4.78826C0.5 6.00188 0.949566 7.10829 1.69119 7.95492C2.14321 8.47011 2.84901 9.54727 3.11919 10.4557C3.12005 10.4625 3.12175 10.4698 3.12261 10.4771H7.50342C7.50427 10.4698 7.50598 10.463 7.50684 10.4557C7.77688 9.54727 8.48281 8.47011 8.93484 7.95492C9.67728 7.13181 10.1258 6.02703 10.1258 4.78826C10.1258 2.15486 7.9709 0.000106649 5.31288 0ZM7.94902 7.11267C7.52078 7.60079 6.99082 8.37878 6.6077 9.18794H4.02051C3.63739 8.37878 3.10743 7.60079 2.67947 7.11294C2.11997 6.47551 1.8126 5.63599 1.8126 4.78826C1.8126 3.09829 3.12794 1.31944 5.28827 1.3126C7.2435 1.3126 8.81315 2.88226 8.81315 4.78826C8.81315 5.63599 8.50688 6.47551 7.94902 7.11267ZM4.87534 2.18767C3.66939 2.18767 2.68767 3.16939 2.68767 4.37534C2.68767 4.61719 2.88336 4.81288 3.12521 4.81288C3.36705 4.81288 3.56274 4.61599 3.56274 4.37534C3.56274 3.6515 4.1515 3.06274 4.87534 3.06274C5.11719 3.06274 5.31288 2.86727 5.31288 2.62548C5.31288 2.38369 5.11599 2.18767 4.87534 2.18767Z"></path></svg></div><div class="text-sm prose dark:prose-invert min-w-0 w-full [&amp;_kbd]:bg-background-light dark:[&amp;_kbd]:bg-background-dark [&amp;_code]:!text-current [&amp;_kbd]:!text-current [&amp;_a]:!text-current [&amp;_a]:border-current text-emerald-900 dark:text-emerald-200" data-component-part="callout-content"><span data-as="p">To learn about structured output, see <a class="link" href="https://docs.langchain.com/oss/python/langchain/structured-output">Structured output</a>.</span></div></div><h3 class="flex whitespace-pre-wrap group font-semibold" id="memory"><div class="absolute" tabindex="-1"><a href="https://docs.langchain.com/oss/python/langchain/agents#memory" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100 focus:opacity-100 focus:outline-0 group/link" aria-label="Navigate to header">â€‹<div class="w-6 h-6 rounded-md flex items-center justify-center shadow-sm text-gray-400 dark:text-white/50 dark:bg-background-dark dark:brightness-[1.35] dark:ring-1 dark:hover:brightness-150 bg-white ring-1 ring-gray-400/30 dark:ring-gray-700/25 hover:ring-gray-400/60 dark:hover:ring-white/20 group-focus/link:border-2 group-focus/link:border-primary dark:group-focus/link:border-primary-light"><svg xmlns="http://www.w3.org/2000/svg" fill="gray" height="12px" viewBox="0 0 576 512"><path d="M0 256C0 167.6 71.6 96 160 96h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C98.1 144 48 194.1 48 256s50.1 112 112 112h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C71.6 416 0 344.4 0 256zm576 0c0 88.4-71.6 160-160 160H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c61.9 0 112-50.1 112-112s-50.1-112-112-112H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c88.4 0 160 71.6 160 160zM184 232H392c13.3 0 24 10.7 24 24s-10.7 24-24 24H184c-13.3 0-24-10.7-24-24s10.7-24 24-24z"></path></svg></div></a></div><span class="cursor-pointer">Memory</span></h3><span data-as="p">Agents maintain conversation history automatically through the message state. You can also configure the agent to use a custom state schema to remember additional information during the conversation.</span><span data-as="p">Information stored in the state can be thought of as the <a class="link" href="https://docs.langchain.com/oss/python/langchain/short-term-memory">short-term memory</a> of the agent:</span><span data-as="p">Custom state schemas must extend <a href="https://reference.langchain.com/python/langchain/agents/#langchain.agents.AgentState" target="_blank" rel="noreferrer" class="link"><code>AgentState</code></a> as a <code>TypedDict</code>.</span><span data-as="p">There are two ways to define custom state:</span><ol><li>Via <a class="link" href="https://docs.langchain.com/oss/python/langchain/middleware">middleware</a> (preferred)</li><li>Via <a href="https://reference.langchain.com/python/langchain/middleware/#langchain.agents.middleware.AgentMiddleware.state_schema" target="_blank" rel="noreferrer" class="link"><code>state_schema</code></a> on <a href="https://reference.langchain.com/python/langchain/agents/#langchain.agents.create_agent" target="_blank" rel="noreferrer" class="link"><code>create_agent</code></a></li></ol><h4 class="flex whitespace-pre-wrap group font-semibold" id="defining-state-via-middleware"><div class="absolute" tabindex="-1"><a href="https://docs.langchain.com/oss/python/langchain/agents#defining-state-via-middleware" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100 focus:opacity-100 focus:outline-0 group/link" aria-label="Navigate to header">â€‹<div class="w-6 h-6 rounded-md flex items-center justify-center shadow-sm text-gray-400 dark:text-white/50 dark:bg-background-dark dark:brightness-[1.35] dark:ring-1 dark:hover:brightness-150 bg-white ring-1 ring-gray-400/30 dark:ring-gray-700/25 hover:ring-gray-400/60 dark:hover:ring-white/20 group-focus/link:border-2 group-focus/link:border-primary dark:group-focus/link:border-primary-light"><svg xmlns="http://www.w3.org/2000/svg" fill="gray" height="12px" viewBox="0 0 576 512"><path d="M0 256C0 167.6 71.6 96 160 96h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C98.1 144 48 194.1 48 256s50.1 112 112 112h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C71.6 416 0 344.4 0 256zm576 0c0 88.4-71.6 160-160 160H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c61.9 0 112-50.1 112-112s-50.1-112-112-112H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c88.4 0 160 71.6 160 160zM184 232H392c13.3 0 24 10.7 24 24s-10.7 24-24 24H184c-13.3 0-24-10.7-24-24s10.7-24 24-24z"></path></svg></div></a></div><span class="cursor-pointer">Defining state via middleware</span></h4><span data-as="p">Use middleware to define custom state when your custom state needs to be accessed by specific middleware hooks and tools attached to said middleware.</span><div class="code-block mt-5 mb-8 not-prose rounded-2xl relative group text-gray-950 dark:text-gray-50 codeblock-light border border-gray-950/10 dark:border-white/10 dark:twoslash-dark bg-transparent dark:bg-transparent" numberoflines="26" language="python"><div data-floating-buttons="true" class="absolute top-3 right-4 flex items-center gap-1.5"><div class="z-10 relative select-none"><button class="h-[26px] w-[26px] flex items-center justify-center rounded-md backdrop-blur peer group/copy-button " data-testid="copy-code-button" aria-label="Copy the contents from the code block"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-400 group-hover/copy-button:text-gray-500 dark:text-white/40 dark:group-hover/copy-button:text-white/60"><path d="M14.25 5.25H7.25C6.14543 5.25 5.25 6.14543 5.25 7.25V14.25C5.25 15.3546 6.14543 16.25 7.25 16.25H14.25C15.3546 16.25 16.25 15.3546 16.25 14.25V7.25C16.25 6.14543 15.3546 5.25 14.25 5.25Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.80103 11.998L1.77203 5.07397C1.61003 3.98097 2.36403 2.96397 3.45603 2.80197L10.38 1.77297C11.313 1.63397 12.19 2.16297 12.528 3.00097" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div aria-hidden="true" class="absolute top-11 left-1/2 transform whitespace-nowrap -translate-x-1/2 -translate-y-1/2 peer-hover:opacity-100 opacity-0 text-tooltip-foreground rounded-lg px-1.5 py-0.5 text-xs bg-primary-dark">Copy</div></div></div><div class="w-0 min-w-full max-w-full py-3.5 px-4 h-full dark:bg-codeblock relative text-sm leading-6 children:!my-0 children:!shadow-none children:!bg-transparent transition-[height] duration-300 ease-in-out code-block-background [&amp;_*]:ring-0 [&amp;_*]:outline-0 [&amp;_*]:focus:ring-0 [&amp;_*]:focus:outline-0 rounded-2xl bg-white overflow-x-auto scrollbar-thin scrollbar-thumb-rounded scrollbar-thumb-black/15 hover:scrollbar-thumb-black/20 active:scrollbar-thumb-black/20 dark:scrollbar-thumb-white/20 dark:hover:scrollbar-thumb-white/25 dark:active:scrollbar-thumb-white/25" data-component-part="code-block-root" tabindex="0" style="font-variant-ligatures: none; height: auto; background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E;"><div class="font-mono whitespace-pre leading-6"><pre class="shiki shiki-themes github-light-default dark-plus" language="python" style="background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E; color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"><code language="python" numberoflines="26"><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">from</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> langchain.agents </span><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">import</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> AgentState</span></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">from</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> langchain.agents.middleware </span><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">import</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> AgentMiddleware</span></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">from</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> typing </span><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">import</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> Any</span></span><span class="line"></span><span class="line"></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;">class</span><span style="color: rgb(149, 56, 0); --shiki-dark: #4EC9B0;"> CustomState</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">(</span><span style="color: rgb(5, 80, 174); --shiki-dark: #4EC9B0;">AgentState</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">):</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">    user_preferences: </span><span style="color: rgb(5, 80, 174); --shiki-dark: #4EC9B0;">dict</span></span><span class="line"></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;">class</span><span style="color: rgb(149, 56, 0); --shiki-dark: #4EC9B0;"> CustomMiddleware</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">(</span><span style="color: rgb(5, 80, 174); --shiki-dark: #4EC9B0;">AgentMiddleware</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">):</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">    state_schema </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> CustomState</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">    tools </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> [tool1, tool2]</span></span><span class="line"></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;">    def</span><span style="color: rgb(130, 80, 223); --shiki-dark: #DCDCAA;"> before_model</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">(</span><span style="color: rgb(31, 35, 40); --shiki-dark: #9CDCFE;">self</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">, </span><span style="color: rgb(31, 35, 40); --shiki-dark: #9CDCFE;">state</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: CustomState, </span><span style="color: rgb(31, 35, 40); --shiki-dark: #9CDCFE;">runtime</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">) -&gt; dict[</span><span style="color: rgb(5, 80, 174); --shiki-dark: #4EC9B0;">str</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">, Any] </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">|</span><span style="color: rgb(5, 80, 174); --shiki-dark: #569CD6;"> None</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">:</span></span><span class="line"><span style="color: rgb(5, 80, 174); --shiki-dark: #D4D4D4;">        ...</span></span><span class="line"></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">agent </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> create_agent(</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">    model,</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">    tools</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">tools,</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">    middleware</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">[CustomMiddleware()]</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">)</span></span><span class="line"></span><span class="line"><span style="color: rgb(110, 119, 129); --shiki-dark: #6A9955;"># The agent can now track additional state beyond messages</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">result </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> agent.invoke(&#123;</span></span><span class="line"><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">    "messages"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: [&#123;</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"role"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"user"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">, </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"content"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"I prefer technical explanations"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">&#125;],</span></span><span class="line"><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">    "user_preferences"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: &#123;</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"style"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"technical"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">, </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"verbosity"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"detailed"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">&#125;,</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">&#125;)</span></span></code></pre></div></div><div data-fade-overlay="true" aria-hidden="true" style="--fade-color-light: #ffffff; --fade-color-dark: #0B0C0E;"></div></div><h4 class="flex whitespace-pre-wrap group font-semibold" id="defining-state-via-state_schema"><div class="absolute" tabindex="-1"><a href="https://docs.langchain.com/oss/python/langchain/agents#defining-state-via-state_schema" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100 focus:opacity-100 focus:outline-0 group/link" aria-label="Navigate to header">â€‹<div class="w-6 h-6 rounded-md flex items-center justify-center shadow-sm text-gray-400 dark:text-white/50 dark:bg-background-dark dark:brightness-[1.35] dark:ring-1 dark:hover:brightness-150 bg-white ring-1 ring-gray-400/30 dark:ring-gray-700/25 hover:ring-gray-400/60 dark:hover:ring-white/20 group-focus/link:border-2 group-focus/link:border-primary dark:group-focus/link:border-primary-light"><svg xmlns="http://www.w3.org/2000/svg" fill="gray" height="12px" viewBox="0 0 576 512"><path d="M0 256C0 167.6 71.6 96 160 96h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C98.1 144 48 194.1 48 256s50.1 112 112 112h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C71.6 416 0 344.4 0 256zm576 0c0 88.4-71.6 160-160 160H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c61.9 0 112-50.1 112-112s-50.1-112-112-112H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c88.4 0 160 71.6 160 160zM184 232H392c13.3 0 24 10.7 24 24s-10.7 24-24 24H184c-13.3 0-24-10.7-24-24s10.7-24 24-24z"></path></svg></div></a></div><span class="cursor-pointer">Defining state via <code>state_schema</code></span></h4><span data-as="p">Use the <a href="https://reference.langchain.com/python/langchain/middleware/#langchain.agents.middleware.AgentMiddleware.state_schema" target="_blank" rel="noreferrer" class="link"><code>state_schema</code></a> parameter as a shortcut to define custom state that is only used in tools.</span><div class="code-block mt-5 mb-8 not-prose rounded-2xl relative group text-gray-950 dark:text-gray-50 codeblock-light border border-gray-950/10 dark:border-white/10 dark:twoslash-dark bg-transparent dark:bg-transparent" numberoflines="16" language="python"><div data-floating-buttons="true" class="absolute top-3 right-4 flex items-center gap-1.5"><div class="z-10 relative select-none"><button class="h-[26px] w-[26px] flex items-center justify-center rounded-md backdrop-blur peer group/copy-button " data-testid="copy-code-button" aria-label="Copy the contents from the code block"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-400 group-hover/copy-button:text-gray-500 dark:text-white/40 dark:group-hover/copy-button:text-white/60"><path d="M14.25 5.25H7.25C6.14543 5.25 5.25 6.14543 5.25 7.25V14.25C5.25 15.3546 6.14543 16.25 7.25 16.25H14.25C15.3546 16.25 16.25 15.3546 16.25 14.25V7.25C16.25 6.14543 15.3546 5.25 14.25 5.25Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.80103 11.998L1.77203 5.07397C1.61003 3.98097 2.36403 2.96397 3.45603 2.80197L10.38 1.77297C11.313 1.63397 12.19 2.16297 12.528 3.00097" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div aria-hidden="true" class="absolute top-11 left-1/2 transform whitespace-nowrap -translate-x-1/2 -translate-y-1/2 peer-hover:opacity-100 opacity-0 text-tooltip-foreground rounded-lg px-1.5 py-0.5 text-xs bg-primary-dark">Copy</div></div></div><div class="w-0 min-w-full max-w-full py-3.5 px-4 h-full dark:bg-codeblock relative text-sm leading-6 children:!my-0 children:!shadow-none children:!bg-transparent transition-[height] duration-300 ease-in-out code-block-background [&amp;_*]:ring-0 [&amp;_*]:outline-0 [&amp;_*]:focus:ring-0 [&amp;_*]:focus:outline-0 rounded-2xl bg-white overflow-x-auto scrollbar-thin scrollbar-thumb-rounded scrollbar-thumb-black/15 hover:scrollbar-thumb-black/20 active:scrollbar-thumb-black/20 dark:scrollbar-thumb-white/20 dark:hover:scrollbar-thumb-white/25 dark:active:scrollbar-thumb-white/25" data-component-part="code-block-root" tabindex="0" style="font-variant-ligatures: none; height: auto; background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E;"><div class="font-mono whitespace-pre leading-6"><pre class="shiki shiki-themes github-light-default dark-plus" language="python" style="background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E; color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"><code language="python" numberoflines="16"><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">from</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> langchain.agents </span><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">import</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> AgentState</span></span><span class="line"></span><span class="line"></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;">class</span><span style="color: rgb(149, 56, 0); --shiki-dark: #4EC9B0;"> CustomState</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">(</span><span style="color: rgb(5, 80, 174); --shiki-dark: #4EC9B0;">AgentState</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">):</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">    user_preferences: </span><span style="color: rgb(5, 80, 174); --shiki-dark: #4EC9B0;">dict</span></span><span class="line"></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">agent </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> create_agent(</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">    model,</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">    tools</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">[tool1, tool2],</span></span><span class="line"><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">    state_schema</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">CustomState</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">)</span></span><span class="line"><span style="color: rgb(110, 119, 129); --shiki-dark: #6A9955;"># The agent can now track additional state beyond messages</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">result </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> agent.invoke(&#123;</span></span><span class="line"><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">    "messages"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: [&#123;</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"role"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"user"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">, </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"content"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"I prefer technical explanations"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">&#125;],</span></span><span class="line"><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">    "user_preferences"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: &#123;</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"style"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"technical"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">, </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"verbosity"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"detailed"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">&#125;,</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">&#125;)</span></span></code></pre></div></div><div data-fade-overlay="true" aria-hidden="true" style="--fade-color-light: #ffffff; --fade-color-dark: #0B0C0E;"></div></div><div class="callout my-4 px-5 py-4 overflow-hidden rounded-2xl flex gap-3 border border-sky-500/20 bg-sky-50/50 dark:border-sky-500/30 dark:bg-sky-500/10" data-callout-type="note"><div class="mt-0.5 w-4" data-component-part="callout-icon"><svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-sky-500" aria-label="Note"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 1.3C10.14 1.3 12.7 3.86 12.7 7C12.7 10.14 10.14 12.7 7 12.7C5.48908 12.6974 4.0408 12.096 2.97241 11.0276C1.90403 9.9592 1.30264 8.51092 1.3 7C1.3 3.86 3.86 1.3 7 1.3ZM7 0C3.14 0 0 3.14 0 7C0 10.86 3.14 14 7 14C10.86 14 14 10.86 14 7C14 3.14 10.86 0 7 0ZM8 3H6V8H8V3ZM8 9H6V11H8V9Z"></path></svg></div><div class="text-sm prose dark:prose-invert min-w-0 w-full [&amp;_kbd]:bg-background-light dark:[&amp;_kbd]:bg-background-dark [&amp;_code]:!text-current [&amp;_kbd]:!text-current [&amp;_a]:!text-current [&amp;_a]:border-current text-sky-900 dark:text-sky-200" data-component-part="callout-content"><span data-as="p">As of <code>langchain 1.0</code>, custom state schemas <strong>must</strong> be <code>TypedDict</code> types. Pydantic models and dataclasses are no longer supported. See the <a class="link" href="https://docs.langchain.com/oss/python/migrate/langchain-v1#state-type-restrictions">v1 migration guide</a> for more details.</span></div></div><div class="callout my-4 px-5 py-4 overflow-hidden rounded-2xl flex gap-3 border border-sky-500/20 bg-sky-50/50 dark:border-sky-500/30 dark:bg-sky-500/10" data-callout-type="note"><div class="mt-0.5 w-4" data-component-part="callout-icon"><svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-sky-500" aria-label="Note"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 1.3C10.14 1.3 12.7 3.86 12.7 7C12.7 10.14 10.14 12.7 7 12.7C5.48908 12.6974 4.0408 12.096 2.97241 11.0276C1.90403 9.9592 1.30264 8.51092 1.3 7C1.3 3.86 3.86 1.3 7 1.3ZM7 0C3.14 0 0 3.14 0 7C0 10.86 3.14 14 7 14C10.86 14 14 10.86 14 7C14 3.14 10.86 0 7 0ZM8 3H6V8H8V3ZM8 9H6V11H8V9Z"></path></svg></div><div class="text-sm prose dark:prose-invert min-w-0 w-full [&amp;_kbd]:bg-background-light dark:[&amp;_kbd]:bg-background-dark [&amp;_code]:!text-current [&amp;_kbd]:!text-current [&amp;_a]:!text-current [&amp;_a]:border-current text-sky-900 dark:text-sky-200" data-component-part="callout-content"><span data-as="p">Defining custom state via middleware is preferred over defining it via <a href="https://reference.langchain.com/python/langchain/middleware/#langchain.agents.middleware.AgentMiddleware.state_schema" target="_blank" rel="noreferrer" class="link"><code>state_schema</code></a> on <a href="https://reference.langchain.com/python/langchain/agents/#langchain.agents.create_agent" target="_blank" rel="noreferrer" class="link"><code>create_agent</code></a> because it allows you to keep state extensions conceptually scoped to the relevant middleware and tools.</span><span data-as="p"><a href="https://reference.langchain.com/python/langchain/middleware/#langchain.agents.middleware.AgentMiddleware.state_schema" target="_blank" rel="noreferrer" class="link"><code>state_schema</code></a> is still supported for backwards compatibility on <a href="https://reference.langchain.com/python/langchain/agents/#langchain.agents.create_agent" target="_blank" rel="noreferrer" class="link"><code>create_agent</code></a>.</span></div></div><div class="callout my-4 px-5 py-4 overflow-hidden rounded-2xl flex gap-3 border border-emerald-500/20 bg-emerald-50/50 dark:border-emerald-500/30 dark:bg-emerald-500/10 [&amp;_[data-component-part=&#39;callout-icon&#39;]]:mt-px" data-callout-type="tip"><div class="mt-0.5 w-4" data-component-part="callout-icon"><svg width="11" height="14" viewBox="0 0 11 14" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="text-emerald-600 dark:text-emerald-400/80 w-3.5 h-auto" aria-label="Tip"><path d="M3.12794 12.4232C3.12794 12.5954 3.1776 12.7634 3.27244 12.907L3.74114 13.6095C3.88471 13.8248 4.21067 14 4.46964 14H6.15606C6.41415 14 6.74017 13.825 6.88373 13.6095L7.3508 12.9073C7.43114 12.7859 7.49705 12.569 7.49705 12.4232L7.50055 11.3513H3.12521L3.12794 12.4232ZM5.31288 0C2.52414 0.00875889 0.5 2.26889 0.5 4.78826C0.5 6.00188 0.949566 7.10829 1.69119 7.95492C2.14321 8.47011 2.84901 9.54727 3.11919 10.4557C3.12005 10.4625 3.12175 10.4698 3.12261 10.4771H7.50342C7.50427 10.4698 7.50598 10.463 7.50684 10.4557C7.77688 9.54727 8.48281 8.47011 8.93484 7.95492C9.67728 7.13181 10.1258 6.02703 10.1258 4.78826C10.1258 2.15486 7.9709 0.000106649 5.31288 0ZM7.94902 7.11267C7.52078 7.60079 6.99082 8.37878 6.6077 9.18794H4.02051C3.63739 8.37878 3.10743 7.60079 2.67947 7.11294C2.11997 6.47551 1.8126 5.63599 1.8126 4.78826C1.8126 3.09829 3.12794 1.31944 5.28827 1.3126C7.2435 1.3126 8.81315 2.88226 8.81315 4.78826C8.81315 5.63599 8.50688 6.47551 7.94902 7.11267ZM4.87534 2.18767C3.66939 2.18767 2.68767 3.16939 2.68767 4.37534C2.68767 4.61719 2.88336 4.81288 3.12521 4.81288C3.36705 4.81288 3.56274 4.61599 3.56274 4.37534C3.56274 3.6515 4.1515 3.06274 4.87534 3.06274C5.11719 3.06274 5.31288 2.86727 5.31288 2.62548C5.31288 2.38369 5.11599 2.18767 4.87534 2.18767Z"></path></svg></div><div class="text-sm prose dark:prose-invert min-w-0 w-full [&amp;_kbd]:bg-background-light dark:[&amp;_kbd]:bg-background-dark [&amp;_code]:!text-current [&amp;_kbd]:!text-current [&amp;_a]:!text-current [&amp;_a]:border-current text-emerald-900 dark:text-emerald-200" data-component-part="callout-content"><span data-as="p">To learn more about memory, see <a class="link" href="https://docs.langchain.com/oss/python/concepts/memory">Memory</a>. For information on implementing long-term memory that persists across sessions, see <a class="link" href="https://docs.langchain.com/oss/python/langchain/long-term-memory">Long-term memory</a>.</span></div></div><h3 class="flex whitespace-pre-wrap group font-semibold" id="streaming"><div class="absolute" tabindex="-1"><a href="https://docs.langchain.com/oss/python/langchain/agents#streaming" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100 focus:opacity-100 focus:outline-0 group/link" aria-label="Navigate to header">â€‹<div class="w-6 h-6 rounded-md flex items-center justify-center shadow-sm text-gray-400 dark:text-white/50 dark:bg-background-dark dark:brightness-[1.35] dark:ring-1 dark:hover:brightness-150 bg-white ring-1 ring-gray-400/30 dark:ring-gray-700/25 hover:ring-gray-400/60 dark:hover:ring-white/20 group-focus/link:border-2 group-focus/link:border-primary dark:group-focus/link:border-primary-light"><svg xmlns="http://www.w3.org/2000/svg" fill="gray" height="12px" viewBox="0 0 576 512"><path d="M0 256C0 167.6 71.6 96 160 96h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C98.1 144 48 194.1 48 256s50.1 112 112 112h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C71.6 416 0 344.4 0 256zm576 0c0 88.4-71.6 160-160 160H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c61.9 0 112-50.1 112-112s-50.1-112-112-112H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c88.4 0 160 71.6 160 160zM184 232H392c13.3 0 24 10.7 24 24s-10.7 24-24 24H184c-13.3 0-24-10.7-24-24s10.7-24 24-24z"></path></svg></div></a></div><span class="cursor-pointer">Streaming</span></h3><span data-as="p">Weâ€™ve seen how the agent can be called with <code>invoke</code> to get a final response. If the agent executes multiple steps, this may take a while. To show intermediate progress, we can stream back messages as they occur.</span><div class="code-block mt-5 mb-8 not-prose rounded-2xl relative group text-gray-950 dark:text-gray-50 codeblock-light border border-gray-950/10 dark:border-white/10 dark:twoslash-dark bg-transparent dark:bg-transparent" numberoflines="9" language="python"><div data-floating-buttons="true" class="absolute top-3 right-4 flex items-center gap-1.5"><div class="z-10 relative select-none"><button class="h-[26px] w-[26px] flex items-center justify-center rounded-md backdrop-blur peer group/copy-button " data-testid="copy-code-button" aria-label="Copy the contents from the code block"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-400 group-hover/copy-button:text-gray-500 dark:text-white/40 dark:group-hover/copy-button:text-white/60"><path d="M14.25 5.25H7.25C6.14543 5.25 5.25 6.14543 5.25 7.25V14.25C5.25 15.3546 6.14543 16.25 7.25 16.25H14.25C15.3546 16.25 16.25 15.3546 16.25 14.25V7.25C16.25 6.14543 15.3546 5.25 14.25 5.25Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.80103 11.998L1.77203 5.07397C1.61003 3.98097 2.36403 2.96397 3.45603 2.80197L10.38 1.77297C11.313 1.63397 12.19 2.16297 12.528 3.00097" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div aria-hidden="true" class="absolute top-11 left-1/2 transform whitespace-nowrap -translate-x-1/2 -translate-y-1/2 peer-hover:opacity-100 opacity-0 text-tooltip-foreground rounded-lg px-1.5 py-0.5 text-xs bg-primary-dark">Copy</div></div></div><div class="w-0 min-w-full max-w-full py-3.5 px-4 h-full dark:bg-codeblock relative text-sm leading-6 children:!my-0 children:!shadow-none children:!bg-transparent transition-[height] duration-300 ease-in-out code-block-background [&amp;_*]:ring-0 [&amp;_*]:outline-0 [&amp;_*]:focus:ring-0 [&amp;_*]:focus:outline-0 rounded-2xl bg-white overflow-x-auto scrollbar-thin scrollbar-thumb-rounded scrollbar-thumb-black/15 hover:scrollbar-thumb-black/20 active:scrollbar-thumb-black/20 dark:scrollbar-thumb-white/20 dark:hover:scrollbar-thumb-white/25 dark:active:scrollbar-thumb-white/25" data-component-part="code-block-root" tabindex="0" style="font-variant-ligatures: none; height: auto; background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E;"><div class="font-mono whitespace-pre leading-6"><pre class="shiki shiki-themes github-light-default dark-plus" language="python" style="background-color: rgb(255, 255, 255); --shiki-dark-bg: #0B0C0E; color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"><code language="python" numberoflines="9"><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">for</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> chunk </span><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">in</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> agent.stream(&#123;</span></span><span class="line"><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">    "messages"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: [&#123;</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"role"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"user"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">, </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"content"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">: </span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"Search for AI news and summarize the findings"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">&#125;]</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">&#125;, </span><span style="color: rgb(149, 56, 0); --shiki-dark: #9CDCFE;">stream_mode</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"values"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">):</span></span><span class="line"><span style="color: rgb(110, 119, 129); --shiki-dark: #6A9955;">    # Each chunk contains the full state at that point</span></span><span class="line"><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">    latest_message </span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">=</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> chunk[</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"messages"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">][</span><span style="color: rgb(207, 34, 46); --shiki-dark: #D4D4D4;">-</span><span style="color: rgb(5, 80, 174); --shiki-dark: #B5CEA8;">1</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">]</span></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">    if</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> latest_message.content:</span></span><span class="line"><span style="color: rgb(5, 80, 174); --shiki-dark: #DCDCAA;">        print</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">(</span><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;">f</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"Agent: </span><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;">&#123;</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">latest_message.content</span><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;">&#125;</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">)</span></span><span class="line"><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">    elif</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> latest_message.tool_calls:</span></span><span class="line"><span style="color: rgb(5, 80, 174); --shiki-dark: #DCDCAA;">        print</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">(</span><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;">f</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"Calling tools: </span><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;">&#123;</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">[tc[</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">'name'</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">] </span><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">for</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> tc </span><span style="color: rgb(207, 34, 46); --shiki-dark: #C586C0;">in</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;"> latest_message.tool_calls]</span><span style="color: rgb(207, 34, 46); --shiki-dark: #569CD6;">&#125;</span><span style="color: rgb(10, 48, 105); --shiki-dark: #CE9178;">"</span><span style="color: rgb(31, 35, 40); --shiki-dark: #D4D4D4;">)</span></span></code></pre></div></div><div data-fade-overlay="true" aria-hidden="true" style="--fade-color-light: #ffffff; --fade-color-dark: #0B0C0E;"></div></div><div class="callout my-4 px-5 py-4 overflow-hidden rounded-2xl flex gap-3 border border-emerald-500/20 bg-emerald-50/50 dark:border-emerald-500/30 dark:bg-emerald-500/10 [&amp;_[data-component-part=&#39;callout-icon&#39;]]:mt-px" data-callout-type="tip"><div class="mt-0.5 w-4" data-component-part="callout-icon"><svg width="11" height="14" viewBox="0 0 11 14" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="text-emerald-600 dark:text-emerald-400/80 w-3.5 h-auto" aria-label="Tip"><path d="M3.12794 12.4232C3.12794 12.5954 3.1776 12.7634 3.27244 12.907L3.74114 13.6095C3.88471 13.8248 4.21067 14 4.46964 14H6.15606C6.41415 14 6.74017 13.825 6.88373 13.6095L7.3508 12.9073C7.43114 12.7859 7.49705 12.569 7.49705 12.4232L7.50055 11.3513H3.12521L3.12794 12.4232ZM5.31288 0C2.52414 0.00875889 0.5 2.26889 0.5 4.78826C0.5 6.00188 0.949566 7.10829 1.69119 7.95492C2.14321 8.47011 2.84901 9.54727 3.11919 10.4557C3.12005 10.4625 3.12175 10.4698 3.12261 10.4771H7.50342C7.50427 10.4698 7.50598 10.463 7.50684 10.4557C7.77688 9.54727 8.48281 8.47011 8.93484 7.95492C9.67728 7.13181 10.1258 6.02703 10.1258 4.78826C10.1258 2.15486 7.9709 0.000106649 5.31288 0ZM7.94902 7.11267C7.52078 7.60079 6.99082 8.37878 6.6077 9.18794H4.02051C3.63739 8.37878 3.10743 7.60079 2.67947 7.11294C2.11997 6.47551 1.8126 5.63599 1.8126 4.78826C1.8126 3.09829 3.12794 1.31944 5.28827 1.3126C7.2435 1.3126 8.81315 2.88226 8.81315 4.78826C8.81315 5.63599 8.50688 6.47551 7.94902 7.11267ZM4.87534 2.18767C3.66939 2.18767 2.68767 3.16939 2.68767 4.37534C2.68767 4.61719 2.88336 4.81288 3.12521 4.81288C3.36705 4.81288 3.56274 4.61599 3.56274 4.37534C3.56274 3.6515 4.1515 3.06274 4.87534 3.06274C5.11719 3.06274 5.31288 2.86727 5.31288 2.62548C5.31288 2.38369 5.11599 2.18767 4.87534 2.18767Z"></path></svg></div><div class="text-sm prose dark:prose-invert min-w-0 w-full [&amp;_kbd]:bg-background-light dark:[&amp;_kbd]:bg-background-dark [&amp;_code]:!text-current [&amp;_kbd]:!text-current [&amp;_a]:!text-current [&amp;_a]:border-current text-emerald-900 dark:text-emerald-200" data-component-part="callout-content"><span data-as="p">For more details on streaming, see <a class="link" href="https://docs.langchain.com/oss/python/langchain/streaming">Streaming</a>.</span></div></div><h3 class="flex whitespace-pre-wrap group font-semibold" id="middleware"><div class="absolute" tabindex="-1"><a href="https://docs.langchain.com/oss/python/langchain/agents#middleware" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100 focus:opacity-100 focus:outline-0 group/link" aria-label="Navigate to header">â€‹<div class="w-6 h-6 rounded-md flex items-center justify-center shadow-sm text-gray-400 dark:text-white/50 dark:bg-background-dark dark:brightness-[1.35] dark:ring-1 dark:hover:brightness-150 bg-white ring-1 ring-gray-400/30 dark:ring-gray-700/25 hover:ring-gray-400/60 dark:hover:ring-white/20 group-focus/link:border-2 group-focus/link:border-primary dark:group-focus/link:border-primary-light"><svg xmlns="http://www.w3.org/2000/svg" fill="gray" height="12px" viewBox="0 0 576 512"><path d="M0 256C0 167.6 71.6 96 160 96h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C98.1 144 48 194.1 48 256s50.1 112 112 112h72c13.3 0 24 10.7 24 24s-10.7 24-24 24H160C71.6 416 0 344.4 0 256zm576 0c0 88.4-71.6 160-160 160H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c61.9 0 112-50.1 112-112s-50.1-112-112-112H344c-13.3 0-24-10.7-24-24s10.7-24 24-24h72c88.4 0 160 71.6 160 160zM184 232H392c13.3 0 24 10.7 24 24s-10.7 24-24 24H184c-13.3 0-24-10.7-24-24s10.7-24 24-24z"></path></svg></div></a></div><span class="cursor-pointer">Middleware</span></h3><span data-as="p"><a class="link" href="https://docs.langchain.com/oss/python/langchain/middleware">Middleware</a> provides powerful extensibility for customizing agent behavior at different stages of execution. You can use middleware to:</span><ul><li>Process state before the model is called (e.g., message trimming, context injection)</li><li>Modify or validate the modelâ€™s response (e.g., guardrails, content filtering)</li><li>Handle tool execution errors with custom logic</li><li>Implement dynamic model selection based on state or context</li><li>Add custom logging, monitoring, or analytics</li></ul><span data-as="p">Middleware integrates seamlessly into the agentâ€™s execution, allowing you to intercept and modify data flow at key points without changing the core agent logic.</span><div class="callout my-4 px-5 py-4 overflow-hidden rounded-2xl flex gap-3 border border-emerald-500/20 bg-emerald-50/50 dark:border-emerald-500/30 dark:bg-emerald-500/10 [&amp;_[data-component-part=&#39;callout-icon&#39;]]:mt-px" data-callout-type="tip"><div class="mt-0.5 w-4" data-component-part="callout-icon"><svg width="11" height="14" viewBox="0 0 11 14" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="text-emerald-600 dark:text-emerald-400/80 w-3.5 h-auto" aria-label="Tip"><path d="M3.12794 12.4232C3.12794 12.5954 3.1776 12.7634 3.27244 12.907L3.74114 13.6095C3.88471 13.8248 4.21067 14 4.46964 14H6.15606C6.41415 14 6.74017 13.825 6.88373 13.6095L7.3508 12.9073C7.43114 12.7859 7.49705 12.569 7.49705 12.4232L7.50055 11.3513H3.12521L3.12794 12.4232ZM5.31288 0C2.52414 0.00875889 0.5 2.26889 0.5 4.78826C0.5 6.00188 0.949566 7.10829 1.69119 7.95492C2.14321 8.47011 2.84901 9.54727 3.11919 10.4557C3.12005 10.4625 3.12175 10.4698 3.12261 10.4771H7.50342C7.50427 10.4698 7.50598 10.463 7.50684 10.4557C7.77688 9.54727 8.48281 8.47011 8.93484 7.95492C9.67728 7.13181 10.1258 6.02703 10.1258 4.78826C10.1258 2.15486 7.9709 0.000106649 5.31288 0ZM7.94902 7.11267C7.52078 7.60079 6.99082 8.37878 6.6077 9.18794H4.02051C3.63739 8.37878 3.10743 7.60079 2.67947 7.11294C2.11997 6.47551 1.8126 5.63599 1.8126 4.78826C1.8126 3.09829 3.12794 1.31944 5.28827 1.3126C7.2435 1.3126 8.81315 2.88226 8.81315 4.78826C8.81315 5.63599 8.50688 6.47551 7.94902 7.11267ZM4.87534 2.18767C3.66939 2.18767 2.68767 3.16939 2.68767 4.37534C2.68767 4.61719 2.88336 4.81288 3.12521 4.81288C3.36705 4.81288 3.56274 4.61599 3.56274 4.37534C3.56274 3.6515 4.1515 3.06274 4.87534 3.06274C5.11719 3.06274 5.31288 2.86727 5.31288 2.62548C5.31288 2.38369 5.11599 2.18767 4.87534 2.18767Z"></path></svg></div><div class="text-sm prose dark:prose-invert min-w-0 w-full [&amp;_kbd]:bg-background-light dark:[&amp;_kbd]:bg-background-dark [&amp;_code]:!text-current [&amp;_kbd]:!text-current [&amp;_a]:!text-current [&amp;_a]:border-current text-emerald-900 dark:text-emerald-200" data-component-part="callout-content"><span data-as="p">For comprehensive middleware documentation including decorators like <a href="https://reference.langchain.com/python/langchain/middleware/#langchain.agents.middleware.before_model" target="_blank" rel="noreferrer" class="link"><code>@before_model</code></a>, <a href="https://reference.langchain.com/python/langchain/middleware/#langchain.agents.middleware.after_model" target="_blank" rel="noreferrer" class="link"><code>@after_model</code></a>, and <a href="https://reference.langchain.com/python/langchain/middleware/#langchain.agents.middleware.wrap_tool_call" target="_blank" rel="noreferrer" class="link"><code>@wrap_tool_call</code></a>, see <a class="link" href="https://docs.langchain.com/oss/python/langchain/middleware">Middleware</a>.</span></div></div><hr><div class="callout my-4 px-5 py-4 overflow-hidden rounded-2xl flex gap-3 border border-zinc-500/20 bg-zinc-50/50 dark:border-zinc-500/30 dark:bg-zinc-500/10" data-callout-type="callout"><div class="mt-0.5 w-4" data-component-part="callout-icon"><svg class="h-4 w-4 !m-0 shrink-0 bg-gray-800 dark:bg-gray-100" style="mask-image: url(&quot;https://d3gk2c5xim1je2.cloudfront.net/v7.1.0/regular/pen-to-square.svg&quot;); mask-repeat: no-repeat; mask-position: center center;"></svg></div><div class="text-sm prose dark:prose-invert min-w-0 w-full [&amp;_kbd]:bg-background-light dark:[&amp;_kbd]:bg-background-dark [&amp;_code]:!text-current [&amp;_kbd]:!text-current [&amp;_a]:!text-current [&amp;_a]:border-current text-zinc-900 dark:text-zinc-200" data-component-part="callout-content"><span data-as="p"><a href="https://github.com/langchain-ai/docs/edit/main/src/oss/langchain/agents.mdx" target="_blank" rel="noreferrer" class="link">Edit this page on GitHub</a> or <a href="https://github.com/langchain-ai/docs/issues/new/choose" target="_blank" rel="noreferrer" class="link">file an issue</a>.</span></div></div><div class="callout my-4 px-5 py-4 overflow-hidden rounded-2xl flex gap-3 border border-emerald-500/20 bg-emerald-50/50 dark:border-emerald-500/30 dark:bg-emerald-500/10 [&amp;_[data-component-part=&#39;callout-icon&#39;]]:mt-px" data-callout-type="tip"><div class="mt-0.5 w-4" data-component-part="callout-icon"><svg width="11" height="14" viewBox="0 0 11 14" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="text-emerald-600 dark:text-emerald-400/80 w-3.5 h-auto" aria-label="Tip"><path d="M3.12794 12.4232C3.12794 12.5954 3.1776 12.7634 3.27244 12.907L3.74114 13.6095C3.88471 13.8248 4.21067 14 4.46964 14H6.15606C6.41415 14 6.74017 13.825 6.88373 13.6095L7.3508 12.9073C7.43114 12.7859 7.49705 12.569 7.49705 12.4232L7.50055 11.3513H3.12521L3.12794 12.4232ZM5.31288 0C2.52414 0.00875889 0.5 2.26889 0.5 4.78826C0.5 6.00188 0.949566 7.10829 1.69119 7.95492C2.14321 8.47011 2.84901 9.54727 3.11919 10.4557C3.12005 10.4625 3.12175 10.4698 3.12261 10.4771H7.50342C7.50427 10.4698 7.50598 10.463 7.50684 10.4557C7.77688 9.54727 8.48281 8.47011 8.93484 7.95492C9.67728 7.13181 10.1258 6.02703 10.1258 4.78826C10.1258 2.15486 7.9709 0.000106649 5.31288 0ZM7.94902 7.11267C7.52078 7.60079 6.99082 8.37878 6.6077 9.18794H4.02051C3.63739 8.37878 3.10743 7.60079 2.67947 7.11294C2.11997 6.47551 1.8126 5.63599 1.8126 4.78826C1.8126 3.09829 3.12794 1.31944 5.28827 1.3126C7.2435 1.3126 8.81315 2.88226 8.81315 4.78826C8.81315 5.63599 8.50688 6.47551 7.94902 7.11267ZM4.87534 2.18767C3.66939 2.18767 2.68767 3.16939 2.68767 4.37534C2.68767 4.61719 2.88336 4.81288 3.12521 4.81288C3.36705 4.81288 3.56274 4.61599 3.56274 4.37534C3.56274 3.6515 4.1515 3.06274 4.87534 3.06274C5.11719 3.06274 5.31288 2.86727 5.31288 2.62548C5.31288 2.38369 5.11599 2.18767 4.87534 2.18767Z"></path></svg></div><div class="text-sm prose dark:prose-invert min-w-0 w-full [&amp;_kbd]:bg-background-light dark:[&amp;_kbd]:bg-background-dark [&amp;_code]:!text-current [&amp;_kbd]:!text-current [&amp;_a]:!text-current [&amp;_a]:border-current text-emerald-900 dark:text-emerald-200" data-component-part="callout-content"><span data-as="p"><a class="link" href="https://docs.langchain.com/use-these-docs">Connect these docs</a> to Claude, VSCode, and more via MCP for real-time answers.</span></div></div></div><div class="feedback-toolbar pb-16 w-full flex flex-col gap-y-8"><div class="flex flex-row flex-wrap gap-4 items-center justify-between"><p class="inline-block text-sm text-gray-600 dark:text-gray-400 whitespace-nowrap">Was this page helpful?</p><div class="flex flex-wrap flex-grow gap-3 items-center justify-end"><div class="flex gap-3 items-center"><button id="feedback-thumbs-up" class="px-3.5 py-2 flex flex-row gap-3 items-center border-standard rounded-xl text-gray-600 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 bg-white/50 dark:bg-codeblock/50 hover:border-gray-500 hover:dark:border-gray-500"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="fill-current"><path d="M10.1187 1.08741C8.925 0.746789 7.67813 1.43741 7.3375 2.63116L7.15938 3.25616C7.04375 3.66241 6.83438 4.03741 6.55 4.34991L4.94688 6.11241C4.66875 6.41866 4.69062 6.89366 4.99687 7.17179C5.30312 7.44991 5.77813 7.42804 6.05625 7.12179L7.65938 5.35929C8.1 4.87491 8.42188 4.29679 8.6 3.66866L8.77812 3.04366C8.89062 2.64679 9.30625 2.41554 9.70625 2.52804C10.1063 2.64054 10.3344 3.05616 10.2219 3.45616L10.0437 4.08116C9.86562 4.70304 9.58437 5.29054 9.2125 5.81554C9.05 6.04366 9.03125 6.34366 9.15938 6.59366C9.2875 6.84366 9.54375 6.99991 9.825 6.99991H14C14.275 6.99991 14.5 7.22491 14.5 7.49991C14.5 7.71241 14.3656 7.89679 14.175 7.96866C13.9438 8.05616 13.7688 8.24992 13.7094 8.49054C13.65 8.73117 13.7125 8.98429 13.875 9.16866C13.9531 9.25616 14 9.37179 14 9.49991C14 9.74366 13.825 9.94679 13.5938 9.99054C13.3375 10.0405 13.1219 10.2187 13.0312 10.4624C12.9406 10.7062 12.9813 10.9843 13.1438 11.1905C13.2094 11.2749 13.25 11.3812 13.25 11.4999C13.25 11.7093 13.1187 11.8937 12.9312 11.9655C12.5719 12.1062 12.3781 12.4937 12.4812 12.8655C12.4937 12.9062 12.5 12.953 12.5 12.9999C12.5 13.2749 12.275 13.4999 12 13.4999H8.95312C8.55937 13.4999 8.17188 13.3843 7.84375 13.1655L5.91563 11.8812C5.57188 11.6499 5.10625 11.7437 4.875 12.0905C4.64375 12.4374 4.7375 12.8999 5.08437 13.1312L7.0125 14.4155C7.5875 14.7999 8.2625 15.003 8.95312 15.003H12C13.0844 15.003 13.9656 14.1405 14 13.0655C14.4563 12.6999 14.75 12.1374 14.75 11.503C14.75 11.3624 14.7344 11.228 14.7094 11.0968C15.1906 10.7312 15.5 10.153 15.5 9.50304C15.5 9.29991 15.4688 9.10304 15.4125 8.91866C15.775 8.55304 16 8.05304 16 7.49991C16 6.39679 15.1063 5.49991 14 5.49991H11.1156C11.2625 5.17491 11.3875 4.83741 11.4844 4.49366L11.6625 3.86866C12.0031 2.67491 11.3125 1.42804 10.1187 1.08741ZM1 5.99991C0.446875 5.99991 0 6.44679 0 6.99991V13.9999C0 14.553 0.446875 14.9999 1 14.9999H3C3.55313 14.9999 4 14.553 4 13.9999V6.99991C4 6.44679 3.55313 5.99991 3 5.99991H1Z"></path></svg><small class="text-sm font-normal leading-4">Yes</small></button><button id="feedback-thumbs-down" class="px-3.5 py-2 flex flex-row gap-3 items-center border-standard rounded-xl text-gray-600 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 bg-white/50 dark:bg-codeblock/50 hover:border-gray-500 hover:dark:border-gray-500"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="fill-current"><path d="M10.1187 14.9124C8.925 15.253 7.67813 14.5624 7.3375 13.3687L7.15938 12.7437C7.04375 12.3374 6.83438 11.9624 6.55 11.6499L4.94688 9.8874C4.66875 9.58115 4.69062 9.10615 4.99687 8.82803C5.30312 8.5499 5.77813 8.57178 6.05625 8.87803L7.65938 10.6405C8.1 11.1249 8.42188 11.703 8.6 12.3312L8.77812 12.9562C8.89062 13.353 9.30625 13.5843 9.70625 13.4718C10.1063 13.3593 10.3344 12.9437 10.2219 12.5437L10.0437 11.9187C9.86562 11.2968 9.58437 10.7093 9.2125 10.1843C9.05 9.95615 9.03125 9.65615 9.15938 9.40615C9.2875 9.15615 9.54375 8.9999 9.825 8.9999H14C14.275 8.9999 14.5 8.7749 14.5 8.4999C14.5 8.2874 14.3656 8.10303 14.175 8.03115C13.9438 7.94365 13.7688 7.7499 13.7094 7.50928C13.65 7.26865 13.7125 7.01553 13.875 6.83115C13.9531 6.74365 14 6.62803 14 6.4999C14 6.25615 13.825 6.05303 13.5938 6.00928C13.3375 5.95928 13.1219 5.78115 13.0312 5.53428C12.9406 5.2874 12.9813 5.0124 13.1438 4.80615C13.2094 4.72178 13.25 4.61553 13.25 4.49678C13.25 4.2874 13.1187 4.10303 12.9312 4.03115C12.5719 3.89053 12.3781 3.50303 12.4812 3.13115C12.4937 3.09053 12.5 3.04365 12.5 2.99678C12.5 2.72178 12.275 2.49678 12 2.49678H8.95312C8.55937 2.49678 8.17188 2.6124 7.84375 2.83115L5.91563 4.11553C5.57188 4.34678 5.10625 4.25303 4.875 3.90615C4.64375 3.55928 4.7375 3.09678 5.08437 2.86553L7.0125 1.58115C7.5875 1.19678 8.2625 0.993652 8.95312 0.993652H12C13.0844 0.993652 13.9656 1.85615 14 2.93115C14.4563 3.29678 14.75 3.85928 14.75 4.49365C14.75 4.63428 14.7344 4.76865 14.7094 4.8999C15.1906 5.26553 15.5 5.84365 15.5 6.49365C15.5 6.69678 15.4688 6.89365 15.4125 7.07803C15.775 7.44678 16 7.94678 16 8.4999C16 9.60303 15.1063 10.4999 14 10.4999H11.1156C11.2625 10.8249 11.3875 11.1624 11.4844 11.5062L11.6625 12.1312C12.0031 13.3249 11.3125 14.5718 10.1187 14.9124ZM1 11.9999C0.446875 11.9999 0 11.553 0 10.9999V3.9999C0 3.44678 0.446875 2.9999 1 2.9999H3C3.55313 2.9999 4 3.44678 4 3.9999V10.9999C4 11.553 3.55313 11.9999 3 11.9999H1Z"></path></svg><small class="text-sm font-normal leading-4">No</small></button></div><div class="flex gap-3"></div></div></div></div><div id="pagination" class="grid lg:grid-cols-2 gap-4"><a class="border border-gray-200/70 dark:border-gray-800/70 group flex items-center rounded-xl py-3 px-4 hover:border-gray-300 dark:hover:border-gray-700 justify-start" href="https://docs.langchain.com/oss/python/langchain/philosophy"><div class="space-y-1"><div class="font-medium text-gray-900 dark:text-gray-200">Philosophy</div><div class="flex items-center text-sm text-gray-500 dark:text-gray-500 group-hover:text-gray-600 dark:group-hover:text-gray-400 gap-x-1"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-left size-3.5 text-gray-400 dark:text-gray-600 group-hover:text-gray-500 dark:group-hover:text-gray-500"><path d="m15 18-6-6 6-6"></path></svg><span class="font-medium">Previous</span></div></div></a><a class="border border-gray-200/70 dark:border-gray-800/70 group flex items-center rounded-xl py-3 px-4 hover:border-gray-300 dark:hover:border-gray-700 justify-end" href="https://docs.langchain.com/oss/python/langchain/models"><div class="space-y-1"><div class="font-medium text-gray-900 dark:text-gray-200 text-right">Models</div><div class="flex items-center text-sm text-gray-500 dark:text-gray-500 group-hover:text-gray-600 dark:group-hover:text-gray-400 gap-x-1 flex-row-reverse"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right size-3.5 text-gray-400 dark:text-gray-600 group-hover:text-gray-500 dark:group-hover:text-gray-500"><path d="m9 18 6-6-6-6"></path></svg><span class="font-medium">Next</span></div></div></a></div><div class="left-0 right-0 sticky sm:px-4 pb-4 sm:pb-6 bottom-0 pt-1 flex flex-col items-center w-full overflow-hidden z-20 pointer-events-none"><div class="chat-assistant-floating-input z-10 w-full sm:w-96 focus-within:w-full group/assistant-bar sm:focus-within:w-[30rem] hover:scale-100 sm:hover:scale-105 focus-within:hover:scale-100 [transition:width_400ms,left_200ms,transform_500ms,opacity_200ms]"><div class="transition-all duration-300 translate-y-[100px] opacity-0"><div class="flex flex-col w-full rounded-2xl pointer-events-auto bg-background-light/90 dark:bg-background-dark/90 backdrop-blur-xl border border-gray-200 dark:border-white/30 focus-within:border-primary dark:focus-within:border-primary-light transition-colors sm:shadow-xl"><div class="relative flex items-end"><textarea id="chat-assistant-textarea" aria-label="Ask a question..." autocomplete="off" placeholder="Ask a question..." class="chat-assistant-input w-full bg-transparent border-0 peer/input text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 !outline-none focus:!outline-none focus:ring-0 py-2.5 pl-3.5 pr-10 font-bodyWeight text-sm" style="resize: none; height: 60px !important;"></textarea><span class="absolute right-11 bottom-3 text-xs font-medium text-gray-400 dark:text-gray-500 select-none pointer-events-none peer-focus/input:hidden hidden sm:inline">âŒ˜I</span><button class="chat-assistant-send-button flex justify-center items-center rounded-full p-1 size-6 bg-primary/30 dark:bg-primary-dark/30 absolute right-2.5 bottom-2" aria-label="Send message" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-up text-white dark:text-white size-3.5"><path d="m5 12 7-7 7 7"></path><path d="M12 19V5"></path></svg></button></div></div></div></div></div></div></div><footer id="footer" class="advanced-footer flex flex-col items-center mx-auto border-t border-gray-100 dark:border-gray-800/50 w-full"><div class="flex w-full flex-col gap-12 justify-between px-8 py-16 md:py-20 lg:py-28 max-w-[984px] z-20"><div class="flex flex-col md:flex-row gap-8 justify-between min-h-[76px]"><div class="flex md:flex-col justify-between items-center md:items-start min-w-16 md:min-w-20 lg:min-w-48 md:gap-y-24"><a class="" href="https://docs.langchain.com/"><span class="sr-only">Docs by LangChain home page</span><img class="nav-logo w-auto relative object-contain block dark:hidden max-w-48 h-[26px]" alt="light logo" src="./Agents01_files/langchain-docs-teal.svg"><img class="nav-logo w-auto relative object-contain hidden dark:block max-w-48 h-[26px]" alt="dark logo" src="./Agents01_files/langchain-docs-lilac.svg"></a><div class="flex gap-4 min-w-[140px] max-w-[492px] flex-wrap h-fit md:hidden justify-end"><a href="https://github.com/langchain-ai" target="_blank" class="h-fit"><span class="sr-only">github</span><svg class="w-5 h-5 bg-gray-500 dark:bg-gray-600 hover:bg-gray-600 dark:hover:bg-gray-500" style="mask-image: url(&quot;https://d3gk2c5xim1je2.cloudfront.net/v7.1.0/brands/github.svg&quot;); mask-repeat: no-repeat; mask-position: center center;"></svg></a><a href="https://x.com/LangChainAI" target="_blank" class="h-fit"><span class="sr-only">x</span><svg class="w-5 h-5 bg-gray-500 dark:bg-gray-600 hover:bg-gray-600 dark:hover:bg-gray-500" style="mask-image: url(&quot;https://d3gk2c5xim1je2.cloudfront.net/v7.1.0/brands/x-twitter.svg&quot;); mask-repeat: no-repeat; mask-position: center center;"></svg></a><a href="https://www.linkedin.com/company/langchain/" target="_blank" class="h-fit"><span class="sr-only">linkedin</span><svg class="w-5 h-5 bg-gray-500 dark:bg-gray-600 hover:bg-gray-600 dark:hover:bg-gray-500" style="mask-image: url(&quot;https://d3gk2c5xim1je2.cloudfront.net/v7.1.0/brands/linkedin.svg&quot;); mask-repeat: no-repeat; mask-position: center center;"></svg></a><a href="https://www.youtube.com/@LangChain" target="_blank" class="h-fit"><span class="sr-only">youtube</span><svg class="w-5 h-5 bg-gray-500 dark:bg-gray-600 hover:bg-gray-600 dark:hover:bg-gray-500" style="mask-image: url(&quot;https://d3gk2c5xim1je2.cloudfront.net/v7.1.0/brands/youtube.svg&quot;); mask-repeat: no-repeat; mask-position: center center;"></svg></a></div></div><div class="flex flex-col sm:grid max-md:!grid-cols-2 gap-8 flex-1" style="grid-template-columns: repeat(2, minmax(0px, 1fr));"><div class="flex flex-col gap-4 flex-1 whitespace-nowrap w-full md:items-center"><div class="flex gap-4 flex-col"><p class="text-sm font-semibold text-gray-950 dark:text-white mb-1">Resources</p><a class="text-sm max-w-36 whitespace-normal md:truncate text-gray-950/50 dark:text-white/50 hover:text-gray-950/70 dark:hover:text-white/70" href="https://forum.langchain.com/" target="_blank" rel="noreferrer">Forum</a><a class="text-sm max-w-36 whitespace-normal md:truncate text-gray-950/50 dark:text-white/50 hover:text-gray-950/70 dark:hover:text-white/70" href="https://changelog.langchain.com/" target="_blank" rel="noreferrer">Changelog</a><a class="text-sm max-w-36 whitespace-normal md:truncate text-gray-950/50 dark:text-white/50 hover:text-gray-950/70 dark:hover:text-white/70" href="https://academy.langchain.com/" target="_blank" rel="noreferrer">LangChain Academy</a><a class="text-sm max-w-36 whitespace-normal md:truncate text-gray-950/50 dark:text-white/50 hover:text-gray-950/70 dark:hover:text-white/70" href="https://trust.langchain.com/" target="_blank" rel="noreferrer">Trust Center</a></div></div><div class="flex flex-col gap-4 flex-1 whitespace-nowrap w-full md:items-center"><div class="flex gap-4 flex-col"><p class="text-sm font-semibold text-gray-950 dark:text-white mb-1">Company</p><a class="text-sm max-w-36 whitespace-normal md:truncate text-gray-950/50 dark:text-white/50 hover:text-gray-950/70 dark:hover:text-white/70" href="https://langchain.com/about" target="_blank" rel="noreferrer">About</a><a class="text-sm max-w-36 whitespace-normal md:truncate text-gray-950/50 dark:text-white/50 hover:text-gray-950/70 dark:hover:text-white/70" href="https://langchain.com/careers" target="_blank" rel="noreferrer">Careers</a><a class="text-sm max-w-36 whitespace-normal md:truncate text-gray-950/50 dark:text-white/50 hover:text-gray-950/70 dark:hover:text-white/70" href="https://blog.langchain.com/" target="_blank" rel="noreferrer">Blog</a></div></div></div><div class="gap-4 min-w-[140px] max-w-[492px] flex-wrap hidden md:flex justify-end"><a href="https://github.com/langchain-ai" target="_blank" class="h-fit"><span class="sr-only">github</span><svg class="w-5 h-5 bg-gray-500 dark:bg-gray-600 hover:bg-gray-600 dark:hover:bg-gray-500" style="mask-image: url(&quot;https://d3gk2c5xim1je2.cloudfront.net/v7.1.0/brands/github.svg&quot;); mask-repeat: no-repeat; mask-position: center center;"></svg></a><a href="https://x.com/LangChainAI" target="_blank" class="h-fit"><span class="sr-only">x</span><svg class="w-5 h-5 bg-gray-500 dark:bg-gray-600 hover:bg-gray-600 dark:hover:bg-gray-500" style="mask-image: url(&quot;https://d3gk2c5xim1je2.cloudfront.net/v7.1.0/brands/x-twitter.svg&quot;); mask-repeat: no-repeat; mask-position: center center;"></svg></a><a href="https://www.linkedin.com/company/langchain/" target="_blank" class="h-fit"><span class="sr-only">linkedin</span><svg class="w-5 h-5 bg-gray-500 dark:bg-gray-600 hover:bg-gray-600 dark:hover:bg-gray-500" style="mask-image: url(&quot;https://d3gk2c5xim1je2.cloudfront.net/v7.1.0/brands/linkedin.svg&quot;); mask-repeat: no-repeat; mask-position: center center;"></svg></a><a href="https://www.youtube.com/@LangChain" target="_blank" class="h-fit"><span class="sr-only">youtube</span><svg class="w-5 h-5 bg-gray-500 dark:bg-gray-600 hover:bg-gray-600 dark:hover:bg-gray-500" style="mask-image: url(&quot;https://d3gk2c5xim1je2.cloudfront.net/v7.1.0/brands/youtube.svg&quot;); mask-repeat: no-repeat; mask-position: center center;"></svg></a></div></div><div class="h-[1px] w-full bg-gray-100 dark:bg-white/5"></div><div class="flex items-center justify-between"><div class="sm:flex"><a href="https://www.mintlify.com/?utm_campaign=poweredBy&amp;utm_medium=referral&amp;utm_source=langchain-5e9cc07a" target="_blank" rel="noreferrer" class="group flex items-baseline gap-1 text-sm text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300"><span>Powered by</span><svg width="1274" height="367" viewBox="0 0 1274 367" fill="none" xmlns="http://www.w3.org/2000/svg" class="h-3.5 w-auto translate-y-[3px]"><path d="M1154.38 366.038H1097.86L1137.69 276.14L1058.04 97.1046H1114.93L1161.35 209.337C1162.97 213.26 1168.53 213.253 1170.14 209.325L1216.21 97.1046H1273.49L1154.38 366.038Z" fill="currentColor"></path><path d="M982.714 286.761V142.622H944.403V97.1041H982.714V72.4488C982.714 49.9429 989.542 32.2416 1003.2 19.345C1016.85 6.44832 1034.17 0 1055.16 0C1068.06 0 1079.06 1.39081 1088.16 4.17244V50.0693C1082.09 47.7934 1075.01 46.6555 1066.92 46.6555C1055.54 46.6555 1047.32 49.1843 1042.27 54.2418C1037.21 59.0464 1034.68 67.2648 1034.68 78.8971V97.1041H1088.16V142.622H1034.68V286.761H982.714Z" fill="currentColor"></path><path d="M897.916 66.0005C889.066 66.0005 881.353 62.8395 874.778 56.5176C868.203 49.9429 864.916 42.1037 864.916 33.0002C864.916 23.8967 868.203 16.184 874.778 9.86215C881.353 3.28738 889.066 0 897.916 0C907.273 0 915.112 3.28738 921.434 9.86215C928.008 16.184 931.296 23.8967 931.296 33.0002C931.296 42.1037 928.008 49.9429 921.434 56.5176C915.112 62.8395 907.273 66.0005 897.916 66.0005ZM872.123 286.761V97.1041H924.089V286.761H872.123Z" fill="currentColor"></path><path d="M781.638 286.761V2.27609H833.604V286.761H781.638Z" fill="currentColor"></path><path d="M722.934 289.037C701.693 289.037 684.244 283.221 670.589 271.588C657.187 259.703 650.485 242.634 650.485 220.381V142.622H612.175V97.1044H650.485V44.3799H702.451V97.1044H755.934V142.622H702.451V210.14C702.451 221.772 704.98 230.117 710.038 235.174C715.095 239.979 723.313 242.381 734.693 242.381C742.785 242.381 749.865 241.243 755.934 238.967V284.864C746.831 287.646 735.831 289.037 722.934 289.037Z" fill="currentColor"></path><path d="M417.674 286.761V97.1041H469.64V110.967C469.64 113.311 472.83 114.347 474.382 112.591C485.967 99.4848 502.467 92.9317 523.881 92.9317C546.64 92.9317 564.468 100.518 577.365 115.69C590.514 130.61 597.089 150.587 597.089 175.622V286.761H545.123V184.346C545.123 170.438 542.215 159.691 536.399 152.105C530.583 144.265 522.364 140.346 511.743 140.346C499.1 140.346 488.858 144.898 481.019 154.001C473.433 163.105 469.64 176.507 469.64 194.208V286.761H417.674Z" fill="currentColor"></path><path d="M352.981 66.0005C344.13 66.0005 336.417 62.8395 329.843 56.5176C323.268 49.9429 319.98 42.1037 319.98 33.0002C319.98 23.8967 323.268 16.184 329.843 9.86215C336.417 3.28738 344.13 0 352.981 0C362.337 0 370.176 3.28738 376.498 9.86215C383.073 16.184 386.36 23.8967 386.36 33.0002C386.36 42.1037 383.073 49.9429 376.498 56.5176C370.176 62.8395 362.337 66.0005 352.981 66.0005ZM327.187 286.761V97.1041H379.153V286.761H327.187Z" fill="currentColor"></path><path d="M238.967 286.761V185.484C238.967 155.392 229.105 140.346 209.381 140.346C198.001 140.346 188.898 144.645 182.07 153.242C175.495 161.84 171.955 174.61 171.449 191.553V286.761H119.484V185.484C119.484 155.392 109.621 140.346 89.8972 140.346C78.2649 140.346 69.035 144.898 62.2073 154.001C55.3797 163.105 51.9659 176.507 51.9659 194.208V286.761H0V97.1041H51.9659V111.103C51.9659 113.435 55.1014 114.462 56.633 112.704C68.1136 99.5223 83.3741 92.9317 102.415 92.9317C127.436 92.9317 146.283 103.262 158.953 123.923C159.953 125.553 162.412 125.527 163.406 123.894C168.884 114.891 176.496 107.731 186.243 102.415C197.369 96.0926 208.622 92.9317 220.002 92.9317C242.507 92.9317 259.956 100.392 272.347 115.311C284.738 130.231 290.933 150.714 290.933 176.76V286.761H238.967Z" fill="currentColor"></path></svg></a></div><div class="flex items-center gap-2"><button aria-label="Switch to system theme" data-testid="mode-switch-system" class="p-1.5 rounded-lg text-gray-400 dark:text-gray-600 hover:text-gray-600 dark:hover:text-gray-400"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-4"><g clip-path="url(#clip0_2736_5814)"><path d="M5.11133 14.4444C5.78511 14.232 6.78066 14 8.00022 14C8.70688 14 9.72555 14.0782 10.8891 14.4444" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M8 11.7778V14.0001" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12.6668 2.44434H3.33344C2.3516 2.44434 1.55566 3.24027 1.55566 4.22211V9.99989C1.55566 10.9817 2.3516 11.7777 3.33344 11.7777H12.6668C13.6486 11.7777 14.4446 10.9817 14.4446 9.99989V4.22211C14.4446 3.24027 13.6486 2.44434 12.6668 2.44434Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></g><defs><clippath id="clip0_2736_5814"><rect width="16" height="16" fill="white"></rect></clippath></defs></svg></button><button aria-label="Switch to light theme" data-testid="mode-switch-light" class="p-1.5 rounded-lg bg-gray-200 dark:bg-gray-800 text-gray-600 dark:text-gray-400"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg" class="size-4"><g clip-path="url(#clip0_2880_7340)"><path d="M8 1.11133V2.00022" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12.8711 3.12891L12.2427 3.75735" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M14.8889 8H14" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12.8711 12.8711L12.2427 12.2427" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M8 14.8889V14" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M3.12891 12.8711L3.75735 12.2427" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M1.11133 8H2.00022" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M3.12891 3.12891L3.75735 3.75735" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M8.00043 11.7782C10.0868 11.7782 11.7782 10.0868 11.7782 8.00043C11.7782 5.91402 10.0868 4.22266 8.00043 4.22266C5.91402 4.22266 4.22266 5.91402 4.22266 8.00043C4.22266 10.0868 5.91402 11.7782 8.00043 11.7782Z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></g><defs><clippath id="clip0_2880_7340"><rect width="16" height="16" fill="white"></rect></clippath></defs></svg></button><button aria-label="Switch to dark theme" data-testid="mode-switch-dark" class="p-1.5 rounded-lg text-gray-400 dark:text-gray-600 hover:text-gray-600 dark:hover:text-gray-400"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon size-4"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path></svg></button></div></div></div></footer></div></div></div><div class="sticky top-0 h-screen shrink-0 z-[22] bg-background-light dark:bg-background-dark" style="width: 0px; pointer-events: none; visibility: hidden; overflow: hidden;"><div class="absolute left-0 top-0 bottom-0 w-px z-10 cursor-col-resize bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 after:content-[&quot;&quot;] after:absolute after:inset-y-0 after:-inset-x-2 after:select-none"></div><div id="chat-assistant-sheet" class="flex flex-col overflow-hidden shrink-0 h-full bg-background-light dark:bg-background-dark chat-assistant-sheet" aria-hidden="true"><div class="w-full flex flex-col flex-1 min-h-0 lg:pt-3"><div class="chat-assistant-sheet-header flex items-center justify-between pb-3 px-4"><div class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18" class="size-5 text-primary dark:text-primary-light"><g fill="currentColor"><path d="M5.658,2.99l-1.263-.421-.421-1.263c-.137-.408-.812-.408-.949,0l-.421,1.263-1.263,.421c-.204,.068-.342,.259-.342,.474s.138,.406,.342,.474l1.263,.421,.421,1.263c.068,.204,.26,.342,.475,.342s.406-.138,.475-.342l.421-1.263,1.263-.421c.204-.068,.342-.259,.342-.474s-.138-.406-.342-.474Z" fill="currentColor" data-stroke="none" stroke="none"></path><polygon points="9.5 2.75 11.412 7.587 16.25 9.5 11.412 11.413 9.5 16.25 7.587 11.413 2.75 9.5 7.587 7.587 9.5 2.75" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></polygon></g></svg><span class="font-medium text-gray-900 dark:text-gray-100">Assistant</span></div><div class="flex items-center gap-1"><button class="group hover:bg-gray-100 dark:hover:bg-white/10 p-1.5 rounded-lg"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2 size-4 sm:size-3.5 text-gray-500 group-hover:text-gray-700 dark:group-hover:text-gray-300"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></button><button class="group hover:bg-gray-100 dark:hover:bg-white/10 p-1.5 rounded-lg"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x size-[20px] sm:size-4 text-gray-500 group-hover:text-gray-700 dark:group-hover:text-gray-300"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg></button></div></div><div id="chat-content" class="chat-assistant-sheet-content flex-1 overflow-y-auto relative px-5 min-h-0"><div class="h-full flex flex-col justify-between"><div class="mt-4 flex flex-col items-center text-sm"><div class="mx-8 text-center text-gray-400 dark:text-gray-600 text-xs chat-assistant-disclaimer-text">Responses are generated using AI and may contain mistakes.</div></div></div></div><div class="px-4 pb-4 shrink-0"><div class=""><div class="flex flex-col w-full rounded-2xl pointer-events-auto bg-background-light/90 dark:bg-background-dark/90 backdrop-blur-xl border border-gray-200 dark:border-white/30 focus-within:border-primary dark:focus-within:border-primary-light transition-colors"><div class="relative flex items-end"><textarea id="chat-assistant-textarea" aria-label="Ask a question..." autocomplete="off" placeholder="Ask a question..." class="chat-assistant-input w-full bg-transparent border-0 peer/input text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 !outline-none focus:!outline-none focus:ring-0 py-2.5 pl-3.5 pr-10 font-bodyWeight text-sm" style="resize: none; height: 220px !important;"></textarea><button class="chat-assistant-send-button flex justify-center items-center rounded-full p-1 size-6 bg-primary/30 dark:bg-primary-dark/30 absolute right-2.5 bottom-2" aria-label="Send message" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-up text-white dark:text-white size-3.5"><path d="m5 12 7-7 7 7"></path><path d="M12 19V5"></path></svg></button></div></div></div></div></div></div></div></div></div><script src="./Agents01_files/webpack-605f4630efb20cbf.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[85341,[],\"\"]\n"])</script><script>self.__next_f.push([1,"3:I[2510,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"30479\",\"static/chunks/30479-caf1de786dc73f43.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"18039\",\"static/chunks/app/error-c6d97a83f6ebe249.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"default\",1]\n"])</script><script>self.__next_f.push([1,"4:I[90025,[],\"\"]\n"])</script><script>self.__next_f.push([1,"5:I[51749,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"74610\",\"static/chunks/74610-281c4fe11ead87d4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"59823\",\"static/chunks/59823-9016fae3a0af6930.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"35456\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/layout-3a53ac52e5c673ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"ThemeProvider\",1]\n"])</script><script>self.__next_f.push([1,"6:I[35021,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"74610\",\"static/chunks/74610-281c4fe11ead87d4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"59823\",\"static/chunks/59823-9016fae3a0af6930.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"35456\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/layout-3a53ac52e5c673ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"ColorVariables\",1]\n"])</script><script>self.__next_f.push([1,"7:I[88746,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"74610\",\"static/chunks/74610-281c4fe11ead87d4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"59823\",\"static/chunks/59823-9016fae3a0af6930.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"35456\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/layout-3a53ac52e5c673ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"FontScript\",1]\n"])</script><script>self.__next_f.push([1,"8:I[24223,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"74610\",\"static/chunks/74610-281c4fe11ead87d4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"59823\",\"static/chunks/59823-9016fae3a0af6930.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"35456\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/layout-3a53ac52e5c673ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"RoundedVariables\",1]\n"])</script><script>self.__next_f.push([1,"9:I[48622,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"92967\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/not-found-99c11e8d979f101e.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"RecommendedPagesList\"]\n"])</script><script>self.__next_f.push([1,"a:I[69206,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"30479\",\"static/chunks/30479-caf1de786dc73f43.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"9249\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/error-227cf83a7e0637b7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"default\",1]\n"])</script><script>self.__next_f.push([1,"15:I[34431,[],\"\"]\n:HL[\"/mintlify-assets/_next/static/media/bb3ef058b751a6ad-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/mintlify-assets/_next/static/media/c4b700dcb2187787-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/mintlify-assets/_next/static/media/e4af272ccee01ff0-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/mintlify-assets/_next/static/css/ca7d6eb2a816651f.css?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"style\"]\n:HL[\"/mintlify-assets/_next/static/css/9e8832c8599d2dba.css?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"style\"]\n:HL[\"/mintlify-assets/_next/static/css/5b8c8e3125ac4cdb.css?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"bbCsKCAFO-STEiG9zHECB\",\"p\":\"/mintlify-assets\",\"c\":[\"\",\"_sites\",\"langchain-5e9cc07a\",\"\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"%5Fsites\",{\"children\":[[\"subdomain\",\"langchain-5e9cc07a\",\"d\"],{\"children\":[\"(multitenant)\",{\"topbar\":[\"(slot)\",{\"children\":[[\"slug\",\"\",\"oc\"],{\"children\":[\"__PAGE__\",{}]}]}],\"children\":[[\"slug\",\"\",\"oc\"],{\"children\":[\"__PAGE__\",{}]}]}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/mintlify-assets/_next/static/css/ca7d6eb2a816651f.css?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/mintlify-assets/_next/static/css/9e8832c8599d2dba.css?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"suppressHydrationWarning\":true,\"lang\":\"en\",\"className\":\"__variable_47c970 __variable_3bbdad dark\",\"data-banner-state\":\"visible\",\"data-page-mode\":\"none\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"script\",null,{\"type\":\"text/javascript\",\"dangerouslySetInnerHTML\":{\"__html\":\"(function(a,b){try{let c=document.getElementById(\\\"banner\\\")?.innerText;if(c){for(let d=0;d\u003clocalStorage.length;d++){let e=localStorage.key(d);if(e?.endsWith(a)\u0026\u0026localStorage.getItem(e)===c)return void document.documentElement.setAttribute(b,\\\"hidden\\\")}document.documentElement.setAttribute(b,\\\"visible\\\");return}for(let c=0;c\u003clocalStorage.length;c++){let d=localStorage.key(c);if(d?.endsWith(a)\u0026\u0026localStorage.getItem(d))return void document.documentElement.setAttribute(b,\\\"hidden\\\")}document.documentElement.setAttribute(b,\\\"visible\\\")}catch(a){document.documentElement.setAttribute(b,\\\"hidden\\\")}})(\\n  \\\"bannerDismissed\\\",\\n  \\\"data-banner-state\\\",\\n)\"}}],false]}],[\"$\",\"body\",null,{\"children\":[[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$3\",\"errorStyles\":[],\"errorScripts\":[],\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"$L5\",null,{\"children\":[[\"$\",\"$L6\",null,{}],[\"$\",\"$L7\",null,{}],[\"$\",\"$L8\",null,{}],[\"$\",\"style\",null,{\"children\":\":root {\\n  --primary: 17 120 102;\\n  --primary-light: 74 222 128;\\n  --primary-dark: 22 101 52;\\n  --background-light: 255 255 255;\\n  --background-dark: 15 17 23;\\n}\"}],[\"$\",\"main\",null,{\"className\":\"h-screen bg-background-light dark:bg-background-dark text-left\",\"children\":[\"$\",\"article\",null,{\"className\":\"bg-custom bg-fixed bg-center bg-cover relative flex flex-col items-center justify-center h-full\",\"children\":[\"$\",\"div\",null,{\"className\":\"w-full max-w-xl px-10\",\"children\":[[\"$\",\"span\",null,{\"className\":\"inline-flex mb-6 rounded-full px-3 py-1 text-sm font-semibold mr-4 text-white p-1 bg-primary\",\"children\":[\"Error \",404]}],[\"$\",\"h1\",null,{\"className\":\"font-semibold mb-3 text-3xl\",\"children\":\"Page not found!\"}],[\"$\",\"p\",null,{\"className\":\"text-lg text-gray-600 dark:text-gray-400 mb-6\",\"children\":\"We couldn't find the page.\"}],[\"$\",\"$L9\",null,{}]]}]}]}]]}],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}],null]}]]}]]}],{\"children\":[\"%5Fsites\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"subdomain\",\"langchain-5e9cc07a\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$a\",\"errorStyles\":[],\"errorScripts\":[],\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"$L5\",null,{\"children\":[[\"$\",\"$L6\",null,{}],[\"$\",\"$L7\",null,{}],[\"$\",\"$L8\",null,{}],[\"$\",\"style\",null,{\"children\":\":root {\\n  --primary: 17 120 102;\\n  --primary-light: 74 222 128;\\n  --primary-dark: 22 101 52;\\n  --background-light: 255 255 255;\\n  --background-dark: 15 17 23;\\n}\"}],[\"$\",\"main\",null,{\"className\":\"h-screen bg-background-light dark:bg-background-dark text-left\",\"children\":[\"$\",\"article\",null,{\"className\":\"bg-custom bg-fixed bg-center bg-cover relative flex flex-col items-center justify-center h-full\",\"children\":[\"$\",\"div\",null,{\"className\":\"w-full max-w-xl px-10\",\"children\":[[\"$\",\"span\",null,{\"className\":\"inline-flex mb-6 rounded-full px-3 py-1 text-sm font-semibold mr-4 text-white p-1 bg-primary\",\"children\":[\"Error \",404]}],\"$Lb\",\"$Lc\",\"$Ld\"]}]}]}]]}],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"(multitenant)\",\"$Le\",{\"topbar\":[\"(slot)\",\"$Lf\",{\"children\":[[\"slug\",\"\",\"oc\"],\"$L10\",{\"children\":[\"__PAGE__\",\"$L11\",{},null,false]},null,false]},null,false],\"children\":[[\"slug\",\"\",\"oc\"],\"$L12\",{\"children\":[\"__PAGE__\",\"$L13\",{},null,false]},null,false]},null,false]},null,false]},null,false]},null,false],\"$L14\",false]],\"m\":\"$undefined\",\"G\":[\"$15\",[]],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"18:I[15104,[],\"OutletBoundary\"]\n1d:I[94777,[],\"AsyncMetadataOutlet\"]\n1f:I[15104,[],\"ViewportBoundary\"]\n21:I[15104,[],\"MetadataBoundary\"]\n22:\"$Sreact.suspense\"\nb:[\"$\",\"h1\",null,{\"className\":\"font-semibold mb-3 text-3xl\",\"children\":\"Page not found!\"}]\nc:[\"$\",\"p\",null,{\"className\":\"text-lg text-gray-600 dark:text-gray-400 mb-6\",\"children\":\"We couldn't find the page.\"}]\nd:[\"$\",\"$L9\",null,{}]\ne:[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/mintlify-assets/_next/static/css/5b8c8e3125ac4cdb.css?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],\"$L16\"]}]\nf:[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]\n10:[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]\n11:[\"$\",\"$1\",\"c\",{\"children\":[\"$L17\",null,[\"$\",\"$L18\",null,{\"children\":[\"$L19\",\"$L1a\"]}]]}]\n12:[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]\n13:[\"$\",\"$1\",\"c\",{\"children\":[\"$L1b\",null,[\"$\",\"$L18\",null,{\"children\":[\"$L1c\",[\"$\",\"$L1d\",null,{\"promise\":\"$@1e\"}]]}]]}]\n14:[\"$\",\"$1\",\"h\",{\"children\":[null,[[\"$\",\"$L1f\",null,{\"children\":\"$L20\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]],[\"$\",\"$L21\",null,{\"children\":[\"$\",\"div\",null,{\"hidden\":true,\"ch"])</script><script>self.__next_f.push([1,"ildren\":[\"$\",\"$22\",null,{\"fallback\":null,\"children\":\"$L23\"}]}]}]]}]\n"])</script><script>self.__next_f.push([1,"19:null\n1a:null\n"])</script><script>self.__next_f.push([1,"20:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover\"}]]\n1c:null\n"])</script><script>self.__next_f.push([1,"2a:I[20469,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25263\",\"static/chunks/25263-1e30f64402644edf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"64829\",\"static/chunks/64829-732c519d2b5cb182.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83378\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/%40topbar/%5B%5B...slug%5D%5D/page-d86372b391ebd2aa.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"TopBar\",1]\n"])</script><script>self.__next_f.push([1,"2b:I[13928,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25263\",\"static/chunks/25263-1e30f64402644edf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"2870\",\"static/chunks/2870-43b3b296a96d0195.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"89841\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/%5B%5B...slug%5D%5D/page-024162cb87bbb1c5.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"ApiReferenceProvider\",1]\n"])</script><script>self.__next_f.push([1,"2c:I[13928,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25263\",\"static/chunks/25263-1e30f64402644edf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"2870\",\"static/chunks/2870-43b3b296a96d0195.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"89841\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/%5B%5B...slug%5D%5D/page-024162cb87bbb1c5.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"PageProvider\",1]\n"])</script><script>self.__next_f.push([1,"2d:I[13928,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25263\",\"static/chunks/25263-1e30f64402644edf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"2870\",\"static/chunks/2870-43b3b296a96d0195.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"89841\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/%5B%5B...slug%5D%5D/page-024162cb87bbb1c5.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"ApiReferenceProvider2\",1]\n"])</script><script>self.__next_f.push([1,"2e:I[97870,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25263\",\"static/chunks/25263-1e30f64402644edf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"2870\",\"static/chunks/2870-43b3b296a96d0195.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"89841\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/%5B%5B...slug%5D%5D/page-024162cb87bbb1c5.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"TabSyncContextProvider\"]\n"])</script><script>self.__next_f.push([1,"2f:I[45165,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25263\",\"static/chunks/25263-1e30f64402644edf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"2870\",\"static/chunks/2870-43b3b296a96d0195.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"89841\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/%5B%5B...slug%5D%5D/page-024162cb87bbb1c5.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"\"]\n"])</script><script>self.__next_f.push([1,"30:I[42080,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25263\",\"static/chunks/25263-1e30f64402644edf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"2870\",\"static/chunks/2870-43b3b296a96d0195.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"89841\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/%5B%5B...slug%5D%5D/page-024162cb87bbb1c5.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"FooterAndSidebarScrollScript\",1]\n"])</script><script>self.__next_f.push([1,"31:I[91153,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25263\",\"static/chunks/25263-1e30f64402644edf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"2870\",\"static/chunks/2870-43b3b296a96d0195.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"89841\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/%5B%5B...slug%5D%5D/page-024162cb87bbb1c5.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"Background\",1]\n"])</script><script>self.__next_f.push([1,"1e:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"Home - Docs by LangChain\"}],[\"$\",\"meta\",\"1\",{\"name\":\"application-name\",\"content\":\"Docs by LangChain\"}],[\"$\",\"meta\",\"2\",{\"name\":\"generator\",\"content\":\"Mintlify\"}],[\"$\",\"meta\",\"3\",{\"name\":\"msapplication-config\",\"content\":\"/mintlify-assets/_mintlify/favicons/langchain-5e9cc07a/6qGJdyFkFFvLiKlZ/_generated/favicon/browserconfig.xml\"}],[\"$\",\"meta\",\"4\",{\"name\":\"apple-mobile-web-app-title\",\"content\":\"Docs by LangChain\"}],[\"$\",\"meta\",\"5\",{\"name\":\"msapplication-TileColor\",\"content\":\"#2F6868\"}],[\"$\",\"meta\",\"6\",{\"name\":\"charset\",\"content\":\"utf-8\"}],[\"$\",\"meta\",\"7\",{\"name\":\"og:site_name\",\"content\":\"Docs by LangChain\"}],[\"$\",\"meta\",\"8\",{\"name\":\"canonical\",\"content\":\"https://docs.langchain.com\"}],[\"$\",\"meta\",\"9\",{\"name\":\"google-site-verification\",\"content\":\"9_2KHeJwmEdwgncBRk1MsKxriZz7Sc21EJdbfCxkTEo\"}],[\"$\",\"link\",\"10\",{\"rel\":\"canonical\",\"href\":\"https://docs.langchain.com\"}],[\"$\",\"link\",\"11\",{\"rel\":\"alternate\",\"type\":\"application/xml\",\"href\":\"/sitemap.xml\"}],[\"$\",\"meta\",\"12\",{\"property\":\"og:title\",\"content\":\"Home - Docs by LangChain\"}],[\"$\",\"meta\",\"13\",{\"property\":\"og:url\",\"content\":\"https://docs.langchain.com\"}],[\"$\",\"meta\",\"14\",{\"property\":\"og:image\",\"content\":\"https://langchain-5e9cc07a.mintlify.app/mintlify-assets/_next/image?url=%2F_mintlify%2Fapi%2Fog%3Fdivision%3DDocumentation%26appearance%3Dsystem%26title%3DHome%26logoLight%3Dhttps%253A%252F%252Fmintcdn.com%252Flangchain-5e9cc07a%252FXbr8HuVd9jPi6qTU%252Fimages%252Fbrand%252Flangchain-docs-teal.svg%253Ffit%253Dmax%2526auto%253Dformat%2526n%253DXbr8HuVd9jPi6qTU%2526q%253D85%2526s%253D16111530672bf976cb54ef2143478342%26logoDark%3Dhttps%253A%252F%252Fmintcdn.com%252Flangchain-5e9cc07a%252FXbr8HuVd9jPi6qTU%252Fimages%252Fbrand%252Flangchain-docs-lilac.svg%253Ffit%253Dmax%2526auto%253Dformat%2526n%253DXbr8HuVd9jPi6qTU%2526q%253D85%2526s%253Db70fb1a2208670492ef94aef14b680be%26primaryColor%3D%25232F6868%26lightColor%3D%252384C4C0%26darkColor%3D%25231C3C3C%26backgroundLight%3D%2523ffffff%26backgroundDark%3D%25230b0d0f\u0026w=1200\u0026q=100\"}],[\"$\",\"meta\",\"15\",{\"property\":\"og:image:width\",\"content\":\"1200\"}],[\"$\",\"meta\",\"16\",{\"property\":\"og:image:height\",\"content\":\"630\"}],[\"$\",\"meta\",\"17\",{\"property\":\"og:type\",\"content\":\"website\"}],[\"$\",\"meta\",\"18\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"19\",{\"name\":\"twitter:title\",\"content\":\"Home - Docs by LangChain\"}],[\"$\",\"meta\",\"20\",{\"name\":\"twitter:image\",\"content\":\"https://langchain-5e9cc07a.mintlify.app/mintlify-assets/_next/image?url=%2F_mintlify%2Fapi%2Fog%3Fdivision%3DDocumentation%26appearance%3Dsystem%26title%3DHome%26logoLight%3Dhttps%253A%252F%252Fmintcdn.com%252Flangchain-5e9cc07a%252FXbr8HuVd9jPi6qTU%252Fimages%252Fbrand%252Flangchain-docs-teal.svg%253Ffit%253Dmax%2526auto%253Dformat%2526n%253DXbr8HuVd9jPi6qTU%2526q%253D85%2526s%253D16111530672bf976cb54ef2143478342%26logoDark%3Dhttps%253A%252F%252Fmintcdn.com%252Flangchain-5e9cc07a%252FXbr8HuVd9jPi6qTU%252Fimages%252Fbrand%252Flangchain-docs-lilac.svg%253Ffit%253Dmax%2526auto%253Dformat%2526n%253DXbr8HuVd9jPi6qTU%2526q%253D85%2526s%253Db70fb1a2208670492ef94aef14b680be%26primaryColor%3D%25232F6868%26lightColor%3D%252384C4C0%26darkColor%3D%25231C3C3C%26backgroundLight%3D%2523ffffff%26backgroundDark%3D%25230b0d0f\u0026w=1200\u0026q=100\"}],[\"$\",\"meta\",\"21\",{\"name\":\"twitter:image:width\",\"content\":\"1200\"}],[\"$\",\"meta\",\"22\",{\"name\":\"twitter:image:height\",\"content\":\"630\"}],[\"$\",\"link\",\"23\",{\"rel\":\"apple-touch-icon\",\"href\":\"/mintlify-assets/_mintlify/favicons/langchain-5e9cc07a/6qGJdyFkFFvLiKlZ/_generated/favicon/apple-touch-icon.png\",\"type\":\"image/png\",\"sizes\":\"180x180\",\"media\":\"$undefined\"}],[\"$\",\"link\",\"24\",{\"rel\":\"icon\",\"href\":\"/mintlify-assets/_mintlify/favicons/langchain-5e9cc07a/6qGJdyFkFFvLiKlZ/_generated/favicon/favicon-16x16.png\",\"type\":\"image/png\",\"sizes\":\"16x16\",\"media\":\"(prefers-color-scheme: light)\"}],\"$L24\",\"$L25\",\"$L26\",\"$L27\",\"$L28\",\"$L29\"],\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"23:\"$1e:metadata\"\n"])</script><script>self.__next_f.push([1,"17:[\"$\",\"$L2a\",null,{\"pageMetadata\":{\"title\":null,\"sidebarTitle\":\"Home\",\"mode\":\"custom\",\"description\":null,\"href\":\"/index\"},\"docsConfig\":{\"theme\":\"aspen\",\"$schema\":\"https://mintlify.com/docs.json\",\"name\":\"Docs by LangChain\",\"description\":\"Documentation for LangChain, LangGraph, LangSmith, and more.\",\"colors\":{\"primary\":\"#2F6868\",\"light\":\"#84C4C0\",\"dark\":\"#1C3C3C\"},\"logo\":{\"light\":\"https://mintcdn.com/langchain-5e9cc07a/Xbr8HuVd9jPi6qTU/images/brand/langchain-docs-teal.svg?fit=max\u0026auto=format\u0026n=Xbr8HuVd9jPi6qTU\u0026q=85\u0026s=16111530672bf976cb54ef2143478342\",\"dark\":\"https://mintcdn.com/langchain-5e9cc07a/Xbr8HuVd9jPi6qTU/images/brand/langchain-docs-lilac.svg?fit=max\u0026auto=format\u0026n=Xbr8HuVd9jPi6qTU\u0026q=85\u0026s=b70fb1a2208670492ef94aef14b680be\"},\"favicon\":{\"light\":\"/images/brand/docs-favicon.png\",\"dark\":\"/images/brand/docs-favicon.png\"},\"appearance\":{\"default\":\"system\",\"strict\":false},\"navbar\":{\"links\":[{\"label\":\"Support\",\"href\":\"https://support.langchain.com/\"},{\"label\":\"GitHub\",\"icon\":\"github\",\"href\":\"https://github.com/langchain-ai\"}],\"primary\":{\"type\":\"button\",\"label\":\"Try LangSmith\",\"href\":\"https://smith.langchain.com/\"}},\"navigation\":{\"products\":[{\"product\":\"Home\",\"icon\":\"house\",\"pages\":[\"index\"]},{\"product\":\"LangChain + LangGraph\",\"icon\":\"link\",\"description\":\"Open source frameworks\",\"dropdowns\":[{\"dropdown\":\"Python\",\"icon\":\"python\",\"tabs\":[{\"tab\":\"LangChain\",\"pages\":[\"oss/python/langchain/overview\",{\"group\":\"Get started\",\"pages\":[\"oss/python/langchain/install\",\"oss/python/langchain/quickstart\",\"oss/python/langchain/changelog-py\",\"oss/python/langchain/philosophy\"]},{\"group\":\"Core components\",\"pages\":[\"oss/python/langchain/agents\",\"oss/python/langchain/models\",\"oss/python/langchain/messages\",\"oss/python/langchain/tools\",\"oss/python/langchain/short-term-memory\",\"oss/python/langchain/streaming\",\"oss/python/langchain/structured-output\"]},{\"group\":\"Middleware\",\"pages\":[\"oss/python/langchain/middleware/overview\",\"oss/python/langchain/middleware/built-in\",\"oss/python/langchain/middleware/custom\"]},{\"group\":\"Advanced usage\",\"pages\":[\"oss/python/langchain/guardrails\",\"oss/python/langchain/runtime\",\"oss/python/langchain/context-engineering\",\"oss/python/langchain/mcp\",\"oss/python/langchain/human-in-the-loop\",{\"group\":\"Multi-agent\",\"pages\":[\"oss/python/langchain/multi-agent/index\",\"oss/python/langchain/multi-agent/subagents\",\"oss/python/langchain/multi-agent/handoffs\",\"oss/python/langchain/multi-agent/skills\",\"oss/python/langchain/multi-agent/router\",\"oss/python/langchain/multi-agent/custom-workflow\"]},\"oss/python/langchain/retrieval\",\"oss/python/langchain/long-term-memory\"]},{\"group\":\"Agent development\",\"pages\":[\"oss/python/langchain/studio\",\"oss/python/langchain/test\",\"oss/python/langchain/ui\"]},{\"group\":\"Deploy with LangSmith\",\"pages\":[\"oss/python/langchain/deploy\",\"oss/python/langchain/observability\"]}]},{\"tab\":\"LangGraph\",\"pages\":[\"oss/python/langgraph/overview\",{\"group\":\"Get started\",\"pages\":[\"oss/python/langgraph/install\",\"oss/python/langgraph/quickstart\",\"oss/python/langgraph/local-server\",\"oss/python/langgraph/changelog-py\",\"oss/python/langgraph/thinking-in-langgraph\",\"oss/python/langgraph/workflows-agents\"]},{\"group\":\"Capabilities\",\"pages\":[\"oss/python/langgraph/persistence\",\"oss/python/langgraph/durable-execution\",\"oss/python/langgraph/streaming\",\"oss/python/langgraph/interrupts\",\"oss/python/langgraph/use-time-travel\",\"oss/python/langgraph/add-memory\",\"oss/python/langgraph/use-subgraphs\"]},{\"group\":\"Production\",\"pages\":[\"oss/python/langgraph/application-structure\",\"oss/python/langgraph/test\",\"oss/python/langgraph/studio\",\"oss/python/langgraph/ui\",\"oss/python/langgraph/deploy\",\"oss/python/langgraph/observability\"]},{\"group\":\"LangGraph APIs\",\"pages\":[{\"group\":\"Graph API\",\"pages\":[\"oss/python/langgraph/choosing-apis\",\"oss/python/langgraph/graph-api\",\"oss/python/langgraph/use-graph-api\"]},{\"group\":\"Functional API\",\"pages\":[\"oss/python/langgraph/functional-api\",\"oss/python/langgraph/use-functional-api\"]},\"oss/python/langgraph/pregel\"]}]},{\"tab\":\"Deep Agents\",\"pages\":[\"oss/python/deepagents/overview\",{\"group\":\"Get started\",\"pages\":[\"oss/python/deepagents/quickstart\",\"oss/python/deepagents/customization\"]},{\"group\":\"Core capabilities\",\"pages\":[\"oss/python/deepagents/harness\",\"oss/python/deepagents/backends\",\"oss/python/deepagents/subagents\",\"oss/python/deepagents/human-in-the-loop\",\"oss/python/deepagents/long-term-memory\",\"oss/python/deepagents/middleware\"]},{\"group\":\"Command line interface\",\"pages\":[\"oss/python/deepagents/cli\"]}]},{\"tab\":\"Integrations\",\"pages\":[\"oss/python/integrations/providers/overview\",\"oss/python/integrations/providers/all_providers\",{\"group\":\"Popular Providers\",\"icon\":\"user-group\",\"pages\":[\"oss/python/integrations/providers/openai\",\"oss/python/integrations/providers/anthropic\",\"oss/python/integrations/providers/google\",\"oss/python/integrations/providers/aws\",\"oss/python/integrations/providers/huggingface\",\"oss/python/integrations/providers/microsoft\",\"oss/python/integrations/providers/ollama\",\"oss/python/integrations/chat/groq\"]},{\"group\":\"Integrations by component\",\"icon\":\"plug\",\"pages\":[\"oss/python/integrations/chat/index\",\"oss/python/integrations/tools/index\",\"oss/python/integrations/middleware/index\",\"oss/python/integrations/retrievers/index\",\"oss/python/integrations/splitters/index\",\"oss/python/integrations/text_embedding/index\",\"oss/python/integrations/vectorstores/index\",\"oss/python/integrations/document_loaders/index\",\"oss/python/integrations/stores/index\"]}]},{\"tab\":\"Learn\",\"pages\":[\"oss/python/learn\",{\"group\":\"Tutorials\",\"icon\":\"code\",\"pages\":[{\"group\":\"LangChain\",\"expanded\":true,\"pages\":[\"oss/python/langchain/knowledge-base\",\"oss/python/langchain/rag\",\"oss/python/langchain/sql-agent\",\"oss/python/langchain/voice-agent\"]},{\"group\":\"Multi-agent\",\"expanded\":true,\"pages\":[\"oss/python/langchain/multi-agent/subagents-personal-assistant\",\"oss/python/langchain/multi-agent/handoffs-customer-support\",\"oss/python/langchain/multi-agent/router-knowledge-base\",\"oss/python/langchain/multi-agent/skills-sql-assistant\"]},{\"group\":\"LangGraph\",\"expanded\":true,\"pages\":[\"oss/python/langgraph/agentic-rag\",\"oss/python/langgraph/sql-agent\"]}]},{\"group\":\"Conceptual overviews\",\"icon\":\"book\",\"pages\":[\"oss/python/langchain/component-architecture\",\"oss/python/concepts/memory\",\"oss/python/concepts/context\",\"oss/python/langgraph/graph-api\",\"oss/python/langgraph/functional-api\"]},{\"group\":\"Additional resources\",\"icon\":\"list\",\"pages\":[\"oss/python/langchain/academy\",\"oss/python/langgraph/case-studies\",\"oss/python/langchain/get-help\"]}]},{\"tab\":\"Reference\",\"pages\":[\"oss/python/reference/overview\",{\"group\":\"Reference\",\"pages\":[\"oss/python/reference/langchain-python\",\"oss/python/reference/langgraph-python\",\"oss/python/reference/integrations-python\",\"oss/python/reference/deepagents-python\"]},{\"group\":\"Errors\",\"pages\":[\"oss/python/common-errors\"]},{\"group\":\"Releases\",\"pages\":[\"oss/python/versioning\",\"oss/python/releases/changelog\",{\"group\":\"Releases\",\"pages\":[\"oss/python/releases/langchain-v1\",\"oss/python/releases/langgraph-v1\"]},{\"group\":\"Migration guides\",\"pages\":[\"oss/python/migrate/langchain-v1\",\"oss/python/migrate/langgraph-v1\"]}]},{\"group\":\"Policies\",\"pages\":[\"oss/python/release-policy\",\"oss/python/security-policy\"]}]},{\"tab\":\"Contribute\",\"pages\":[\"oss/python/contributing/overview\",{\"group\":\"Contribute\",\"icon\":\"heart-circle-plus\",\"pages\":[\"oss/python/contributing/documentation\",\"oss/python/contributing/code\",{\"group\":\"Integrations\",\"pages\":[\"oss/python/contributing/integrations-langchain\",\"oss/python/contributing/implement-langchain\",\"oss/python/contributing/standard-tests-langchain\",\"oss/python/contributing/publish-langchain\",\"oss/python/contributing/comarketing\"]}]}]}]},{\"dropdown\":\"TypeScript\",\"icon\":\"square-js\",\"tabs\":[{\"tab\":\"LangChain\",\"pages\":[\"oss/javascript/langchain/overview\",{\"group\":\"Get started\",\"pages\":[\"oss/javascript/langchain/install\",\"oss/javascript/langchain/quickstart\",\"oss/javascript/langchain/changelog-js\",\"oss/javascript/langchain/philosophy\"]},{\"group\":\"Core components\",\"pages\":[\"oss/javascript/langchain/agents\",\"oss/javascript/langchain/models\",\"oss/javascript/langchain/messages\",\"oss/javascript/langchain/tools\",\"oss/javascript/langchain/short-term-memory\",\"oss/javascript/langchain/streaming\",\"oss/javascript/langchain/structured-output\"]},{\"group\":\"Middleware\",\"pages\":[\"oss/javascript/langchain/middleware/overview\",\"oss/javascript/langchain/middleware/built-in\",\"oss/javascript/langchain/middleware/custom\"]},{\"group\":\"Advanced usage\",\"pages\":[\"oss/javascript/langchain/guardrails\",\"oss/javascript/langchain/runtime\",\"oss/javascript/langchain/context-engineering\",\"oss/javascript/langchain/mcp\",\"oss/javascript/langchain/human-in-the-loop\",{\"group\":\"Multi-agent\",\"pages\":[\"oss/javascript/langchain/multi-agent/index\",\"oss/javascript/langchain/multi-agent/subagents\",\"oss/javascript/langchain/multi-agent/handoffs\",\"oss/javascript/langchain/multi-agent/skills\",\"oss/javascript/langchain/multi-agent/router\",\"oss/javascript/langchain/multi-agent/custom-workflow\"]},\"oss/javascript/langchain/retrieval\",\"oss/javascript/langchain/long-term-memory\"]},{\"group\":\"Agent development\",\"pages\":[\"oss/javascript/langchain/studio\",\"oss/javascript/langchain/test\",\"oss/javascript/langchain/ui\"]},{\"group\":\"Deploy with LangSmith\",\"pages\":[\"oss/javascript/langchain/deploy\",\"oss/javascript/langchain/observability\"]}]},{\"tab\":\"LangGraph\",\"pages\":[\"oss/javascript/langgraph/overview\",{\"group\":\"Get started\",\"pages\":[\"oss/javascript/langgraph/install\",\"oss/javascript/langgraph/quickstart\",\"oss/javascript/langgraph/local-server\",\"oss/javascript/langgraph/changelog-js\",\"oss/javascript/langgraph/thinking-in-langgraph\",\"oss/javascript/langgraph/workflows-agents\"]},{\"group\":\"Capabilities\",\"pages\":[\"oss/javascript/langgraph/persistence\",\"oss/javascript/langgraph/durable-execution\",\"oss/javascript/langgraph/streaming\",\"oss/javascript/langgraph/interrupts\",\"oss/javascript/langgraph/use-time-travel\",\"oss/javascript/langgraph/add-memory\",\"oss/javascript/langgraph/use-subgraphs\"]},{\"group\":\"Production\",\"pages\":[\"oss/javascript/langgraph/application-structure\",\"oss/javascript/langgraph/test\",\"oss/javascript/langgraph/studio\",\"oss/javascript/langgraph/ui\",\"oss/javascript/langgraph/deploy\",\"oss/javascript/langgraph/observability\"]},{\"group\":\"LangGraph APIs\",\"pages\":[{\"group\":\"Graph API\",\"pages\":[\"oss/javascript/langgraph/choosing-apis\",\"oss/javascript/langgraph/graph-api\",\"oss/javascript/langgraph/use-graph-api\"]},{\"group\":\"Functional API\",\"pages\":[\"oss/javascript/langgraph/functional-api\",\"oss/javascript/langgraph/use-functional-api\"]},\"oss/javascript/langgraph/pregel\"]}]},{\"tab\":\"Deep Agents\",\"pages\":[\"oss/javascript/deepagents/overview\",{\"group\":\"Get started\",\"pages\":[\"oss/javascript/deepagents/quickstart\",\"oss/javascript/deepagents/customization\"]},{\"group\":\"Core capabilities\",\"pages\":[\"oss/javascript/deepagents/harness\",\"oss/javascript/deepagents/backends\",\"oss/javascript/deepagents/subagents\",\"oss/javascript/deepagents/human-in-the-loop\",\"oss/javascript/deepagents/long-term-memory\",\"oss/javascript/deepagents/middleware\"]},{\"group\":\"Deep Agents CLI\",\"pages\":[\"oss/javascript/deepagents/cli\"]}]},{\"tab\":\"Integrations\",\"pages\":[\"oss/javascript/integrations/providers/overview\",\"oss/javascript/integrations/providers/all_providers\",{\"group\":\"Popular Providers\",\"icon\":\"user-group\",\"pages\":[{\"group\":\"OpenAI\",\"pages\":[\"oss/javascript/integrations/providers/openai\",\"oss/javascript/integrations/chat/openai\",\"oss/javascript/integrations/text_embedding/openai\",\"oss/javascript/integrations/tools/openai\"]},{\"group\":\"Anthropic\",\"pages\":[\"oss/javascript/integrations/providers/anthropic\",\"oss/javascript/integrations/chat/anthropic\",\"oss/javascript/integrations/tools/anthropic\"]},{\"group\":\"Google\",\"pages\":[\"oss/javascript/integrations/providers/google\",\"oss/javascript/integrations/chat/google_generative_ai\",\"oss/javascript/integrations/text_embedding/google_generativeai\"]},{\"group\":\"AWS\",\"pages\":[\"oss/javascript/integrations/providers/aws\",\"oss/javascript/integrations/chat/bedrock\",\"oss/javascript/integrations/text_embedding/bedrock\"]},{\"group\":\"Microsoft\",\"pages\":[\"oss/javascript/integrations/providers/microsoft\",\"oss/javascript/integrations/chat/azure\",\"oss/javascript/integrations/text_embedding/azure_openai\"]}]},{\"group\":\"General integrations\",\"icon\":\"plug\",\"pages\":[\"oss/javascript/integrations/chat/index\",\"oss/javascript/integrations/tools/index\",\"oss/javascript/integrations/llms/index\",\"oss/javascript/integrations/middleware/index\",\"oss/javascript/integrations/stores/index\",\"oss/javascript/integrations/document_transformers/index\",\"oss/javascript/integrations/llm_caching/index\",\"oss/javascript/integrations/callbacks/index\"]},{\"group\":\"RAG integrations\",\"icon\":\"database\",\"pages\":[\"oss/javascript/integrations/retrievers/index\",\"oss/javascript/integrations/splitters/index\",\"oss/javascript/integrations/text_embedding/index\",\"oss/javascript/integrations/vectorstores/index\",\"oss/javascript/integrations/document_loaders/index\",\"oss/javascript/integrations/stores/index\"]}]},{\"tab\":\"Learn\",\"pages\":[\"oss/javascript/learn\",{\"group\":\"Tutorials\",\"icon\":\"code\",\"pages\":[{\"group\":\"LangChain\",\"expanded\":true,\"pages\":[\"oss/javascript/langchain/knowledge-base\",\"oss/javascript/langchain/rag\",\"oss/javascript/langchain/sql-agent\",\"oss/javascript/langchain/voice-agent\"]},{\"group\":\"Multi-agent\",\"expanded\":true,\"pages\":[\"oss/javascript/langchain/multi-agent/subagents-personal-assistant\",\"oss/javascript/langchain/multi-agent/router-knowledge-base\"]},{\"group\":\"LangGraph\",\"expanded\":true,\"pages\":[\"oss/javascript/langgraph/agentic-rag\"]}]},{\"group\":\"Conceptual overviews\",\"icon\":\"book\",\"pages\":[\"oss/javascript/langchain/component-architecture\",\"oss/javascript/concepts/memory\",\"oss/javascript/concepts/context\",\"oss/javascript/langgraph/graph-api\",\"oss/javascript/langgraph/functional-api\"]},{\"group\":\"LangChain Academy\",\"icon\":\"graduation-cap\",\"pages\":[\"oss/javascript/langchain/academy\"]},{\"group\":\"Additional resources\",\"icon\":\"list\",\"pages\":[\"oss/javascript/langgraph/case-studies\",\"oss/javascript/langchain/get-help\"]}]},{\"tab\":\"Reference\",\"pages\":[\"oss/javascript/reference/overview\",{\"group\":\"Reference\",\"pages\":[\"oss/javascript/reference/langchain-javascript\",\"oss/javascript/reference/langgraph-javascript\",\"oss/javascript/reference/deepagents-javascript\"]},{\"group\":\"Errors\",\"pages\":[\"oss/javascript/common-errors\"]},{\"group\":\"Releases\",\"pages\":[\"oss/javascript/versioning\",\"oss/javascript/releases/changelog\",{\"group\":\"Releases\",\"pages\":[\"oss/javascript/releases/langchain-v1\",\"oss/javascript/releases/langgraph-v1\"]},{\"group\":\"Migration guides\",\"pages\":[\"oss/javascript/migrate/langchain-v1\",\"oss/javascript/migrate/langgraph-v1\"]}]},{\"group\":\"Policies\",\"pages\":[\"oss/javascript/release-policy\",\"oss/javascript/security-policy\"]}]},{\"tab\":\"Contribute\",\"pages\":[\"oss/javascript/contributing/overview\",{\"group\":\"Contribute\",\"icon\":\"heart-circle-plus\",\"pages\":[\"oss/javascript/contributing/documentation\",\"oss/javascript/contributing/code\",{\"group\":\"Integrations\",\"pages\":[\"oss/javascript/contributing/integrations-langchain\",\"oss/javascript/contributing/implement-langchain\",\"oss/javascript/contributing/standard-tests-langchain\",\"oss/javascript/contributing/publish-langchain\",\"oss/javascript/contributing/comarketing\"]}]}]}]}]},{\"product\":\"LangSmith\",\"icon\":\"screwdriver-wrench\",\"description\":\"LLM observability, evaluation, and deployment\",\"tabs\":[{\"tab\":\"Get started\",\"pages\":[\"langsmith/home\",\"langsmith/pricing-plans\",\"langsmith/create-account-api-key\",{\"group\":\"Account administration\",\"pages\":[\"langsmith/administration-overview\",\"langsmith/set-up-hierarchy\",\"langsmith/workload-isolation\",\"langsmith/manage-organization-by-api\",\"langsmith/billing\",\"langsmith/set-up-resource-tags\",\"langsmith/user-management\"]},{\"group\":\"Additional resources\",\"pages\":[\"langsmith/polly\",{\"group\":\"Data management\",\"pages\":[\"langsmith/data-storage-and-privacy\",\"langsmith/data-purging-compliance\"]},{\"group\":\"Access control \u0026 Authentication\",\"pages\":[\"langsmith/rbac\",\"langsmith/organization-workspace-operations\",\"langsmith/authentication-methods\"]},\"langsmith/scalability-and-resilience\",\"langsmith/faq\",\"langsmith/regions-faq\",\"langsmith/pricing-faq\",\"langsmith/status\"]}]},{\"tab\":\"Observability\",\"pages\":[\"langsmith/observability\",\"langsmith/observability-quickstart\",\"langsmith/observability-concepts\",\"langsmith/observability-llm-tutorial\",{\"group\":\"Tracing setup\",\"pages\":[{\"group\":\"Integrations\",\"pages\":[\"langsmith/integrations\",\"langsmith/trace-with-langchain\",\"langsmith/trace-with-langgraph\",\"langsmith/trace-anthropic\",\"langsmith/trace-openai\",\"langsmith/trace-with-autogen\",\"langsmith/trace-claude-agent-sdk\",\"langsmith/trace-claude-code\",\"langsmith/trace-with-crewai\",\"langsmith/trace-with-google-adk\",\"langsmith/trace-with-instructor\",\"langsmith/trace-with-openai-agents-sdk\",\"langsmith/trace-with-opentelemetry\",\"langsmith/trace-with-pydantic-ai\",\"langsmith/trace-with-semantic-kernel\",\"langsmith/trace-with-vercel-ai-sdk\",\"langsmith/trace-with-livekit\",\"langsmith/trace-with-pipecat\"]},{\"group\":\"Manual instrumentation\",\"pages\":[\"langsmith/annotate-code\",\"langsmith/trace-with-api\",\"langsmith/log-llm-trace\",\"langsmith/log-retriever-trace\",\"langsmith/ls-metadata-parameters\",\"langsmith/upload-files-with-traces\"]},\"langsmith/threads\"]},{\"group\":\"Configuration \u0026 troubleshooting\",\"pages\":[{\"group\":\"Project \u0026 environment settings\",\"pages\":[\"langsmith/log-traces-to-project\",\"langsmith/trace-without-env-vars\",\"langsmith/sample-traces\"]},\"langsmith/cost-tracking\",{\"group\":\"Advanced tracing techniques\",\"pages\":[\"langsmith/distributed-tracing\",\"langsmith/serverless-environments\",\"langsmith/log-multimodal-traces\",\"langsmith/trace-generator-functions\"]},{\"group\":\"Data \u0026 privacy\",\"pages\":[\"langsmith/add-metadata-tags\",\"langsmith/mask-inputs-outputs\"]},{\"group\":\"Troubleshooting guides\",\"pages\":[\"langsmith/nest-traces\",\"langsmith/troubleshooting-variable-caching\",\"langsmith/collector-proxy\"]}]},{\"group\":\"Viewing \u0026 managing traces\",\"pages\":[\"langsmith/filter-traces-in-application\",\"langsmith/export-traces\",\"langsmith/compare-traces\",\"langsmith/share-trace\",\"langsmith/langsmith-fetch\",\"langsmith/platform-logs\",\"langsmith/data-export\"]},{\"group\":\"Automations\",\"pages\":[\"langsmith/rules\",\"langsmith/webhooks\"]},{\"group\":\"Feedback \u0026 evaluation\",\"pages\":[\"langsmith/attach-user-feedback\",\"langsmith/online-evaluations\"]},{\"group\":\"Monitoring \u0026 alerting\",\"pages\":[\"langsmith/dashboards\",\"langsmith/alerts\",\"langsmith/alerts-webhook\",\"langsmith/insights\"]},{\"group\":\"Data type reference\",\"pages\":[\"langsmith/run-data-format\",\"langsmith/feedback-data-format\",\"langsmith/trace-query-syntax\"]}]},{\"tab\":\"Evaluation\",\"pages\":[\"langsmith/evaluation\",\"langsmith/evaluation-quickstart\",\"langsmith/evaluation-concepts\",\"langsmith/evaluation-approaches\",{\"group\":\"Datasets\",\"pages\":[{\"group\":\"Create a dataset\",\"pages\":[\"langsmith/manage-datasets-in-application\",\"langsmith/manage-datasets-programmatically\"]},\"langsmith/manage-datasets\",\"langsmith/custom-output-rendering\"]},{\"group\":\"Set up evaluations\",\"pages\":[{\"group\":\"Run an evaluation\",\"pages\":[\"langsmith/evaluate-llm-application\",\"langsmith/run-evaluation-from-prompt-playground\",\"langsmith/prebuilt-evaluators\"]},{\"group\":\"Evaluation types\",\"pages\":[\"langsmith/evaluation-types\",\"langsmith/code-evaluator\",\"langsmith/llm-as-judge\",\"langsmith/composite-evaluators\",\"langsmith/summary\",\"langsmith/evaluate-pairwise\"]},{\"group\":\"Frameworks \u0026 integrations\",\"pages\":[\"langsmith/evaluation-async\",\"langsmith/pytest\",\"langsmith/vitest-jest\",\"langsmith/run-evals-api-only\"]},{\"group\":\"Evaluation techniques\",\"pages\":[\"langsmith/experiment-configuration\",\"langsmith/define-target-function\",\"langsmith/evaluate-on-intermediate-steps\",\"langsmith/multiple-scores\",\"langsmith/metric-type\",\"langsmith/bind-evaluator-to-dataset\",\"langsmith/repetition\",\"langsmith/rate-limiting\",\"langsmith/local\",\"langsmith/read-local-experiment-results\",\"langsmith/langchain-runnable\",\"langsmith/evaluate-graph\",\"langsmith/evaluate-existing-experiment\",\"langsmith/evaluate-with-attachments\",\"langsmith/multi-turn-simulation\",\"langsmith/trajectory-evals\"]},{\"group\":\"Improve evaluators\",\"pages\":[\"langsmith/improve-judge-evaluator-feedback\",\"langsmith/create-few-shot-evaluators\",\"langsmith/index-datasets-for-dynamic-few-shot-example-selection\"]},{\"group\":\"Tutorials\",\"pages\":[\"langsmith/evaluate-chatbot-tutorial\",\"langsmith/evaluate-rag-tutorial\",\"langsmith/test-react-agent-pytest\",\"langsmith/evaluate-complex-agent\",\"langsmith/run-backtests-new-agent\"]}]},{\"group\":\"Analyze experiment results\",\"pages\":[\"langsmith/analyze-an-experiment\",\"langsmith/compare-experiment-results\",\"langsmith/filter-experiments-ui\",\"langsmith/fetch-perf-metrics-experiment\",\"langsmith/upload-existing-experiments\"]},{\"group\":\"Annotation \u0026 human feedback\",\"pages\":[\"langsmith/annotation-queues\",\"langsmith/set-up-feedback-criteria\",\"langsmith/annotate-traces-inline\",\"langsmith/audit-evaluator-scores\"]},{\"group\":\"Common data types\",\"pages\":[\"langsmith/example-data-format\",\"langsmith/dataset-json-types\",\"langsmith/dataset-transformations\"]}]},{\"tab\":\"Prompt engineering\",\"pages\":[\"langsmith/prompt-engineering\",\"langsmith/prompt-engineering-quickstart\",\"langsmith/prompt-engineering-concepts\",{\"group\":\"Create and update prompts\",\"pages\":[\"langsmith/create-a-prompt\",\"langsmith/manage-prompts\",\"langsmith/manage-prompts-programmatically\",\"langsmith/managing-model-configurations\",\"langsmith/use-tools\",\"langsmith/multimodal-content\",\"langsmith/write-prompt-with-ai\",{\"group\":\"Connect to models\",\"pages\":[\"langsmith/custom-openai-compliant-model\",\"langsmith/custom-endpoint\"]}]},{\"group\":\"Tutorials\",\"pages\":[\"langsmith/optimize-classifier\",\"langsmith/prompt-commit\",\"langsmith/multiple-messages\"]}]},{\"tab\":\"Deployment\",\"pages\":[\"langsmith/deployments\",\"langsmith/local-server\",\"langsmith/app-development\",\"langsmith/deployment-quickstart\",{\"group\":\"Configure app for deployment\",\"pages\":[\"langsmith/application-structure\",{\"group\":\"Setup\",\"pages\":[\"langsmith/setup-app-requirements-txt\",\"langsmith/setup-pyproject\",\"langsmith/setup-javascript\",\"langsmith/monorepo-support\"]},{\"group\":\"Deployment components\",\"pages\":[\"langsmith/components\",\"langsmith/agent-server\",\"langsmith/data-plane\",\"langsmith/control-plane\"]},\"langsmith/graph-rebuild\",\"langsmith/use-remote-graph\",\"langsmith/semantic-search\",\"langsmith/configure-ttl\",\"langsmith/agent-server-scale\",\"langsmith/cicd-pipeline-example\"]},{\"group\":\"Deployment guides\",\"pages\":[\"langsmith/deploy-to-cloud\",\"langsmith/deploy-with-control-plane\",\"langsmith/deploy-standalone-server\",\"langsmith/diagnostics-self-hosted\"]},{\"group\":\"App development\",\"pages\":[{\"group\":\"Data models\",\"pages\":[{\"group\":\"Assistants\",\"pages\":[\"langsmith/assistants\",\"langsmith/configuration-cloud\",\"langsmith/use-threads\"]},{\"group\":\"Runs\",\"pages\":[\"langsmith/background-run\",\"langsmith/same-thread\",\"langsmith/cron-jobs\",\"langsmith/stateless-runs\"]}]},{\"group\":\"Core capabilities\",\"pages\":[\"langsmith/streaming\",\"langsmith/add-human-in-the-loop\",\"langsmith/human-in-the-loop-time-travel\",\"langsmith/server-mcp\",\"langsmith/server-a2a\",\"langsmith/agent-server-distributed-tracing\",\"langsmith/use-webhooks\",{\"group\":\"Double-texting\",\"pages\":[\"langsmith/double-texting\",\"langsmith/interrupt-concurrent\",\"langsmith/rollback-concurrent\",\"langsmith/reject-concurrent\",\"langsmith/enqueue-concurrent\"]}]},{\"group\":\"Tutorials\",\"pages\":[\"langsmith/deploy-other-frameworks\",\"langsmith/use-stream-react\",\"langsmith/generative-ui-react\"]}]},{\"group\":\"Studio\",\"pages\":[\"langsmith/studio\",\"langsmith/quick-start-studio\",\"langsmith/use-studio\",\"langsmith/observability-studio\",\"langsmith/troubleshooting-studio\"]},{\"group\":\"Auth \u0026 access control\",\"pages\":[\"langsmith/auth\",\"langsmith/custom-auth\",\"langsmith/set-up-custom-auth\",\"langsmith/resource-auth\",\"langsmith/add-auth-server\",\"langsmith/openapi-security\",\"langsmith/agent-auth\"]},{\"group\":\"Server customization\",\"pages\":[\"langsmith/custom-lifespan\",\"langsmith/custom-middleware\",\"langsmith/custom-routes\",\"langsmith/encryption\",\"langsmith/configurable-headers\",\"langsmith/configurable-logs\"]}]},{\"tab\":\"Agent Builder\",\"pages\":[\"langsmith/agent-builder\",{\"group\":\"Get started\",\"pages\":[\"langsmith/agent-builder-essentials\",{\"group\":\"Templates\",\"pages\":[\"langsmith/agent-builder-templates\",\"langsmith/agent-builder-quickstart\"]},\"langsmith/agent-builder-setup\",\"langsmith/agent-builder-workspace-vs-private\"]},{\"group\":\"Tools and integrations\",\"pages\":[\"langsmith/agent-builder-tools\",\"langsmith/agent-builder-third-party-mcp-servers\",\"langsmith/agent-builder-slack-app\"]},{\"group\":\"Advanced\",\"pages\":[\"langsmith/agent-builder-auth-format\",\"langsmith/agent-builder-code\",\"langsmith/agent-builder-mcp-framework\"]}]},{\"tab\":\"Platform setup\",\"groups\":[{\"group\":\"Overview\",\"pages\":[\"langsmith/platform-setup\",\"langsmith/cloud\"]},{\"group\":\"Self-hosted cloud architecture\",\"pages\":[\"langsmith/aws-self-hosted\",\"langsmith/azure-self-hosted\",\"langsmith/gcp-self-hosted\"]},{\"group\":\"Hybrid\",\"pages\":[\"langsmith/hybrid\",\"langsmith/deploy-hybrid\"]},{\"group\":\"Self-hosted\",\"pages\":[\"langsmith/self-hosted\",{\"group\":\"Setup guides\",\"pages\":[{\"group\":\"LangSmith\",\"icon\":\"server\",\"pages\":[\"langsmith/kubernetes\",\"langsmith/docker\"]},\"langsmith/deploy-self-hosted-full-platform\",{\"group\":\"Manage an installation\",\"pages\":[\"langsmith/self-host-usage\",\"langsmith/self-host-upgrades\",\"langsmith/self-host-egress\",\"langsmith/self-host-organization-charts\",\"langsmith/langsmith-managed-clickhouse\",\"langsmith/self-host-ingress\",\"langsmith/self-host-mirroring-images\"]}]},{\"group\":\"Configuration\",\"pages\":[\"langsmith/self-host-scale\",\"langsmith/self-host-ttl\",\"langsmith/custom-docker\",\"langsmith/self-host-playground-environment-settings\",\"langsmith/troubleshooting\"]},{\"group\":\"Connect external services\",\"pages\":[\"langsmith/self-host-blob-storage\",\"langsmith/self-host-external-clickhouse\",\"langsmith/self-host-external-postgres\",\"langsmith/self-host-external-redis\"]},{\"group\":\"Platform auth \u0026 access control\",\"pages\":[\"langsmith/self-host-basic-auth\",\"langsmith/self-host-sso\",\"langsmith/self-host-user-management\",\"langsmith/self-host-custom-tls-certificates\",\"langsmith/self-host-using-an-existing-secret\"]},{\"group\":\"Self-hosted observability\",\"pages\":[\"langsmith/export-backend\",\"langsmith/langsmith-collector\",\"langsmith/observability-stack\"]},{\"group\":\"Scripts for management tasks\",\"pages\":[\"langsmith/script-delete-a-workspace\",\"langsmith/script-delete-an-organization\",\"langsmith/script-delete-traces\",\"langsmith/script-generate-clickhouse-stats\",\"langsmith/script-generate-query-stats\",\"langsmith/script-running-pg-support-queries\",\"langsmith/script-running-ch-support-queries\"]}]}]},{\"tab\":\"Reference\",\"pages\":[\"langsmith/reference\",\"langsmith/smith-python-sdk\",\"langsmith/smith-js-ts-sdk\",\"langsmith/langgraph-python-sdk\",\"langsmith/langgraph-js-ts-sdk\",\"langsmith/smith-api-ref\",{\"group\":\"LangSmith Deployment\",\"pages\":[{\"group\":\"Agent Server API\",\"pages\":[\"langsmith/server-api-ref\",{\"group\":\"Assistants\",\"pages\":[\"langsmith/agent-server-api/assistants/create-assistant\",\"langsmith/agent-server-api/assistants/search-assistants\",\"langsmith/agent-server-api/assistants/count-assistants\",\"langsmith/agent-server-api/assistants/get-assistant\",\"langsmith/agent-server-api/assistants/delete-assistant\",\"langsmith/agent-server-api/assistants/patch-assistant\",\"langsmith/agent-server-api/assistants/get-assistant-graph\",\"langsmith/agent-server-api/assistants/get-assistant-subgraphs\",\"langsmith/agent-server-api/assistants/get-assistant-subgraphs-by-namespace\",\"langsmith/agent-server-api/assistants/get-assistant-schemas\",\"langsmith/agent-server-api/assistants/get-assistant-versions\",\"langsmith/agent-server-api/assistants/set-latest-assistant-version\"]},{\"group\":\"Threads\",\"pages\":[\"langsmith/agent-server-api/threads/create-thread\",\"langsmith/agent-server-api/threads/search-threads\",\"langsmith/agent-server-api/threads/count-threads\",\"langsmith/agent-server-api/threads/prune-threads\",\"langsmith/agent-server-api/threads/get-thread-state\",\"langsmith/agent-server-api/threads/update-thread-state\",\"langsmith/agent-server-api/threads/get-thread-state-at-checkpoint\",\"langsmith/agent-server-api/threads/get-thread-state-at-checkpoint-1\",\"langsmith/agent-server-api/threads/get-thread-history\",\"langsmith/agent-server-api/threads/get-thread-history-post\",\"langsmith/agent-server-api/threads/copy-thread\",\"langsmith/agent-server-api/threads/get-thread\",\"langsmith/agent-server-api/threads/delete-thread\",\"langsmith/agent-server-api/threads/patch-thread\",\"langsmith/agent-server-api/threads/join-thread-stream\"]},{\"group\":\"Thread Runs\",\"pages\":[\"langsmith/agent-server-api/thread-runs/list-runs\",\"langsmith/agent-server-api/thread-runs/create-background-run\",\"langsmith/agent-server-api/thread-runs/create-run-stream-output\",\"langsmith/agent-server-api/thread-runs/create-run-wait-for-output\",\"langsmith/agent-server-api/thread-runs/get-run\",\"langsmith/agent-server-api/thread-runs/delete-run\",\"langsmith/agent-server-api/thread-runs/join-run\",\"langsmith/agent-server-api/thread-runs/join-run-stream\",\"langsmith/agent-server-api/thread-runs/cancel-run\",\"langsmith/agent-server-api/thread-runs/cancel-runs\"]},{\"group\":\"Crons (Plus tier)\",\"pages\":[\"langsmith/agent-server-api/crons-plus-tier/create-thread-cron\",\"langsmith/agent-server-api/crons-plus-tier/create-cron\",\"langsmith/agent-server-api/crons-plus-tier/search-crons\",\"langsmith/agent-server-api/crons-plus-tier/count-crons\",\"langsmith/agent-server-api/crons-plus-tier/delete-cron\"]},{\"group\":\"Stateless Runs\",\"pages\":[\"langsmith/agent-server-api/stateless-runs/create-run-stream-output\",\"langsmith/agent-server-api/stateless-runs/create-run-wait-for-output\",\"langsmith/agent-server-api/stateless-runs/create-background-run\",\"langsmith/agent-server-api/stateless-runs/create-run-batch\"]},{\"group\":\"Store\",\"pages\":[\"langsmith/agent-server-api/store/retrieve-a-single-item\",\"langsmith/agent-server-api/store/store-or-update-an-item\",\"langsmith/agent-server-api/store/delete-an-item\",\"langsmith/agent-server-api/store/search-for-items-within-a-namespace-prefix\",\"langsmith/agent-server-api/store/list-namespaces-with-optional-match-conditions\"]},{\"group\":\"A2A\",\"pages\":[\"langsmith/agent-server-api/a2a/a2a-post\"]},{\"group\":\"MCP\",\"pages\":[\"langsmith/agent-server-api/mcp/mcp-get\",\"langsmith/agent-server-api/mcp/mcp-post\",\"langsmith/agent-server-api/mcp/terminate-session\"]},{\"group\":\"System\",\"pages\":[\"langsmith/agent-server-api/system/server-information\",\"langsmith/agent-server-api/system/system-metrics\",\"langsmith/agent-server-api/system/health-check\"]}]},{\"group\":\"Control Plane API\",\"pages\":[\"langsmith/api-ref-control-plane\",{\"group\":\"Integrations (v1)\",\"pages\":[\"api-reference/integrations-v1/list-github-integrations\",\"api-reference/integrations-v1/list-github-repositories\"]},{\"group\":\"Deployments (v2)\",\"pages\":[\"api-reference/deployments-v2/list-deployments\",\"api-reference/deployments-v2/create-deployment\",\"api-reference/deployments-v2/get-deployment\",\"api-reference/deployments-v2/delete-deployment\",\"api-reference/deployments-v2/patch-deployment\",\"api-reference/deployments-v2/list-revisions\",\"api-reference/deployments-v2/get-revision\",\"api-reference/deployments-v2/redeploy-revision\"]},{\"group\":\"Listeners (v2)\",\"pages\":[\"api-reference/listeners-v2/list-listeners\",\"api-reference/listeners-v2/create-listener\",\"api-reference/listeners-v2/get-listener\",\"api-reference/listeners-v2/delete-listener\",\"api-reference/listeners-v2/patch-listener\"]},{\"group\":\"Auth Service (v2)\",\"pages\":[\"api-reference/auth-service-v2/list-oauth-providers\",\"api-reference/auth-service-v2/create-oauth-provider\",\"api-reference/auth-service-v2/oauth-setup-callback\",\"api-reference/auth-service-v2/oauth-callback-get\",\"api-reference/auth-service-v2/oauth-callback\",\"api-reference/auth-service-v2/authenticate\",\"api-reference/auth-service-v2/wait-for-auth-completion\",\"api-reference/auth-service-v2/create-mcp-oauth-provider\",\"api-reference/auth-service-v2/get-oauth-provider\",\"api-reference/auth-service-v2/delete-oauth-provider\",\"api-reference/auth-service-v2/update-oauth-provider\",\"api-reference/auth-service-v2/check-oauth-token-exists\",\"api-reference/auth-service-v2/delete-oauth-tokens-for-user\"]}]},\"langsmith/cli\",\"langsmith/remote-graph\",\"langsmith/env-var\"]},{\"group\":\"Releases\",\"pages\":[\"langsmith/agent-server-changelog\",\"langsmith/self-hosted-changelog\",\"langsmith/release-versions\"]}]}]}]},\"footer\":{\"socials\":{\"github\":\"https://github.com/langchain-ai\",\"x\":\"https://x.com/LangChainAI\",\"linkedin\":\"https://www.linkedin.com/company/langchain/\",\"youtube\":\"https://www.youtube.com/@LangChain\"},\"links\":[{\"header\":\"Resources\",\"items\":[{\"label\":\"Forum\",\"href\":\"https://forum.langchain.com/\"},{\"label\":\"Changelog\",\"href\":\"https://changelog.langchain.com/\"},{\"label\":\"LangChain Academy\",\"href\":\"https://academy.langchain.com/\"},{\"label\":\"Trust Center\",\"href\":\"https://trust.langchain.com/\"}]},{\"header\":\"Company\",\"items\":[{\"label\":\"About\",\"href\":\"https://langchain.com/about\"},{\"label\":\"Careers\",\"href\":\"https://langchain.com/careers\"},{\"label\":\"Blog\",\"href\":\"https://blog.langchain.com/\"}]}]},\"seo\":{\"metatags\":{\"canonical\":\"https://docs.langchain.com\",\"google-site-verification\":\"9_2KHeJwmEdwgncBRk1MsKxriZz7Sc21EJdbfCxkTEo\"}},\"fonts\":{\"heading\":{\"family\":\"Manrope\"}},\"styling\":{\"eyebrows\":\"breadcrumbs\",\"latex\":true},\"redirects\":[{\"source\":\"/langchain\",\"destination\":\"/oss/python/langchain/overview\"},{\"source\":\"/langgraph\",\"destination\":\"/oss/python/langgraph/overview\"},{\"source\":\"/deepagents\",\"destination\":\"/oss/python/deepagents/overview\"},{\"source\":\"/langsmith\",\"destination\":\"/langsmith/home\"},{\"source\":\"/js/langchain\",\"destination\":\"/oss/javascript/langchain/overview\"},{\"source\":\"/js/langgraph\",\"destination\":\"/oss/javascript/langgraph/overview\"},{\"source\":\"/python/langchain\",\"destination\":\"/oss/python/langchain/overview\"},{\"source\":\"/python/langgraph\",\"destination\":\"/oss/python/langgraph/overview\"},{\"source\":\"/python/deepagents\",\"destination\":\"/oss/python/deepagents/overview\"},{\"source\":\"/javascript/langchain\",\"destination\":\"/oss/javascript/langchain/overview\"},{\"source\":\"/javascript/langgraph\",\"destination\":\"/oss/javascript/langgraph/overview\"},{\"source\":\"/langsmith/cloud-architecture-and-scalability\",\"destination\":\"/langsmith/cloud#cloud-architecture-and-scalability\"},{\"source\":\"/langsmith/reference-overview\",\"destination\":\"/langsmith/home\"},{\"source\":\"/langsmith/hosting\",\"destination\":\"/langsmith/platform-setup\"},{\"source\":\"/oss/python/langchain-agents\",\"destination\":\"/oss/python/langchain/agents\"},{\"source\":\"/oss/javascript/langchain-agents\",\"destination\":\"/oss/javascript/langchain/agents\"},{\"source\":\"/oss/python/langchain-models\",\"destination\":\"/oss/python/langchain/models\"},{\"source\":\"/oss/javascript/langchain-models\",\"destination\":\"/oss/javascript/langchain/models\"},{\"source\":\"/oss/python/langchain-messages\",\"destination\":\"/oss/python/langchain/messages\"},{\"source\":\"/oss/javascript/langchain-messages\",\"destination\":\"/oss/javascript/langchain/messages\"},{\"source\":\"/oss/python/langchain-tools\",\"destination\":\"/oss/python/langchain/tools\"},{\"source\":\"/oss/javascript/langchain-tools\",\"destination\":\"/oss/javascript/langchain/tools\"},{\"source\":\"/oss/python/langchain-memory\",\"destination\":\"/oss/python/langchain/short-term-memory\"},{\"source\":\"/oss/javascript/langchain-memory\",\"destination\":\"/oss/javascript/langchain/short-term-memory\"},{\"source\":\"/oss/python/langchain-streaming\",\"destination\":\"/oss/python/langchain/streaming\"},{\"source\":\"/oss/javascript/langchain-streaming\",\"destination\":\"/oss/javascript/langchain/streaming\"},{\"source\":\"/oss/python/releases-v1\",\"destination\":\"/oss/python/releases/langchain-v1\"},{\"source\":\"/oss/javascript/releases-v1\",\"destination\":\"/oss/javascript/releases/langchain-v1\"},{\"source\":\"/oss/python/langgraph/human-in-the-loop\",\"destination\":\"/oss/python/langgraph/interrupts\"},{\"source\":\"/oss/javascript/langgraph/human-in-the-loop\",\"destination\":\"/oss/javascript/langgraph/interrupts\"},{\"source\":\"/langgraph-platform/index\",\"destination\":\"/langsmith/deployments\"},{\"source\":\"/langsmith/langgraph-platform-logs\",\"destination\":\"/langsmith/platform-logs\"},{\"source\":\"/langgraph-platform/deployment-options\",\"destination\":\"/langsmith/platform-setup\"},{\"source\":\"/langgraph-platform/langgraph-studio\",\"destination\":\"/langsmith/studio\"},{\"source\":\"/langgraph-platform/langgraph-cli\",\"destination\":\"/langsmith/cli\"},{\"source\":\"/langsmith/api-ref\",\"destination\":\"/langsmith/smith-api-ref\"},{\"source\":\"/langsmith/js-ts-sdk\",\"destination\":\"/langsmith/smith-js-ts-sdk\"},{\"source\":\"/langsmith/python-sdk\",\"destination\":\"/langsmith/smith-python-sdk\"},{\"source\":\"/langgraph-platform/egress-metrics-metadata\",\"destination\":\"/langsmith/self-host-egress\"},{\"source\":\"/langgraph-platform/why-langgraph\",\"destination\":\"/langsmith/app-development\"},{\"source\":\"/langgraph-platform/:path*\",\"destination\":\"/langsmith/:path*\"},{\"source\":\"/oss/python/deepagents/index\",\"destination\":\"/oss/python/deepagents/overview\"},{\"source\":\"/oss/python/integrations/document_loaders/azure_blob_storage_container\",\"destination\":\"/oss/python/integrations/document_loaders/azure_blob_storage\"},{\"source\":\"/oss/python/integrations/document_loaders/azure_blob_storage_file\",\"destination\":\"/oss/python/integrations/document_loaders/azure_blob_storage\"},{\"source\":\"oss/python/langgraph/GRAPH_RECURSION_LIMIT\",\"destination\":\"oss/python/langgraph/errors/GRAPH_RECURSION_LIMIT\"},{\"source\":\"oss/python/langgraph/INVALID_CHAT_HISTORY\",\"destination\":\"oss/python/langgraph/errors/INVALID_CHAT_HISTORY\"},{\"source\":\"oss/python/langgraph/INVALID_CONCURRENT_GRAPH_UPDATE\",\"destination\":\"oss/python/langgraph/errors/INVALID_CONCURRENT_GRAPH_UPDATE\"},{\"source\":\"oss/python/langgraph/INVALID_GRAPH_NODE_RETURN_VALUE\",\"destination\":\"oss/python/langgraph/errors/INVALID_GRAPH_NODE_RETURN_VALUE\"},{\"source\":\"oss/python/langgraph/MULTIPLE_SUBGRAPHS\",\"destination\":\"oss/python/langgraph/errors/MULTIPLE_SUBGRAPHS\"},{\"source\":\"oss/python/langgraph/MISSING_CHECKPOINTER\",\"destination\":\"oss/python/langgraph/errors/MISSING_CHECKPOINTER\"},{\"source\":\"oss/javascript/langgraph/GRAPH_RECURSION_LIMIT\",\"destination\":\"oss/javascript/langgraph/errors/GRAPH_RECURSION_LIMIT\"},{\"source\":\"oss/javascript/langgraph/INVALID_CHAT_HISTORY\",\"destination\":\"oss/javascript/langgraph/errors/INVALID_CHAT_HISTORY\"},{\"source\":\"oss/javascript/langgraph/INVALID_CONCURRENT_GRAPH_UPDATE\",\"destination\":\"oss/javascript/langgraph/errors/INVALID_CONCURRENT_GRAPH_UPDATE\"},{\"source\":\"oss/javascript/langgraph/INVALID_GRAPH_NODE_RETURN_VALUE\",\"destination\":\"oss/javascript/langgraph/errors/INVALID_GRAPH_NODE_RETURN_VALUE\"},{\"source\":\"oss/javascript/langgraph/MULTIPLE_SUBGRAPHS\",\"destination\":\"oss/javascript/langgraph/errors/MULTIPLE_SUBGRAPHS\"},{\"source\":\"oss/javascript/langgraph/MISSING_CHECKPOINTER\",\"destination\":\"oss/javascript/langgraph/errors/MISSING_CHECKPOINTER\"},{\"source\":\"oss/python/langgraph/common-errors\",\"destination\":\"oss/python/common-errors\"},{\"source\":\"oss/javascript/langgraph/common-errors\",\"destination\":\"oss/javascript/common-errors\"},{\"source\":\"oss/python/langchain/INVALID_PROMPT_INPUT\",\"destination\":\"oss/python/langchain/errors/INVALID_PROMPT_INPUT\"},{\"source\":\"oss/python/langchain/MODEL_AUTHENTICATION\",\"destination\":\"oss/python/langchain/errors/MODEL_AUTHENTICATION\"},{\"source\":\"oss/python/langchain/MODEL_NOT_FOUND\",\"destination\":\"oss/python/langchain/errors/MODEL_NOT_FOUND\"},{\"source\":\"oss/python/langchain/MODEL_RATE_LIMIT\",\"destination\":\"oss/python/langchain/errors/MODEL_RATE_LIMIT\"},{\"source\":\"oss/python/langchain/MESSAGE_COERCION_FAILURE\",\"destination\":\"oss/python/langchain/errors/MESSAGE_COERCION_FAILURE\"},{\"source\":\"oss/python/langchain/INVALID_TOOL_RESULTS\",\"destination\":\"oss/python/langchain/errors/INVALID_TOOL_RESULTS\"},{\"source\":\"oss/python/langchain/OUTPUT_PARSING_FAILURE\",\"destination\":\"oss/python/langchain/errors/OUTPUT_PARSING_FAILURE\"},{\"source\":\"oss/javascript/langchain/INVALID_PROMPT_INPUT\",\"destination\":\"oss/javascript/langchain/errors/INVALID_PROMPT_INPUT\"},{\"source\":\"oss/javascript/langchain/MODEL_AUTHENTICATION\",\"destination\":\"oss/javascript/langchain/errors/MODEL_AUTHENTICATION\"},{\"source\":\"oss/javascript/langchain/MODEL_NOT_FOUND\",\"destination\":\"oss/javascript/langchain/errors/MODEL_NOT_FOUND\"},{\"source\":\"oss/javascript/langchain/MODEL_RATE_LIMIT\",\"destination\":\"oss/javascript/langchain/errors/MODEL_RATE_LIMIT\"},{\"source\":\"oss/javascript/langchain/MESSAGE_COERCION_FAILURE\",\"destination\":\"oss/javascript/langchain/errors/MESSAGE_COERCION_FAILURE\"},{\"source\":\"oss/javascript/langchain/INVALID_TOOL_RESULTS\",\"destination\":\"oss/javascript/langchain/errors/INVALID_TOOL_RESULTS\"},{\"source\":\"oss/javascript/langchain/OUTPUT_PARSING_FAILURE\",\"destination\":\"oss/javascript/langchain/errors/OUTPUT_PARSING_FAILURE\"},{\"source\":\"/langsmith/langgraph-server\",\"destination\":\"/langsmith/agent-server\"},{\"source\":\"/langsmith/langgraph-server-changelog\",\"destination\":\"/langsmith/agent-server-changelog\"},{\"source\":\"/oss/python/langchain/middleware\",\"destination\":\"/oss/python/langchain/middleware/overview\"},{\"source\":\"/oss/javascript/langchain/middleware\",\"destination\":\"/oss/javascript/langchain/middleware/overview\"},{\"source\":\"/oss/python/integrations/tools/toolbox\",\"destination\":\"/oss/python/integrations/tools/mcp_toolbox\"},{\"source\":\"/oss/integrations/tools/toolbox\",\"destination\":\"/oss/integrations/tools/mcp_toolbox\"},{\"source\":\"/oss/python/integrations/tools/gmail\",\"destination\":\"/oss/python/integrations/tools/google_gmail\"},{\"source\":\"/oss/integrations/tools/gmail\",\"destination\":\"/oss/integrations/tools/google_gmail\"},{\"source\":\"/oss/javascript/integrations/tools/gmail\",\"destination\":\"/oss/javascript/integrations/tools/google_gmail\"},{\"source\":\"/oss/python/integrations/chat_loaders/gmail\",\"destination\":\"/oss/python/integrations/chat_loaders/google_gmail\"},{\"source\":\"/oss/integrations/chat_loaders/gmail\",\"destination\":\"/oss/integrations/chat_loaders/google_gmail\"},{\"source\":\"/oss/python/integrations/vectorstores/scann\",\"destination\":\"/oss/python/integrations/vectorstores/google_scann\"},{\"source\":\"/oss/integrations/vectorstores/scann\",\"destination\":\"/oss/integrations/vectorstores/google_scann\"},{\"source\":\"/oss/python/integrations/chat/google_vertex_ai_palm\",\"destination\":\"/oss/python/integrations/chat/google_vertex_ai\"},{\"source\":\"/oss/integrations/chat/google_vertex_ai_palm\",\"destination\":\"/oss/integrations/chat/google_vertex_ai\"},{\"source\":\"/oss/python/integrations/text_embedding/google_vertex_ai_palm\",\"destination\":\"/oss/python/integrations/text_embedding/google_vertex_ai\"},{\"source\":\"/oss/integrations/text_embedding/google_vertex_ai_palm\",\"destination\":\"/oss/integrations/text_embedding/google_vertex_ai\"},{\"source\":\"/oss/python/integrations/llms/google_vertex_ai_palm\",\"destination\":\"/oss/python/integrations/llms/google_vertex_ai\"},{\"source\":\"/oss/integrations/llms/google_vertex_ai_palm\",\"destination\":\"/oss/integrations/llms/google_vertex_ai\"},{\"source\":\"/oss/javascript/integrations/text_embedding/google_generativeai\",\"destination\":\"/oss/javascript/integrations/text_embedding/google_generative_ai\"},{\"source\":\"/oss/integrations/text_embedding/google_generativeai\",\"destination\":\"/oss/integrations/text_embedding/google_generative_ai\"},{\"source\":\"/langsmith/agent-server-api-ref\",\"destination\":\"/langsmith/server-api-ref\"},{\"source\":\"/oss/python/integrations/llms/google_ai\",\"destination\":\"/oss/python/integrations/llms/google_generative_ai\"},{\"source\":\"/oss/python/langchain/supervisor\",\"destination\":\"/oss/python/langchain/multi-agent/subagents-personal-assistant\"},{\"source\":\"/oss/javascript/langchain/supervisor\",\"destination\":\"/oss/javascript/langchain/multi-agent/subagents-personal-assistant\"}],\"integrations\":{\"gtm\":{\"tagId\":\"GTM-MBBX68ST\"}},\"errors\":{\"404\":{\"redirect\":false,\"title\":\"Page not found\",\"description\":\"We couldn't find the page you were looking for.\"}},\"contextual\":{\"options\":[\"copy\",\"view\",{\"title\":\"llms.txt\",\"description\":\"Open llms.txt for this site\",\"icon\":\"file\",\"href\":\"https://docs.langchain.com/llms.txt\"},\"chatgpt\",\"claude\",\"mcp\",\"cursor\",\"vscode\"]},\"interaction\":{\"drilldown\":true}}}]\n"])</script><script>self.__next_f.push([1,"32:Tc98,"])</script><script>self.__next_f.push([1,"/* Make sidebar title heavier weight */\n#sidebar-title {\n    font-weight: 600 !important;\n  }\n\n/* Inline code links have same color and underline as regular links */\na code,\na[href] code {\n  color: inherit !important;\n  text-decoration: none !important; /* Remove underline from code itself */\n  padding: 0 !important; /* Remove padding to prevent gaps in parent link underline */\n}\n\n/* Ensure callout links and lists match callout text formatting */\n.callout a,\n[class*=\"callout\"] a {\n  font-size: inherit !important; /* Match callout text size */\n  color: inherit !important; /* Match callout text color */\n}\n\n.callout ul,\n.callout ol,\n.callout li,\n[class*=\"callout\"] ul,\n[class*=\"callout\"] ol,\n[class*=\"callout\"] li {\n  font-size: inherit !important; /* Match callout text size */\n  color: inherit !important; /* Match callout text color */\n  line-height: inherit !important; /* Match callout line height */\n}\n\n.callout p,\n[class*=\"callout\"] p {\n  font-size: inherit !important; /* Match callout text size */\n  color: inherit !important; /* Match callout text color */\n}\n\n/* Ensure bold and italic text inherit callout formatting */\n.callout strong,\n.callout b,\n.callout em,\n.callout i,\n[class*=\"callout\"] strong,\n[class*=\"callout\"] b,\n[class*=\"callout\"] em,\n[class*=\"callout\"] i {\n  font-size: inherit !important; /* Match callout text size */\n  color: inherit !important; /* Match callout text color */\n}\n\n/* Ensure mermaid diagrams are centered */\n.mermaid {\n    text-align: center;\n    display: flex;\n    justify-content: center;\n  }\n\n.mermaid .labelBkg {\n  background-color: white !important;\n  border: 1px solid #2F6868 !important;\n  border-radius: 4px !important;\n  padding: 0 4px !important;\n}\n.mermaid .labelBkg:not(:has(p)) {\n  display: none !important;\n}\n.mermaid .edgeLabel {\n  color: #1C3C3C !important;\n}\n.dark .mermaid .labelBkg {\n  background-color: #1C3C3C !important;\n  border-color: #84C4C0 !important;\n}\n.dark .mermaid .edgeLabel {\n  color: #84C4C0 !important;\n}\n\n\n/* Fix vertical alignment in table cells with mixed content (text and images) */\n.prose table td, article table td, .markdown table td, .content table td, [class*=\"prose\"] table td,\n.prose table th, article table th, .markdown table th, .content table th, [class*=\"prose\"] table th {\n  vertical-align: middle !important; /* Center align content vertically */\n  line-height: 1.5 !important; /* Consistent line height */\n}\n\n/* Hide pagination */\n#pagination {\n    display: none;\n  }\n\n/* Improve banner link readability in light mode */\n#banner a {\n  color: inherit !important;\n  text-decoration: none !important;\n}\n\n/* Compact first column for multi agent pattern comparison tables (no horizontal scroll) */\n.compact-first-col [data-table-wrapper] {\n  overflow-x: visible !important;\n}\n\n.compact-first-col table {\n  table-layout: auto !important;\n  width: 100% !important;\n}\n\n.compact-first-col table td,\n.compact-first-col table th {\n  min-width: 0 !important;\n}\n\n.compact-first-col table td:first-child,\n.compact-first-col table th:first-child {\n  width: 1% !important;\n  white-space: nowrap !important;\n}\n\n/* Hide auto-generated callouts on home page */\n.home-page ~ :is(.callout, [data-callout-type]) {\n  display: none !important;\n}\n\n"])</script><script>self.__next_f.push([1,"1b:[\"$\",\"$L2b\",null,{\"value\":{\"apiReferenceData\":{}},\"children\":[\"$\",\"$L2c\",null,{\"value\":{\"pageMetadata\":\"$17:props:pageMetadata\",\"lastModified\":\"2025-12-16T22:07:23.295Z\",\"description\":null,\"mdxExtracts\":{\"tableOfContents\":[],\"codeExamples\":{}},\"pageType\":\"$undefined\",\"panelMdxSource\":\"$undefined\",\"panelMdxSourceWithNoJs\":\"$undefined\"},\"children\":[\"$\",\"$L2d\",null,{\"pageMetadata\":\"$17:props:pageMetadata\",\"docsConfig\":\"$17:props:docsConfig\",\"mdxExtracts\":\"$1b:props:children:props:value:mdxExtracts\",\"apiReferenceData2\":\"$undefined\",\"children\":[\"$\",\"$L2e\",null,{\"children\":[[\"$\",\"$L2f\",null,{\"id\":\"_mintlify-page-mode-script\",\"strategy\":\"beforeInteractive\",\"dangerouslySetInnerHTML\":{\"__html\":\"document.documentElement.setAttribute('data-page-mode', 'custom');\"}}],[\"$\",\"$L30\",null,{\"theme\":\"aspen\"}],[\"$\",\"$L31\",null,{\"docsConfig\":\"$17:props:docsConfig\",\"pageMetadata\":\"$17:props:pageMetadata\"}],[[\"$\",\"style\",\"0\",{\"data-custom-css-index\":0,\"data-custom-css-path\":\"style.css\",\"dangerouslySetInnerHTML\":{\"__html\":\"$32\"}}]],[\"$L33\"],\"$L34\"]}]}]}]}]\n"])</script><script>self.__next_f.push([1,"35:I[36505,[],\"IconMark\"]\n"])</script><script>self.__next_f.push([1,"37:I[90964,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25263\",\"static/chunks/25263-1e30f64402644edf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"2870\",\"static/chunks/2870-43b3b296a96d0195.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"89841\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/%5B%5B...slug%5D%5D/page-024162cb87bbb1c5.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"MDXContentController\",1]\n"])</script><script>self.__next_f.push([1,"38:I[59646,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25263\",\"static/chunks/25263-1e30f64402644edf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"2870\",\"static/chunks/2870-43b3b296a96d0195.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"89841\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/%5B%5B...slug%5D%5D/page-024162cb87bbb1c5.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"default\",1]\n"])</script><script>self.__next_f.push([1,"24:[\"$\",\"link\",\"25\",{\"rel\":\"icon\",\"href\":\"/mintlify-assets/_mintlify/favicons/langchain-5e9cc07a/6qGJdyFkFFvLiKlZ/_generated/favicon/favicon-32x32.png\",\"type\":\"image/png\",\"sizes\":\"32x32\",\"media\":\"(prefers-color-scheme: light)\"}]\n25:[\"$\",\"link\",\"26\",{\"rel\":\"shortcut icon\",\"href\":\"/mintlify-assets/_mintlify/favicons/langchain-5e9cc07a/6qGJdyFkFFvLiKlZ/_generated/favicon/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"$undefined\",\"media\":\"(prefers-color-scheme: light)\"}]\n26:[\"$\",\"link\",\"27\",{\"rel\":\"icon\",\"href\":\"/mintlify-assets/_mintlify/favicons/langchain-5e9cc07a/6qGJdyFkFFvLiKlZ/_generated/favicon-dark/favicon-16x16.png\",\"type\":\"image/png\",\"sizes\":\"16x16\",\"media\":\"(prefers-color-scheme: dark)\"}]\n27:[\"$\",\"link\",\"28\",{\"rel\":\"icon\",\"href\":\"/mintlify-assets/_mintlify/favicons/langchain-5e9cc07a/6qGJdyFkFFvLiKlZ/_generated/favicon-dark/favicon-32x32.png\",\"type\":\"image/png\",\"sizes\":\"32x32\",\"media\":\"(prefers-color-scheme: dark)\"}]\n28:[\"$\",\"link\",\"29\",{\"rel\":\"shortcut icon\",\"href\":\"/mintlify-assets/_mintlify/favicons/langchain-5e9cc07a/6qGJdyFkFFvLiKlZ/_generated/favicon-dark/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"$undefined\",\"media\":\"(prefers-color-scheme: dark)\"}]\n29:[\"$\",\"$L35\",\"30\",{}]\n36:T1154,"])</script><script>self.__next_f.push([1,"/**\n * Language Toggle Script\n *\n * Enables smart navigation when switching between Python and TypeScript docs.\n * When a user clicks the language dropdown, this redirects them to the equivalent\n * page in the target language (preserving the section hash) instead of the default\n * overview page.\n *\n * How it works:\n * 1. Click listener detects language toggle clicks and stores current URL+hash\n * 2. History API interception (pushState/replaceState) and popstate/hashchange\n *    listeners detect when Mintlify's client-side routing changes the path\n * 3. On path change, check if we're switching languages and redirect to equivalent page\n */\n\n(function () {\n  \"use strict\";\n\n  const PYTHON_PREFIX = \"/oss/python/\";\n  const JS_PREFIX = \"/oss/javascript/\";\n\n  // Selector for language dropdown items (Python/TypeScript links)\n  const LANGUAGE_TOGGLE_SELECTOR = \"[data-dropdown-item]\";\n\n  let previousUrl = null;\n\n  /**\n   * Convert a path from one language to another\n   * e.g., /oss/javascript/foo â†’ /oss/python/foo\n   */\n  function getEquivalentPath(sourcePath, targetLang) {\n    const sourcePrefix = targetLang === \"python\" ? JS_PREFIX : PYTHON_PREFIX;\n    const targetPrefix = targetLang === \"python\" ? PYTHON_PREFIX : JS_PREFIX;\n\n    if (sourcePath.startsWith(sourcePrefix)) {\n      return targetPrefix + sourcePath.substring(sourcePrefix.length);\n    }\n    return null;\n  }\n\n  /**\n   * Detect which language a path belongs to\n   * Returns \"python\", \"javascript\", or null\n   */\n  function getPathLanguage(path) {\n    if (path.startsWith(PYTHON_PREFIX)) return \"python\";\n    if (path.startsWith(JS_PREFIX)) return \"javascript\";\n    return null;\n  }\n\n  /**\n   * Store current URL (path + hash) in memory\n   * Only stores language-specific pages\n   */\n  function updateCurrent() {\n    const lang = getPathLanguage(location.pathname);\n    if (lang) {\n      previousUrl = location.pathname + location.hash;\n    }\n  }\n\n  /**\n   * Check if we should redirect to an equivalent page in a different language\n   * This runs after every path change detected by the MutationObserver\n   */\n  function checkRedirect() {\n    const currentLang = getPathLanguage(location.pathname);\n    if (!currentLang) return;\n\n    if (!previousUrl) {\n      updateCurrent();\n      return;\n    }\n\n    // Split path and hash (e.g., \"/oss/python/foo#bar\" â†’ [\"/oss/python/foo\", \"bar\"])\n    const [prevPath, prevHash = \"\"] = previousUrl.split(\"#\");\n    const prevLang = getPathLanguage(prevPath);\n\n    // Only redirect if we're switching between languages\n    if (prevLang \u0026\u0026 prevLang !== currentLang) {\n      const equivalentPath = getEquivalentPath(prevPath, currentLang);\n\n      if (equivalentPath \u0026\u0026 equivalentPath !== location.pathname) {\n        // Clear previous URL before redirect to prevent redirect loops\n        previousUrl = null;\n\n        // Redirect with the hash from the previous page\n        location.replace(equivalentPath + (prevHash ? \"#\" + prevHash : \"\"));\n        return;\n      }\n    }\n\n    // If no redirect needed, store current location for next navigation\n    updateCurrent();\n  }\n\n  // Store current URL when language toggle is clicked\n  // This captures the hash before Mintlify's client-side routing changes the page\n  document.addEventListener(\n    \"click\",\n    function (e) {\n      const toggle = e.target.closest(LANGUAGE_TOGGLE_SELECTOR);\n      if (toggle) {\n        updateCurrent();\n      }\n    },\n    true,\n  );\n\n  // Watch for URL changes via History API (used by Mintlify's client-side routing)\n  // This is more efficient than MutationObserver - only fires on actual URL changes\n  let lastPath = location.pathname;\n\n  function onPathChange() {\n    if (location.pathname !== lastPath) {\n      lastPath = location.pathname;\n      checkRedirect();\n    }\n  }\n\n  // Handle back/forward navigation\n  window.addEventListener(\"popstate\", onPathChange);\n\n  // Handle hash changes (when user clicks anchor links)\n  window.addEventListener(\"hashchange\", onPathChange);\n\n  // Intercept pushState/replaceState calls\n  const originalPushState = history.pushState;\n  const originalReplaceState = history.replaceState;\n\n  history.pushState = function (...args) {\n    originalPushState.apply(this, args);\n    onPathChange();\n  };\n\n  history.replaceState = function (...args) {\n    originalReplaceState.apply(this, args);\n    onPathChange();\n  };\n\n  // Run initial check in case user landed here via language toggle\n  checkRedirect();\n})();\n"])</script><script>self.__next_f.push([1,"33:[\"$\",\"$L2f\",\"0\",{\"id\":\"0\",\"children\":\"$36\"}]\n39:T2a83,"])</script><script>self.__next_f.push([1,"\"use strict\";\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = {\n    a: \"a\",\n    hr: \"hr\",\n    p: \"p\",\n    strong: \"strong\",\n    ..._provideComponents(),\n    ...props.components\n  }, {Callout, Card, CardGroup, Tab, Tabs, Tip} = _components;\n  if (!Callout) _missingMdxReference(\"Callout\", true);\n  if (!Card) _missingMdxReference(\"Card\", true);\n  if (!CardGroup) _missingMdxReference(\"CardGroup\", true);\n  if (!Tab) _missingMdxReference(\"Tab\", true);\n  if (!Tabs) _missingMdxReference(\"Tabs\", true);\n  if (!Tip) _missingMdxReference(\"Tip\", true);\n  return _jsxs(_Fragment, {\n    children: [_jsx(\"div\", {\n      class: \"home-page mx-auto max-w-8xl px-0 lg:px-5\",\n      style: {\n        paddingBottom: \"8rem\"\n      },\n      children: _jsxs(\"div\", {\n        class: \"mdx-content prose prose-gray dark:prose-invert mx-4 pt-10\",\n        children: [_jsx(\"h1\", {\n          class: \"flex whitespace-pre-wrap group font-semibold text-2xl sm:text-3xl mt-8\",\n          children: \"Documentation\"\n        }), _jsx(_components.p, {\n          children: \"LangChain is the platform for agent engineering. AI teams at Replit, Clay, Rippling, Cloudflare, Workday, and more trust LangChainâ€™s products to engineer reliable agents.\"\n        }), _jsx(\"h2\", {\n          class: \"flex whitespace-pre-wrap group font-semibold\",\n          children: \"Open source agent frameworks\"\n        }), _jsxs(Tabs, {\n          children: [_jsx(Tab, {\n            title: \"Python\",\n            icon: \"python\",\n            id: \"python\",\n            children: _jsxs(CardGroup, {\n              cols: 3,\n              children: [_jsx(Card, {\n                title: \"LangChain (Python)\",\n                href: \"/oss/python/langchain/overview\",\n                icon: \"link\",\n                cta: \"Learn more\",\n                children: _jsx(_components.p, {\n                  children: \"Quickly get started building agents, with any model provider of your choice.\"\n                })\n              }), _jsx(Card, {\n                title: \"LangGraph (Python)\",\n                href: \"/oss/python/langgraph/overview\",\n                icon: \"circle-nodes\",\n                cta: \"Learn more\",\n                children: _jsx(_components.p, {\n                  children: \"Control every step of your custom agent with low-level orchestration, memory, and human-in-the-loop support.\"\n                })\n              }), _jsx(Card, {\n                title: \"Deep Agents (Python)\",\n                href: \"/oss/python/deepagents/overview\",\n                icon: \"robot\",\n                cta: \"Learn more\",\n                children: _jsx(_components.p, {\n                  children: \"Build agents that can tackle complex, multi-step tasks.\"\n                })\n              })]\n            })\n          }), _jsx(Tab, {\n            title: \"TypeScript\",\n            icon: \"js\",\n            id: \"typescript\",\n            children: _jsxs(CardGroup, {\n              cols: 3,\n              children: [_jsx(Card, {\n                title: \"LangChain (TypeScript)\",\n                href: \"/oss/javascript/langchain/overview\",\n                icon: \"link\",\n                cta: \"Learn more\",\n                children: _jsx(_components.p, {\n                  children: \"Quickly get started building agents, with any model provider of your choice.\"\n                })\n              }), _jsx(Card, {\n                title: \"LangGraph (TypeScript)\",\n                href: \"/oss/javascript/langgraph/overview\",\n                icon: \"circle-nodes\",\n                cta: \"Learn more\",\n                children: _jsx(_components.p, {\n                  children: \"Control every step of your custom agent with low-level orchestration, memory, and human-in-the-loop support.\"\n                })\n              }), _jsx(Card, {\n                title: \"Deep Agents (TypeScript)\",\n                href: \"/oss/javascript/deepagents/overview\",\n                icon: \"robot\",\n                cta: \"Learn more\",\n                children: _jsx(_components.p, {\n                  children: \"Build agents that can tackle complex, multi-step tasks.\"\n                })\n              })]\n            })\n          })]\n        }), _jsx(\"h2\", {\n          class: \"flex whitespace-pre-wrap group font-semibold\",\n          children: \"LangSmith\"\n        }), _jsxs(_components.p, {\n          children: [_jsx(_components.a, {\n            href: \"/langsmith/home\",\n            children: _jsx(_components.strong, {\n              children: \"LangSmith\"\n            })\n          }), \" is a platform that helps AI teams use live production data for continuous testing and improvement. LangSmith provides:\"]\n        }), _jsxs(CardGroup, {\n          cols: 3,\n          children: [_jsx(Card, {\n            title: \"Observability\",\n            href: \"/langsmith/observability\",\n            icon: \"magnifying-glass\",\n            cta: \"Learn more\",\n            children: _jsx(_components.p, {\n              children: \"See exactly how your agent thinks and acts with detailed tracing and aggregate trend metrics.\"\n            })\n          }), _jsx(Card, {\n            title: \"Evaluation\",\n            href: \"/langsmith/evaluation\",\n            icon: \"chart-simple\",\n            cta: \"Learn more\",\n            children: _jsx(_components.p, {\n              children: \"Test and score agent behavior on production data or offline datasets to continuously improve performance.\"\n            })\n          }), _jsx(Card, {\n            title: \"Prompt Engineering\",\n            href: \"/langsmith/prompt-engineering\",\n            icon: \"terminal\",\n            cta: \"Learn more\",\n            children: _jsx(_components.p, {\n              children: \"Iterate on prompts with version control, prompt optimization, and collaboration features.\"\n            })\n          }), _jsx(Card, {\n            title: \"Deployment\",\n            href: \"/langsmith/deployments\",\n            icon: \"rocket-launch\",\n            cta: \"Learn more\",\n            children: _jsx(_components.p, {\n              children: \"Ship your agent in one click, using scalable infrastructure built for long-running tasks.\"\n            })\n          }), _jsx(Card, {\n            title: \"Agent Builder (Beta)\",\n            href: \"/langsmith/agent-builder\",\n            icon: \"wand-magic-sparkles\",\n            cta: \"Learn more\",\n            children: _jsx(_components.p, {\n              children: \"Turn natural-language ideas into production agents with persistent memory and self-updating capabilities.\"\n            })\n          })]\n        }), _jsx(Callout, {\n          icon: \"lock\",\n          color: \"#DFC5FE\",\n          iconType: \"regular\",\n          children: _jsxs(_components.p, {\n            children: [\"LangSmith meets the highest standards of data security and privacy with HIPAA, SOC 2 Type 2, and GDPR compliance. For more information, see the \", _jsx(_components.a, {\n              href: \"https://trust.langchain.com/\",\n              children: \"Trust Center\"\n            }), \".\"]\n          })\n        }), _jsx(\"h2\", {\n          class: \"flex whitespace-pre-wrap group font-semibold\",\n          children: \"Get started\"\n        }), _jsxs(CardGroup, {\n          cols: 4,\n          children: [_jsx(Card, {\n            title: \"Build your first agent with LangChain\",\n            icon: \"gear\",\n            href: \"/oss/python/langchain/quickstart\",\n            cta: \"Get started\"\n          }), _jsx(Card, {\n            title: \"Sign up for LangSmith\",\n            icon: \"screwdriver-wrench\",\n            href: \"https://smith.langchain.com/\",\n            cta: \"Try LangSmith\"\n          }), _jsx(Card, {\n            title: \"Build an advanced agent with LangGraph\",\n            icon: \"robot\",\n            href: \"/oss/python/langgraph/quickstart\",\n            cta: \"Get started\"\n          }), _jsx(Card, {\n            title: \"Enroll in LangChain Academy\",\n            icon: \"graduation-cap\",\n            href: \"https://academy.langchain.com/\",\n            cta: \"Get started\"\n          })]\n        }), _jsx(\"h2\", {\n          class: \"flex whitespace-pre-wrap group font-semibold\",\n          children: \"Additional resources\"\n        }), _jsxs(CardGroup, {\n          cols: 4,\n          children: [_jsx(Card, {\n            title: \"Community forum\",\n            icon: \"messages\",\n            href: \"https://forum.langchain.com/\",\n            cta: \"Join\",\n            children: _jsx(_components.p, {\n              children: \"Ask questions, share solutions, and discuss best practices.\"\n            })\n          }), _jsx(Card, {\n            title: \"Community Slack\",\n            icon: \"slack\",\n            href: \"https://www.langchain.com/join-community\",\n            cta: \"Join\",\n            children: _jsx(_components.p, {\n              children: \"Connect with other builders and get quick help.\"\n            })\n          }), _jsx(Card, {\n            title: \"Support portal\",\n            icon: \"user-headset\",\n            href: \"https://support.langchain.com/\",\n            cta: \"Visit\",\n            children: _jsx(_components.p, {\n              children: \"Submit tickets and track support requests.\"\n            })\n          }), _jsx(Card, {\n            title: \"LangSmith status\",\n            icon: \"screwdriver-wrench\",\n            href: \"https://status.smith.langchain.com/\",\n            cta: \"View\",\n            children: _jsx(_components.p, {\n              children: \"Real-time status of LangSmith services and APIs.\"\n            })\n          })]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(Callout, {\n      icon: \"pen-to-square\",\n      iconType: \"regular\",\n      children: _jsxs(_components.p, {\n        children: [_jsx(_components.a, {\n          href: \"https://github.com/langchain-ai/docs/edit/main/src/index.mdx\",\n          children: \"Edit this page on GitHub\"\n        }), \" or \", _jsx(_components.a, {\n          href: \"https://github.com/langchain-ai/docs/issues/new/choose\",\n          children: \"file an issue\"\n        }), \".\"]\n      })\n    }), \"\\n\", _jsx(Tip, {\n      icon: \"terminal\",\n      iconType: \"regular\",\n      children: _jsxs(_components.p, {\n        children: [_jsx(_components.a, {\n          href: \"/use-these-docs\",\n          children: \"Connect these docs\"\n        }), \" to Claude, VSCode, and more via MCP for real-time answers.\"]\n      })\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = {\n    ..._provideComponents(),\n    ...props.components\n  };\n  return MDXLayout ? _jsx(MDXLayout, {\n    ...props,\n    children: _jsx(_createMdxContent, {\n      ...props\n    })\n  }) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\nfunction _missingMdxReference(id, component) {\n  throw new Error(\"Expected \" + (component ? \"component\" : \"object\") + \" `\" + id + \"` to be defined: you likely forgot to import, pass, or provide it.\");\n}\n"])</script><script>self.__next_f.push([1,"3a:T2a4d,"])</script><script>self.__next_f.push([1,"\"use strict\";\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = {\n    a: \"a\",\n    hr: \"hr\",\n    p: \"p\",\n    strong: \"strong\",\n    ..._provideComponents(),\n    ...props.components\n  }, {Callout, Card, CardGroup, Tab, Tabs, Tip} = _components;\n  if (!Callout) _missingMdxReference(\"Callout\", true);\n  if (!Card) _missingMdxReference(\"Card\", true);\n  if (!CardGroup) _missingMdxReference(\"CardGroup\", true);\n  if (!Tab) _missingMdxReference(\"Tab\", true);\n  if (!Tabs) _missingMdxReference(\"Tabs\", true);\n  if (!Tip) _missingMdxReference(\"Tip\", true);\n  return _jsxs(_Fragment, {\n    children: [_jsx(\"div\", {\n      class: \"home-page mx-auto max-w-8xl px-0 lg:px-5\",\n      children: _jsxs(\"div\", {\n        class: \"mdx-content prose prose-gray dark:prose-invert mx-4 pt-10\",\n        children: [_jsx(\"h1\", {\n          class: \"flex whitespace-pre-wrap group font-semibold text-2xl sm:text-3xl mt-8\",\n          children: \"Documentation\"\n        }), _jsx(_components.p, {\n          children: \"LangChain is the platform for agent engineering. AI teams at Replit, Clay, Rippling, Cloudflare, Workday, and more trust LangChainâ€™s products to engineer reliable agents.\"\n        }), _jsx(\"h2\", {\n          class: \"flex whitespace-pre-wrap group font-semibold\",\n          children: \"Open source agent frameworks\"\n        }), _jsxs(Tabs, {\n          children: [_jsx(Tab, {\n            title: \"Python\",\n            icon: \"python\",\n            id: \"python\",\n            children: _jsxs(CardGroup, {\n              cols: 3,\n              children: [_jsx(Card, {\n                title: \"LangChain (Python)\",\n                href: \"/oss/python/langchain/overview\",\n                icon: \"link\",\n                cta: \"Learn more\",\n                children: _jsx(_components.p, {\n                  children: \"Quickly get started building agents, with any model provider of your choice.\"\n                })\n              }), _jsx(Card, {\n                title: \"LangGraph (Python)\",\n                href: \"/oss/python/langgraph/overview\",\n                icon: \"circle-nodes\",\n                cta: \"Learn more\",\n                children: _jsx(_components.p, {\n                  children: \"Control every step of your custom agent with low-level orchestration, memory, and human-in-the-loop support.\"\n                })\n              }), _jsx(Card, {\n                title: \"Deep Agents (Python)\",\n                href: \"/oss/python/deepagents/overview\",\n                icon: \"robot\",\n                cta: \"Learn more\",\n                children: _jsx(_components.p, {\n                  children: \"Build agents that can tackle complex, multi-step tasks.\"\n                })\n              })]\n            })\n          }), _jsx(Tab, {\n            title: \"TypeScript\",\n            icon: \"js\",\n            id: \"typescript\",\n            children: _jsxs(CardGroup, {\n              cols: 3,\n              children: [_jsx(Card, {\n                title: \"LangChain (TypeScript)\",\n                href: \"/oss/javascript/langchain/overview\",\n                icon: \"link\",\n                cta: \"Learn more\",\n                children: _jsx(_components.p, {\n                  children: \"Quickly get started building agents, with any model provider of your choice.\"\n                })\n              }), _jsx(Card, {\n                title: \"LangGraph (TypeScript)\",\n                href: \"/oss/javascript/langgraph/overview\",\n                icon: \"circle-nodes\",\n                cta: \"Learn more\",\n                children: _jsx(_components.p, {\n                  children: \"Control every step of your custom agent with low-level orchestration, memory, and human-in-the-loop support.\"\n                })\n              }), _jsx(Card, {\n                title: \"Deep Agents (TypeScript)\",\n                href: \"/oss/javascript/deepagents/overview\",\n                icon: \"robot\",\n                cta: \"Learn more\",\n                children: _jsx(_components.p, {\n                  children: \"Build agents that can tackle complex, multi-step tasks.\"\n                })\n              })]\n            })\n          })]\n        }), _jsx(\"h2\", {\n          class: \"flex whitespace-pre-wrap group font-semibold\",\n          children: \"LangSmith\"\n        }), _jsxs(_components.p, {\n          children: [_jsx(_components.a, {\n            href: \"/langsmith/home\",\n            children: _jsx(_components.strong, {\n              children: \"LangSmith\"\n            })\n          }), \" is a platform that helps AI teams use live production data for continuous testing and improvement. LangSmith provides:\"]\n        }), _jsxs(CardGroup, {\n          cols: 3,\n          children: [_jsx(Card, {\n            title: \"Observability\",\n            href: \"/langsmith/observability\",\n            icon: \"magnifying-glass\",\n            cta: \"Learn more\",\n            children: _jsx(_components.p, {\n              children: \"See exactly how your agent thinks and acts with detailed tracing and aggregate trend metrics.\"\n            })\n          }), _jsx(Card, {\n            title: \"Evaluation\",\n            href: \"/langsmith/evaluation\",\n            icon: \"chart-simple\",\n            cta: \"Learn more\",\n            children: _jsx(_components.p, {\n              children: \"Test and score agent behavior on production data or offline datasets to continuously improve performance.\"\n            })\n          }), _jsx(Card, {\n            title: \"Prompt Engineering\",\n            href: \"/langsmith/prompt-engineering\",\n            icon: \"terminal\",\n            cta: \"Learn more\",\n            children: _jsx(_components.p, {\n              children: \"Iterate on prompts with version control, prompt optimization, and collaboration features.\"\n            })\n          }), _jsx(Card, {\n            title: \"Deployment\",\n            href: \"/langsmith/deployments\",\n            icon: \"rocket-launch\",\n            cta: \"Learn more\",\n            children: _jsx(_components.p, {\n              children: \"Ship your agent in one click, using scalable infrastructure built for long-running tasks.\"\n            })\n          }), _jsx(Card, {\n            title: \"Agent Builder (Beta)\",\n            href: \"/langsmith/agent-builder\",\n            icon: \"wand-magic-sparkles\",\n            cta: \"Learn more\",\n            children: _jsx(_components.p, {\n              children: \"Turn natural-language ideas into production agents with persistent memory and self-updating capabilities.\"\n            })\n          })]\n        }), _jsx(Callout, {\n          icon: \"lock\",\n          color: \"#DFC5FE\",\n          iconType: \"regular\",\n          children: _jsxs(_components.p, {\n            children: [\"LangSmith meets the highest standards of data security and privacy with HIPAA, SOC 2 Type 2, and GDPR compliance. For more information, see the \", _jsx(_components.a, {\n              href: \"https://trust.langchain.com/\",\n              children: \"Trust Center\"\n            }), \".\"]\n          })\n        }), _jsx(\"h2\", {\n          class: \"flex whitespace-pre-wrap group font-semibold\",\n          children: \"Get started\"\n        }), _jsxs(CardGroup, {\n          cols: 4,\n          children: [_jsx(Card, {\n            title: \"Build your first agent with LangChain\",\n            icon: \"gear\",\n            href: \"/oss/python/langchain/quickstart\",\n            cta: \"Get started\"\n          }), _jsx(Card, {\n            title: \"Sign up for LangSmith\",\n            icon: \"screwdriver-wrench\",\n            href: \"https://smith.langchain.com/\",\n            cta: \"Try LangSmith\"\n          }), _jsx(Card, {\n            title: \"Build an advanced agent with LangGraph\",\n            icon: \"robot\",\n            href: \"/oss/python/langgraph/quickstart\",\n            cta: \"Get started\"\n          }), _jsx(Card, {\n            title: \"Enroll in LangChain Academy\",\n            icon: \"graduation-cap\",\n            href: \"https://academy.langchain.com/\",\n            cta: \"Get started\"\n          })]\n        }), _jsx(\"h2\", {\n          class: \"flex whitespace-pre-wrap group font-semibold\",\n          children: \"Additional resources\"\n        }), _jsxs(CardGroup, {\n          cols: 4,\n          children: [_jsx(Card, {\n            title: \"Community forum\",\n            icon: \"messages\",\n            href: \"https://forum.langchain.com/\",\n            cta: \"Join\",\n            children: _jsx(_components.p, {\n              children: \"Ask questions, share solutions, and discuss best practices.\"\n            })\n          }), _jsx(Card, {\n            title: \"Community Slack\",\n            icon: \"slack\",\n            href: \"https://www.langchain.com/join-community\",\n            cta: \"Join\",\n            children: _jsx(_components.p, {\n              children: \"Connect with other builders and get quick help.\"\n            })\n          }), _jsx(Card, {\n            title: \"Support portal\",\n            icon: \"user-headset\",\n            href: \"https://support.langchain.com/\",\n            cta: \"Visit\",\n            children: _jsx(_components.p, {\n              children: \"Submit tickets and track support requests.\"\n            })\n          }), _jsx(Card, {\n            title: \"LangSmith status\",\n            icon: \"screwdriver-wrench\",\n            href: \"https://status.smith.langchain.com/\",\n            cta: \"View\",\n            children: _jsx(_components.p, {\n              children: \"Real-time status of LangSmith services and APIs.\"\n            })\n          })]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(Callout, {\n      icon: \"pen-to-square\",\n      iconType: \"regular\",\n      children: _jsxs(_components.p, {\n        children: [_jsx(_components.a, {\n          href: \"https://github.com/langchain-ai/docs/edit/main/src/index.mdx\",\n          children: \"Edit this page on GitHub\"\n        }), \" or \", _jsx(_components.a, {\n          href: \"https://github.com/langchain-ai/docs/issues/new/choose\",\n          children: \"file an issue\"\n        }), \".\"]\n      })\n    }), \"\\n\", _jsx(Tip, {\n      icon: \"terminal\",\n      iconType: \"regular\",\n      children: _jsxs(_components.p, {\n        children: [_jsx(_components.a, {\n          href: \"/use-these-docs\",\n          children: \"Connect these docs\"\n        }), \" to Claude, VSCode, and more via MCP for real-time answers.\"]\n      })\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = {\n    ..._provideComponents(),\n    ...props.components\n  };\n  return MDXLayout ? _jsx(MDXLayout, {\n    ...props,\n    children: _jsx(_createMdxContent, {\n      ...props\n    })\n  }) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\nfunction _missingMdxReference(id, component) {\n  throw new Error(\"Expected \" + (component ? \"component\" : \"object\") + \" `\" + id + \"` to be defined: you likely forgot to import, pass, or provide it.\");\n}\n"])</script><script>self.__next_f.push([1,"34:[\"$\",\"$L37\",null,{\"slug\":\"/\",\"pageMetadata\":\"$17:props:pageMetadata\",\"theme\":\"aspen\",\"children\":[\"$\",\"$L38\",null,{\"mdxSource\":{\"compiledSource\":\"$39\",\"frontmatter\":{},\"scope\":{\"config\":{},\"pageMetadata\":{\"title\":null,\"sidebarTitle\":\"Home\",\"mode\":\"custom\",\"description\":null,\"href\":\"/index\"}}},\"mdxSourceWithNoJs\":{\"compiledSource\":\"$3a\",\"frontmatter\":{},\"scope\":{\"config\":{},\"pageMetadata\":{\"title\":null,\"sidebarTitle\":\"Home\",\"mode\":\"custom\",\"description\":null,\"href\":\"/index\"}}}}]}]\n"])</script><script>self.__next_f.push([1,"3b:I[79890,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"74610\",\"static/chunks/74610-281c4fe11ead87d4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"59823\",\"static/chunks/59823-9016fae3a0af6930.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"35456\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/layout-3a53ac52e5c673ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"LivePreviewProvider\",1]\n"])</script><script>self.__next_f.push([1,"3c:I[49769,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"74610\",\"static/chunks/74610-281c4fe11ead87d4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"59823\",\"static/chunks/59823-9016fae3a0af6930.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"35456\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/layout-3a53ac52e5c673ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"default\"]\n"])</script><script>self.__next_f.push([1,"3d:I[13928,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25263\",\"static/chunks/25263-1e30f64402644edf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"2870\",\"static/chunks/2870-43b3b296a96d0195.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"89841\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/%5B%5B...slug%5D%5D/page-024162cb87bbb1c5.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"AuthProvider\",1]\n"])</script><script>self.__next_f.push([1,"3e:I[13928,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25263\",\"static/chunks/25263-1e30f64402644edf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"2870\",\"static/chunks/2870-43b3b296a96d0195.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"89841\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/%5B%5B...slug%5D%5D/page-024162cb87bbb1c5.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"DeploymentMetadataProvider\",1]\n"])</script><script>self.__next_f.push([1,"3f:I[13928,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25263\",\"static/chunks/25263-1e30f64402644edf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"2870\",\"static/chunks/2870-43b3b296a96d0195.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"89841\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/%5B%5B...slug%5D%5D/page-024162cb87bbb1c5.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"DocsConfigProvider\",1]\n"])</script><script>self.__next_f.push([1,"16:[\"$\",\"$L3b\",null,{\"children\":[\"$\",\"$L5\",null,{\"appearance\":{\"default\":\"system\",\"strict\":false},\"codeblockTheme\":\"system\",\"children\":[false,[\"$\",\"$L2f\",null,{\"id\":\"_mintlify-banner-script\",\"strategy\":\"beforeInteractive\",\"dangerouslySetInnerHTML\":{\"__html\":\"(function j(a,b,c,d,e){try{let f,g,h=[];try{h=window.location.pathname.split(\\\"/\\\").filter(a=\u003e\\\"\\\"!==a\u0026\u0026\\\"global\\\"!==a).slice(0,2)}catch{h=[]}let i=h.find(a=\u003ec.includes(a)),j=[];for(let c of(i?j.push(i):j.push(b),j.push(\\\"global\\\"),j)){if(!c)continue;let b=a[c];if(b?.content){f=b.content,g=c;break}}if(!f)return void document.documentElement.setAttribute(d,\\\"hidden\\\");let k=!0,l=0;for(;l\u003clocalStorage.length;){let a=localStorage.key(l);if(l++,!a?.endsWith(e))continue;let b=localStorage.getItem(a);if(b\u0026\u0026b===f){k=!1;break}g\u0026\u0026(a.startsWith(`lang:${g}_`)||!a.startsWith(\\\"lang:\\\"))\u0026\u0026(localStorage.removeItem(a),l--)}document.documentElement.setAttribute(d,k?\\\"visible\\\":\\\"hidden\\\")}catch(a){console.error(a),document.documentElement.setAttribute(d,\\\"hidden\\\")}})(\\n  {},\\n  \\\"en\\\",\\n  [],\\n  \\\"data-banner-state\\\",\\n  \\\"bannerDismissed\\\",\\n)\"}}],[\"$\",\"$L3c\",null,{\"appId\":\"$undefined\",\"autoBoot\":true,\"children\":[\"$\",\"$L3d\",null,{\"value\":{\"auth\":\"$undefined\",\"userAuth\":\"$undefined\"},\"children\":[\"$\",\"$L3e\",null,{\"value\":{\"subdomain\":\"langchain-5e9cc07a\",\"actualSubdomain\":\"langchain-5e9cc07a\",\"gitSource\":{\"type\":\"github\",\"owner\":\"langchain-ai\",\"repo\":\"docs\",\"deployBranch\":\"prod\",\"contentDirectory\":\"build\",\"isPrivate\":false},\"inkeep\":\"$undefined\",\"trieve\":{\"datasetId\":\"3a551434-1a79-438a-8a27-e9f6200637e2\"},\"feedback\":{\"thumbs\":true,\"edits\":false,\"issues\":false},\"entitlements\":{\"AI_CHAT\":{\"status\":\"ENABLED\"}},\"buildId\":\"6961961ab7221bf48f638bef:success\",\"clientVersion\":\"0.0.2327\",\"preview\":\"$undefined\"},\"children\":[\"$\",\"$L3f\",null,{\"value\":{\"docsConfig\":{\"theme\":\"aspen\",\"$schema\":\"https://mintlify.com/docs.json\",\"name\":\"Docs by LangChain\",\"description\":\"Documentation for LangChain, LangGraph, LangSmith, and more.\",\"colors\":{\"primary\":\"#2F6868\",\"light\":\"#84C4C0\",\"dark\":\"#1C3C3C\"},\"logo\":{\"light\":\"https://mintcdn.com/langchain-5e9cc07a/Xbr8HuVd9jPi6qTU/images/brand/langchain-docs-teal.svg?fit=max\u0026auto=format\u0026n=Xbr8HuVd9jPi6qTU\u0026q=85\u0026s=16111530672bf976cb54ef2143478342\",\"dark\":\"https://mintcdn.com/langchain-5e9cc07a/Xbr8HuVd9jPi6qTU/images/brand/langchain-docs-lilac.svg?fit=max\u0026auto=format\u0026n=Xbr8HuVd9jPi6qTU\u0026q=85\u0026s=b70fb1a2208670492ef94aef14b680be\"},\"favicon\":{\"light\":\"/images/brand/docs-favicon.png\",\"dark\":\"/images/brand/docs-favicon.png\"},\"appearance\":\"$16:props:children:props:appearance\",\"navbar\":{\"links\":[{\"label\":\"Support\",\"href\":\"https://support.langchain.com/\"},{\"label\":\"GitHub\",\"icon\":\"github\",\"href\":\"https://github.com/langchain-ai\"}],\"primary\":{\"type\":\"button\",\"label\":\"Try LangSmith\",\"href\":\"https://smith.langchain.com/\"}},\"navigation\":{\"products\":[{\"product\":\"Home\",\"icon\":\"house\",\"pages\":[\"index\"]},{\"product\":\"LangChain + LangGraph\",\"icon\":\"link\",\"description\":\"Open source frameworks\",\"dropdowns\":[{\"dropdown\":\"Python\",\"icon\":\"python\",\"tabs\":[{\"tab\":\"LangChain\",\"pages\":[\"oss/python/langchain/overview\",{\"group\":\"Get started\",\"pages\":[\"oss/python/langchain/install\",\"oss/python/langchain/quickstart\",\"oss/python/langchain/changelog-py\",\"oss/python/langchain/philosophy\"]},{\"group\":\"Core components\",\"pages\":[\"oss/python/langchain/agents\",\"oss/python/langchain/models\",\"oss/python/langchain/messages\",\"oss/python/langchain/tools\",\"oss/python/langchain/short-term-memory\",\"oss/python/langchain/streaming\",\"oss/python/langchain/structured-output\"]},{\"group\":\"Middleware\",\"pages\":[\"oss/python/langchain/middleware/overview\",\"oss/python/langchain/middleware/built-in\",\"oss/python/langchain/middleware/custom\"]},{\"group\":\"Advanced usage\",\"pages\":[\"oss/python/langchain/guardrails\",\"oss/python/langchain/runtime\",\"oss/python/langchain/context-engineering\",\"oss/python/langchain/mcp\",\"oss/python/langchain/human-in-the-loop\",{\"group\":\"Multi-agent\",\"pages\":[\"oss/python/langchain/multi-agent/index\",\"oss/python/langchain/multi-agent/subagents\",\"oss/python/langchain/multi-agent/handoffs\",\"oss/python/langchain/multi-agent/skills\",\"oss/python/langchain/multi-agent/router\",\"oss/python/langchain/multi-agent/custom-workflow\"]},\"oss/python/langchain/retrieval\",\"oss/python/langchain/long-term-memory\"]},{\"group\":\"Agent development\",\"pages\":[\"oss/python/langchain/studio\",\"oss/python/langchain/test\",\"oss/python/langchain/ui\"]},{\"group\":\"Deploy with LangSmith\",\"pages\":[\"oss/python/langchain/deploy\",\"oss/python/langchain/observability\"]}]},{\"tab\":\"LangGraph\",\"pages\":[\"oss/python/langgraph/overview\",{\"group\":\"Get started\",\"pages\":[\"oss/python/langgraph/install\",\"oss/python/langgraph/quickstart\",\"oss/python/langgraph/local-server\",\"oss/python/langgraph/changelog-py\",\"oss/python/langgraph/thinking-in-langgraph\",\"oss/python/langgraph/workflows-agents\"]},{\"group\":\"Capabilities\",\"pages\":[\"oss/python/langgraph/persistence\",\"oss/python/langgraph/durable-execution\",\"oss/python/langgraph/streaming\",\"oss/python/langgraph/interrupts\",\"oss/python/langgraph/use-time-travel\",\"oss/python/langgraph/add-memory\",\"oss/python/langgraph/use-subgraphs\"]},{\"group\":\"Production\",\"pages\":[\"oss/python/langgraph/application-structure\",\"oss/python/langgraph/test\",\"oss/python/langgraph/studio\",\"oss/python/langgraph/ui\",\"oss/python/langgraph/deploy\",\"oss/python/langgraph/observability\"]},{\"group\":\"LangGraph APIs\",\"pages\":[{\"group\":\"Graph API\",\"pages\":[\"oss/python/langgraph/choosing-apis\",\"oss/python/langgraph/graph-api\",\"oss/python/langgraph/use-graph-api\"]},{\"group\":\"Functional API\",\"pages\":[\"oss/python/langgraph/functional-api\",\"oss/python/langgraph/use-functional-api\"]},\"oss/python/langgraph/pregel\"]}]},{\"tab\":\"Deep Agents\",\"pages\":[\"oss/python/deepagents/overview\",{\"group\":\"Get started\",\"pages\":[\"oss/python/deepagents/quickstart\",\"oss/python/deepagents/customization\"]},{\"group\":\"Core capabilities\",\"pages\":[\"oss/python/deepagents/harness\",\"oss/python/deepagents/backends\",\"oss/python/deepagents/subagents\",\"oss/python/deepagents/human-in-the-loop\",\"oss/python/deepagents/long-term-memory\",\"oss/python/deepagents/middleware\"]},{\"group\":\"Command line interface\",\"pages\":[\"oss/python/deepagents/cli\"]}]},{\"tab\":\"Integrations\",\"pages\":[\"oss/python/integrations/providers/overview\",\"oss/python/integrations/providers/all_providers\",{\"group\":\"Popular Providers\",\"icon\":\"user-group\",\"pages\":[\"oss/python/integrations/providers/openai\",\"oss/python/integrations/providers/anthropic\",\"oss/python/integrations/providers/google\",\"oss/python/integrations/providers/aws\",\"oss/python/integrations/providers/huggingface\",\"oss/python/integrations/providers/microsoft\",\"oss/python/integrations/providers/ollama\",\"oss/python/integrations/chat/groq\"]},{\"group\":\"Integrations by component\",\"icon\":\"plug\",\"pages\":[\"oss/python/integrations/chat/index\",\"oss/python/integrations/tools/index\",\"oss/python/integrations/middleware/index\",\"oss/python/integrations/retrievers/index\",\"oss/python/integrations/splitters/index\",\"oss/python/integrations/text_embedding/index\",\"oss/python/integrations/vectorstores/index\",\"oss/python/integrations/document_loaders/index\",\"oss/python/integrations/stores/index\"]}]},{\"tab\":\"Learn\",\"pages\":[\"oss/python/learn\",{\"group\":\"Tutorials\",\"icon\":\"code\",\"pages\":[{\"group\":\"LangChain\",\"expanded\":true,\"pages\":[\"oss/python/langchain/knowledge-base\",\"oss/python/langchain/rag\",\"oss/python/langchain/sql-agent\",\"oss/python/langchain/voice-agent\"]},{\"group\":\"Multi-agent\",\"expanded\":true,\"pages\":[\"oss/python/langchain/multi-agent/subagents-personal-assistant\",\"oss/python/langchain/multi-agent/handoffs-customer-support\",\"oss/python/langchain/multi-agent/router-knowledge-base\",\"oss/python/langchain/multi-agent/skills-sql-assistant\"]},{\"group\":\"LangGraph\",\"expanded\":true,\"pages\":[\"oss/python/langgraph/agentic-rag\",\"oss/python/langgraph/sql-agent\"]}]},{\"group\":\"Conceptual overviews\",\"icon\":\"book\",\"pages\":[\"oss/python/langchain/component-architecture\",\"oss/python/concepts/memory\",\"oss/python/concepts/context\",\"oss/python/langgraph/graph-api\",\"oss/python/langgraph/functional-api\"]},{\"group\":\"Additional resources\",\"icon\":\"list\",\"pages\":[\"oss/python/langchain/academy\",\"oss/python/langgraph/case-studies\",\"oss/python/langchain/get-help\"]}]},{\"tab\":\"Reference\",\"pages\":[\"oss/python/reference/overview\",{\"group\":\"Reference\",\"pages\":[\"oss/python/reference/langchain-python\",\"oss/python/reference/langgraph-python\",\"oss/python/reference/integrations-python\",\"oss/python/reference/deepagents-python\"]},{\"group\":\"Errors\",\"pages\":[\"oss/python/common-errors\"]},{\"group\":\"Releases\",\"pages\":[\"oss/python/versioning\",\"oss/python/releases/changelog\",{\"group\":\"Releases\",\"pages\":[\"oss/python/releases/langchain-v1\",\"oss/python/releases/langgraph-v1\"]},{\"group\":\"Migration guides\",\"pages\":[\"oss/python/migrate/langchain-v1\",\"oss/python/migrate/langgraph-v1\"]}]},{\"group\":\"Policies\",\"pages\":[\"oss/python/release-policy\",\"oss/python/security-policy\"]}]},{\"tab\":\"Contribute\",\"pages\":[\"oss/python/contributing/overview\",{\"group\":\"Contribute\",\"icon\":\"heart-circle-plus\",\"pages\":[\"oss/python/contributing/documentation\",\"oss/python/contributing/code\",{\"group\":\"Integrations\",\"pages\":[\"oss/python/contributing/integrations-langchain\",\"oss/python/contributing/implement-langchain\",\"oss/python/contributing/standard-tests-langchain\",\"oss/python/contributing/publish-langchain\",\"oss/python/contributing/comarketing\"]}]}]}]},{\"dropdown\":\"TypeScript\",\"icon\":\"square-js\",\"tabs\":[{\"tab\":\"LangChain\",\"pages\":[\"oss/javascript/langchain/overview\",{\"group\":\"Get started\",\"pages\":[\"oss/javascript/langchain/install\",\"oss/javascript/langchain/quickstart\",\"oss/javascript/langchain/changelog-js\",\"oss/javascript/langchain/philosophy\"]},{\"group\":\"Core components\",\"pages\":[\"oss/javascript/langchain/agents\",\"oss/javascript/langchain/models\",\"oss/javascript/langchain/messages\",\"oss/javascript/langchain/tools\",\"oss/javascript/langchain/short-term-memory\",\"oss/javascript/langchain/streaming\",\"oss/javascript/langchain/structured-output\"]},{\"group\":\"Middleware\",\"pages\":[\"oss/javascript/langchain/middleware/overview\",\"oss/javascript/langchain/middleware/built-in\",\"oss/javascript/langchain/middleware/custom\"]},{\"group\":\"Advanced usage\",\"pages\":[\"oss/javascript/langchain/guardrails\",\"oss/javascript/langchain/runtime\",\"oss/javascript/langchain/context-engineering\",\"oss/javascript/langchain/mcp\",\"oss/javascript/langchain/human-in-the-loop\",{\"group\":\"Multi-agent\",\"pages\":[\"oss/javascript/langchain/multi-agent/index\",\"oss/javascript/langchain/multi-agent/subagents\",\"oss/javascript/langchain/multi-agent/handoffs\",\"oss/javascript/langchain/multi-agent/skills\",\"oss/javascript/langchain/multi-agent/router\",\"oss/javascript/langchain/multi-agent/custom-workflow\"]},\"oss/javascript/langchain/retrieval\",\"oss/javascript/langchain/long-term-memory\"]},{\"group\":\"Agent development\",\"pages\":[\"oss/javascript/langchain/studio\",\"oss/javascript/langchain/test\",\"oss/javascript/langchain/ui\"]},{\"group\":\"Deploy with LangSmith\",\"pages\":[\"oss/javascript/langchain/deploy\",\"oss/javascript/langchain/observability\"]}]},{\"tab\":\"LangGraph\",\"pages\":[\"oss/javascript/langgraph/overview\",{\"group\":\"Get started\",\"pages\":[\"oss/javascript/langgraph/install\",\"oss/javascript/langgraph/quickstart\",\"oss/javascript/langgraph/local-server\",\"oss/javascript/langgraph/changelog-js\",\"oss/javascript/langgraph/thinking-in-langgraph\",\"oss/javascript/langgraph/workflows-agents\"]},{\"group\":\"Capabilities\",\"pages\":[\"oss/javascript/langgraph/persistence\",\"oss/javascript/langgraph/durable-execution\",\"oss/javascript/langgraph/streaming\",\"oss/javascript/langgraph/interrupts\",\"oss/javascript/langgraph/use-time-travel\",\"oss/javascript/langgraph/add-memory\",\"oss/javascript/langgraph/use-subgraphs\"]},{\"group\":\"Production\",\"pages\":[\"oss/javascript/langgraph/application-structure\",\"oss/javascript/langgraph/test\",\"oss/javascript/langgraph/studio\",\"oss/javascript/langgraph/ui\",\"oss/javascript/langgraph/deploy\",\"oss/javascript/langgraph/observability\"]},{\"group\":\"LangGraph APIs\",\"pages\":[{\"group\":\"Graph API\",\"pages\":[\"oss/javascript/langgraph/choosing-apis\",\"oss/javascript/langgraph/graph-api\",\"oss/javascript/langgraph/use-graph-api\"]},{\"group\":\"Functional API\",\"pages\":[\"oss/javascript/langgraph/functional-api\",\"oss/javascript/langgraph/use-functional-api\"]},\"oss/javascript/langgraph/pregel\"]}]},{\"tab\":\"Deep Agents\",\"pages\":[\"oss/javascript/deepagents/overview\",{\"group\":\"Get started\",\"pages\":[\"oss/javascript/deepagents/quickstart\",\"oss/javascript/deepagents/customization\"]},{\"group\":\"Core capabilities\",\"pages\":[\"oss/javascript/deepagents/harness\",\"oss/javascript/deepagents/backends\",\"oss/javascript/deepagents/subagents\",\"oss/javascript/deepagents/human-in-the-loop\",\"oss/javascript/deepagents/long-term-memory\",\"oss/javascript/deepagents/middleware\"]},{\"group\":\"Deep Agents CLI\",\"pages\":[\"oss/javascript/deepagents/cli\"]}]},{\"tab\":\"Integrations\",\"pages\":[\"oss/javascript/integrations/providers/overview\",\"oss/javascript/integrations/providers/all_providers\",{\"group\":\"Popular Providers\",\"icon\":\"user-group\",\"pages\":[{\"group\":\"OpenAI\",\"pages\":[\"oss/javascript/integrations/providers/openai\",\"oss/javascript/integrations/chat/openai\",\"oss/javascript/integrations/text_embedding/openai\",\"oss/javascript/integrations/tools/openai\"]},{\"group\":\"Anthropic\",\"pages\":[\"oss/javascript/integrations/providers/anthropic\",\"oss/javascript/integrations/chat/anthropic\",\"oss/javascript/integrations/tools/anthropic\"]},{\"group\":\"Google\",\"pages\":[\"oss/javascript/integrations/providers/google\",\"oss/javascript/integrations/chat/google_generative_ai\",\"oss/javascript/integrations/text_embedding/google_generativeai\"]},{\"group\":\"AWS\",\"pages\":[\"oss/javascript/integrations/providers/aws\",\"oss/javascript/integrations/chat/bedrock\",\"oss/javascript/integrations/text_embedding/bedrock\"]},{\"group\":\"Microsoft\",\"pages\":[\"oss/javascript/integrations/providers/microsoft\",\"oss/javascript/integrations/chat/azure\",\"oss/javascript/integrations/text_embedding/azure_openai\"]}]},{\"group\":\"General integrations\",\"icon\":\"plug\",\"pages\":[\"oss/javascript/integrations/chat/index\",\"oss/javascript/integrations/tools/index\",\"oss/javascript/integrations/llms/index\",\"oss/javascript/integrations/middleware/index\",\"oss/javascript/integrations/stores/index\",\"oss/javascript/integrations/document_transformers/index\",\"oss/javascript/integrations/llm_caching/index\",\"oss/javascript/integrations/callbacks/index\"]},{\"group\":\"RAG integrations\",\"icon\":\"database\",\"pages\":[\"oss/javascript/integrations/retrievers/index\",\"oss/javascript/integrations/splitters/index\",\"oss/javascript/integrations/text_embedding/index\",\"oss/javascript/integrations/vectorstores/index\",\"oss/javascript/integrations/document_loaders/index\",\"oss/javascript/integrations/stores/index\"]}]},{\"tab\":\"Learn\",\"pages\":[\"oss/javascript/learn\",{\"group\":\"Tutorials\",\"icon\":\"code\",\"pages\":[{\"group\":\"LangChain\",\"expanded\":true,\"pages\":[\"oss/javascript/langchain/knowledge-base\",\"oss/javascript/langchain/rag\",\"oss/javascript/langchain/sql-agent\",\"oss/javascript/langchain/voice-agent\"]},{\"group\":\"Multi-agent\",\"expanded\":true,\"pages\":[\"oss/javascript/langchain/multi-agent/subagents-personal-assistant\",\"oss/javascript/langchain/multi-agent/router-knowledge-base\"]},{\"group\":\"LangGraph\",\"expanded\":true,\"pages\":[\"oss/javascript/langgraph/agentic-rag\"]}]},{\"group\":\"Conceptual overviews\",\"icon\":\"book\",\"pages\":[\"oss/javascript/langchain/component-architecture\",\"oss/javascript/concepts/memory\",\"oss/javascript/concepts/context\",\"oss/javascript/langgraph/graph-api\",\"oss/javascript/langgraph/functional-api\"]},{\"group\":\"LangChain Academy\",\"icon\":\"graduation-cap\",\"pages\":[\"oss/javascript/langchain/academy\"]},{\"group\":\"Additional resources\",\"icon\":\"list\",\"pages\":[\"oss/javascript/langgraph/case-studies\",\"oss/javascript/langchain/get-help\"]}]},{\"tab\":\"Reference\",\"pages\":[\"oss/javascript/reference/overview\",{\"group\":\"Reference\",\"pages\":[\"oss/javascript/reference/langchain-javascript\",\"oss/javascript/reference/langgraph-javascript\",\"oss/javascript/reference/deepagents-javascript\"]},{\"group\":\"Errors\",\"pages\":[\"oss/javascript/common-errors\"]},{\"group\":\"Releases\",\"pages\":[\"oss/javascript/versioning\",\"oss/javascript/releases/changelog\",{\"group\":\"Releases\",\"pages\":[\"oss/javascript/releases/langchain-v1\",\"oss/javascript/releases/langgraph-v1\"]},{\"group\":\"Migration guides\",\"pages\":[\"oss/javascript/migrate/langchain-v1\",\"oss/javascript/migrate/langgraph-v1\"]}]},{\"group\":\"Policies\",\"pages\":[\"oss/javascript/release-policy\",\"oss/javascript/security-policy\"]}]},{\"tab\":\"Contribute\",\"pages\":[\"oss/javascript/contributing/overview\",{\"group\":\"Contribute\",\"icon\":\"heart-circle-plus\",\"pages\":[\"oss/javascript/contributing/documentation\",\"oss/javascript/contributing/code\",{\"group\":\"Integrations\",\"pages\":[\"oss/javascript/contributing/integrations-langchain\",\"oss/javascript/contributing/implement-langchain\",\"oss/javascript/contributing/standard-tests-langchain\",\"oss/javascript/contributing/publish-langchain\",\"oss/javascript/contributing/comarketing\"]}]}]}]}]},{\"product\":\"LangSmith\",\"icon\":\"screwdriver-wrench\",\"description\":\"LLM observability, evaluation, and deployment\",\"tabs\":[{\"tab\":\"Get started\",\"pages\":[\"langsmith/home\",\"langsmith/pricing-plans\",\"langsmith/create-account-api-key\",{\"group\":\"Account administration\",\"pages\":[\"langsmith/administration-overview\",\"langsmith/set-up-hierarchy\",\"langsmith/workload-isolation\",\"langsmith/manage-organization-by-api\",\"langsmith/billing\",\"langsmith/set-up-resource-tags\",\"langsmith/user-management\"]},{\"group\":\"Additional resources\",\"pages\":[\"langsmith/polly\",{\"group\":\"Data management\",\"pages\":[\"langsmith/data-storage-and-privacy\",\"langsmith/data-purging-compliance\"]},{\"group\":\"Access control \u0026 Authentication\",\"pages\":[\"langsmith/rbac\",\"langsmith/organization-workspace-operations\",\"langsmith/authentication-methods\"]},\"langsmith/scalability-and-resilience\",\"langsmith/faq\",\"langsmith/regions-faq\",\"langsmith/pricing-faq\",\"langsmith/status\"]}]},{\"tab\":\"Observability\",\"pages\":[\"langsmith/observability\",\"langsmith/observability-quickstart\",\"langsmith/observability-concepts\",\"langsmith/observability-llm-tutorial\",{\"group\":\"Tracing setup\",\"pages\":[{\"group\":\"Integrations\",\"pages\":[\"langsmith/integrations\",\"langsmith/trace-with-langchain\",\"langsmith/trace-with-langgraph\",\"langsmith/trace-anthropic\",\"langsmith/trace-openai\",\"langsmith/trace-with-autogen\",\"langsmith/trace-claude-agent-sdk\",\"langsmith/trace-claude-code\",\"langsmith/trace-with-crewai\",\"langsmith/trace-with-google-adk\",\"langsmith/trace-with-instructor\",\"langsmith/trace-with-openai-agents-sdk\",\"langsmith/trace-with-opentelemetry\",\"langsmith/trace-with-pydantic-ai\",\"langsmith/trace-with-semantic-kernel\",\"langsmith/trace-with-vercel-ai-sdk\",\"langsmith/trace-with-livekit\",\"langsmith/trace-with-pipecat\"]},{\"group\":\"Manual instrumentation\",\"pages\":[\"langsmith/annotate-code\",\"langsmith/trace-with-api\",\"langsmith/log-llm-trace\",\"langsmith/log-retriever-trace\",\"langsmith/ls-metadata-parameters\",\"langsmith/upload-files-with-traces\"]},\"langsmith/threads\"]},{\"group\":\"Configuration \u0026 troubleshooting\",\"pages\":[{\"group\":\"Project \u0026 environment settings\",\"pages\":[\"langsmith/log-traces-to-project\",\"langsmith/trace-without-env-vars\",\"langsmith/sample-traces\"]},\"langsmith/cost-tracking\",{\"group\":\"Advanced tracing techniques\",\"pages\":[\"langsmith/distributed-tracing\",\"langsmith/serverless-environments\",\"langsmith/log-multimodal-traces\",\"langsmith/trace-generator-functions\"]},{\"group\":\"Data \u0026 privacy\",\"pages\":[\"langsmith/add-metadata-tags\",\"langsmith/mask-inputs-outputs\"]},{\"group\":\"Troubleshooting guides\",\"pages\":[\"langsmith/nest-traces\",\"langsmith/troubleshooting-variable-caching\",\"langsmith/collector-proxy\"]}]},{\"group\":\"Viewing \u0026 managing traces\",\"pages\":[\"langsmith/filter-traces-in-application\",\"langsmith/export-traces\",\"langsmith/compare-traces\",\"langsmith/share-trace\",\"langsmith/langsmith-fetch\",\"langsmith/platform-logs\",\"langsmith/data-export\"]},{\"group\":\"Automations\",\"pages\":[\"langsmith/rules\",\"langsmith/webhooks\"]},{\"group\":\"Feedback \u0026 evaluation\",\"pages\":[\"langsmith/attach-user-feedback\",\"langsmith/online-evaluations\"]},{\"group\":\"Monitoring \u0026 alerting\",\"pages\":[\"langsmith/dashboards\",\"langsmith/alerts\",\"langsmith/alerts-webhook\",\"langsmith/insights\"]},{\"group\":\"Data type reference\",\"pages\":[\"langsmith/run-data-format\",\"langsmith/feedback-data-format\",\"langsmith/trace-query-syntax\"]}]},{\"tab\":\"Evaluation\",\"pages\":[\"langsmith/evaluation\",\"langsmith/evaluation-quickstart\",\"langsmith/evaluation-concepts\",\"langsmith/evaluation-approaches\",{\"group\":\"Datasets\",\"pages\":[{\"group\":\"Create a dataset\",\"pages\":[\"langsmith/manage-datasets-in-application\",\"langsmith/manage-datasets-programmatically\"]},\"langsmith/manage-datasets\",\"langsmith/custom-output-rendering\"]},{\"group\":\"Set up evaluations\",\"pages\":[{\"group\":\"Run an evaluation\",\"pages\":[\"langsmith/evaluate-llm-application\",\"langsmith/run-evaluation-from-prompt-playground\",\"langsmith/prebuilt-evaluators\"]},{\"group\":\"Evaluation types\",\"pages\":[\"langsmith/evaluation-types\",\"langsmith/code-evaluator\",\"langsmith/llm-as-judge\",\"langsmith/composite-evaluators\",\"langsmith/summary\",\"langsmith/evaluate-pairwise\"]},{\"group\":\"Frameworks \u0026 integrations\",\"pages\":[\"langsmith/evaluation-async\",\"langsmith/pytest\",\"langsmith/vitest-jest\",\"langsmith/run-evals-api-only\"]},{\"group\":\"Evaluation techniques\",\"pages\":[\"langsmith/experiment-configuration\",\"langsmith/define-target-function\",\"langsmith/evaluate-on-intermediate-steps\",\"langsmith/multiple-scores\",\"langsmith/metric-type\",\"langsmith/bind-evaluator-to-dataset\",\"langsmith/repetition\",\"langsmith/rate-limiting\",\"langsmith/local\",\"langsmith/read-local-experiment-results\",\"langsmith/langchain-runnable\",\"langsmith/evaluate-graph\",\"langsmith/evaluate-existing-experiment\",\"langsmith/evaluate-with-attachments\",\"langsmith/multi-turn-simulation\",\"langsmith/trajectory-evals\"]},{\"group\":\"Improve evaluators\",\"pages\":[\"langsmith/improve-judge-evaluator-feedback\",\"langsmith/create-few-shot-evaluators\",\"langsmith/index-datasets-for-dynamic-few-shot-example-selection\"]},{\"group\":\"Tutorials\",\"pages\":[\"langsmith/evaluate-chatbot-tutorial\",\"langsmith/evaluate-rag-tutorial\",\"langsmith/test-react-agent-pytest\",\"langsmith/evaluate-complex-agent\",\"langsmith/run-backtests-new-agent\"]}]},{\"group\":\"Analyze experiment results\",\"pages\":[\"langsmith/analyze-an-experiment\",\"langsmith/compare-experiment-results\",\"langsmith/filter-experiments-ui\",\"langsmith/fetch-perf-metrics-experiment\",\"langsmith/upload-existing-experiments\"]},{\"group\":\"Annotation \u0026 human feedback\",\"pages\":[\"langsmith/annotation-queues\",\"langsmith/set-up-feedback-criteria\",\"langsmith/annotate-traces-inline\",\"langsmith/audit-evaluator-scores\"]},{\"group\":\"Common data types\",\"pages\":[\"langsmith/example-data-format\",\"langsmith/dataset-json-types\",\"langsmith/dataset-transformations\"]}]},{\"tab\":\"Prompt engineering\",\"pages\":[\"langsmith/prompt-engineering\",\"langsmith/prompt-engineering-quickstart\",\"langsmith/prompt-engineering-concepts\",{\"group\":\"Create and update prompts\",\"pages\":[\"langsmith/create-a-prompt\",\"langsmith/manage-prompts\",\"langsmith/manage-prompts-programmatically\",\"langsmith/managing-model-configurations\",\"langsmith/use-tools\",\"langsmith/multimodal-content\",\"langsmith/write-prompt-with-ai\",{\"group\":\"Connect to models\",\"pages\":[\"langsmith/custom-openai-compliant-model\",\"langsmith/custom-endpoint\"]}]},{\"group\":\"Tutorials\",\"pages\":[\"langsmith/optimize-classifier\",\"langsmith/prompt-commit\",\"langsmith/multiple-messages\"]}]},{\"tab\":\"Deployment\",\"pages\":[\"langsmith/deployments\",\"langsmith/local-server\",\"langsmith/app-development\",\"langsmith/deployment-quickstart\",{\"group\":\"Configure app for deployment\",\"pages\":[\"langsmith/application-structure\",{\"group\":\"Setup\",\"pages\":[\"langsmith/setup-app-requirements-txt\",\"langsmith/setup-pyproject\",\"langsmith/setup-javascript\",\"langsmith/monorepo-support\"]},{\"group\":\"Deployment components\",\"pages\":[\"langsmith/components\",\"langsmith/agent-server\",\"langsmith/data-plane\",\"langsmith/control-plane\"]},\"langsmith/graph-rebuild\",\"langsmith/use-remote-graph\",\"langsmith/semantic-search\",\"langsmith/configure-ttl\",\"langsmith/agent-server-scale\",\"langsmith/cicd-pipeline-example\"]},{\"group\":\"Deployment guides\",\"pages\":[\"langsmith/deploy-to-cloud\",\"langsmith/deploy-with-control-plane\",\"langsmith/deploy-standalone-server\",\"langsmith/diagnostics-self-hosted\"]},{\"group\":\"App development\",\"pages\":[{\"group\":\"Data models\",\"pages\":[{\"group\":\"Assistants\",\"pages\":[\"langsmith/assistants\",\"langsmith/configuration-cloud\",\"langsmith/use-threads\"]},{\"group\":\"Runs\",\"pages\":[\"langsmith/background-run\",\"langsmith/same-thread\",\"langsmith/cron-jobs\",\"langsmith/stateless-runs\"]}]},{\"group\":\"Core capabilities\",\"pages\":[\"langsmith/streaming\",\"langsmith/add-human-in-the-loop\",\"langsmith/human-in-the-loop-time-travel\",\"langsmith/server-mcp\",\"langsmith/server-a2a\",\"langsmith/agent-server-distributed-tracing\",\"langsmith/use-webhooks\",{\"group\":\"Double-texting\",\"pages\":[\"langsmith/double-texting\",\"langsmith/interrupt-concurrent\",\"langsmith/rollback-concurrent\",\"langsmith/reject-concurrent\",\"langsmith/enqueue-concurrent\"]}]},{\"group\":\"Tutorials\",\"pages\":[\"langsmith/deploy-other-frameworks\",\"langsmith/use-stream-react\",\"langsmith/generative-ui-react\"]}]},{\"group\":\"Studio\",\"pages\":[\"langsmith/studio\",\"langsmith/quick-start-studio\",\"langsmith/use-studio\",\"langsmith/observability-studio\",\"langsmith/troubleshooting-studio\"]},{\"group\":\"Auth \u0026 access control\",\"pages\":[\"langsmith/auth\",\"langsmith/custom-auth\",\"langsmith/set-up-custom-auth\",\"langsmith/resource-auth\",\"langsmith/add-auth-server\",\"langsmith/openapi-security\",\"langsmith/agent-auth\"]},{\"group\":\"Server customization\",\"pages\":[\"langsmith/custom-lifespan\",\"langsmith/custom-middleware\",\"langsmith/custom-routes\",\"langsmith/encryption\",\"langsmith/configurable-headers\",\"langsmith/configurable-logs\"]}]},{\"tab\":\"Agent Builder\",\"pages\":[\"langsmith/agent-builder\",{\"group\":\"Get started\",\"pages\":[\"langsmith/agent-builder-essentials\",{\"group\":\"Templates\",\"pages\":[\"langsmith/agent-builder-templates\",\"langsmith/agent-builder-quickstart\"]},\"langsmith/agent-builder-setup\",\"langsmith/agent-builder-workspace-vs-private\"]},{\"group\":\"Tools and integrations\",\"pages\":[\"langsmith/agent-builder-tools\",\"langsmith/agent-builder-third-party-mcp-servers\",\"langsmith/agent-builder-slack-app\"]},{\"group\":\"Advanced\",\"pages\":[\"langsmith/agent-builder-auth-format\",\"langsmith/agent-builder-code\",\"langsmith/agent-builder-mcp-framework\"]}]},{\"tab\":\"Platform setup\",\"groups\":[{\"group\":\"Overview\",\"pages\":[\"langsmith/platform-setup\",\"langsmith/cloud\"]},{\"group\":\"Self-hosted cloud architecture\",\"pages\":[\"langsmith/aws-self-hosted\",\"langsmith/azure-self-hosted\",\"langsmith/gcp-self-hosted\"]},{\"group\":\"Hybrid\",\"pages\":[\"langsmith/hybrid\",\"langsmith/deploy-hybrid\"]},{\"group\":\"Self-hosted\",\"pages\":[\"langsmith/self-hosted\",{\"group\":\"Setup guides\",\"pages\":[{\"group\":\"LangSmith\",\"icon\":\"server\",\"pages\":[\"langsmith/kubernetes\",\"langsmith/docker\"]},\"langsmith/deploy-self-hosted-full-platform\",{\"group\":\"Manage an installation\",\"pages\":[\"langsmith/self-host-usage\",\"langsmith/self-host-upgrades\",\"langsmith/self-host-egress\",\"langsmith/self-host-organization-charts\",\"langsmith/langsmith-managed-clickhouse\",\"langsmith/self-host-ingress\",\"langsmith/self-host-mirroring-images\"]}]},{\"group\":\"Configuration\",\"pages\":[\"langsmith/self-host-scale\",\"langsmith/self-host-ttl\",\"langsmith/custom-docker\",\"langsmith/self-host-playground-environment-settings\",\"langsmith/troubleshooting\"]},{\"group\":\"Connect external services\",\"pages\":[\"langsmith/self-host-blob-storage\",\"langsmith/self-host-external-clickhouse\",\"langsmith/self-host-external-postgres\",\"langsmith/self-host-external-redis\"]},{\"group\":\"Platform auth \u0026 access control\",\"pages\":[\"langsmith/self-host-basic-auth\",\"langsmith/self-host-sso\",\"langsmith/self-host-user-management\",\"langsmith/self-host-custom-tls-certificates\",\"langsmith/self-host-using-an-existing-secret\"]},{\"group\":\"Self-hosted observability\",\"pages\":[\"langsmith/export-backend\",\"langsmith/langsmith-collector\",\"langsmith/observability-stack\"]},{\"group\":\"Scripts for management tasks\",\"pages\":[\"langsmith/script-delete-a-workspace\",\"langsmith/script-delete-an-organization\",\"langsmith/script-delete-traces\",\"langsmith/script-generate-clickhouse-stats\",\"langsmith/script-generate-query-stats\",\"langsmith/script-running-pg-support-queries\",\"langsmith/script-running-ch-support-queries\"]}]}]},{\"tab\":\"Reference\",\"pages\":[\"langsmith/reference\",\"langsmith/smith-python-sdk\",\"langsmith/smith-js-ts-sdk\",\"langsmith/langgraph-python-sdk\",\"langsmith/langgraph-js-ts-sdk\",\"langsmith/smith-api-ref\",{\"group\":\"LangSmith Deployment\",\"pages\":[{\"group\":\"Agent Server API\",\"pages\":[\"langsmith/server-api-ref\",{\"group\":\"Assistants\",\"pages\":[\"langsmith/agent-server-api/assistants/create-assistant\",\"langsmith/agent-server-api/assistants/search-assistants\",\"langsmith/agent-server-api/assistants/count-assistants\",\"langsmith/agent-server-api/assistants/get-assistant\",\"langsmith/agent-server-api/assistants/delete-assistant\",\"langsmith/agent-server-api/assistants/patch-assistant\",\"langsmith/agent-server-api/assistants/get-assistant-graph\",\"langsmith/agent-server-api/assistants/get-assistant-subgraphs\",\"langsmith/agent-server-api/assistants/get-assistant-subgraphs-by-namespace\",\"langsmith/agent-server-api/assistants/get-assistant-schemas\",\"langsmith/agent-server-api/assistants/get-assistant-versions\",\"langsmith/agent-server-api/assistants/set-latest-assistant-version\"]},{\"group\":\"Threads\",\"pages\":[\"langsmith/agent-server-api/threads/create-thread\",\"langsmith/agent-server-api/threads/search-threads\",\"langsmith/agent-server-api/threads/count-threads\",\"langsmith/agent-server-api/threads/prune-threads\",\"langsmith/agent-server-api/threads/get-thread-state\",\"langsmith/agent-server-api/threads/update-thread-state\",\"langsmith/agent-server-api/threads/get-thread-state-at-checkpoint\",\"langsmith/agent-server-api/threads/get-thread-state-at-checkpoint-1\",\"langsmith/agent-server-api/threads/get-thread-history\",\"langsmith/agent-server-api/threads/get-thread-history-post\",\"langsmith/agent-server-api/threads/copy-thread\",\"langsmith/agent-server-api/threads/get-thread\",\"langsmith/agent-server-api/threads/delete-thread\",\"langsmith/agent-server-api/threads/patch-thread\",\"langsmith/agent-server-api/threads/join-thread-stream\"]},{\"group\":\"Thread Runs\",\"pages\":[\"langsmith/agent-server-api/thread-runs/list-runs\",\"langsmith/agent-server-api/thread-runs/create-background-run\",\"langsmith/agent-server-api/thread-runs/create-run-stream-output\",\"langsmith/agent-server-api/thread-runs/create-run-wait-for-output\",\"langsmith/agent-server-api/thread-runs/get-run\",\"langsmith/agent-server-api/thread-runs/delete-run\",\"langsmith/agent-server-api/thread-runs/join-run\",\"langsmith/agent-server-api/thread-runs/join-run-stream\",\"langsmith/agent-server-api/thread-runs/cancel-run\",\"langsmith/agent-server-api/thread-runs/cancel-runs\"]},{\"group\":\"Crons (Plus tier)\",\"pages\":[\"langsmith/agent-server-api/crons-plus-tier/create-thread-cron\",\"langsmith/agent-server-api/crons-plus-tier/create-cron\",\"langsmith/agent-server-api/crons-plus-tier/search-crons\",\"langsmith/agent-server-api/crons-plus-tier/count-crons\",\"langsmith/agent-server-api/crons-plus-tier/delete-cron\"]},{\"group\":\"Stateless Runs\",\"pages\":[\"langsmith/agent-server-api/stateless-runs/create-run-stream-output\",\"langsmith/agent-server-api/stateless-runs/create-run-wait-for-output\",\"langsmith/agent-server-api/stateless-runs/create-background-run\",\"langsmith/agent-server-api/stateless-runs/create-run-batch\"]},{\"group\":\"Store\",\"pages\":[\"langsmith/agent-server-api/store/retrieve-a-single-item\",\"langsmith/agent-server-api/store/store-or-update-an-item\",\"langsmith/agent-server-api/store/delete-an-item\",\"langsmith/agent-server-api/store/search-for-items-within-a-namespace-prefix\",\"langsmith/agent-server-api/store/list-namespaces-with-optional-match-conditions\"]},{\"group\":\"A2A\",\"pages\":[\"langsmith/agent-server-api/a2a/a2a-post\"]},{\"group\":\"MCP\",\"pages\":[\"langsmith/agent-server-api/mcp/mcp-get\",\"langsmith/agent-server-api/mcp/mcp-post\",\"langsmith/agent-server-api/mcp/terminate-session\"]},{\"group\":\"System\",\"pages\":[\"langsmith/agent-server-api/system/server-information\",\"langsmith/agent-server-api/system/system-metrics\",\"langsmith/agent-server-api/system/health-check\"]}]},{\"group\":\"Control Plane API\",\"pages\":[\"langsmith/api-ref-control-plane\",{\"group\":\"Integrations (v1)\",\"pages\":[\"api-reference/integrations-v1/list-github-integrations\",\"api-reference/integrations-v1/list-github-repositories\"]},{\"group\":\"Deployments (v2)\",\"pages\":[\"api-reference/deployments-v2/list-deployments\",\"api-reference/deployments-v2/create-deployment\",\"api-reference/deployments-v2/get-deployment\",\"api-reference/deployments-v2/delete-deployment\",\"api-reference/deployments-v2/patch-deployment\",\"api-reference/deployments-v2/list-revisions\",\"api-reference/deployments-v2/get-revision\",\"api-reference/deployments-v2/redeploy-revision\"]},{\"group\":\"Listeners (v2)\",\"pages\":[\"api-reference/listeners-v2/list-listeners\",\"api-reference/listeners-v2/create-listener\",\"api-reference/listeners-v2/get-listener\",\"api-reference/listeners-v2/delete-listener\",\"api-reference/listeners-v2/patch-listener\"]},{\"group\":\"Auth Service (v2)\",\"pages\":[\"api-reference/auth-service-v2/list-oauth-providers\",\"api-reference/auth-service-v2/create-oauth-provider\",\"api-reference/auth-service-v2/oauth-setup-callback\",\"api-reference/auth-service-v2/oauth-callback-get\",\"api-reference/auth-service-v2/oauth-callback\",\"api-reference/auth-service-v2/authenticate\",\"api-reference/auth-service-v2/wait-for-auth-completion\",\"api-reference/auth-service-v2/create-mcp-oauth-provider\",\"api-reference/auth-service-v2/get-oauth-provider\",\"api-reference/auth-service-v2/delete-oauth-provider\",\"api-reference/auth-service-v2/update-oauth-provider\",\"api-reference/auth-service-v2/check-oauth-token-exists\",\"api-reference/auth-service-v2/delete-oauth-tokens-for-user\"]}]},\"langsmith/cli\",\"langsmith/remote-graph\",\"langsmith/env-var\"]},{\"group\":\"Releases\",\"pages\":[\"langsmith/agent-server-changelog\",\"langsmith/self-hosted-changelog\",\"langsmith/release-versions\"]}]}]}]},\"footer\":{\"socials\":{\"github\":\"https://github.com/langchain-ai\",\"x\":\"https://x.com/LangChainAI\",\"linkedin\":\"https://www.linkedin.com/company/langchain/\",\"youtube\":\"https://www.youtube.com/@LangChain\"},\"links\":[{\"header\":\"Resources\",\"items\":[{\"label\":\"Forum\",\"href\":\"https://forum.langchain.com/\"},{\"label\":\"Changelog\",\"href\":\"https://changelog.langchain.com/\"},{\"label\":\"LangChain Academy\",\"href\":\"https://academy.langchain.com/\"},{\"label\":\"Trust Center\",\"href\":\"https://trust.langchain.com/\"}]},{\"header\":\"Company\",\"items\":[{\"label\":\"About\",\"href\":\"https://langchain.com/about\"},{\"label\":\"Careers\",\"href\":\"https://langchain.com/careers\"},{\"label\":\"Blog\",\"href\":\"https://blog.langchain.com/\"}]}]},\"seo\":{\"metatags\":{\"canonical\":\"https://docs.langchain.com\",\"google-site-verification\":\"9_2KHeJwmEdwgncBRk1MsKxriZz7Sc21EJdbfCxkTEo\"}},\"fonts\":{\"heading\":{\"family\":\"Manrope\"}},\"styling\":{\"eyebrows\":\"breadcrumbs\",\"latex\":true,\"codeblocks\":\"system\"},\"redirects\":[{\"source\":\"/langchain\",\"destination\":\"/oss/python/langchain/overview\"},{\"source\":\"/langgraph\",\"destination\":\"/oss/python/langgraph/overview\"},{\"source\":\"/deepagents\",\"destination\":\"/oss/python/deepagents/overview\"},{\"source\":\"/langsmith\",\"destination\":\"/langsmith/home\"},{\"source\":\"/js/langchain\",\"destination\":\"/oss/javascript/langchain/overview\"},{\"source\":\"/js/langgraph\",\"destination\":\"/oss/javascript/langgraph/overview\"},{\"source\":\"/python/langchain\",\"destination\":\"/oss/python/langchain/overview\"},{\"source\":\"/python/langgraph\",\"destination\":\"/oss/python/langgraph/overview\"},{\"source\":\"/python/deepagents\",\"destination\":\"/oss/python/deepagents/overview\"},{\"source\":\"/javascript/langchain\",\"destination\":\"/oss/javascript/langchain/overview\"},{\"source\":\"/javascript/langgraph\",\"destination\":\"/oss/javascript/langgraph/overview\"},{\"source\":\"/langsmith/cloud-architecture-and-scalability\",\"destination\":\"/langsmith/cloud#cloud-architecture-and-scalability\"},{\"source\":\"/langsmith/reference-overview\",\"destination\":\"/langsmith/home\"},{\"source\":\"/langsmith/hosting\",\"destination\":\"/langsmith/platform-setup\"},{\"source\":\"/oss/python/langchain-agents\",\"destination\":\"/oss/python/langchain/agents\"},{\"source\":\"/oss/javascript/langchain-agents\",\"destination\":\"/oss/javascript/langchain/agents\"},{\"source\":\"/oss/python/langchain-models\",\"destination\":\"/oss/python/langchain/models\"},{\"source\":\"/oss/javascript/langchain-models\",\"destination\":\"/oss/javascript/langchain/models\"},{\"source\":\"/oss/python/langchain-messages\",\"destination\":\"/oss/python/langchain/messages\"},{\"source\":\"/oss/javascript/langchain-messages\",\"destination\":\"/oss/javascript/langchain/messages\"},{\"source\":\"/oss/python/langchain-tools\",\"destination\":\"/oss/python/langchain/tools\"},{\"source\":\"/oss/javascript/langchain-tools\",\"destination\":\"/oss/javascript/langchain/tools\"},{\"source\":\"/oss/python/langchain-memory\",\"destination\":\"/oss/python/langchain/short-term-memory\"},{\"source\":\"/oss/javascript/langchain-memory\",\"destination\":\"/oss/javascript/langchain/short-term-memory\"},{\"source\":\"/oss/python/langchain-streaming\",\"destination\":\"/oss/python/langchain/streaming\"},{\"source\":\"/oss/javascript/langchain-streaming\",\"destination\":\"/oss/javascript/langchain/streaming\"},{\"source\":\"/oss/python/releases-v1\",\"destination\":\"/oss/python/releases/langchain-v1\"},{\"source\":\"/oss/javascript/releases-v1\",\"destination\":\"/oss/javascript/releases/langchain-v1\"},{\"source\":\"/oss/python/langgraph/human-in-the-loop\",\"destination\":\"/oss/python/langgraph/interrupts\"},{\"source\":\"/oss/javascript/langgraph/human-in-the-loop\",\"destination\":\"/oss/javascript/langgraph/interrupts\"},{\"source\":\"/langgraph-platform/index\",\"destination\":\"/langsmith/deployments\"},{\"source\":\"/langsmith/langgraph-platform-logs\",\"destination\":\"/langsmith/platform-logs\"},{\"source\":\"/langgraph-platform/deployment-options\",\"destination\":\"/langsmith/platform-setup\"},{\"source\":\"/langgraph-platform/langgraph-studio\",\"destination\":\"/langsmith/studio\"},{\"source\":\"/langgraph-platform/langgraph-cli\",\"destination\":\"/langsmith/cli\"},{\"source\":\"/langsmith/api-ref\",\"destination\":\"/langsmith/smith-api-ref\"},{\"source\":\"/langsmith/js-ts-sdk\",\"destination\":\"/langsmith/smith-js-ts-sdk\"},{\"source\":\"/langsmith/python-sdk\",\"destination\":\"/langsmith/smith-python-sdk\"},{\"source\":\"/langgraph-platform/egress-metrics-metadata\",\"destination\":\"/langsmith/self-host-egress\"},{\"source\":\"/langgraph-platform/why-langgraph\",\"destination\":\"/langsmith/app-development\"},{\"source\":\"/langgraph-platform/:path*\",\"destination\":\"/langsmith/:path*\"},{\"source\":\"/oss/python/deepagents/index\",\"destination\":\"/oss/python/deepagents/overview\"},{\"source\":\"/oss/python/integrations/document_loaders/azure_blob_storage_container\",\"destination\":\"/oss/python/integrations/document_loaders/azure_blob_storage\"},{\"source\":\"/oss/python/integrations/document_loaders/azure_blob_storage_file\",\"destination\":\"/oss/python/integrations/document_loaders/azure_blob_storage\"},{\"source\":\"oss/python/langgraph/GRAPH_RECURSION_LIMIT\",\"destination\":\"oss/python/langgraph/errors/GRAPH_RECURSION_LIMIT\"},{\"source\":\"oss/python/langgraph/INVALID_CHAT_HISTORY\",\"destination\":\"oss/python/langgraph/errors/INVALID_CHAT_HISTORY\"},{\"source\":\"oss/python/langgraph/INVALID_CONCURRENT_GRAPH_UPDATE\",\"destination\":\"oss/python/langgraph/errors/INVALID_CONCURRENT_GRAPH_UPDATE\"},{\"source\":\"oss/python/langgraph/INVALID_GRAPH_NODE_RETURN_VALUE\",\"destination\":\"oss/python/langgraph/errors/INVALID_GRAPH_NODE_RETURN_VALUE\"},{\"source\":\"oss/python/langgraph/MULTIPLE_SUBGRAPHS\",\"destination\":\"oss/python/langgraph/errors/MULTIPLE_SUBGRAPHS\"},{\"source\":\"oss/python/langgraph/MISSING_CHECKPOINTER\",\"destination\":\"oss/python/langgraph/errors/MISSING_CHECKPOINTER\"},{\"source\":\"oss/javascript/langgraph/GRAPH_RECURSION_LIMIT\",\"destination\":\"oss/javascript/langgraph/errors/GRAPH_RECURSION_LIMIT\"},{\"source\":\"oss/javascript/langgraph/INVALID_CHAT_HISTORY\",\"destination\":\"oss/javascript/langgraph/errors/INVALID_CHAT_HISTORY\"},{\"source\":\"oss/javascript/langgraph/INVALID_CONCURRENT_GRAPH_UPDATE\",\"destination\":\"oss/javascript/langgraph/errors/INVALID_CONCURRENT_GRAPH_UPDATE\"},{\"source\":\"oss/javascript/langgraph/INVALID_GRAPH_NODE_RETURN_VALUE\",\"destination\":\"oss/javascript/langgraph/errors/INVALID_GRAPH_NODE_RETURN_VALUE\"},{\"source\":\"oss/javascript/langgraph/MULTIPLE_SUBGRAPHS\",\"destination\":\"oss/javascript/langgraph/errors/MULTIPLE_SUBGRAPHS\"},{\"source\":\"oss/javascript/langgraph/MISSING_CHECKPOINTER\",\"destination\":\"oss/javascript/langgraph/errors/MISSING_CHECKPOINTER\"},{\"source\":\"oss/python/langgraph/common-errors\",\"destination\":\"oss/python/common-errors\"},{\"source\":\"oss/javascript/langgraph/common-errors\",\"destination\":\"oss/javascript/common-errors\"},{\"source\":\"oss/python/langchain/INVALID_PROMPT_INPUT\",\"destination\":\"oss/python/langchain/errors/INVALID_PROMPT_INPUT\"},{\"source\":\"oss/python/langchain/MODEL_AUTHENTICATION\",\"destination\":\"oss/python/langchain/errors/MODEL_AUTHENTICATION\"},{\"source\":\"oss/python/langchain/MODEL_NOT_FOUND\",\"destination\":\"oss/python/langchain/errors/MODEL_NOT_FOUND\"},{\"source\":\"oss/python/langchain/MODEL_RATE_LIMIT\",\"destination\":\"oss/python/langchain/errors/MODEL_RATE_LIMIT\"},{\"source\":\"oss/python/langchain/MESSAGE_COERCION_FAILURE\",\"destination\":\"oss/python/langchain/errors/MESSAGE_COERCION_FAILURE\"},{\"source\":\"oss/python/langchain/INVALID_TOOL_RESULTS\",\"destination\":\"oss/python/langchain/errors/INVALID_TOOL_RESULTS\"},{\"source\":\"oss/python/langchain/OUTPUT_PARSING_FAILURE\",\"destination\":\"oss/python/langchain/errors/OUTPUT_PARSING_FAILURE\"},{\"source\":\"oss/javascript/langchain/INVALID_PROMPT_INPUT\",\"destination\":\"oss/javascript/langchain/errors/INVALID_PROMPT_INPUT\"},{\"source\":\"oss/javascript/langchain/MODEL_AUTHENTICATION\",\"destination\":\"oss/javascript/langchain/errors/MODEL_AUTHENTICATION\"},{\"source\":\"oss/javascript/langchain/MODEL_NOT_FOUND\",\"destination\":\"oss/javascript/langchain/errors/MODEL_NOT_FOUND\"},{\"source\":\"oss/javascript/langchain/MODEL_RATE_LIMIT\",\"destination\":\"oss/javascript/langchain/errors/MODEL_RATE_LIMIT\"},{\"source\":\"oss/javascript/langchain/MESSAGE_COERCION_FAILURE\",\"destination\":\"oss/javascript/langchain/errors/MESSAGE_COERCION_FAILURE\"},{\"source\":\"oss/javascript/langchain/INVALID_TOOL_RESULTS\",\"destination\":\"oss/javascript/langchain/errors/INVALID_TOOL_RESULTS\"},{\"source\":\"oss/javascript/langchain/OUTPUT_PARSING_FAILURE\",\"destination\":\"oss/javascript/langchain/errors/OUTPUT_PARSING_FAILURE\"},{\"source\":\"/langsmith/langgraph-server\",\"destination\":\"/langsmith/agent-server\"},{\"source\":\"/langsmith/langgraph-server-changelog\",\"destination\":\"/langsmith/agent-server-changelog\"},{\"source\":\"/oss/python/langchain/middleware\",\"destination\":\"/oss/python/langchain/middleware/overview\"},{\"source\":\"/oss/javascript/langchain/middleware\",\"destination\":\"/oss/javascript/langchain/middleware/overview\"},{\"source\":\"/oss/python/integrations/tools/toolbox\",\"destination\":\"/oss/python/integrations/tools/mcp_toolbox\"},{\"source\":\"/oss/integrations/tools/toolbox\",\"destination\":\"/oss/integrations/tools/mcp_toolbox\"},{\"source\":\"/oss/python/integrations/tools/gmail\",\"destination\":\"/oss/python/integrations/tools/google_gmail\"},{\"source\":\"/oss/integrations/tools/gmail\",\"destination\":\"/oss/integrations/tools/google_gmail\"},{\"source\":\"/oss/javascript/integrations/tools/gmail\",\"destination\":\"/oss/javascript/integrations/tools/google_gmail\"},{\"source\":\"/oss/python/integrations/chat_loaders/gmail\",\"destination\":\"/oss/python/integrations/chat_loaders/google_gmail\"},{\"source\":\"/oss/integrations/chat_loaders/gmail\",\"destination\":\"/oss/integrations/chat_loaders/google_gmail\"},{\"source\":\"/oss/python/integrations/vectorstores/scann\",\"destination\":\"/oss/python/integrations/vectorstores/google_scann\"},{\"source\":\"/oss/integrations/vectorstores/scann\",\"destination\":\"/oss/integrations/vectorstores/google_scann\"},{\"source\":\"/oss/python/integrations/chat/google_vertex_ai_palm\",\"destination\":\"/oss/python/integrations/chat/google_vertex_ai\"},{\"source\":\"/oss/integrations/chat/google_vertex_ai_palm\",\"destination\":\"/oss/integrations/chat/google_vertex_ai\"},{\"source\":\"/oss/python/integrations/text_embedding/google_vertex_ai_palm\",\"destination\":\"/oss/python/integrations/text_embedding/google_vertex_ai\"},{\"source\":\"/oss/integrations/text_embedding/google_vertex_ai_palm\",\"destination\":\"/oss/integrations/text_embedding/google_vertex_ai\"},{\"source\":\"/oss/python/integrations/llms/google_vertex_ai_palm\",\"destination\":\"/oss/python/integrations/llms/google_vertex_ai\"},{\"source\":\"/oss/integrations/llms/google_vertex_ai_palm\",\"destination\":\"/oss/integrations/llms/google_vertex_ai\"},{\"source\":\"/oss/javascript/integrations/text_embedding/google_generativeai\",\"destination\":\"/oss/javascript/integrations/text_embedding/google_generative_ai\"},{\"source\":\"/oss/integrations/text_embedding/google_generativeai\",\"destination\":\"/oss/integrations/text_embedding/google_generative_ai\"},{\"source\":\"/langsmith/agent-server-api-ref\",\"destination\":\"/langsmith/server-api-ref\"},{\"source\":\"/oss/python/integrations/llms/google_ai\",\"destination\":\"/oss/python/integrations/llms/google_generative_ai\"},{\"source\":\"/oss/python/langchain/supervisor\",\"destination\":\"/oss/python/langchain/multi-agent/subagents-personal-assistant\"},{\"source\":\"/oss/javascript/langchain/supervisor\",\"destination\":\"/oss/javascript/langchain/multi-agent/subagents-personal-assistant\"}],\"integrations\":{\"gtm\":{\"tagId\":\"GTM-MBBX68ST\"}},\"errors\":{\"404\":{\"redirect\":false,\"title\":\"Page not found\",\"description\":\"We couldn't find the page you were looking for.\"}},\"contextual\":{\"options\":[\"copy\",\"view\",{\"title\":\"llms.txt\",\"description\":\"Open llms.txt for this site\",\"icon\":\"file\",\"href\":\"https://docs.langchain.com/llms.txt\"},\"chatgpt\",\"claude\",\"mcp\",\"cursor\",\"vscode\"]},\"interaction\":{\"drilldown\":true}},\"docsNavWithMetadata\":{\"global\":null,\"products\":[{\"product\":\"Home\",\"icon\":\"house\",\"pages\":[{\"title\":null,\"sidebarTitle\":\"Home\",\"mode\":\"custom\",\"description\":null,\"href\":\"/index\"}]},{\"product\":\"LangChain + LangGraph\",\"icon\":\"link\",\"description\":\"Open source frameworks\",\"dropdowns\":[{\"dropdown\":\"Python\",\"icon\":\"python\",\"tabs\":[{\"tab\":\"LangChain\",\"pages\":[{\"title\":\"LangChain overview\",\"sidebarTitle\":\"Overview\",\"description\":\"LangChain is an open source framework with a pre-built agent architecture and integrations for any model or tool â€” so you can build agents that adapt as fast as the ecosystem evolves\",\"href\":\"/oss/python/langchain/overview\"},{\"group\":\"Get started\",\"pages\":[{\"title\":\"Install LangChain\",\"sidebarTitle\":\"Install\",\"description\":null,\"href\":\"/oss/python/langchain/install\"},{\"title\":\"Quickstart\",\"description\":null,\"href\":\"/oss/python/langchain/quickstart\"},{\"title\":\"Changelog\",\"url\":\"https://docs.langchain.com/oss/python/releases/changelog\",\"description\":null,\"href\":\"/oss/python/langchain/changelog-py\"},{\"title\":\"Philosophy\",\"description\":\"LangChain exists to be the easiest place to start building with LLMs, while also being flexible and production-ready.\",\"mode\":\"wide\",\"href\":\"/oss/python/langchain/philosophy\"}]},{\"group\":\"Core components\",\"pages\":[{\"title\":\"Agents\",\"description\":null,\"href\":\"/oss/python/langchain/agents\"},{\"title\":\"Models\",\"description\":null,\"href\":\"/oss/python/langchain/models\"},{\"title\":\"Messages\",\"description\":null,\"href\":\"/oss/python/langchain/messages\"},{\"title\":\"Tools\",\"description\":null,\"href\":\"/oss/python/langchain/tools\"},{\"title\":\"Short-term memory\",\"description\":null,\"href\":\"/oss/python/langchain/short-term-memory\"},{\"title\":\"Streaming\",\"description\":null,\"href\":\"/oss/python/langchain/streaming\"},{\"title\":\"Structured output\",\"description\":null,\"href\":\"/oss/python/langchain/structured-output\"}]},{\"group\":\"Middleware\",\"pages\":[{\"title\":\"Overview\",\"description\":\"Control and customize agent execution at every step\",\"href\":\"/oss/python/langchain/middleware/overview\"},{\"title\":\"Built-in middleware\",\"description\":\"Prebuilt middleware for common agent use cases\",\"href\":\"/oss/python/langchain/middleware/built-in\"},{\"title\":\"Custom middleware\",\"description\":null,\"href\":\"/oss/python/langchain/middleware/custom\"}]},{\"group\":\"Advanced usage\",\"pages\":[{\"title\":\"Guardrails\",\"description\":\"Implement safety checks and content filtering for your agents\",\"href\":\"/oss/python/langchain/guardrails\"},{\"title\":\"Runtime\",\"description\":null,\"href\":\"/oss/python/langchain/runtime\"},{\"title\":\"Context engineering in agents\",\"sidebarTitle\":\"Context engineering\",\"description\":null,\"href\":\"/oss/python/langchain/context-engineering\"},{\"title\":\"Model Context Protocol (MCP)\",\"description\":null,\"href\":\"/oss/python/langchain/mcp\"},{\"title\":\"Human-in-the-loop\",\"description\":null,\"href\":\"/oss/python/langchain/human-in-the-loop\"},{\"group\":\"Multi-agent\",\"pages\":[{\"title\":\"Multi-agent\",\"sidebarTitle\":\"Overview\",\"description\":null,\"href\":\"/oss/python/langchain/multi-agent/index\"},{\"title\":\"Subagents\",\"description\":null,\"href\":\"/oss/python/langchain/multi-agent/subagents\"},{\"title\":\"Handoffs\",\"description\":null,\"href\":\"/oss/python/langchain/multi-agent/handoffs\"},{\"title\":\"Skills\",\"description\":null,\"href\":\"/oss/python/langchain/multi-agent/skills\"},{\"title\":\"Router\",\"description\":null,\"href\":\"/oss/python/langchain/multi-agent/router\"},{\"title\":\"Custom workflow\",\"description\":null,\"href\":\"/oss/python/langchain/multi-agent/custom-workflow\"}]},{\"title\":\"Retrieval\",\"description\":null,\"href\":\"/oss/python/langchain/retrieval\"},{\"title\":\"Long-term memory\",\"description\":null,\"href\":\"/oss/python/langchain/long-term-memory\"}]},{\"group\":\"Agent development\",\"pages\":[{\"title\":\"LangSmith Studio\",\"sidebarTitle\":\"LangSmith Studio\",\"description\":null,\"href\":\"/oss/python/langchain/studio\"},{\"title\":\"Test\",\"description\":null,\"href\":\"/oss/python/langchain/test\"},{\"title\":\"Agent Chat UI\",\"description\":null,\"href\":\"/oss/python/langchain/ui\"}]},{\"group\":\"Deploy with LangSmith\",\"pages\":[{\"title\":\"LangSmith Deployment\",\"sidebarTitle\":\"Deployment\",\"description\":null,\"href\":\"/oss/python/langchain/deploy\"},{\"title\":\"LangSmith Observability\",\"sidebarTitle\":\"Observability\",\"description\":null,\"href\":\"/oss/python/langchain/observability\"}]}]},{\"tab\":\"LangGraph\",\"pages\":[{\"title\":\"LangGraph overview\",\"sidebarTitle\":\"Overview\",\"description\":\"Gain control with LangGraph to design agents that reliably handle complex tasks\",\"href\":\"/oss/python/langgraph/overview\"},{\"group\":\"Get started\",\"pages\":[{\"title\":\"Install LangGraph\",\"sidebarTitle\":\"Install\",\"description\":null,\"href\":\"/oss/python/langgraph/install\"},{\"title\":\"Quickstart\",\"description\":null,\"href\":\"/oss/python/langgraph/quickstart\"},{\"title\":\"Run a local server\",\"sidebarTitle\":\"Local server\",\"description\":null,\"href\":\"/oss/python/langgraph/local-server\"},{\"title\":\"Changelog\",\"url\":\"https://docs.langchain.com/oss/python/releases/changelog\",\"description\":null,\"href\":\"/oss/python/langgraph/changelog-py\"},{\"title\":\"Thinking in LangGraph\",\"description\":\"Learn how to think about building agents with LangGraph\",\"href\":\"/oss/python/langgraph/thinking-in-langgraph\"},{\"title\":\"Workflows and agents\",\"sidebarTitle\":\"Workflows + agents\",\"description\":null,\"href\":\"/oss/python/langgraph/workflows-agents\"}]},{\"group\":\"Capabilities\",\"pages\":[{\"title\":\"Persistence\",\"description\":null,\"href\":\"/oss/python/langgraph/persistence\"},{\"title\":\"Durable execution\",\"description\":null,\"href\":\"/oss/python/langgraph/durable-execution\"},{\"title\":\"Streaming\",\"description\":null,\"href\":\"/oss/python/langgraph/streaming\"},{\"title\":\"Interrupts\",\"description\":null,\"href\":\"/oss/python/langgraph/interrupts\"},{\"title\":\"Use time-travel\",\"sidebarTitle\":\"Time travel\",\"description\":null,\"href\":\"/oss/python/langgraph/use-time-travel\"},{\"title\":\"Memory\",\"description\":null,\"href\":\"/oss/python/langgraph/add-memory\"},{\"title\":\"Subgraphs\",\"sidebarTitle\":\"Subgraphs\",\"description\":null,\"href\":\"/oss/python/langgraph/use-subgraphs\"}]},{\"group\":\"Production\",\"pages\":[{\"title\":\"Application structure\",\"description\":null,\"href\":\"/oss/python/langgraph/application-structure\"},{\"title\":\"Test\",\"description\":null,\"href\":\"/oss/python/langgraph/test\"},{\"title\":\"LangSmith Studio\",\"description\":null,\"href\":\"/oss/python/langgraph/studio\"},{\"title\":\"Agent Chat UI\",\"description\":null,\"href\":\"/oss/python/langgraph/ui\"},{\"title\":\"LangSmith Deployment\",\"description\":null,\"href\":\"/oss/python/langgraph/deploy\"},{\"title\":\"LangSmith Observability\",\"description\":null,\"href\":\"/oss/python/langgraph/observability\"}]},{\"group\":\"LangGraph APIs\",\"pages\":[{\"group\":\"Graph API\",\"pages\":[{\"title\":\"Choosing between Graph and Functional APIs\",\"sidebarTitle\":\"Choosing APIs\",\"description\":null,\"href\":\"/oss/python/langgraph/choosing-apis\"},{\"title\":\"Graph API overview\",\"sidebarTitle\":\"Graph API\",\"description\":null,\"href\":\"/oss/python/langgraph/graph-api\"},{\"title\":\"Use the graph API\",\"sidebarTitle\":\"Use the graph API\",\"description\":null,\"href\":\"/oss/python/langgraph/use-graph-api\"}]},{\"group\":\"Functional API\",\"pages\":[{\"title\":\"Functional API overview\",\"sidebarTitle\":\"Functional API\",\"description\":null,\"href\":\"/oss/python/langgraph/functional-api\"},{\"title\":\"Use the functional API\",\"sidebarTitle\":\"Use the Functional API\",\"description\":null,\"href\":\"/oss/python/langgraph/use-functional-api\"}]},{\"title\":\"LangGraph runtime\",\"sidebarTitle\":\"Runtime\",\"description\":null,\"href\":\"/oss/python/langgraph/pregel\"}]}]},{\"tab\":\"Deep Agents\",\"pages\":[{\"title\":\"Deep Agents overview\",\"sidebarTitle\":\"Overview\",\"description\":\"Build agents that can plan, use subagents, and leverage file systems for complex tasks\",\"href\":\"/oss/python/deepagents/overview\"},{\"group\":\"Get started\",\"pages\":[{\"title\":\"Quickstart\",\"description\":\"Build your first deep agent in minutes\",\"href\":\"/oss/python/deepagents/quickstart\"},{\"title\":\"Customize Deep Agents\",\"sidebarTitle\":\"Customization\",\"description\":\"Learn how to customize deep agents with system prompts, tools, subagents, and more\",\"href\":\"/oss/python/deepagents/customization\"}]},{\"group\":\"Core capabilities\",\"pages\":[{\"title\":\"Agent harness capabilities\",\"sidebarTitle\":\"Agent harness\",\"description\":null,\"href\":\"/oss/python/deepagents/harness\"},{\"title\":\"Backends\",\"description\":\"Choose and configure filesystem backends for deep agents. You can specify routes to different backends, implement virtual filesystems, and enforce policies.\",\"href\":\"/oss/python/deepagents/backends\"},{\"title\":\"Subagents\",\"description\":\"Learn how to use subagents to delegate work and keep context clean\",\"href\":\"/oss/python/deepagents/subagents\"},{\"title\":\"Human-in-the-loop\",\"description\":\"Learn how to configure human approval for sensitive tool operations\",\"href\":\"/oss/python/deepagents/human-in-the-loop\"},{\"title\":\"Long-term memory\",\"description\":\"Learn how to extend deep agents with persistent memory across threads\",\"href\":\"/oss/python/deepagents/long-term-memory\"},{\"title\":\"Deep Agents Middleware\",\"sidebarTitle\":\"Middleware\",\"description\":\"Understand the middleware that powers deep agents\",\"href\":\"/oss/python/deepagents/middleware\"}]},{\"group\":\"Command line interface\",\"pages\":[{\"title\":\"Deep Agents CLI\",\"sidebarTitle\":\"Use the CLI\",\"description\":\"Interactive command-line interface for building with Deep Agents\",\"href\":\"/oss/python/deepagents/cli\"}]}]},{\"tab\":\"Integrations\",\"pages\":[{\"title\":\"LangChain integrations packages\",\"sidebarTitle\":\"LangChain integrations\",\"mode\":\"wide\",\"description\":null,\"href\":\"/oss/python/integrations/providers/overview\"},{\"title\":\"All integration providers\",\"sidebarTitle\":\"All providers\",\"mode\":\"wide\",\"description\":null,\"href\":\"/oss/python/integrations/providers/all_providers\"},{\"group\":\"Popular Providers\",\"icon\":\"user-group\",\"pages\":[{\"title\":\"OpenAI\",\"description\":null,\"href\":\"/oss/python/integrations/providers/openai\"},{\"title\":\"Anthropic (Claude)\",\"description\":null,\"href\":\"/oss/python/integrations/providers/anthropic\"},{\"title\":\"Google\",\"description\":null,\"href\":\"/oss/python/integrations/providers/google\"},{\"title\":\"AWS (Amazon)\",\"description\":null,\"href\":\"/oss/python/integrations/providers/aws\"},{\"title\":\"Hugging Face\",\"description\":null,\"href\":\"/oss/python/integrations/providers/huggingface\"},{\"title\":\"Microsoft\",\"description\":null,\"href\":\"/oss/python/integrations/providers/microsoft\"},{\"title\":\"Ollama\",\"description\":null,\"href\":\"/oss/python/integrations/providers/ollama\"},{\"title\":\"ChatGroq\",\"sidebarTitle\":\"Groq\",\"description\":\"Get started using Groq [chat models](/oss/python/langchain/models) in LangChain.\",\"href\":\"/oss/python/integrations/chat/groq\"}]},{\"group\":\"Integrations by component\",\"icon\":\"plug\",\"pages\":[{\"title\":\"Chat models\",\"mode\":\"wide\",\"description\":null,\"href\":\"/oss/python/integrations/chat/index\"},{\"title\":\"Tools and toolkits\",\"description\":null,\"href\":\"/oss/python/integrations/tools/index\"},{\"title\":\"Provider-specific middleware\",\"sidebarTitle\":\"Middleware\",\"description\":null,\"href\":\"/oss/python/integrations/middleware/index\"},{\"title\":\"Retrievers\",\"description\":null,\"href\":\"/oss/python/integrations/retrievers/index\"},{\"title\":\"Text splitters\",\"description\":null,\"href\":\"/oss/python/integrations/splitters/index\"},{\"title\":\"Embedding models\",\"description\":null,\"href\":\"/oss/python/integrations/text_embedding/index\"},{\"title\":\"Vector stores\",\"description\":null,\"href\":\"/oss/python/integrations/vectorstores/index\"},{\"sidebar_position\":0,\"sidebarTitle\":\"Document loaders\",\"title\":null,\"description\":null,\"href\":\"/oss/python/integrations/document_loaders/index\"},{\"title\":\"Key-value stores\",\"description\":null,\"href\":\"/oss/python/integrations/stores/index\"}]}]},{\"tab\":\"Learn\",\"pages\":[{\"title\":\"Learn\",\"description\":\"Tutorials, conceptual guides, and resources to help you get started.\",\"href\":\"/oss/python/learn\"},{\"group\":\"Tutorials\",\"icon\":\"code\",\"pages\":[{\"group\":\"LangChain\",\"expanded\":true,\"pages\":[{\"title\":\"Build a semantic search engine with LangChain\",\"sidebarTitle\":\"Semantic search\",\"description\":null,\"href\":\"/oss/python/langchain/knowledge-base\"},{\"title\":\"Build a RAG agent with LangChain\",\"sidebarTitle\":\"RAG agent\",\"description\":null,\"href\":\"/oss/python/langchain/rag\"},{\"title\":\"Build a SQL agent\",\"sidebarTitle\":\"SQL agent\",\"description\":null,\"href\":\"/oss/python/langchain/sql-agent\"},{\"title\":\"Build a voice agent with LangChain\",\"sidebarTitle\":\"Voice agent\",\"description\":null,\"href\":\"/oss/python/langchain/voice-agent\"}]},{\"group\":\"Multi-agent\",\"expanded\":true,\"pages\":[{\"title\":\"Build a personal assistant with subagents\",\"sidebarTitle\":\"Subagents: Personal assistant\",\"description\":null,\"href\":\"/oss/python/langchain/multi-agent/subagents-personal-assistant\"},{\"title\":\"Build customer support with handoffs\",\"sidebarTitle\":\"Handoffs: Customer support\",\"description\":null,\"href\":\"/oss/python/langchain/multi-agent/handoffs-customer-support\"},{\"title\":\"Build a multi-source knowledge base with routing\",\"sidebarTitle\":\"Router: Knowledge base\",\"description\":null,\"href\":\"/oss/python/langchain/multi-agent/router-knowledge-base\"},{\"title\":\"Build a SQL assistant with on-demand skills\",\"sidebarTitle\":\"Skills: SQL assistant\",\"description\":null,\"href\":\"/oss/python/langchain/multi-agent/skills-sql-assistant\"}]},{\"group\":\"LangGraph\",\"expanded\":true,\"pages\":[{\"title\":\"Build a custom RAG agent with LangGraph\",\"sidebarTitle\":\"Custom RAG agent\",\"description\":null,\"href\":\"/oss/python/langgraph/agentic-rag\"},{\"title\":\"Build a custom SQL agent\",\"sidebarTitle\":\"Custom SQL agent\",\"description\":null,\"href\":\"/oss/python/langgraph/sql-agent\"}]}]},{\"group\":\"Conceptual overviews\",\"icon\":\"book\",\"pages\":[{\"title\":\"Component architecture\",\"description\":null,\"href\":\"/oss/python/langchain/component-architecture\"},{\"title\":\"Memory overview\",\"sidebarTitle\":\"Memory\",\"description\":null,\"href\":\"/oss/python/concepts/memory\"},{\"title\":\"Context overview\",\"sidebarTitle\":\"Context\",\"description\":null,\"href\":\"/oss/python/concepts/context\"},{\"title\":\"Graph API overview\",\"sidebarTitle\":\"Graph API\",\"description\":null,\"href\":\"/oss/python/langgraph/graph-api\"},{\"title\":\"Functional API overview\",\"sidebarTitle\":\"Functional API\",\"description\":null,\"href\":\"/oss/python/langgraph/functional-api\"}]},{\"group\":\"Additional resources\",\"icon\":\"list\",\"pages\":[{\"title\":\"LangChain Academy\",\"url\":\"https://academy.langchain.com/\",\"description\":null,\"href\":\"/oss/python/langchain/academy\"},{\"title\":\"Case studies\",\"description\":null,\"href\":\"/oss/python/langgraph/case-studies\"},{\"title\":\"Get help\",\"description\":null,\"href\":\"/oss/python/langchain/get-help\"}]}]},{\"tab\":\"Reference\",\"pages\":[{\"title\":\"Reference\",\"sidebarTitle\":\"Overview\",\"description\":null,\"href\":\"/oss/python/reference/overview\"},{\"group\":\"Reference\",\"pages\":[{\"title\":\"LangChain SDK\",\"url\":\"https://reference.langchain.com/python/langchain/\",\"description\":null,\"href\":\"/oss/python/reference/langchain-python\"},{\"title\":\"LangGraph SDK\",\"url\":\"https://reference.langchain.com/python/langgraph/\",\"description\":null,\"href\":\"/oss/python/reference/langgraph-python\"},{\"title\":\"Integrations\",\"url\":\"https://reference.langchain.com/python/integrations/\",\"description\":null,\"href\":\"/oss/python/reference/integrations-python\"},{\"title\":\"Deep Agents\",\"url\":\"https://reference.langchain.com/python/deepagents/\",\"description\":null,\"href\":\"/oss/python/reference/deepagents-python\"}]},{\"group\":\"Errors\",\"pages\":[{\"title\":\"Errors\",\"sidebarTitle\":\"Reference\",\"description\":null,\"href\":\"/oss/python/common-errors\"}]},{\"group\":\"Releases\",\"pages\":[{\"title\":\"Versioning\",\"description\":null,\"href\":\"/oss/python/versioning\"},{\"title\":\"Changelog\",\"sidebarTitle\":\"Changelog\",\"description\":\"Log of updates and improvements to our Python packages\",\"rss\":true,\"href\":\"/oss/python/releases/changelog\"},{\"group\":\"Releases\",\"pages\":[{\"title\":\"What's new in LangChain v1\",\"sidebarTitle\":\"LangChain v1\",\"description\":null,\"href\":\"/oss/python/releases/langchain-v1\"},{\"title\":\"What's new in LangGraph v1\",\"sidebarTitle\":\"LangGraph v1\",\"description\":null,\"href\":\"/oss/python/releases/langgraph-v1\"}]},{\"group\":\"Migration guides\",\"pages\":[{\"title\":\"LangChain v1 migration guide\",\"sidebarTitle\":\"LangChain v1\",\"description\":null,\"href\":\"/oss/python/migrate/langchain-v1\"},{\"title\":\"LangGraph v1 migration guide\",\"sidebarTitle\":\"LangGraph v1\",\"description\":null,\"href\":\"/oss/python/migrate/langgraph-v1\"}]}]},{\"group\":\"Policies\",\"pages\":[{\"title\":\"Release policy\",\"description\":null,\"href\":\"/oss/python/release-policy\"},{\"title\":\"Security policy\",\"sidebarTitle\":\"Security\",\"description\":null,\"href\":\"/oss/python/security-policy\"}]}]},{\"tab\":\"Contribute\",\"pages\":[{\"title\":\"Contributing\",\"sidebarTitle\":\"Overview\",\"description\":null,\"href\":\"/oss/python/contributing/overview\"},{\"group\":\"Contribute\",\"icon\":\"heart-circle-plus\",\"pages\":[{\"title\":\"Contributing to documentation\",\"sidebarTitle\":\"Documentation\",\"description\":null,\"href\":\"/oss/python/contributing/documentation\"},{\"title\":\"Contributing to code\",\"sidebarTitle\":\"Code\",\"description\":null,\"href\":\"/oss/python/contributing/code\"},{\"group\":\"Integrations\",\"pages\":[{\"title\":\"Contributing integrations\",\"sidebarTitle\":\"Guide\",\"description\":null,\"href\":\"/oss/python/contributing/integrations-langchain\"},{\"title\":\"Implement a LangChain integration\",\"sidebarTitle\":\"Implement\",\"description\":null,\"href\":\"/oss/python/contributing/implement-langchain\"},{\"title\":\"Using standard tests\",\"sidebarTitle\":\"Standard tests\",\"description\":null,\"href\":\"/oss/python/contributing/standard-tests-langchain\"},{\"title\":\"Publish an integration\",\"sidebarTitle\":\"Publish\",\"description\":null,\"href\":\"/oss/python/contributing/publish-langchain\"},{\"title\":\"Co-marketing\",\"description\":null,\"href\":\"/oss/python/contributing/comarketing\"}]}]}]}]},{\"dropdown\":\"TypeScript\",\"icon\":\"square-js\",\"tabs\":[{\"tab\":\"LangChain\",\"pages\":[{\"title\":\"LangChain overview\",\"sidebarTitle\":\"Overview\",\"description\":\"LangChain is an open source framework with a pre-built agent architecture and integrations for any model or tool â€” so you can build agents that adapt as fast as the ecosystem evolves\",\"href\":\"/oss/javascript/langchain/overview\"},{\"group\":\"Get started\",\"pages\":[{\"title\":\"Install LangChain\",\"sidebarTitle\":\"Install\",\"description\":null,\"href\":\"/oss/javascript/langchain/install\"},{\"title\":\"Quickstart\",\"description\":null,\"href\":\"/oss/javascript/langchain/quickstart\"},{\"title\":\"Changelog\",\"url\":\"https://docs.langchain.com/oss/javascript/releases/changelog\",\"description\":null,\"href\":\"/oss/javascript/langchain/changelog-js\"},{\"title\":\"Philosophy\",\"description\":\"LangChain exists to be the easiest place to start building with LLMs, while also being flexible and production-ready.\",\"mode\":\"wide\",\"href\":\"/oss/javascript/langchain/philosophy\"}]},{\"group\":\"Core components\",\"pages\":[{\"title\":\"Agents\",\"description\":null,\"href\":\"/oss/javascript/langchain/agents\"},{\"title\":\"Models\",\"description\":null,\"href\":\"/oss/javascript/langchain/models\"},{\"title\":\"Messages\",\"description\":null,\"href\":\"/oss/javascript/langchain/messages\"},{\"title\":\"Tools\",\"description\":null,\"href\":\"/oss/javascript/langchain/tools\"},{\"title\":\"Short-term memory\",\"description\":null,\"href\":\"/oss/javascript/langchain/short-term-memory\"},{\"title\":\"Streaming\",\"description\":null,\"href\":\"/oss/javascript/langchain/streaming\"},{\"title\":\"Structured output\",\"description\":null,\"href\":\"/oss/javascript/langchain/structured-output\"}]},{\"group\":\"Middleware\",\"pages\":[{\"title\":\"Overview\",\"description\":\"Control and customize agent execution at every step\",\"href\":\"/oss/javascript/langchain/middleware/overview\"},{\"title\":\"Built-in middleware\",\"description\":\"Prebuilt middleware for common agent use cases\",\"href\":\"/oss/javascript/langchain/middleware/built-in\"},{\"title\":\"Custom middleware\",\"description\":null,\"href\":\"/oss/javascript/langchain/middleware/custom\"}]},{\"group\":\"Advanced usage\",\"pages\":[{\"title\":\"Guardrails\",\"description\":\"Implement safety checks and content filtering for your agents\",\"href\":\"/oss/javascript/langchain/guardrails\"},{\"title\":\"Runtime\",\"description\":null,\"href\":\"/oss/javascript/langchain/runtime\"},{\"title\":\"Context engineering in agents\",\"sidebarTitle\":\"Context engineering\",\"description\":null,\"href\":\"/oss/javascript/langchain/context-engineering\"},{\"title\":\"Model Context Protocol (MCP)\",\"description\":null,\"href\":\"/oss/javascript/langchain/mcp\"},{\"title\":\"Human-in-the-loop\",\"description\":null,\"href\":\"/oss/javascript/langchain/human-in-the-loop\"},{\"group\":\"Multi-agent\",\"pages\":[{\"title\":\"Multi-agent\",\"sidebarTitle\":\"Overview\",\"description\":null,\"href\":\"/oss/javascript/langchain/multi-agent/index\"},{\"title\":\"Subagents\",\"description\":null,\"href\":\"/oss/javascript/langchain/multi-agent/subagents\"},{\"title\":\"Handoffs\",\"description\":null,\"href\":\"/oss/javascript/langchain/multi-agent/handoffs\"},{\"title\":\"Skills\",\"description\":null,\"href\":\"/oss/javascript/langchain/multi-agent/skills\"},{\"title\":\"Router\",\"description\":null,\"href\":\"/oss/javascript/langchain/multi-agent/router\"},{\"title\":\"Custom workflow\",\"description\":null,\"href\":\"/oss/javascript/langchain/multi-agent/custom-workflow\"}]},{\"title\":\"Retrieval\",\"description\":null,\"href\":\"/oss/javascript/langchain/retrieval\"},{\"title\":\"Long-term memory\",\"description\":null,\"href\":\"/oss/javascript/langchain/long-term-memory\"}]},{\"group\":\"Agent development\",\"pages\":[{\"title\":\"LangSmith Studio\",\"sidebarTitle\":\"LangSmith Studio\",\"description\":null,\"href\":\"/oss/javascript/langchain/studio\"},{\"title\":\"Test\",\"description\":null,\"href\":\"/oss/javascript/langchain/test\"},{\"title\":\"Agent Chat UI\",\"description\":null,\"href\":\"/oss/javascript/langchain/ui\"}]},{\"group\":\"Deploy with LangSmith\",\"pages\":[{\"title\":\"LangSmith Deployment\",\"sidebarTitle\":\"Deployment\",\"description\":null,\"href\":\"/oss/javascript/langchain/deploy\"},{\"title\":\"LangSmith Observability\",\"sidebarTitle\":\"Observability\",\"description\":null,\"href\":\"/oss/javascript/langchain/observability\"}]}]},{\"tab\":\"LangGraph\",\"pages\":[{\"title\":\"LangGraph overview\",\"sidebarTitle\":\"Overview\",\"description\":\"Gain control with LangGraph to design agents that reliably handle complex tasks\",\"href\":\"/oss/javascript/langgraph/overview\"},{\"group\":\"Get started\",\"pages\":[{\"title\":\"Install LangGraph\",\"sidebarTitle\":\"Install\",\"description\":null,\"href\":\"/oss/javascript/langgraph/install\"},{\"title\":\"Quickstart\",\"description\":null,\"href\":\"/oss/javascript/langgraph/quickstart\"},{\"title\":\"Run a local server\",\"sidebarTitle\":\"Local server\",\"description\":null,\"href\":\"/oss/javascript/langgraph/local-server\"},{\"title\":\"Changelog\",\"url\":\"https://docs.langchain.com/oss/javascript/releases/changelog\",\"description\":null,\"href\":\"/oss/javascript/langgraph/changelog-js\"},{\"title\":\"Thinking in LangGraph\",\"description\":\"Learn how to think about building agents with LangGraph\",\"href\":\"/oss/javascript/langgraph/thinking-in-langgraph\"},{\"title\":\"Workflows and agents\",\"sidebarTitle\":\"Workflows + agents\",\"description\":null,\"href\":\"/oss/javascript/langgraph/workflows-agents\"}]},{\"group\":\"Capabilities\",\"pages\":[{\"title\":\"Persistence\",\"description\":null,\"href\":\"/oss/javascript/langgraph/persistence\"},{\"title\":\"Durable execution\",\"description\":null,\"href\":\"/oss/javascript/langgraph/durable-execution\"},{\"title\":\"Streaming\",\"description\":null,\"href\":\"/oss/javascript/langgraph/streaming\"},{\"title\":\"Interrupts\",\"description\":null,\"href\":\"/oss/javascript/langgraph/interrupts\"},{\"title\":\"Use time-travel\",\"sidebarTitle\":\"Time travel\",\"description\":null,\"href\":\"/oss/javascript/langgraph/use-time-travel\"},{\"title\":\"Memory\",\"description\":null,\"href\":\"/oss/javascript/langgraph/add-memory\"},{\"title\":\"Subgraphs\",\"sidebarTitle\":\"Subgraphs\",\"description\":null,\"href\":\"/oss/javascript/langgraph/use-subgraphs\"}]},{\"group\":\"Production\",\"pages\":[{\"title\":\"Application structure\",\"description\":null,\"href\":\"/oss/javascript/langgraph/application-structure\"},{\"title\":\"Test\",\"description\":null,\"href\":\"/oss/javascript/langgraph/test\"},{\"title\":\"LangSmith Studio\",\"description\":null,\"href\":\"/oss/javascript/langgraph/studio\"},{\"title\":\"Agent Chat UI\",\"description\":null,\"href\":\"/oss/javascript/langgraph/ui\"},{\"title\":\"LangSmith Deployment\",\"description\":null,\"href\":\"/oss/javascript/langgraph/deploy\"},{\"title\":\"LangSmith Observability\",\"description\":null,\"href\":\"/oss/javascript/langgraph/observability\"}]},{\"group\":\"LangGraph APIs\",\"pages\":[{\"group\":\"Graph API\",\"pages\":[{\"title\":\"Choosing between Graph and Functional APIs\",\"sidebarTitle\":\"Choosing APIs\",\"description\":null,\"href\":\"/oss/javascript/langgraph/choosing-apis\"},{\"title\":\"Graph API overview\",\"sidebarTitle\":\"Graph API\",\"description\":null,\"href\":\"/oss/javascript/langgraph/graph-api\"},{\"title\":\"Use the graph API\",\"sidebarTitle\":\"Use the graph API\",\"description\":null,\"href\":\"/oss/javascript/langgraph/use-graph-api\"}]},{\"group\":\"Functional API\",\"pages\":[{\"title\":\"Functional API overview\",\"sidebarTitle\":\"Functional API\",\"description\":null,\"href\":\"/oss/javascript/langgraph/functional-api\"},{\"title\":\"Use the functional API\",\"sidebarTitle\":\"Use the Functional API\",\"description\":null,\"href\":\"/oss/javascript/langgraph/use-functional-api\"}]},{\"title\":\"LangGraph runtime\",\"sidebarTitle\":\"Runtime\",\"description\":null,\"href\":\"/oss/javascript/langgraph/pregel\"}]}]},{\"tab\":\"Deep Agents\",\"pages\":[{\"title\":\"Deep Agents overview\",\"sidebarTitle\":\"Overview\",\"description\":\"Build agents that can plan, use subagents, and leverage file systems for complex tasks\",\"href\":\"/oss/javascript/deepagents/overview\"},{\"group\":\"Get started\",\"pages\":[{\"title\":\"Quickstart\",\"description\":\"Build your first deep agent in minutes\",\"href\":\"/oss/javascript/deepagents/quickstart\"},{\"title\":\"Customize Deep Agents\",\"sidebarTitle\":\"Customization\",\"description\":\"Learn how to customize deep agents with system prompts, tools, subagents, and more\",\"href\":\"/oss/javascript/deepagents/customization\"}]},{\"group\":\"Core capabilities\",\"pages\":[{\"title\":\"Agent harness capabilities\",\"sidebarTitle\":\"Agent harness\",\"description\":null,\"href\":\"/oss/javascript/deepagents/harness\"},{\"title\":\"Backends\",\"description\":\"Choose and configure filesystem backends for deep agents. You can specify routes to different backends, implement virtual filesystems, and enforce policies.\",\"href\":\"/oss/javascript/deepagents/backends\"},{\"title\":\"Subagents\",\"description\":\"Learn how to use subagents to delegate work and keep context clean\",\"href\":\"/oss/javascript/deepagents/subagents\"},{\"title\":\"Human-in-the-loop\",\"description\":\"Learn how to configure human approval for sensitive tool operations\",\"href\":\"/oss/javascript/deepagents/human-in-the-loop\"},{\"title\":\"Long-term memory\",\"description\":\"Learn how to extend deep agents with persistent memory across threads\",\"href\":\"/oss/javascript/deepagents/long-term-memory\"},{\"title\":\"Deep Agents Middleware\",\"sidebarTitle\":\"Middleware\",\"description\":\"Understand the middleware that powers deep agents\",\"href\":\"/oss/javascript/deepagents/middleware\"}]},{\"group\":\"Deep Agents CLI\",\"pages\":[{\"title\":\"Deep Agents CLI\",\"sidebarTitle\":\"Use the CLI\",\"description\":\"Interactive command-line interface for building with Deep Agents\",\"href\":\"/oss/javascript/deepagents/cli\"}]}]},{\"tab\":\"Integrations\",\"pages\":[{\"title\":\"Integration Packages\",\"sidebarTitle\":\"Overview\",\"mode\":\"wide\",\"description\":null,\"href\":\"/oss/javascript/integrations/providers/overview\"},{\"title\":\"All integrations\",\"sidebarTitle\":\"All providers\",\"description\":null,\"href\":\"/oss/javascript/integrations/providers/all_providers\"},{\"group\":\"Popular Providers\",\"icon\":\"user-group\",\"pages\":[{\"group\":\"OpenAI\",\"pages\":[{\"title\":\"Overview\",\"description\":null,\"href\":\"/oss/javascript/integrations/providers/openai\"},{\"title\":\"ChatOpenAI\",\"description\":null,\"href\":\"/oss/javascript/integrations/chat/openai\"},{\"title\":\"OpenAIEmbeddings\",\"description\":null,\"href\":\"/oss/javascript/integrations/text_embedding/openai\"},{\"title\":\"Tools\",\"description\":null,\"href\":\"/oss/javascript/integrations/tools/openai\"}]},{\"group\":\"Anthropic\",\"pages\":[{\"title\":\"Overview\",\"description\":null,\"href\":\"/oss/javascript/integrations/providers/anthropic\"},{\"title\":\"ChatAnthropic\",\"description\":null,\"href\":\"/oss/javascript/integrations/chat/anthropic\"},{\"title\":\"Tools\",\"description\":null,\"href\":\"/oss/javascript/integrations/tools/anthropic\"}]},{\"group\":\"Google\",\"pages\":[{\"title\":\"Overview\",\"description\":null,\"href\":\"/oss/javascript/integrations/providers/google\"},{\"title\":\"ChatGoogleGenerativeAI\",\"description\":null,\"href\":\"/oss/javascript/integrations/chat/google_generative_ai\"},{\"title\":\"Google generativeai\",\"href\":\"/oss/javascript/integrations/text_embedding/google_generativeai\"}]},{\"group\":\"AWS\",\"pages\":[{\"title\":\"Overview\",\"description\":null,\"href\":\"/oss/javascript/integrations/providers/aws\"},{\"title\":\"BedrockChat\",\"description\":null,\"href\":\"/oss/javascript/integrations/chat/bedrock\"},{\"title\":\"BedrockEmbeddings\",\"description\":null,\"href\":\"/oss/javascript/integrations/text_embedding/bedrock\"}]},{\"group\":\"Microsoft\",\"pages\":[{\"title\":\"Overview\",\"description\":null,\"href\":\"/oss/javascript/integrations/providers/microsoft\"},{\"title\":\"AzureChatOpenAI\",\"description\":null,\"href\":\"/oss/javascript/integrations/chat/azure\"},{\"title\":\"AzureOpenAIEmbeddings\",\"description\":null,\"href\":\"/oss/javascript/integrations/text_embedding/azure_openai\"}]}]},{\"group\":\"General integrations\",\"icon\":\"plug\",\"pages\":[{\"title\":\"Chat models\",\"description\":null,\"href\":\"/oss/javascript/integrations/chat/index\"},{\"title\":\"Tools and Toolkits\",\"description\":null,\"href\":\"/oss/javascript/integrations/tools/index\"},{\"title\":\"LLMs\",\"description\":null,\"href\":\"/oss/javascript/integrations/llms/index\"},{\"title\":\"Provider-specific middleware\",\"sidebarTitle\":\"Middleware\",\"description\":null,\"href\":\"/oss/javascript/integrations/middleware/index\"},{\"title\":\"Key-value stores\",\"description\":null,\"href\":\"/oss/javascript/integrations/stores/index\"},{\"title\":\"Document transformers\",\"description\":null,\"href\":\"/oss/javascript/integrations/document_transformers/index\"},{\"title\":\"Model caches\",\"description\":null,\"href\":\"/oss/javascript/integrations/llm_caching/index\"},{\"title\":\"Callbacks\",\"description\":null,\"href\":\"/oss/javascript/integrations/callbacks/index\"}]},{\"group\":\"RAG integrations\",\"icon\":\"database\",\"pages\":[{\"title\":\"Retrievers\",\"description\":null,\"href\":\"/oss/javascript/integrations/retrievers/index\"},{\"title\":\"Text splitters\",\"description\":null,\"href\":\"/oss/javascript/integrations/splitters/index\"},{\"title\":\"Embedding models\",\"description\":null,\"href\":\"/oss/javascript/integrations/text_embedding/index\"},{\"title\":\"Vector stores\",\"description\":null,\"href\":\"/oss/javascript/integrations/vectorstores/index\"},{\"sidebar_position\":0,\"sidebarTitle\":\"Document loaders\",\"title\":null,\"description\":null,\"href\":\"/oss/javascript/integrations/document_loaders/index\"},{\"title\":\"Key-value stores\",\"description\":null,\"href\":\"/oss/javascript/integrations/stores/index\"}]}]},{\"tab\":\"Learn\",\"pages\":[{\"title\":\"Learn\",\"description\":\"Tutorials, conceptual guides, and resources to help you get started.\",\"href\":\"/oss/javascript/learn\"},{\"group\":\"Tutorials\",\"icon\":\"code\",\"pages\":[{\"group\":\"LangChain\",\"expanded\":true,\"pages\":[{\"title\":\"Build a semantic search engine with LangChain\",\"sidebarTitle\":\"Semantic search\",\"description\":null,\"href\":\"/oss/javascript/langchain/knowledge-base\"},{\"title\":\"Build a RAG agent with LangChain\",\"sidebarTitle\":\"RAG agent\",\"description\":null,\"href\":\"/oss/javascript/langchain/rag\"},{\"title\":\"Build a SQL agent\",\"sidebarTitle\":\"SQL agent\",\"description\":null,\"href\":\"/oss/javascript/langchain/sql-agent\"},{\"title\":\"Build a voice agent with LangChain\",\"sidebarTitle\":\"Voice agent\",\"description\":null,\"href\":\"/oss/javascript/langchain/voice-agent\"}]},{\"group\":\"Multi-agent\",\"expanded\":true,\"pages\":[{\"title\":\"Build a personal assistant with subagents\",\"sidebarTitle\":\"Subagents: Personal assistant\",\"description\":null,\"href\":\"/oss/javascript/langchain/multi-agent/subagents-personal-assistant\"},{\"title\":\"Build a multi-source knowledge base with routing\",\"sidebarTitle\":\"Router: Knowledge base\",\"description\":null,\"href\":\"/oss/javascript/langchain/multi-agent/router-knowledge-base\"}]},{\"group\":\"LangGraph\",\"expanded\":true,\"pages\":[{\"title\":\"Build a custom RAG agent with LangGraph\",\"sidebarTitle\":\"Custom RAG agent\",\"description\":null,\"href\":\"/oss/javascript/langgraph/agentic-rag\"}]}]},{\"group\":\"Conceptual overviews\",\"icon\":\"book\",\"pages\":[{\"title\":\"Component architecture\",\"description\":null,\"href\":\"/oss/javascript/langchain/component-architecture\"},{\"title\":\"Memory overview\",\"sidebarTitle\":\"Memory\",\"description\":null,\"href\":\"/oss/javascript/concepts/memory\"},{\"title\":\"Context overview\",\"sidebarTitle\":\"Context\",\"description\":null,\"href\":\"/oss/javascript/concepts/context\"},{\"title\":\"Graph API overview\",\"sidebarTitle\":\"Graph API\",\"description\":null,\"href\":\"/oss/javascript/langgraph/graph-api\"},{\"title\":\"Functional API overview\",\"sidebarTitle\":\"Functional API\",\"description\":null,\"href\":\"/oss/javascript/langgraph/functional-api\"}]},{\"group\":\"LangChain Academy\",\"icon\":\"graduation-cap\",\"pages\":[{\"title\":\"LangChain Academy\",\"url\":\"https://academy.langchain.com/\",\"description\":null,\"href\":\"/oss/javascript/langchain/academy\"}]},{\"group\":\"Additional resources\",\"icon\":\"list\",\"pages\":[{\"title\":\"Case studies\",\"description\":null,\"href\":\"/oss/javascript/langgraph/case-studies\"},{\"title\":\"Get help\",\"description\":null,\"href\":\"/oss/javascript/langchain/get-help\"}]}]},{\"tab\":\"Reference\",\"pages\":[{\"title\":\"Reference\",\"sidebarTitle\":\"Overview\",\"description\":null,\"href\":\"/oss/javascript/reference/overview\"},{\"group\":\"Reference\",\"pages\":[{\"title\":\"LangChain SDK\",\"url\":\"https://reference.langchain.com/javascript/modules/langchain.html\",\"description\":null,\"href\":\"/oss/javascript/reference/langchain-javascript\"},{\"title\":\"LangGraph SDK\",\"url\":\"https://reference.langchain.com/javascript/modules/_langchain_langgraph.html\",\"description\":null,\"href\":\"/oss/javascript/reference/langgraph-javascript\"},{\"title\":\"Deep Agents\",\"url\":\"https://reference.langchain.com/javascript/deepagents/\",\"description\":null,\"href\":\"/oss/javascript/reference/deepagents-javascript\"}]},{\"group\":\"Errors\",\"pages\":[{\"title\":\"Errors\",\"sidebarTitle\":\"Reference\",\"description\":null,\"href\":\"/oss/javascript/common-errors\"}]},{\"group\":\"Releases\",\"pages\":[{\"title\":\"Versioning\",\"description\":null,\"href\":\"/oss/javascript/versioning\"},{\"title\":\"Changelog\",\"sidebarTitle\":\"Changelog\",\"description\":\"Log of updates and improvements to our JavaScript/TypeScript packages\",\"rss\":true,\"href\":\"/oss/javascript/releases/changelog\"},{\"group\":\"Releases\",\"pages\":[{\"title\":\"What's new in LangChain v1\",\"sidebarTitle\":\"LangChain v1\",\"description\":null,\"href\":\"/oss/javascript/releases/langchain-v1\"},{\"title\":\"What's new in LangGraph v1\",\"sidebarTitle\":\"LangGraph v1\",\"description\":null,\"href\":\"/oss/javascript/releases/langgraph-v1\"}]},{\"group\":\"Migration guides\",\"pages\":[{\"title\":\"LangChain v1 migration guide\",\"sidebarTitle\":\"LangChain v1\",\"description\":null,\"href\":\"/oss/javascript/migrate/langchain-v1\"},{\"title\":\"LangGraph v1 migration guide\",\"sidebarTitle\":\"LangGraph v1\",\"description\":null,\"href\":\"/oss/javascript/migrate/langgraph-v1\"}]}]},{\"group\":\"Policies\",\"pages\":[{\"title\":\"Release policy\",\"description\":null,\"href\":\"/oss/javascript/release-policy\"},{\"title\":\"Security policy\",\"sidebarTitle\":\"Security\",\"description\":null,\"href\":\"/oss/javascript/security-policy\"}]}]},{\"tab\":\"Contribute\",\"pages\":[{\"title\":\"Contributing\",\"sidebarTitle\":\"Overview\",\"description\":null,\"href\":\"/oss/javascript/contributing/overview\"},{\"group\":\"Contribute\",\"icon\":\"heart-circle-plus\",\"pages\":[{\"title\":\"Contributing to documentation\",\"sidebarTitle\":\"Documentation\",\"description\":null,\"href\":\"/oss/javascript/contributing/documentation\"},{\"title\":\"Contributing to code\",\"sidebarTitle\":\"Code\",\"description\":null,\"href\":\"/oss/javascript/contributing/code\"},{\"group\":\"Integrations\",\"pages\":[{\"title\":\"Contributing integrations\",\"sidebarTitle\":\"Guide\",\"description\":null,\"href\":\"/oss/javascript/contributing/integrations-langchain\"},{\"title\":\"Implement a LangChain integration\",\"sidebarTitle\":\"Implement\",\"description\":null,\"href\":\"/oss/javascript/contributing/implement-langchain\"},{\"title\":\"Using standard tests\",\"sidebarTitle\":\"Standard tests\",\"description\":null,\"href\":\"/oss/javascript/contributing/standard-tests-langchain\"},{\"title\":\"Publish an integration\",\"sidebarTitle\":\"Publish\",\"description\":null,\"href\":\"/oss/javascript/contributing/publish-langchain\"},{\"title\":\"Co-marketing\",\"description\":null,\"href\":\"/oss/javascript/contributing/comarketing\"}]}]}]}]}]},{\"product\":\"LangSmith\",\"icon\":\"screwdriver-wrench\",\"description\":\"LLM observability, evaluation, and deployment\",\"tabs\":[{\"tab\":\"Get started\",\"pages\":[{\"title\":\"LangSmith docs\",\"sidebarTitle\":\"Overview\",\"mode\":\"wide\",\"description\":null,\"href\":\"/langsmith/home\"},{\"title\":\"Pricing plans\",\"sidebarTitle\":\"Plans\",\"url\":\"https://langchain.com/pricing\",\"description\":null,\"href\":\"/langsmith/pricing-plans\"},{\"title\":\"Create an account and API key\",\"sidebarTitle\":\"Create an account and API key\",\"description\":null,\"href\":\"/langsmith/create-account-api-key\"},{\"group\":\"Account administration\",\"pages\":[{\"title\":\"Overview\",\"sidebarTitle\":\"Overview\",\"description\":null,\"href\":\"/langsmith/administration-overview\"},{\"title\":\"Set up hierarchy\",\"sidebarTitle\":\"Set up hierarchy\",\"description\":null,\"href\":\"/langsmith/set-up-hierarchy\"},{\"title\":\"Workload isolation\",\"sidebarTitle\":\"Workload isolation\",\"description\":null,\"href\":\"/langsmith/workload-isolation\"},{\"title\":\"Manage your organization using the API\",\"sidebarTitle\":\"Manage organizations using the API\",\"description\":null,\"href\":\"/langsmith/manage-organization-by-api\"},{\"title\":\"Manage billing in your account\",\"sidebarTitle\":\"Manage billing\",\"description\":null,\"href\":\"/langsmith/billing\"},{\"title\":\"Set up resource tags\",\"sidebarTitle\":\"Set up resource tags\",\"description\":null,\"href\":\"/langsmith/set-up-resource-tags\"},{\"title\":\"User management\",\"sidebarTitle\":\"User management\",\"description\":null,\"href\":\"/langsmith/user-management\"}]},{\"group\":\"Additional resources\",\"pages\":[{\"title\":\"LangSmith Polly\",\"sidebarTitle\":\"Polly (Beta)\",\"description\":null,\"href\":\"/langsmith/polly\"},{\"group\":\"Data management\",\"pages\":[{\"title\":\"Data storage and privacy\",\"sidebarTitle\":\"Data storage and privacy\",\"description\":null,\"href\":\"/langsmith/data-storage-and-privacy\"},{\"title\":\"Data purging for compliance\",\"sidebarTitle\":\"Data purging for compliance\",\"description\":null,\"href\":\"/langsmith/data-purging-compliance\"}]},{\"group\":\"Access control \u0026 Authentication\",\"pages\":[{\"title\":\"Role-based access control\",\"sidebarTitle\":\"Role-based access control\",\"description\":null,\"href\":\"/langsmith/rbac\"},{\"title\":\"Organization and workspace operations reference\",\"sidebarTitle\":\"Organization and workspace operations\",\"mode\":\"wide\",\"description\":null,\"href\":\"/langsmith/organization-workspace-operations\"},{\"title\":\"Authentication methods\",\"sidebarTitle\":\"Authentication methods\",\"description\":null,\"href\":\"/langsmith/authentication-methods\"}]},{\"title\":\"Scalability \u0026 resilience\",\"sidebarTitle\":\"Scalability \u0026 resilience\",\"description\":null,\"href\":\"/langsmith/scalability-and-resilience\"},{\"title\":\"Frequently asked questions\",\"sidebarTitle\":\"FAQs\",\"description\":null,\"href\":\"/langsmith/faq\"},{\"title\":\"Regions FAQ\",\"sidebarTitle\":\"Regions FAQ\",\"description\":null,\"href\":\"/langsmith/regions-faq\"},{\"title\":\"Frequently Asked Questions\",\"sidebarTitle\":\"Pricing FAQ\",\"description\":null,\"href\":\"/langsmith/pricing-faq\"},{\"title\":\"LangSmith status\",\"url\":\"https://status.smith.langchain.com/\",\"description\":null,\"href\":\"/langsmith/status\"}]}]},{\"tab\":\"Observability\",\"pages\":[{\"title\":\"LangSmith Observability\",\"sidebarTitle\":\"Overview\",\"mode\":\"wide\",\"description\":null,\"href\":\"/langsmith/observability\"},{\"title\":\"Tracing quickstart\",\"sidebarTitle\":\"Quickstart\",\"description\":null,\"href\":\"/langsmith/observability-quickstart\"},{\"title\":\"Observability concepts\",\"sidebarTitle\":\"Concepts\",\"description\":null,\"href\":\"/langsmith/observability-concepts\"},{\"title\":\"Trace a RAG application tutorial\",\"sidebarTitle\":\"Trace a RAG application\",\"description\":null,\"href\":\"/langsmith/observability-llm-tutorial\"},{\"group\":\"Tracing setup\",\"pages\":[{\"group\":\"Integrations\",\"pages\":[{\"title\":\"Integrations\",\"sidebarTitle\":\"Overview\",\"mode\":\"wide\",\"description\":null,\"href\":\"/langsmith/integrations\"},{\"title\":\"Trace with LangChain (Python and JS/TS)\",\"sidebarTitle\":\"LangChain\",\"description\":null,\"href\":\"/langsmith/trace-with-langchain\"},{\"title\":\"Trace with LangGraph\",\"sidebarTitle\":\"LangGraph\",\"description\":null,\"href\":\"/langsmith/trace-with-langgraph\"},{\"title\":\"Trace with Anthropic\",\"sidebarTitle\":\"Anthropic (Python only)\",\"description\":null,\"href\":\"/langsmith/trace-anthropic\"},{\"title\":\"Trace with OpenAI\",\"sidebarTitle\":\"OpenAI\",\"description\":null,\"href\":\"/langsmith/trace-openai\"},{\"title\":\"Trace with AutoGen\",\"sidebarTitle\":\"AutoGen\",\"description\":null,\"href\":\"/langsmith/trace-with-autogen\"},{\"title\":\"Trace Claude Agent SDK\",\"sidebarTitle\":\"Claude Agent SDK\",\"description\":null,\"href\":\"/langsmith/trace-claude-agent-sdk\"},{\"title\":\"Trace Claude Code\",\"sidebarTitle\":\"Claude Code\",\"description\":null,\"href\":\"/langsmith/trace-claude-code\"},{\"title\":\"Trace with CrewAI\",\"sidebarTitle\":\"CrewAI\",\"description\":null,\"href\":\"/langsmith/trace-with-crewai\"},{\"title\":\"Trace with Google ADK\",\"sidebarTitle\":\"Google ADK\",\"description\":null,\"href\":\"/langsmith/trace-with-google-adk\"},{\"title\":\"Trace with Instructor\",\"sidebarTitle\":\"Instructor (Python only)\",\"description\":null,\"href\":\"/langsmith/trace-with-instructor\"},{\"title\":\"Trace with OpenAI Agents SDK\",\"sidebarTitle\":\"OpenAI Agents SDK\",\"description\":null,\"href\":\"/langsmith/trace-with-openai-agents-sdk\"},{\"title\":\"Trace with OpenTelemetry\",\"sidebarTitle\":\"OpenTelemetry\",\"description\":null,\"href\":\"/langsmith/trace-with-opentelemetry\"},{\"title\":\"Trace with PydanticAI\",\"sidebarTitle\":\"PydanticAI\",\"description\":null,\"href\":\"/langsmith/trace-with-pydantic-ai\"},{\"title\":\"Trace with Semantic Kernel\",\"sidebarTitle\":\"Semantic Kernel\",\"description\":null,\"href\":\"/langsmith/trace-with-semantic-kernel\"},{\"title\":\"Trace with the Vercel AI SDK (JS/TS only)\",\"sidebarTitle\":\"Vercel AI SDK\",\"description\":null,\"href\":\"/langsmith/trace-with-vercel-ai-sdk\"},{\"title\":\"Trace with LiveKit\",\"sidebarTitle\":\"LiveKit\",\"description\":null,\"href\":\"/langsmith/trace-with-livekit\"},{\"title\":\"Trace with Pipecat\",\"sidebarTitle\":\"Pipecat\",\"description\":null,\"href\":\"/langsmith/trace-with-pipecat\"}]},{\"group\":\"Manual instrumentation\",\"pages\":[{\"title\":\"Custom instrumentation\",\"sidebarTitle\":\"Custom instrumentation\",\"description\":null,\"href\":\"/langsmith/annotate-code\"},{\"title\":\"Trace with API\",\"sidebarTitle\":\"Trace with API\",\"description\":null,\"href\":\"/langsmith/trace-with-api\"},{\"title\":\"Log LLM calls\",\"sidebarTitle\":\"Log LLM calls\",\"description\":null,\"href\":\"/langsmith/log-llm-trace\"},{\"title\":\"Log retriever traces\",\"sidebarTitle\":\"Log retriever traces\",\"description\":null,\"href\":\"/langsmith/log-retriever-trace\"},{\"title\":\"Metadata parameters reference\",\"sidebarTitle\":\"Metadata parameters\",\"description\":null,\"href\":\"/langsmith/ls-metadata-parameters\"},{\"title\":\"Upload files with traces\",\"sidebarTitle\":\"Upload files with traces\",\"description\":null,\"href\":\"/langsmith/upload-files-with-traces\"}]},{\"title\":\"Configure threads\",\"sidebarTitle\":\"Threads\",\"description\":null,\"href\":\"/langsmith/threads\"}]},{\"group\":\"Configuration \u0026 troubleshooting\",\"pages\":[{\"group\":\"Project \u0026 environment settings\",\"pages\":[{\"title\":\"Log traces to a specific project\",\"sidebarTitle\":\"Log traces to a specific project\",\"description\":null,\"href\":\"/langsmith/log-traces-to-project\"},{\"title\":\"Trace without setting environment variables\",\"sidebarTitle\":\"Trace without env vars\",\"keywords\":\"cloudflare, cloudflare workers, serverless\",\"description\":null,\"href\":\"/langsmith/trace-without-env-vars\"},{\"title\":\"Set a sampling rate for traces\",\"sidebarTitle\":\"Set a sampling rate for traces\",\"description\":null,\"href\":\"/langsmith/sample-traces\"}]},{\"title\":\"Cost tracking\",\"sidebarTitle\":\"Cost tracking\",\"description\":null,\"href\":\"/langsmith/cost-tracking\"},{\"group\":\"Advanced tracing techniques\",\"pages\":[{\"title\":\"Implement distributed tracing\",\"sidebarTitle\":\"Implement distributed tracing\",\"description\":null,\"href\":\"/langsmith/distributed-tracing\"},{\"title\":\"Trace JS functions in serverless environments\",\"sidebarTitle\":\"Trace JS functions in serverless environments\",\"description\":null,\"href\":\"/langsmith/serverless-environments\"},{\"title\":\"Log multimodal traces\",\"sidebarTitle\":\"Log multimodal traces\",\"description\":null,\"href\":\"/langsmith/log-multimodal-traces\"},{\"title\":\"Trace generator functions\",\"sidebarTitle\":\"Trace generator functions\",\"description\":null,\"href\":\"/langsmith/trace-generator-functions\"}]},{\"group\":\"Data \u0026 privacy\",\"pages\":[{\"title\":\"Add metadata and tags to traces\",\"sidebarTitle\":\"Add metadata and tags to traces\",\"description\":null,\"href\":\"/langsmith/add-metadata-tags\"},{\"title\":\"Prevent logging of sensitive data in traces\",\"sidebarTitle\":\"Prevent logging of sensitive data in traces\",\"description\":null,\"href\":\"/langsmith/mask-inputs-outputs\"}]},{\"group\":\"Troubleshooting guides\",\"pages\":[{\"title\":\"Troubleshoot trace nesting\",\"sidebarTitle\":\"Troubleshoot trace nesting\",\"description\":null,\"href\":\"/langsmith/nest-traces\"},{\"title\":\"Troubleshoot variable caching\",\"sidebarTitle\":\"Troubleshoot variable caching\",\"description\":null,\"href\":\"/langsmith/troubleshooting-variable-caching\"},{\"title\":\"Beta LangSmith Collector-Proxy\",\"sidebarTitle\":\"Beta LangSmith Collector-Proxy\",\"description\":null,\"href\":\"/langsmith/collector-proxy\"}]}]},{\"group\":\"Viewing \u0026 managing traces\",\"pages\":[{\"title\":\"Filter traces\",\"sidebarTitle\":\"Filter traces\",\"description\":null,\"href\":\"/langsmith/filter-traces-in-application\"},{\"title\":\"Query traces (SDK)\",\"sidebarTitle\":\"Query traces (SDK)\",\"description\":null,\"href\":\"/langsmith/export-traces\"},{\"title\":\"Compare traces\",\"sidebarTitle\":\"Compare traces\",\"description\":null,\"href\":\"/langsmith/compare-traces\"},{\"title\":\"Share or unshare a trace publicly\",\"sidebarTitle\":\"Share or unshare a trace publicly\",\"description\":null,\"href\":\"/langsmith/share-trace\"},{\"title\":\"LangSmith Fetch\",\"sidebarTitle\":\"Retrieve traces via CLI\",\"description\":null,\"href\":\"/langsmith/langsmith-fetch\"},{\"title\":\"View server logs for a trace\",\"sidebarTitle\":\"View server logs for a trace\",\"description\":null,\"href\":\"/langsmith/platform-logs\"},{\"title\":\"Bulk exporting trace data\",\"sidebarTitle\":\"Bulk export trace data\",\"description\":null,\"href\":\"/langsmith/data-export\"}]},{\"group\":\"Automations\",\"pages\":[{\"title\":\"Set up automation rules\",\"sidebarTitle\":\"Set up automation rules\",\"description\":null,\"href\":\"/langsmith/rules\"},{\"title\":\"Configure webhook notifications for rules\",\"sidebarTitle\":\"Configure webhook notifications for rules\",\"description\":null,\"href\":\"/langsmith/webhooks\"}]},{\"group\":\"Feedback \u0026 evaluation\",\"pages\":[{\"title\":\"Log user feedback using the SDK\",\"sidebarTitle\":\"Log user feedback using the SDK\",\"description\":null,\"href\":\"/langsmith/attach-user-feedback\"},{\"title\":\"Set up online evaluators\",\"sidebarTitle\":\"Set up online evaluators\",\"description\":null,\"href\":\"/langsmith/online-evaluations\"}]},{\"group\":\"Monitoring \u0026 alerting\",\"pages\":[{\"title\":\"Monitor projects with dashboards\",\"sidebarTitle\":\"Monitor projects with dashboards\",\"description\":null,\"href\":\"/langsmith/dashboards\"},{\"title\":\"Alerts in LangSmith\",\"sidebarTitle\":\"Alerts\",\"description\":null,\"href\":\"/langsmith/alerts\"},{\"title\":\"Configure webhook notifications for LangSmith alerts\",\"sidebarTitle\":\"Configure webhook notifications for alerts\",\"description\":null,\"href\":\"/langsmith/alerts-webhook\"},{\"title\":\"Discover errors and usage patterns with the Insights Agent\",\"sidebarTitle\":\"Insights\",\"description\":null,\"href\":\"/langsmith/insights\"}]},{\"group\":\"Data type reference\",\"pages\":[{\"title\":\"Run (span) data format\",\"sidebarTitle\":\"Run (span) data format\",\"description\":null,\"href\":\"/langsmith/run-data-format\"},{\"title\":\"Feedback data format\",\"sidebarTitle\":\"Feedback data format\",\"description\":null,\"href\":\"/langsmith/feedback-data-format\"},{\"title\":\"Trace query syntax\",\"sidebarTitle\":\"Trace query syntax\",\"description\":null,\"href\":\"/langsmith/trace-query-syntax\"}]}]},{\"tab\":\"Evaluation\",\"pages\":[{\"title\":\"LangSmith Evaluation\",\"sidebarTitle\":\"Overview\",\"mode\":\"wide\",\"description\":null,\"href\":\"/langsmith/evaluation\"},{\"title\":\"Evaluation quickstart\",\"sidebarTitle\":\"Quickstart\",\"description\":null,\"href\":\"/langsmith/evaluation-quickstart\"},{\"title\":\"Evaluation concepts\",\"sidebarTitle\":\"Concepts\",\"description\":null,\"href\":\"/langsmith/evaluation-concepts\"},{\"title\":\"Application-specific evaluation approaches\",\"sidebarTitle\":\"Evaluation approaches\",\"description\":null,\"href\":\"/langsmith/evaluation-approaches\"},{\"group\":\"Datasets\",\"pages\":[{\"group\":\"Create a dataset\",\"pages\":[{\"title\":\"Create and manage datasets in the UI\",\"sidebarTitle\":\"With the UI\",\"description\":null,\"href\":\"/langsmith/manage-datasets-in-application\"},{\"title\":\"How to create and manage datasets programmatically\",\"sidebarTitle\":\"With the SDK\",\"description\":null,\"href\":\"/langsmith/manage-datasets-programmatically\"}]},{\"title\":\"Manage datasets\",\"sidebarTitle\":\"Manage datasets\",\"description\":null,\"href\":\"/langsmith/manage-datasets\"},{\"title\":\"Custom output rendering\",\"sidebarTitle\":\"Custom output rendering\",\"description\":null,\"href\":\"/langsmith/custom-output-rendering\"}]},{\"group\":\"Set up evaluations\",\"pages\":[{\"group\":\"Run an evaluation\",\"pages\":[{\"title\":\"How to evaluate an LLM application\",\"sidebarTitle\":\"With the SDK\",\"description\":null,\"href\":\"/langsmith/evaluate-llm-application\"},{\"title\":\"Run an evaluation from the prompt playground\",\"sidebarTitle\":\"With the UI\",\"description\":null,\"href\":\"/langsmith/run-evaluation-from-prompt-playground\"},{\"title\":\"How to use prebuilt evaluators\",\"sidebarTitle\":\"Use prebuilt evaluators\",\"description\":null,\"href\":\"/langsmith/prebuilt-evaluators\"}]},{\"group\":\"Evaluation types\",\"pages\":[{\"title\":\"Evaluation types\",\"sidebarTitle\":\"Evaluation types\",\"description\":null,\"href\":\"/langsmith/evaluation-types\"},{\"title\":\"How to define a code evaluator\",\"sidebarTitle\":\"Code evaluator\",\"description\":null,\"href\":\"/langsmith/code-evaluator\"},{\"title\":\"How to define an LLM-as-a-judge evaluator\",\"sidebarTitle\":\"LLM-as-a-judge evaluator\",\"description\":null,\"href\":\"/langsmith/llm-as-judge\"},{\"title\":\"Composite evaluators\",\"sidebarTitle\":\"Composite evaluators\",\"description\":null,\"href\":\"/langsmith/composite-evaluators\"},{\"title\":\"How to define a summary evaluator\",\"sidebarTitle\":\"Summary evaluator\",\"description\":null,\"href\":\"/langsmith/summary\"},{\"title\":\"How to run a pairwise evaluation\",\"sidebarTitle\":\"Pairwise evaluation\",\"description\":null,\"href\":\"/langsmith/evaluate-pairwise\"}]},{\"group\":\"Frameworks \u0026 integrations\",\"pages\":[{\"title\":\"How to run an evaluation asynchronously\",\"sidebarTitle\":\"Run an evaluation asynchronously\",\"description\":null,\"href\":\"/langsmith/evaluation-async\"},{\"title\":\"How to run evaluations with pytest (beta)\",\"sidebarTitle\":\"Run evaluations with pytest\",\"description\":null,\"href\":\"/langsmith/pytest\"},{\"title\":\"How to run evaluations with Vitest/Jest (beta)\",\"sidebarTitle\":\"Run evals with Vitest/Jest\",\"description\":null,\"href\":\"/langsmith/vitest-jest\"},{\"title\":\"How to use the REST API\",\"sidebarTitle\":\"With the API\",\"description\":null,\"href\":\"/langsmith/run-evals-api-only\"}]},{\"group\":\"Evaluation techniques\",\"pages\":[{\"title\":\"Experiment configuration\",\"sidebarTitle\":\"Experiment configuration\",\"description\":null,\"href\":\"/langsmith/experiment-configuration\"},{\"title\":\"How to define a target function to evaluate\",\"sidebarTitle\":\"Define a target function to evaluate\",\"description\":null,\"href\":\"/langsmith/define-target-function\"},{\"title\":\"How to evaluate an application's intermediate steps\",\"sidebarTitle\":\"Evaluate intermediate steps\",\"description\":null,\"href\":\"/langsmith/evaluate-on-intermediate-steps\"},{\"title\":\"How to return multiple scores in one evaluator\",\"sidebarTitle\":\"Return multiple scores in one evaluator\",\"description\":null,\"href\":\"/langsmith/multiple-scores\"},{\"title\":\"How to return categorical vs numerical metrics\",\"sidebarTitle\":\"Return categorical vs numerical metrics\",\"description\":null,\"href\":\"/langsmith/metric-type\"},{\"title\":\"Automatically run evaluators on experiments\",\"sidebarTitle\":\"Run evaluators on experiments\",\"description\":null,\"href\":\"/langsmith/bind-evaluator-to-dataset\"},{\"title\":\"How to evaluate with repetitions\",\"sidebarTitle\":\"Evaluate with repetitions\",\"description\":null,\"href\":\"/langsmith/repetition\"},{\"title\":\"How to handle model rate limits\",\"sidebarTitle\":\"Handle model rate limits\",\"description\":null,\"href\":\"/langsmith/rate-limiting\"},{\"title\":\"How to run an evaluation locally (Python only)\",\"sidebarTitle\":\"Run an evaluation locally (Python)\",\"description\":null,\"href\":\"/langsmith/local\"},{\"title\":\"How to read experiment results locally\",\"sidebarTitle\":\"Read experiment results locally\",\"description\":null,\"href\":\"/langsmith/read-local-experiment-results\"},{\"title\":\"How to evaluate a runnable\",\"sidebarTitle\":\"Evaluate a runnable\",\"description\":null,\"href\":\"/langsmith/langchain-runnable\"},{\"title\":\"How to evaluate a graph\",\"sidebarTitle\":\"Evaluate a graph\",\"description\":null,\"href\":\"/langsmith/evaluate-graph\"},{\"title\":\"How to evaluate an existing experiment (Python only)\",\"sidebarTitle\":\"Evaluate an existing experiment (Python)\",\"description\":null,\"href\":\"/langsmith/evaluate-existing-experiment\"},{\"title\":\"Run an evaluation with multimodal content\",\"sidebarTitle\":\"Run an evaluation with multimodal content\",\"description\":null,\"href\":\"/langsmith/evaluate-with-attachments\"},{\"title\":\"How to simulate multi-turn interactions\",\"sidebarTitle\":\"Simulate multi-turn interactions\",\"description\":null,\"href\":\"/langsmith/multi-turn-simulation\"},{\"title\":\"How to evaluate your agent with trajectory evaluations\",\"sidebarTitle\":\"Evaluate agent trajectories\",\"description\":null,\"href\":\"/langsmith/trajectory-evals\"}]},{\"group\":\"Improve evaluators\",\"pages\":[{\"title\":\"Improve LLM-as-judge evaluators using human feedback\",\"sidebarTitle\":\"Improve LLM-as-judge evaluators using human feedback\",\"description\":null,\"href\":\"/langsmith/improve-judge-evaluator-feedback\"},{\"title\":\"How to improve your evaluator with few-shot examples\",\"sidebarTitle\":\"Improve your evaluator with few-shot examples\",\"description\":null,\"href\":\"/langsmith/create-few-shot-evaluators\"},{\"title\":\"Dynamic few shot example selection\",\"sidebarTitle\":\"Dynamic few shot example selection\",\"description\":null,\"href\":\"/langsmith/index-datasets-for-dynamic-few-shot-example-selection\"}]},{\"group\":\"Tutorials\",\"pages\":[{\"title\":\"Evaluate a chatbot\",\"sidebarTitle\":\"Evaluate a chatbot\",\"description\":null,\"href\":\"/langsmith/evaluate-chatbot-tutorial\"},{\"title\":\"Evaluate a RAG application\",\"sidebarTitle\":\"Evaluate a RAG application\",\"description\":null,\"href\":\"/langsmith/evaluate-rag-tutorial\"},{\"title\":\"Test a ReAct agent with Pytest/Vitest and LangSmith\",\"sidebarTitle\":\"Test a ReAct agent with Pytest/Vitest and LangSmith\",\"description\":null,\"href\":\"/langsmith/test-react-agent-pytest\"},{\"title\":\"Evaluate a complex agent\",\"sidebarTitle\":\"Evaluate a complex agent\",\"description\":null,\"href\":\"/langsmith/evaluate-complex-agent\"},{\"title\":\"Run backtests on a new version of an agent\",\"sidebarTitle\":\"Run backtests on a new version of an agent\",\"description\":null,\"href\":\"/langsmith/run-backtests-new-agent\"}]}]},{\"group\":\"Analyze experiment results\",\"pages\":[{\"title\":\"Analyze an experiment\",\"sidebarTitle\":\"Analyze an experiment\",\"description\":null,\"href\":\"/langsmith/analyze-an-experiment\"},{\"title\":\"How to compare experiment results\",\"sidebarTitle\":\"Compare experiment results\",\"description\":null,\"href\":\"/langsmith/compare-experiment-results\"},{\"title\":\"How to filter experiments in the UI\",\"sidebarTitle\":\"Filter experiments in the UI\",\"description\":null,\"href\":\"/langsmith/filter-experiments-ui\"},{\"title\":\"How to fetch performance metrics for an experiment\",\"sidebarTitle\":\"Fetch performance metrics for an experiment\",\"description\":null,\"href\":\"/langsmith/fetch-perf-metrics-experiment\"},{\"title\":\"How to upload experiments run outside of LangSmith with the REST API\",\"sidebarTitle\":\"Upload experiments run outside of LangSmith\",\"description\":null,\"href\":\"/langsmith/upload-existing-experiments\"}]},{\"group\":\"Annotation \u0026 human feedback\",\"pages\":[{\"title\":\"Use annotation queues\",\"sidebarTitle\":\"Use annotation queues\",\"description\":null,\"href\":\"/langsmith/annotation-queues\"},{\"title\":\"Set up feedback criteria\",\"sidebarTitle\":\"Set up feedback criteria\",\"description\":null,\"href\":\"/langsmith/set-up-feedback-criteria\"},{\"title\":\"Annotate traces and runs inline\",\"sidebarTitle\":\"Annotate traces and runs inline\",\"description\":null,\"href\":\"/langsmith/annotate-traces-inline\"},{\"title\":\"How to audit evaluator scores\",\"sidebarTitle\":\"Audit evaluator scores\",\"description\":null,\"href\":\"/langsmith/audit-evaluator-scores\"}]},{\"group\":\"Common data types\",\"pages\":[{\"title\":\"Example data format\",\"sidebarTitle\":\"Example data format\",\"description\":null,\"href\":\"/langsmith/example-data-format\"},{\"title\":\"Dataset prebuilt JSON schema types\",\"sidebarTitle\":\"Dataset prebuilt JSON schema types\",\"description\":null,\"href\":\"/langsmith/dataset-json-types\"},{\"title\":\"Dataset transformations\",\"sidebarTitle\":\"Dataset transformations\",\"description\":null,\"href\":\"/langsmith/dataset-transformations\"}]}]},{\"tab\":\"Prompt engineering\",\"pages\":[{\"title\":\"Prompt engineering\",\"sidebarTitle\":\"Overview\",\"mode\":\"wide\",\"description\":null,\"href\":\"/langsmith/prompt-engineering\"},{\"title\":\"Prompt engineering quickstart\",\"sidebarTitle\":\"Quickstart\",\"description\":null,\"href\":\"/langsmith/prompt-engineering-quickstart\"},{\"title\":\"Prompt engineering concepts\",\"sidebarTitle\":\"Concepts\",\"description\":null,\"href\":\"/langsmith/prompt-engineering-concepts\"},{\"group\":\"Create and update prompts\",\"pages\":[{\"title\":\"Create a prompt\",\"sidebarTitle\":\"Create a prompt\",\"description\":null,\"href\":\"/langsmith/create-a-prompt\"},{\"title\":\"Manage prompts\",\"sidebarTitle\":\"Manage prompts\",\"description\":null,\"href\":\"/langsmith/manage-prompts\"},{\"title\":\"Manage prompts programmatically\",\"sidebarTitle\":\"Manage prompts programmatically\",\"description\":null,\"href\":\"/langsmith/manage-prompts-programmatically\"},{\"title\":\"Configure prompt settings\",\"sidebarTitle\":\"Configure prompt settings\",\"description\":null,\"href\":\"/langsmith/managing-model-configurations\"},{\"title\":\"Use tools in a prompt\",\"sidebarTitle\":\"Use tools in a prompt\",\"description\":null,\"href\":\"/langsmith/use-tools\"},{\"title\":\"Include multimodal content in a prompt\",\"sidebarTitle\":\"Include multimodal content in a prompt\",\"description\":null,\"href\":\"/langsmith/multimodal-content\"},{\"title\":\"Write your prompt with AI\",\"sidebarTitle\":\"Write your prompt with AI\",\"description\":null,\"href\":\"/langsmith/write-prompt-with-ai\"},{\"group\":\"Connect to models\",\"pages\":[{\"title\":\"Connect to an OpenAI compliant model provider/proxy\",\"sidebarTitle\":\"OpenAI-compliant model provider/proxy\",\"description\":null,\"href\":\"/langsmith/custom-openai-compliant-model\"},{\"title\":\"Connect to a custom model\",\"sidebarTitle\":\"Custom model\",\"description\":null,\"href\":\"/langsmith/custom-endpoint\"}]}]},{\"group\":\"Tutorials\",\"pages\":[{\"title\":\"Optimize a classifier\",\"sidebarTitle\":\"Optimize a classifier\",\"description\":null,\"href\":\"/langsmith/optimize-classifier\"},{\"title\":\"How to sync prompts with GitHub\",\"sidebarTitle\":\"Sync prompts with GitHub\",\"description\":null,\"href\":\"/langsmith/prompt-commit\"},{\"title\":\"Test multi-turn conversations\",\"sidebarTitle\":\"Test multi-turn conversations\",\"description\":null,\"href\":\"/langsmith/multiple-messages\"}]}]},{\"tab\":\"Deployment\",\"pages\":[{\"title\":\"LangSmith Deployment\",\"sidebarTitle\":\"Overview\",\"mode\":\"wide\",\"description\":null,\"href\":\"/langsmith/deployments\"},{\"title\":\"Run a LangGraph app locally\",\"sidebarTitle\":\"Test locally\",\"description\":null,\"href\":\"/langsmith/local-server\"},{\"title\":\"App development in LangSmith Deployment\",\"sidebarTitle\":\"App development\",\"mode\":\"wide\",\"description\":null,\"href\":\"/langsmith/app-development\"},{\"title\":\"Deploy your app to Cloud\",\"sidebarTitle\":\"Cloud quickstart\",\"description\":null,\"href\":\"/langsmith/deployment-quickstart\"},{\"group\":\"Configure app for deployment\",\"pages\":[{\"title\":\"Application structure\",\"sidebarTitle\":\"Application structure\",\"description\":null,\"href\":\"/langsmith/application-structure\"},{\"group\":\"Setup\",\"pages\":[{\"title\":\"How to set up an application with requirements.txt\",\"sidebarTitle\":\"With requirements.txt\",\"description\":null,\"href\":\"/langsmith/setup-app-requirements-txt\"},{\"title\":\"How to set up an application with pyproject.toml\",\"sidebarTitle\":\"With pyproject.toml\",\"description\":null,\"href\":\"/langsmith/setup-pyproject\"},{\"title\":\"How to set up a JavaScript application\",\"sidebarTitle\":\"Set up a JavaScript application\",\"description\":null,\"href\":\"/langsmith/setup-javascript\"},{\"title\":\"Monorepo support\",\"sidebarTitle\":\"Monorepo support\",\"description\":null,\"href\":\"/langsmith/monorepo-support\"}]},{\"group\":\"Deployment components\",\"pages\":[{\"title\":\"LangSmith Deployment components\",\"sidebarTitle\":\"Overview\",\"mode\":\"wide\",\"description\":null,\"href\":\"/langsmith/components\"},{\"title\":\"Agent Server\",\"description\":null,\"href\":\"/langsmith/agent-server\"},{\"title\":\"LangSmith data plane\",\"sidebarTitle\":\"Data plane\",\"description\":null,\"href\":\"/langsmith/data-plane\"},{\"title\":\"LangSmith control plane\",\"sidebarTitle\":\"Control plane\",\"description\":null,\"href\":\"/langsmith/control-plane\"}]},{\"title\":\"Rebuild graph at runtime\",\"sidebarTitle\":\"Rebuild graph at runtime\",\"description\":null,\"href\":\"/langsmith/graph-rebuild\"},{\"title\":\"How to interact with a deployment using RemoteGraph\",\"sidebarTitle\":\"Interact with a deployment using RemoteGraph\",\"description\":null,\"href\":\"/langsmith/use-remote-graph\"},{\"title\":\"How to add semantic search to your agent deployment\",\"sidebarTitle\":\"Add semantic search to your agent deployment\",\"description\":null,\"href\":\"/langsmith/semantic-search\"},{\"title\":\"How to add TTLs to your application\",\"sidebarTitle\":\"Add TTLs to your application\",\"description\":null,\"href\":\"/langsmith/configure-ttl\"},{\"title\":\"Configure LangSmith Agent Server for scale\",\"sidebarTitle\":\"Configure Agent Server for scale\",\"description\":null,\"href\":\"/langsmith/agent-server-scale\"},{\"title\":\"Implement a CI/CD pipeline using LangSmith Deployment and Evaluation\",\"sidebarTitle\":\"Implement a CI/CD pipeline\",\"description\":null,\"href\":\"/langsmith/cicd-pipeline-example\"}]},{\"group\":\"Deployment guides\",\"pages\":[{\"title\":\"Deploy on Cloud\",\"sidebarTitle\":\"Cloud\",\"icon\":\"cloud\",\"iconType\":\"solid\",\"description\":null,\"href\":\"/langsmith/deploy-to-cloud\"},{\"title\":\"Deploy with control plane\",\"sidebarTitle\":\"With control plane\",\"icon\":\"cloud-arrow-up\",\"description\":null,\"href\":\"/langsmith/deploy-with-control-plane\"},{\"title\":\"Self-host standalone servers\",\"sidebarTitle\":\"Standalone servers\",\"icon\":\"server\",\"description\":null,\"href\":\"/langsmith/deploy-standalone-server\"},{\"title\":\"Troubleshooting for self-hosted deployments\",\"sidebarTitle\":\"Troubleshooting\",\"description\":null,\"href\":\"/langsmith/diagnostics-self-hosted\"}]},{\"group\":\"App development\",\"pages\":[{\"group\":\"Data models\",\"pages\":[{\"group\":\"Assistants\",\"pages\":[{\"title\":\"Assistants\",\"sidebarTitle\":\"Overview\",\"description\":null,\"href\":\"/langsmith/assistants\"},{\"title\":\"Manage assistants\",\"sidebarTitle\":\"Manage assistants\",\"description\":null,\"href\":\"/langsmith/configuration-cloud\"},{\"title\":\"Use threads\",\"sidebarTitle\":\"Use threads\",\"description\":null,\"href\":\"/langsmith/use-threads\"}]},{\"group\":\"Runs\",\"pages\":[{\"title\":\"How to kick off background runs\",\"sidebarTitle\":\"Kick off background runs\",\"description\":null,\"href\":\"/langsmith/background-run\"},{\"title\":\"How to run multiple agents on the same thread\",\"sidebarTitle\":\"Run multiple agents on the same thread\",\"description\":null,\"href\":\"/langsmith/same-thread\"},{\"title\":\"Use cron jobs\",\"sidebarTitle\":\"Use cron jobs\",\"description\":null,\"href\":\"/langsmith/cron-jobs\"},{\"title\":\"Stateless runs\",\"sidebarTitle\":\"Stateless runs\",\"description\":null,\"href\":\"/langsmith/stateless-runs\"}]}]},{\"group\":\"Core capabilities\",\"pages\":[{\"title\":\"Streaming API\",\"sidebarTitle\":\"Streaming API\",\"description\":null,\"href\":\"/langsmith/streaming\"},{\"title\":\"Human-in-the-loop using server API\",\"sidebarTitle\":\"Human-in-the-loop using server API\",\"description\":null,\"href\":\"/langsmith/add-human-in-the-loop\"},{\"title\":\"Time travel using the server API\",\"sidebarTitle\":\"Time travel using the server API\",\"description\":null,\"href\":\"/langsmith/human-in-the-loop-time-travel\"},{\"title\":\"MCP endpoint in Agent Server\",\"sidebarTitle\":\"MCP endpoint in Agent Server\",\"description\":null,\"href\":\"/langsmith/server-mcp\"},{\"title\":\"A2A endpoint in Agent Server\",\"sidebarTitle\":\"A2A endpoint in Agent Server\",\"description\":null,\"href\":\"/langsmith/server-a2a\"},{\"title\":\"Distributed tracing with Agent Server\",\"sidebarTitle\":\"Distributed tracing\",\"description\":\"Unify traces when calling your deployed Agent Server from another service using RemoteGraph or the SDK.\",\"href\":\"/langsmith/agent-server-distributed-tracing\"},{\"title\":\"Use webhooks\",\"sidebarTitle\":\"Webhooks\",\"description\":null,\"href\":\"/langsmith/use-webhooks\"},{\"group\":\"Double-texting\",\"pages\":[{\"title\":\"Double texting\",\"sidebarTitle\":\"Overview\",\"description\":null,\"href\":\"/langsmith/double-texting\"},{\"title\":\"Interrupt concurrent\",\"sidebarTitle\":\"Interrupt\",\"description\":null,\"href\":\"/langsmith/interrupt-concurrent\"},{\"title\":\"Rollback Concurrent\",\"sidebarTitle\":\"Rollback\",\"description\":null,\"href\":\"/langsmith/rollback-concurrent\"},{\"title\":\"Reject Concurrent\",\"sidebarTitle\":\"Reject\",\"description\":null,\"href\":\"/langsmith/reject-concurrent\"},{\"title\":\"Enqueue concurrent\",\"sidebarTitle\":\"Enqueue\",\"description\":null,\"href\":\"/langsmith/enqueue-concurrent\"}]}]},{\"group\":\"Tutorials\",\"pages\":[{\"title\":\"Deploy other frameworks\",\"sidebarTitle\":\"Deploy other frameworks (e.g., Strands, CrewAI)\",\"description\":null,\"href\":\"/langsmith/deploy-other-frameworks\"},{\"title\":\"How to integrate LangGraph into your React application\",\"sidebarTitle\":\"Integrate LangGraph into your React application\",\"description\":null,\"href\":\"/langsmith/use-stream-react\"},{\"title\":\"How to implement generative user interfaces with LangGraph\",\"sidebarTitle\":\"Implement generative user interfaces with LangGraph\",\"description\":null,\"href\":\"/langsmith/generative-ui-react\"}]}]},{\"group\":\"Studio\",\"pages\":[{\"title\":\"LangSmith Studio\",\"sidebarTitle\":\"Overview\",\"description\":null,\"href\":\"/langsmith/studio\"},{\"title\":\"Get started with Studio\",\"sidebarTitle\":\"Quickstart\",\"description\":null,\"href\":\"/langsmith/quick-start-studio\"},{\"title\":\"How to use Studio\",\"sidebarTitle\":\"Runs, assistants, threads\",\"description\":null,\"href\":\"/langsmith/use-studio\"},{\"title\":\"Observability in Studio\",\"sidebarTitle\":\"Traces, datasets, prompts\",\"description\":null,\"href\":\"/langsmith/observability-studio\"},{\"title\":\"Studio troubleshooting\",\"sidebarTitle\":\"Troubleshooting\",\"description\":null,\"href\":\"/langsmith/troubleshooting-studio\"}]},{\"group\":\"Auth \u0026 access control\",\"pages\":[{\"title\":\"Authentication \u0026 access control\",\"sidebarTitle\":\"Overview\",\"description\":null,\"href\":\"/langsmith/auth\"},{\"title\":\"Add custom authentication\",\"sidebarTitle\":\"Add custom authentication\",\"description\":null,\"href\":\"/langsmith/custom-auth\"},{\"title\":\"Set up custom authentication\",\"sidebarTitle\":\"Set up custom authentication\",\"description\":null,\"href\":\"/langsmith/set-up-custom-auth\"},{\"title\":\"Make conversations private\",\"sidebarTitle\":\"Make conversations private\",\"description\":null,\"href\":\"/langsmith/resource-auth\"},{\"title\":\"Connect an authentication provider\",\"sidebarTitle\":\"Connect an authentication provider\",\"description\":null,\"href\":\"/langsmith/add-auth-server\"},{\"title\":\"Document API authentication in OpenAPI\",\"sidebarTitle\":\"Document API authentication in OpenAPI\",\"description\":null,\"href\":\"/langsmith/openapi-security\"},{\"title\":\"Set up Agent Auth (Beta)\",\"description\":\"Enable secure access from agents to any system using OAuth 2.0 credentials with Agent Auth.\",\"href\":\"/langsmith/agent-auth\"}]},{\"group\":\"Server customization\",\"pages\":[{\"title\":\"How to add custom lifespan events\",\"sidebarTitle\":\"Add custom lifespan events\",\"description\":null,\"href\":\"/langsmith/custom-lifespan\"},{\"title\":\"How to add custom middleware\",\"sidebarTitle\":\"Add custom middleware\",\"description\":null,\"href\":\"/langsmith/custom-middleware\"},{\"title\":\"How to add custom routes\",\"sidebarTitle\":\"Add custom routes\",\"description\":null,\"href\":\"/langsmith/custom-routes\"},{\"title\":\"Add encryption at-rest\",\"sidebarTitle\":\"Encryption at-rest\",\"description\":null,\"href\":\"/langsmith/encryption\"},{\"title\":\"Use HTTP headers for runtime configuration\",\"sidebarTitle\":\"Configurable headers\",\"description\":null,\"href\":\"/langsmith/configurable-headers\"},{\"title\":\"Include HTTP headers in server logs\",\"sidebarTitle\":\"Logging Headers\",\"description\":null,\"href\":\"/langsmith/configurable-logs\"}]}]},{\"tab\":\"Agent Builder\",\"pages\":[{\"title\":\"Agent Builder\",\"description\":\"Create helpful AI agents without code. Start from a template, connect your accounts, and let the agent handle routine work while you stay in control.\",\"sidebarTitle\":\"Overview\",\"mode\":\"wide\",\"href\":\"/langsmith/agent-builder\"},{\"group\":\"Get started\",\"pages\":[{\"title\":\"Essentials\",\"description\":\"Tools, triggers, memory, sub-agents, and approvalsâ€”everything you need in one place.\",\"sidebarTitle\":\"Essentials\",\"href\":\"/langsmith/agent-builder-essentials\"},{\"group\":\"Templates\",\"pages\":[{\"title\":\"Templates\",\"description\":\"Start faster with curated Agent Builder templates and customize tools, prompts, and triggers.\",\"sidebarTitle\":\"Overview\",\"mode\":\"wide\",\"href\":\"/langsmith/agent-builder-templates\"},{\"title\":\"Build an agent from a template\",\"sidebarTitle\":\"Quickstart\",\"description\":null,\"href\":\"/langsmith/agent-builder-quickstart\"}]},{\"title\":\"Agent Builder setup\",\"description\":\"Add required workspace secrets for models and tools used by Agent Builder.\",\"sidebarTitle\":\"Setup\",\"href\":\"/langsmith/agent-builder-setup\"},{\"title\":\"Workspace vs. private agents\",\"description\":\"Understand visibility, auth, and secrets for personal and workspace agents in Agent Builder.\",\"sidebarTitle\":\"Agent visibility\",\"mode\":\"wide\",\"href\":\"/langsmith/agent-builder-workspace-vs-private\"}]},{\"group\":\"Tools and integrations\",\"pages\":[{\"title\":\"Tools\",\"description\":null,\"href\":\"/langsmith/agent-builder-tools\"},{\"title\":\"Third-party MCP servers\",\"description\":\"Connect Agent Builder to popular third-party MCP servers\",\"href\":\"/langsmith/agent-builder-third-party-mcp-servers\"},{\"title\":\"LangSmith Agent Builder App for Slack\",\"description\":\"Connect the LangSmith Agent Builder to your Slack workspace to power AI agents.\",\"sidebarTitle\":\"Slack app\",\"href\":\"/langsmith/agent-builder-slack-app\"}]},{\"group\":\"Advanced\",\"pages\":[{\"title\":\"Auth-aware tool responses\",\"description\":\"Format tool responses to trigger OAuth flows and resume execution automatically.\",\"sidebarTitle\":\"Auth responses\",\"mode\":\"wide\",\"href\":\"/langsmith/agent-builder-auth-format\"},{\"title\":\"Call agents from code\",\"description\":\"Invoke Agent Builder agents from Python or JavaScript using the LangGraph SDK.\",\"sidebarTitle\":\"Call from code\",\"href\":\"/langsmith/agent-builder-code\"},{\"title\":\"LangSmith Tool Server\",\"sidebarTitle\":\"MCP framework\",\"description\":null,\"href\":\"/langsmith/agent-builder-mcp-framework\"}]}]},{\"tab\":\"Platform setup\",\"groups\":[{\"group\":\"Overview\",\"pages\":[{\"title\":\"Set up LangSmith\",\"sidebarTitle\":\"Set up LangSmith\",\"mode\":\"wide\",\"description\":null,\"href\":\"/langsmith/platform-setup\"},{\"title\":\"Cloud\",\"sidebarTitle\":\"Cloud (SaaS)\",\"icon\":\"cloud\",\"iconType\":\"solid\",\"description\":null,\"href\":\"/langsmith/cloud\"}]},{\"group\":\"Self-hosted cloud architecture\",\"pages\":[{\"title\":\"Self-hosted on AWS\",\"sidebarTitle\":\"AWS\",\"icon\":\"aws\",\"description\":null,\"href\":\"/langsmith/aws-self-hosted\"},{\"title\":\"Self-hosted on Azure\",\"sidebarTitle\":\"Azure\",\"icon\":\"microsoft\",\"description\":null,\"href\":\"/langsmith/azure-self-hosted\"},{\"title\":\"Self-hosted on GCP\",\"sidebarTitle\":\"GCP\",\"icon\":\"google\",\"description\":null,\"href\":\"/langsmith/gcp-self-hosted\"}]},{\"group\":\"Hybrid\",\"pages\":[{\"title\":\"Hybrid\",\"sidebarTitle\":\"Overview\",\"description\":null,\"href\":\"/langsmith/hybrid\"},{\"title\":\"Set up hybrid LangSmith\",\"sidebarTitle\":\"Setup guide\",\"icon\":\"cloud\",\"description\":null,\"href\":\"/langsmith/deploy-hybrid\"}]},{\"group\":\"Self-hosted\",\"pages\":[{\"title\":\"Self-hosted LangSmith\",\"sidebarTitle\":\"Overview\",\"description\":null,\"href\":\"/langsmith/self-hosted\"},{\"group\":\"Setup guides\",\"pages\":[{\"group\":\"LangSmith\",\"icon\":\"server\",\"pages\":[{\"title\":\"Self-host LangSmith on Kubernetes\",\"sidebarTitle\":\"Install on Kubernetes\",\"description\":null,\"href\":\"/langsmith/kubernetes\"},{\"title\":\"Self-host LangSmith with Docker\",\"sidebarTitle\":\"Install on Docker\",\"description\":null,\"href\":\"/langsmith/docker\"}]},{\"title\":\"Enable LangSmith Deployment\",\"sidebarTitle\":\"Enable deployment\",\"icon\":\"server\",\"description\":null,\"href\":\"/langsmith/deploy-self-hosted-full-platform\"},{\"group\":\"Manage an installation\",\"pages\":[{\"title\":\"Interact with your self-hosted instance of LangSmith\",\"sidebarTitle\":\"Interact with an installation\",\"description\":null,\"href\":\"/langsmith/self-host-usage\"},{\"title\":\"Upgrade an installation\",\"sidebarTitle\":\"Upgrade an installation\",\"description\":null,\"href\":\"/langsmith/self-host-upgrades\"},{\"title\":\"Egress for subscription metrics and operational metadata\",\"sidebarTitle\":\"Configure egress for subscription metrics\",\"description\":null,\"href\":\"/langsmith/self-host-egress\"},{\"title\":\"View trace counts across your organization\",\"sidebarTitle\":\"View trace counts across an organization\",\"description\":null,\"href\":\"/langsmith/self-host-organization-charts\"},{\"title\":\"LangSmith-managed ClickHouse\",\"sidebarTitle\":\"LangSmith-managed ClickHouse\",\"description\":null,\"href\":\"/langsmith/langsmith-managed-clickhouse\"},{\"title\":\"Create an Ingress for installations (Kubernetes)\",\"sidebarTitle\":\"Create an Ingress for installations (Kubernetes)\",\"description\":null,\"href\":\"/langsmith/self-host-ingress\"},{\"title\":\"Mirror images for your LangSmith installation\",\"sidebarTitle\":\"Mirror images for your installation\",\"description\":null,\"href\":\"/langsmith/self-host-mirroring-images\"}]}]},{\"group\":\"Configuration\",\"pages\":[{\"title\":\"Configure LangSmith for scale\",\"sidebarTitle\":\"Configure for scale\",\"description\":null,\"href\":\"/langsmith/self-host-scale\"},{\"title\":\"Enable TTL and data retention\",\"sidebarTitle\":\"Enable TTL \u0026 data retention\",\"description\":null,\"href\":\"/langsmith/self-host-ttl\"},{\"title\":\"How to customize the Dockerfile\",\"sidebarTitle\":\"Customize the Dockerfile\",\"description\":null,\"href\":\"/langsmith/custom-docker\"},{\"title\":\"Use environment variables for model providers\",\"sidebarTitle\":\"Use environment variables for model providers\",\"description\":null,\"href\":\"/langsmith/self-host-playground-environment-settings\"},{\"title\":\"Troubleshooting\",\"sidebarTitle\":\"Troubleshooting\",\"description\":null,\"href\":\"/langsmith/troubleshooting\"}]},{\"group\":\"Connect external services\",\"pages\":[{\"title\":\"Enable blob storage\",\"sidebarTitle\":\"Enable blob storage\",\"description\":null,\"href\":\"/langsmith/self-host-blob-storage\"},{\"title\":\"Connect to an external ClickHouse database\",\"sidebarTitle\":\"Connect to an external ClickHouse database\",\"description\":null,\"href\":\"/langsmith/self-host-external-clickhouse\"},{\"title\":\"Connect to an external PostgreSQL database\",\"sidebarTitle\":\"Connect to an external PostgreSQL database\",\"description\":null,\"href\":\"/langsmith/self-host-external-postgres\"},{\"title\":\"Connect to an external Redis database\",\"sidebarTitle\":\"Connect to an external Redis database\",\"description\":null,\"href\":\"/langsmith/self-host-external-redis\"}]},{\"group\":\"Platform auth \u0026 access control\",\"pages\":[{\"title\":\"Basic authentication with email and password\",\"sidebarTitle\":\"Set up basic authentication\",\"description\":null,\"href\":\"/langsmith/self-host-basic-auth\"},{\"title\":\"Set up SSO with OAuth2.0 and OIDC\",\"sidebarTitle\":\"Set up SSO with OAuth2.0 \u0026 OIDC\",\"description\":null,\"href\":\"/langsmith/self-host-sso\"},{\"title\":\"Customize user management\",\"sidebarTitle\":\"Customize user management\",\"description\":null,\"href\":\"/langsmith/self-host-user-management\"},{\"title\":\"Configure custom TLS certificates\",\"sidebarTitle\":\"Configure custom TLS certificates\",\"description\":null,\"href\":\"/langsmith/self-host-custom-tls-certificates\"},{\"title\":\"Use an existing secret for your installation (Kubernetes)\",\"sidebarTitle\":\"Use an existing secret for your installation (Kubernetes)\",\"description\":null,\"href\":\"/langsmith/self-host-using-an-existing-secret\"}]},{\"group\":\"Self-hosted observability\",\"pages\":[{\"title\":\"Export LangSmith telemetry to your observability backend\",\"sidebarTitle\":\"Export LangSmith telemetry to your observability backend\",\"description\":null,\"href\":\"/langsmith/export-backend\"},{\"title\":\"Configure your collector for LangSmith telemetry\",\"sidebarTitle\":\"Configure your collector for telemetry\",\"description\":null,\"href\":\"/langsmith/langsmith-collector\"},{\"title\":\"Deploy an observability stack for your LangSmith deployment\",\"sidebarTitle\":\"Deploy an observability stack\",\"description\":null,\"href\":\"/langsmith/observability-stack\"}]},{\"group\":\"Scripts for management tasks\",\"pages\":[{\"title\":\"Delete workspaces\",\"sidebarTitle\":\"Delete workspaces\",\"description\":null,\"href\":\"/langsmith/script-delete-a-workspace\"},{\"title\":\"Delete organizations\",\"sidebarTitle\":\"Delete organizations\",\"description\":null,\"href\":\"/langsmith/script-delete-an-organization\"},{\"title\":\"Delete traces\",\"sidebarTitle\":\"Delete traces\",\"description\":null,\"href\":\"/langsmith/script-delete-traces\"},{\"title\":\"Generate ClickHouse stats\",\"sidebarTitle\":\"Generate ClickHouse Stats\",\"description\":null,\"href\":\"/langsmith/script-generate-clickhouse-stats\"},{\"title\":\"Generate query stats\",\"sidebarTitle\":\"Generate query stats\",\"description\":null,\"href\":\"/langsmith/script-generate-query-stats\"},{\"title\":\"Run support queries against PostgreSQL\",\"sidebarTitle\":\"Run support queries against PostgreSQL\",\"description\":null,\"href\":\"/langsmith/script-running-pg-support-queries\"},{\"title\":\"Run support queries against ClickHouse\",\"sidebarTitle\":\"Run support queries against ClickHouse\",\"description\":null,\"href\":\"/langsmith/script-running-ch-support-queries\"}]}]}]},{\"tab\":\"Reference\",\"pages\":[{\"title\":\"LangSmith reference\",\"sidebarTitle\":\"Overview\",\"mode\":\"wide\",\"description\":null,\"href\":\"/langsmith/reference\"},{\"title\":\"LangSmith Python SDK\",\"sidebarTitle\":\"LangSmith Python SDK\",\"url\":\"https://reference.langchain.com/python/langsmith/observability/sdk/\",\"description\":null,\"href\":\"/langsmith/smith-python-sdk\"},{\"title\":\"LangSmith JS/TS SDK\",\"sidebarTitle\":\"LangSmith JS/TS SDK\",\"url\":\"https://reference.langchain.com/javascript/modules/langsmith.html\",\"description\":null,\"href\":\"/langsmith/smith-js-ts-sdk\"},{\"title\":\"LangGraph Python SDK\",\"sidebarTitle\":\"LangGraph Python SDK\",\"url\":\"https://reference.langchain.com/python/langgraph/\",\"description\":null,\"href\":\"/langsmith/langgraph-python-sdk\"},{\"title\":\"LangGraph JS/TS SDK\",\"sidebarTitle\":\"LangGraph JS/TS SDK\",\"url\":\"https://reference.langchain.com/javascript/modules/_langchain_langgraph-sdk.html\",\"description\":null,\"href\":\"/langsmith/langgraph-js-ts-sdk\"},{\"title\":\"LangSmith API reference\",\"sidebarTitle\":\"LangSmith API\",\"url\":\"https://api.smith.langchain.com/redoc\",\"description\":null,\"href\":\"/langsmith/smith-api-ref\"},{\"group\":\"LangSmith Deployment\",\"pages\":[{\"group\":\"Agent Server API\",\"pages\":[{\"title\":\"Agent Server API reference for LangSmith Deployment\",\"sidebarTitle\":\"Overview\",\"description\":null,\"href\":\"/langsmith/server-api-ref\"},{\"group\":\"Assistants\",\"pages\":[{\"title\":\"Create Assistant\",\"description\":\"Create an assistant.\\n\\nAn initial version of the assistant will be created and the assistant is set to that version. To change versions, use the `POST /assistants/{assistant_id}/latest` endpoint.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json post /assistants\",\"href\":\"/langsmith/agent-server-api/assistants/create-assistant\",\"autogeneratedByOpenApi\":true},{\"title\":\"Search Assistants\",\"description\":\"Search for assistants.\\n\\nThis endpoint also functions as the endpoint to list all assistants.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json post /assistants/search\",\"href\":\"/langsmith/agent-server-api/assistants/search-assistants\",\"autogeneratedByOpenApi\":true},{\"title\":\"Count Assistants\",\"description\":\"Get the count of assistants matching the specified criteria.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json post /assistants/count\",\"href\":\"/langsmith/agent-server-api/assistants/count-assistants\",\"autogeneratedByOpenApi\":true},{\"title\":\"Get Assistant\",\"description\":\"Get an assistant by ID.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json get /assistants/{assistant_id}\",\"href\":\"/langsmith/agent-server-api/assistants/get-assistant\",\"autogeneratedByOpenApi\":true},{\"title\":\"Delete Assistant\",\"description\":\"Delete an assistant by ID.\\n\\nAll versions of the assistant will be deleted as well.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json delete /assistants/{assistant_id}\",\"href\":\"/langsmith/agent-server-api/assistants/delete-assistant\",\"autogeneratedByOpenApi\":true},{\"title\":\"Patch Assistant\",\"description\":\"Update an assistant.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json patch /assistants/{assistant_id}\",\"href\":\"/langsmith/agent-server-api/assistants/patch-assistant\",\"autogeneratedByOpenApi\":true},{\"title\":\"Get Assistant Graph\",\"description\":\"Get an assistant by ID.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json get /assistants/{assistant_id}/graph\",\"href\":\"/langsmith/agent-server-api/assistants/get-assistant-graph\",\"autogeneratedByOpenApi\":true},{\"title\":\"Get Assistant Subgraphs\",\"description\":\"Get an assistant's subgraphs.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json get /assistants/{assistant_id}/subgraphs\",\"href\":\"/langsmith/agent-server-api/assistants/get-assistant-subgraphs\",\"autogeneratedByOpenApi\":true},{\"title\":\"Get Assistant Subgraphs by Namespace\",\"description\":\"Get an assistant's subgraphs filtered by namespace.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json get /assistants/{assistant_id}/subgraphs/{namespace}\",\"href\":\"/langsmith/agent-server-api/assistants/get-assistant-subgraphs-by-namespace\",\"autogeneratedByOpenApi\":true},{\"title\":\"Get Assistant Schemas\",\"description\":\"Get an assistant by ID.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json get /assistants/{assistant_id}/schemas\",\"href\":\"/langsmith/agent-server-api/assistants/get-assistant-schemas\",\"autogeneratedByOpenApi\":true},{\"title\":\"Get Assistant Versions\",\"description\":\"Get all versions of an assistant.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json post /assistants/{assistant_id}/versions\",\"href\":\"/langsmith/agent-server-api/assistants/get-assistant-versions\",\"autogeneratedByOpenApi\":true},{\"title\":\"Set Latest Assistant Version\",\"description\":\"Set the latest version for an assistant.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json post /assistants/{assistant_id}/latest\",\"href\":\"/langsmith/agent-server-api/assistants/set-latest-assistant-version\",\"autogeneratedByOpenApi\":true}]},{\"group\":\"Threads\",\"pages\":[{\"title\":\"Create Thread\",\"description\":\"Create a thread.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json post /threads\",\"href\":\"/langsmith/agent-server-api/threads/create-thread\",\"autogeneratedByOpenApi\":true},{\"title\":\"Search Threads\",\"description\":\"Search for threads.\\n\\nThis endpoint also functions as the endpoint to list all threads.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json post /threads/search\",\"href\":\"/langsmith/agent-server-api/threads/search-threads\",\"autogeneratedByOpenApi\":true},{\"title\":\"Count Threads\",\"description\":\"Get the count of threads matching the specified criteria.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json post /threads/count\",\"href\":\"/langsmith/agent-server-api/threads/count-threads\",\"autogeneratedByOpenApi\":true},{\"title\":\"Prune Threads\",\"description\":\"Prune threads by ID. The 'delete' strategy removes threads entirely. The 'keep_latest' strategy prunes old checkpoints but keeps threads and their latest state (requires FF_USE_CORE_API=true).\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json post /threads/prune\",\"href\":\"/langsmith/agent-server-api/threads/prune-threads\",\"autogeneratedByOpenApi\":true},{\"title\":\"Get Thread State\",\"description\":\"Get state for a thread.\\n\\nThe latest state of the thread (i.e. latest checkpoint) is returned.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json get /threads/{thread_id}/state\",\"href\":\"/langsmith/agent-server-api/threads/get-thread-state\",\"autogeneratedByOpenApi\":true},{\"title\":\"Update Thread State\",\"description\":\"Add state to a thread.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json post /threads/{thread_id}/state\",\"href\":\"/langsmith/agent-server-api/threads/update-thread-state\",\"autogeneratedByOpenApi\":true},{\"title\":\"Get Thread State At Checkpoint\",\"description\":\"Get state for a thread at a specific checkpoint.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json get /threads/{thread_id}/state/{checkpoint_id}\",\"href\":\"/langsmith/agent-server-api/threads/get-thread-state-at-checkpoint\",\"autogeneratedByOpenApi\":true},{\"title\":\"Get Thread State At Checkpoint\",\"description\":\"Get state for a thread at a specific checkpoint.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json post /threads/{thread_id}/state/checkpoint\",\"href\":\"/langsmith/agent-server-api/threads/get-thread-state-at-checkpoint-1\",\"autogeneratedByOpenApi\":true},{\"title\":\"Get Thread History\",\"description\":\"Get all past states for a thread.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json get /threads/{thread_id}/history\",\"href\":\"/langsmith/agent-server-api/threads/get-thread-history\",\"autogeneratedByOpenApi\":true},{\"title\":\"Get Thread History Post\",\"description\":\"Get all past states for a thread.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json post /threads/{thread_id}/history\",\"href\":\"/langsmith/agent-server-api/threads/get-thread-history-post\",\"autogeneratedByOpenApi\":true},{\"title\":\"Copy Thread\",\"description\":\"Create a new thread with a copy of the state and checkpoints from an existing thread.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json post /threads/{thread_id}/copy\",\"href\":\"/langsmith/agent-server-api/threads/copy-thread\",\"autogeneratedByOpenApi\":true},{\"title\":\"Get Thread\",\"description\":\"Get a thread by ID.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json get /threads/{thread_id}\",\"href\":\"/langsmith/agent-server-api/threads/get-thread\",\"autogeneratedByOpenApi\":true},{\"title\":\"Delete Thread\",\"description\":\"Delete a thread by ID.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json delete /threads/{thread_id}\",\"href\":\"/langsmith/agent-server-api/threads/delete-thread\",\"autogeneratedByOpenApi\":true},{\"title\":\"Patch Thread\",\"description\":\"Update a thread.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json patch /threads/{thread_id}\",\"href\":\"/langsmith/agent-server-api/threads/patch-thread\",\"autogeneratedByOpenApi\":true},{\"title\":\"Join Thread Stream\",\"description\":\"This endpoint streams output in real-time from a thread. The stream will include the output of each run executed sequentially on the thread and will remain open indefinitely. It is the responsibility of the calling client to close the connection.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json get /threads/{thread_id}/stream\",\"href\":\"/langsmith/agent-server-api/threads/join-thread-stream\",\"autogeneratedByOpenApi\":true}]},{\"group\":\"Thread Runs\",\"pages\":[{\"title\":\"List Runs\",\"description\":\"List runs for a thread.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json get /threads/{thread_id}/runs\",\"href\":\"/langsmith/agent-server-api/thread-runs/list-runs\",\"autogeneratedByOpenApi\":true},{\"title\":\"Create Background Run\",\"description\":\"Create a run in existing thread, return the run ID immediately. Don't wait for the final run output.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json post /threads/{thread_id}/runs\",\"href\":\"/langsmith/agent-server-api/thread-runs/create-background-run\",\"autogeneratedByOpenApi\":true},{\"title\":\"Create Run, Stream Output\",\"description\":\"Create a run in existing thread. Stream the output.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json post /threads/{thread_id}/runs/stream\",\"href\":\"/langsmith/agent-server-api/thread-runs/create-run-stream-output\",\"autogeneratedByOpenApi\":true},{\"title\":\"Create Run, Wait for Output\",\"description\":\"Create a run in existing thread. Wait for the final output and then return it.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json post /threads/{thread_id}/runs/wait\",\"href\":\"/langsmith/agent-server-api/thread-runs/create-run-wait-for-output\",\"autogeneratedByOpenApi\":true},{\"title\":\"Get Run\",\"description\":\"Get a run by ID.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json get /threads/{thread_id}/runs/{run_id}\",\"href\":\"/langsmith/agent-server-api/thread-runs/get-run\",\"autogeneratedByOpenApi\":true},{\"title\":\"Delete Run\",\"description\":\"Delete a run by ID.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json delete /threads/{thread_id}/runs/{run_id}\",\"href\":\"/langsmith/agent-server-api/thread-runs/delete-run\",\"autogeneratedByOpenApi\":true},{\"title\":\"Join Run\",\"description\":\"Wait for a run to finish.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json get /threads/{thread_id}/runs/{run_id}/join\",\"href\":\"/langsmith/agent-server-api/thread-runs/join-run\",\"autogeneratedByOpenApi\":true},{\"title\":\"Join Run Stream\",\"description\":\"Join a run stream. This endpoint streams output in real-time from a run similar to the /threads/__THREAD_ID__/runs/stream endpoint. If the run has been created with `stream_resumable=true`, the stream can be resumed from the last seen event ID.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json get /threads/{thread_id}/runs/{run_id}/stream\",\"href\":\"/langsmith/agent-server-api/thread-runs/join-run-stream\",\"autogeneratedByOpenApi\":true},{\"title\":\"Cancel Run\",\"description\":null,\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json post /threads/{thread_id}/runs/{run_id}/cancel\",\"href\":\"/langsmith/agent-server-api/thread-runs/cancel-run\",\"autogeneratedByOpenApi\":true},{\"title\":\"Cancel Runs\",\"description\":\"Cancel one or more runs. Can cancel runs by thread ID and run IDs, or by status filter.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json post /runs/cancel\",\"href\":\"/langsmith/agent-server-api/thread-runs/cancel-runs\",\"autogeneratedByOpenApi\":true}]},{\"group\":\"Crons (Plus tier)\",\"pages\":[{\"title\":\"Create Thread Cron\",\"description\":\"Create a cron to schedule runs on a thread.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json post /threads/{thread_id}/runs/crons\",\"href\":\"/langsmith/agent-server-api/crons-plus-tier/create-thread-cron\",\"autogeneratedByOpenApi\":true},{\"title\":\"Create Cron\",\"description\":\"Create a cron to schedule runs on new threads.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json post /runs/crons\",\"href\":\"/langsmith/agent-server-api/crons-plus-tier/create-cron\",\"autogeneratedByOpenApi\":true},{\"title\":\"Search Crons\",\"description\":\"Search all active crons\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json post /runs/crons/search\",\"href\":\"/langsmith/agent-server-api/crons-plus-tier/search-crons\",\"autogeneratedByOpenApi\":true},{\"title\":\"Count Crons\",\"description\":\"Get the count of crons matching the specified criteria.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json post /runs/crons/count\",\"href\":\"/langsmith/agent-server-api/crons-plus-tier/count-crons\",\"autogeneratedByOpenApi\":true},{\"title\":\"Delete Cron\",\"description\":\"Delete a cron by ID.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json delete /runs/crons/{cron_id}\",\"href\":\"/langsmith/agent-server-api/crons-plus-tier/delete-cron\",\"autogeneratedByOpenApi\":true}]},{\"group\":\"Stateless Runs\",\"pages\":[{\"title\":\"Create Run, Stream Output\",\"description\":\"Create a run and stream the output.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json post /runs/stream\",\"href\":\"/langsmith/agent-server-api/stateless-runs/create-run-stream-output\",\"autogeneratedByOpenApi\":true},{\"title\":\"Create Run, Wait for Output\",\"description\":\"Create a run, wait for the final output and then return it.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json post /runs/wait\",\"href\":\"/langsmith/agent-server-api/stateless-runs/create-run-wait-for-output\",\"autogeneratedByOpenApi\":true},{\"title\":\"Create Background Run\",\"description\":\"Create a run and return the run ID immediately. Don't wait for the final run output.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json post /runs\",\"href\":\"/langsmith/agent-server-api/stateless-runs/create-background-run\",\"autogeneratedByOpenApi\":true},{\"title\":\"Create Run Batch\",\"description\":\"Create a batch of runs and return immediately.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json post /runs/batch\",\"href\":\"/langsmith/agent-server-api/stateless-runs/create-run-batch\",\"autogeneratedByOpenApi\":true}]},{\"group\":\"Store\",\"pages\":[{\"title\":\"Retrieve a single item.\",\"description\":null,\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json get /store/items\",\"href\":\"/langsmith/agent-server-api/store/retrieve-a-single-item\",\"autogeneratedByOpenApi\":true},{\"title\":\"Store or update an item.\",\"description\":null,\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json put /store/items\",\"href\":\"/langsmith/agent-server-api/store/store-or-update-an-item\",\"autogeneratedByOpenApi\":true},{\"title\":\"Delete an item.\",\"description\":null,\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json delete /store/items\",\"href\":\"/langsmith/agent-server-api/store/delete-an-item\",\"autogeneratedByOpenApi\":true},{\"title\":\"Search for items within a namespace prefix.\",\"description\":null,\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json post /store/items/search\",\"href\":\"/langsmith/agent-server-api/store/search-for-items-within-a-namespace-prefix\",\"autogeneratedByOpenApi\":true},{\"title\":\"List namespaces with optional match conditions.\",\"description\":null,\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json post /store/namespaces\",\"href\":\"/langsmith/agent-server-api/store/list-namespaces-with-optional-match-conditions\",\"autogeneratedByOpenApi\":true}]},{\"group\":\"A2A\",\"pages\":[{\"title\":\"A2A Post\",\"description\":\"Communicate with an assistant using the Agent-to-Agent Protocol.\\nSends a JSON-RPC 2.0 message to the assistant.\\n\\n- **Request**: Provide an object with `jsonrpc`, `id`, `method`, and optional `params`.\\n- **Response**: Returns a JSON-RPC response with task information or error.\\n\\n**Supported Methods:**\\n- `message/send`: Send a message to the assistant\\n- `tasks/get`: Get the status and result of a task\\n\\n**Notes:**\\n- Supports threaded conversations via thread context\\n- Messages can contain text and data parts\\n- Tasks run asynchronously and return completion status\\n\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json post /a2a/{assistant_id}\",\"href\":\"/langsmith/agent-server-api/a2a/a2a-post\",\"autogeneratedByOpenApi\":true}]},{\"group\":\"MCP\",\"pages\":[{\"title\":\"MCP Get\",\"description\":\"Implemented according to the Streamable HTTP Transport specification.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json get /mcp/\",\"href\":\"/langsmith/agent-server-api/mcp/mcp-get\",\"autogeneratedByOpenApi\":true},{\"title\":\"MCP Post\",\"description\":\"Implemented according to the Streamable HTTP Transport specification.\\nSends a JSON-RPC 2.0 message to the server.\\n\\n- **Request**: Provide an object with `jsonrpc`, `id`, `method`, and optional `params`.\\n- **Response**: Returns a JSON-RPC response or acknowledgment.\\n\\n**Notes:**\\n- Stateless: Sessions are not persisted across requests.\\n\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json post /mcp/\",\"href\":\"/langsmith/agent-server-api/mcp/mcp-post\",\"autogeneratedByOpenApi\":true},{\"title\":\"Terminate Session\",\"description\":\"Implemented according to the Streamable HTTP Transport specification.\\nTerminate an MCP session. The server implementation is stateless, so this is a no-op.\\n\\n\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json delete /mcp/\",\"href\":\"/langsmith/agent-server-api/mcp/terminate-session\",\"autogeneratedByOpenApi\":true}]},{\"group\":\"System\",\"pages\":[{\"title\":\"Server Information\",\"description\":\"Get server version information, feature flags, and metadata.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json get /info\",\"href\":\"/langsmith/agent-server-api/system/server-information\",\"autogeneratedByOpenApi\":true},{\"title\":\"System Metrics\",\"description\":\"Get system metrics in Prometheus or JSON format for monitoring and observability.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json get /metrics\",\"href\":\"/langsmith/agent-server-api/system/system-metrics\",\"autogeneratedByOpenApi\":true},{\"title\":\"Health Check\",\"description\":\"Check the health status of the server. Optionally check database connectivity.\",\"deprecated\":null,\"version\":null,\"openapi\":\"langsmith/agent-server-openapi.json get /ok\",\"href\":\"/langsmith/agent-server-api/system/health-check\",\"autogeneratedByOpenApi\":true}]}]},{\"group\":\"Control Plane API\",\"pages\":[{\"title\":\"Control plane API reference for LangSmith Deployment\",\"sidebarTitle\":\"Overview\",\"description\":null,\"href\":\"/langsmith/api-ref-control-plane\"},{\"group\":\"Integrations (v1)\",\"pages\":[{\"title\":\"List GitHub Integrations\",\"description\":\"List available GitHub integrations for LangGraph Platfom Cloud SaaS.\",\"deprecated\":null,\"version\":null,\"openapi\":\"https://api.host.langchain.com/openapi.json get /v1/integrations/github/install\",\"href\":\"/api-reference/integrations-v1/list-github-integrations\",\"autogeneratedByOpenApi\":true},{\"title\":\"List GitHub Repositories\",\"description\":\"List available GitHub repositories for an integration that are available to deploy to LangSmith Deployment.\",\"deprecated\":null,\"version\":null,\"openapi\":\"https://api.host.langchain.com/openapi.json get /v1/integrations/github/{integration_id}/repos\",\"href\":\"/api-reference/integrations-v1/list-github-repositories\",\"autogeneratedByOpenApi\":true}]},{\"group\":\"Deployments (v2)\",\"pages\":[{\"title\":\"List Deployments\",\"description\":\"List all deployments.\",\"deprecated\":null,\"version\":null,\"openapi\":\"https://api.host.langchain.com/openapi.json get /v2/deployments\",\"href\":\"/api-reference/deployments-v2/list-deployments\",\"autogeneratedByOpenApi\":true},{\"title\":\"Create Deployment\",\"description\":\"Create a new deployment.\",\"deprecated\":null,\"version\":null,\"openapi\":\"https://api.host.langchain.com/openapi.json post /v2/deployments\",\"href\":\"/api-reference/deployments-v2/create-deployment\",\"autogeneratedByOpenApi\":true},{\"title\":\"Get Deployment\",\"description\":\"Get a deployment by ID.\",\"deprecated\":null,\"version\":null,\"openapi\":\"https://api.host.langchain.com/openapi.json get /v2/deployments/{deployment_id}\",\"href\":\"/api-reference/deployments-v2/get-deployment\",\"autogeneratedByOpenApi\":true},{\"title\":\"Delete Deployment\",\"description\":\"Delete a deployment by ID.\",\"deprecated\":null,\"version\":null,\"openapi\":\"https://api.host.langchain.com/openapi.json delete /v2/deployments/{deployment_id}\",\"href\":\"/api-reference/deployments-v2/delete-deployment\",\"autogeneratedByOpenApi\":true},{\"title\":\"Patch Deployment\",\"description\":\"Patch a deployment by ID.\",\"deprecated\":null,\"version\":null,\"openapi\":\"https://api.host.langchain.com/openapi.json patch /v2/deployments/{deployment_id}\",\"href\":\"/api-reference/deployments-v2/patch-deployment\",\"autogeneratedByOpenApi\":true},{\"title\":\"List Revisions\",\"description\":\"List all revisions for a deployment.\",\"deprecated\":null,\"version\":null,\"openapi\":\"https://api.host.langchain.com/openapi.json get /v2/deployments/{deployment_id}/revisions\",\"href\":\"/api-reference/deployments-v2/list-revisions\",\"autogeneratedByOpenApi\":true},{\"title\":\"Get Revision\",\"description\":\"Get a revision by ID for a deployment.\",\"deprecated\":null,\"version\":null,\"openapi\":\"https://api.host.langchain.com/openapi.json get /v2/deployments/{deployment_id}/revisions/{revision_id}\",\"href\":\"/api-reference/deployments-v2/get-revision\",\"autogeneratedByOpenApi\":true},{\"title\":\"Redeploy Revision\",\"description\":\"Redeploy a specific revision ID.\",\"deprecated\":null,\"version\":null,\"openapi\":\"https://api.host.langchain.com/openapi.json post /v2/deployments/{deployment_id}/revisions/{revision_id}/redeploy\",\"href\":\"/api-reference/deployments-v2/redeploy-revision\",\"autogeneratedByOpenApi\":true}]},{\"group\":\"Listeners (v2)\",\"pages\":[{\"title\":\"List Listeners\",\"description\":\"List all listeners.\",\"deprecated\":null,\"version\":null,\"openapi\":\"https://api.host.langchain.com/openapi.json get /v2/listeners\",\"href\":\"/api-reference/listeners-v2/list-listeners\",\"autogeneratedByOpenApi\":true},{\"title\":\"Create Listener\",\"description\":\"Create a listener.\u003cbr\u003e\\n\u003cbr\u003e\\nCreating a listener is only allowed for LangSmith organizations with self-hosted enterprise plans.\",\"deprecated\":null,\"version\":null,\"openapi\":\"https://api.host.langchain.com/openapi.json post /v2/listeners\",\"href\":\"/api-reference/listeners-v2/create-listener\",\"autogeneratedByOpenApi\":true},{\"title\":\"Get Listener\",\"description\":\"Get a listener by ID.\",\"deprecated\":null,\"version\":null,\"openapi\":\"https://api.host.langchain.com/openapi.json get /v2/listeners/{listener_id}\",\"href\":\"/api-reference/listeners-v2/get-listener\",\"autogeneratedByOpenApi\":true},{\"title\":\"Delete Listener\",\"description\":\"Delete a listener by ID.\",\"deprecated\":null,\"version\":null,\"openapi\":\"https://api.host.langchain.com/openapi.json delete /v2/listeners/{listener_id}\",\"href\":\"/api-reference/listeners-v2/delete-listener\",\"autogeneratedByOpenApi\":true},{\"title\":\"Patch Listener\",\"description\":\"Patch a listener by ID.\",\"deprecated\":null,\"version\":null,\"openapi\":\"https://api.host.langchain.com/openapi.json patch /v2/listeners/{listener_id}\",\"href\":\"/api-reference/listeners-v2/patch-listener\",\"autogeneratedByOpenApi\":true}]},{\"group\":\"Auth Service (v2)\",\"pages\":[{\"title\":\"List Oauth Providers\",\"description\":\"List OAuth providers.\",\"deprecated\":null,\"version\":null,\"openapi\":\"https://api.host.langchain.com/openapi.json get /v2/auth/providers\",\"href\":\"/api-reference/auth-service-v2/list-oauth-providers\",\"autogeneratedByOpenApi\":true},{\"title\":\"Create Oauth Provider\",\"description\":\"Create a new OAuth provider manually.\",\"deprecated\":null,\"version\":null,\"openapi\":\"https://api.host.langchain.com/openapi.json post /v2/auth/providers\",\"href\":\"/api-reference/auth-service-v2/create-oauth-provider\",\"autogeneratedByOpenApi\":true},{\"title\":\"Oauth Setup Callback\",\"description\":\"Handle OAuth setup callback redirect from GitHub Apps.\\n\\nThis endpoint handles the \\\"Setup URL\\\" callback from GitHub Apps, which is\\ntriggered when a user installs or updates their GitHub App installation.\\n\\nFor \\\"update\\\" actions (user modified repo access via GitHub), we just show\\na success page since no token exchange is needed.\\n\\nFor new installations with code/state, we process similar to the regular\\nOAuth callback.\",\"deprecated\":null,\"version\":null,\"openapi\":\"https://api.host.langchain.com/openapi.json get /v2/auth/setup/{provider_id}\",\"href\":\"/api-reference/auth-service-v2/oauth-setup-callback\",\"autogeneratedByOpenApi\":true},{\"title\":\"Oauth Callback Get\",\"description\":\"Handle OAuth callback redirect from OAuth providers.\\n\\nProcesses the OAuth token exchange, then redirects to the frontend callback\\npage for a consistent UI experience.\",\"deprecated\":null,\"version\":null,\"openapi\":\"https://api.host.langchain.com/openapi.json get /v2/auth/callback/{provider_id}\",\"href\":\"/api-reference/auth-service-v2/oauth-callback-get\",\"autogeneratedByOpenApi\":true},{\"title\":\"Oauth Callback\",\"description\":null,\"deprecated\":null,\"version\":null,\"openapi\":\"https://api.host.langchain.com/openapi.json post /v2/auth/callback/{provider_id}\",\"href\":\"/api-reference/auth-service-v2/oauth-callback\",\"autogeneratedByOpenApi\":true},{\"title\":\"Authenticate\",\"description\":\"Get OAuth token or start authentication flow if needed.\",\"deprecated\":null,\"version\":null,\"openapi\":\"https://api.host.langchain.com/openapi.json post /v2/auth/authenticate\",\"href\":\"/api-reference/auth-service-v2/authenticate\",\"autogeneratedByOpenApi\":true},{\"title\":\"Wait For Auth Completion\",\"description\":\"Wait for OAuth authentication completion.\",\"deprecated\":null,\"version\":null,\"openapi\":\"https://api.host.langchain.com/openapi.json get /v2/auth/wait/{auth_id}\",\"href\":\"/api-reference/auth-service-v2/wait-for-auth-completion\",\"autogeneratedByOpenApi\":true},{\"title\":\"Create Mcp Oauth Provider\",\"description\":\"Create an OAuth provider via MCP auto-discovery.\",\"deprecated\":null,\"version\":null,\"openapi\":\"https://api.host.langchain.com/openapi.json post /v2/auth/providers/mcp-discover\",\"href\":\"/api-reference/auth-service-v2/create-mcp-oauth-provider\",\"autogeneratedByOpenApi\":true},{\"title\":\"Get Oauth Provider\",\"description\":\"Get a specific OAuth provider.\",\"deprecated\":null,\"version\":null,\"openapi\":\"https://api.host.langchain.com/openapi.json get /v2/auth/providers/{provider_id}\",\"href\":\"/api-reference/auth-service-v2/get-oauth-provider\",\"autogeneratedByOpenApi\":true},{\"title\":\"Delete Oauth Provider\",\"description\":\"Delete an OAuth provider.\",\"deprecated\":null,\"version\":null,\"openapi\":\"https://api.host.langchain.com/openapi.json delete /v2/auth/providers/{provider_id}\",\"href\":\"/api-reference/auth-service-v2/delete-oauth-provider\",\"autogeneratedByOpenApi\":true},{\"title\":\"Update Oauth Provider\",\"description\":\"Update an OAuth provider.\",\"deprecated\":null,\"version\":null,\"openapi\":\"https://api.host.langchain.com/openapi.json patch /v2/auth/providers/{provider_id}\",\"href\":\"/api-reference/auth-service-v2/update-oauth-provider\",\"autogeneratedByOpenApi\":true},{\"title\":\"Check Oauth Token Exists\",\"description\":\"Return whether the current user has any tokens for a given provider (across agents).\",\"deprecated\":null,\"version\":null,\"openapi\":\"https://api.host.langchain.com/openapi.json get /v2/auth/tokens/exists\",\"href\":\"/api-reference/auth-service-v2/check-oauth-token-exists\",\"autogeneratedByOpenApi\":true},{\"title\":\"Delete Oauth Tokens For User\",\"description\":\"Delete all tokens for the current user for the given provider (across agents).\",\"deprecated\":null,\"version\":null,\"openapi\":\"https://api.host.langchain.com/openapi.json delete /v2/auth/tokens\",\"href\":\"/api-reference/auth-service-v2/delete-oauth-tokens-for-user\",\"autogeneratedByOpenApi\":true}]}]},{\"title\":\"LangGraph CLI\",\"sidebarTitle\":\"LangGraph CLI\",\"description\":null,\"href\":\"/langsmith/cli\"},{\"title\":\"RemoteGraph\",\"sidebarTitle\":\"RemoteGraph\",\"url\":\"https://reference.langchain.com/python/langsmith/deployment/remote_graph/\",\"description\":null,\"href\":\"/langsmith/remote-graph\"},{\"title\":\"Environment variables\",\"sidebarTitle\":\"Agent Server environment variables\",\"description\":null,\"href\":\"/langsmith/env-var\"}]},{\"group\":\"Releases\",\"pages\":[{\"title\":\"Agent Server changelog\",\"sidebarTitle\":\"Agent Server changelog\",\"rss\":true,\"description\":null,\"href\":\"/langsmith/agent-server-changelog\"},{\"title\":\"Self-hosted LangSmith changelog\",\"sidebarTitle\":\"Self-hosted changelog\",\"rss\":true,\"description\":null,\"href\":\"/langsmith/self-hosted-changelog\"},{\"title\":\"Release versions\",\"description\":null,\"href\":\"/langsmith/release-versions\"}]}]}]}]}},\"children\":\"$L40\"}]}]}]}]]}]}]\n"])</script><script>self.__next_f.push([1,"41:I[68367,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"74610\",\"static/chunks/74610-281c4fe11ead87d4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"59823\",\"static/chunks/59823-9016fae3a0af6930.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"35456\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/layout-3a53ac52e5c673ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"LoginButtonProvider\",1]\n"])</script><script>self.__next_f.push([1,"42:I[54001,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"74610\",\"static/chunks/74610-281c4fe11ead87d4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"59823\",\"static/chunks/59823-9016fae3a0af6930.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"35456\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/layout-3a53ac52e5c673ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"SidebarLoginButtonProvider\",1]\n"])</script><script>self.__next_f.push([1,"43:I[76829,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"74610\",\"static/chunks/74610-281c4fe11ead87d4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"59823\",\"static/chunks/59823-9016fae3a0af6930.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"35456\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/layout-3a53ac52e5c673ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"NavigationContextController\",1]\n"])</script><script>self.__next_f.push([1,"44:I[96924,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"74610\",\"static/chunks/74610-281c4fe11ead87d4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"59823\",\"static/chunks/59823-9016fae3a0af6930.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"35456\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/layout-3a53ac52e5c673ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"PrefetchProvider\"]\n"])</script><script>self.__next_f.push([1,"45:I[69445,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"74610\",\"static/chunks/74610-281c4fe11ead87d4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"59823\",\"static/chunks/59823-9016fae3a0af6930.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"35456\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/layout-3a53ac52e5c673ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"Fonts\",1]\n"])</script><script>self.__next_f.push([1,"46:I[12192,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"74610\",\"static/chunks/74610-281c4fe11ead87d4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"59823\",\"static/chunks/59823-9016fae3a0af6930.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"35456\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/layout-3a53ac52e5c673ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"BannerProvider\",1]\n"])</script><script>self.__next_f.push([1,"47:I[42080,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25263\",\"static/chunks/25263-1e30f64402644edf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"2870\",\"static/chunks/2870-43b3b296a96d0195.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"89841\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/%5B%5B...slug%5D%5D/page-024162cb87bbb1c5.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"ScrollTopScript\",1]\n"])</script><script>self.__next_f.push([1,"48:I[45905,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"74610\",\"static/chunks/74610-281c4fe11ead87d4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"59823\",\"static/chunks/59823-9016fae3a0af6930.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"35456\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/layout-3a53ac52e5c673ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"LocalStorageAndAnalyticsProviders\",1]\n"])</script><script>self.__next_f.push([1,"49:I[83176,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"74610\",\"static/chunks/74610-281c4fe11ead87d4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"59823\",\"static/chunks/59823-9016fae3a0af6930.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"35456\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/layout-3a53ac52e5c673ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"default\"]\n"])</script><script>self.__next_f.push([1,"4a:I[33427,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"74610\",\"static/chunks/74610-281c4fe11ead87d4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"59823\",\"static/chunks/59823-9016fae3a0af6930.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"35456\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/layout-3a53ac52e5c673ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"SearchProvider\",1]\n"])</script><script>self.__next_f.push([1,"4b:I[76982,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"74610\",\"static/chunks/74610-281c4fe11ead87d4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"59823\",\"static/chunks/59823-9016fae3a0af6930.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"35456\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/layout-3a53ac52e5c673ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"SkipToContent\",1]\n"])</script><script>self.__next_f.push([1,"4c:I[89261,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"74610\",\"static/chunks/74610-281c4fe11ead87d4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"59823\",\"static/chunks/59823-9016fae3a0af6930.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"35456\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/layout-3a53ac52e5c673ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"AssistantLayoutWrapper\",1]\n"])</script><script>self.__next_f.push([1,"4d:I[14975,[\"73473\",\"static/chunks/891cff7f-dcf0b8e94fd9e2cd.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"53016\",\"static/chunks/cfdfcc00-442051842d4b5e4f.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"41725\",\"static/chunks/d30757c7-2d2105da33b688d0.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"82431\",\"static/chunks/82431-a3e0a126611457bf.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"43881\",\"static/chunks/43881-67920a24b626c850.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"98816\",\"static/chunks/98816-4875194b6205382d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"77187\",\"static/chunks/77187-54d234c2e70a9fd4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"19664\",\"static/chunks/19664-8ce43df6b74bea12.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"21246\",\"static/chunks/21246-a76922653256bc59.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"91769\",\"static/chunks/91769-84a60608f35c4c3d.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"70523\",\"static/chunks/70523-43da3b59f75962b1.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"74610\",\"static/chunks/74610-281c4fe11ead87d4.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"25930\",\"static/chunks/25930-eccc103710e2a8fe.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"73205\",\"static/chunks/73205-76d4949febf700ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"14224\",\"static/chunks/14224-2cd0f04bb81003af.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"83667\",\"static/chunks/83667-9f6e01e9cb0525db.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"86707\",\"static/chunks/86707-0d7682a9279a50a7.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"59823\",\"static/chunks/59823-9016fae3a0af6930.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\",\"35456\",\"static/chunks/app/%255Fsites/%5Bsubdomain%5D/(multitenant)/layout-3a53ac52e5c673ad.js?dpl=dpl_HX1vg1Fjod4Jp5EW1SK2BmZqWtvw\"],\"ThemeLayout\",1]\n"])</script><script>self.__next_f.push([1,"40:[\"$\",\"$L41\",null,{\"children\":[\"$\",\"$L42\",null,{\"children\":[\"$\",\"$L43\",null,{\"children\":[\"$\",\"$L44\",null,{\"children\":[[\"$\",\"$L7\",null,{\"fonts\":\"$16:props:children:props:children:2:props:children:props:children:props:children:props:value:docsConfig:fonts\",\"theme\":\"aspen\",\"subdomain\":\"langchain-5e9cc07a\"}],[[\"$\",\"$L6\",null,{\"docsConfig\":\"$16:props:children:props:children:2:props:children:props:children:props:children:props:value:docsConfig\"}],[[\"$\",\"link\",null,{\"rel\":\"preload\",\"href\":\"https://d4tuoctqmanu0.cloudfront.net/katex.min.css\",\"as\":\"style\"}],[\"$\",\"script\",null,{\"type\":\"text/javascript\",\"children\":\"\\n          (function() {\\n            function loadKatex() {\\n              const link = document.querySelector('link[href=\\\"https://d4tuoctqmanu0.cloudfront.net/katex.min.css\\\"]');\\n              if (link) link.rel = 'stylesheet';\\n            }\\n            if (document.readyState === 'loading') {\\n              document.addEventListener('DOMContentLoaded', loadKatex);\\n            } else {\\n              loadKatex();\\n            }\\n          })();\\n        \"}]],[\"$\",\"$L8\",null,{\"theme\":\"aspen\"}],[\"$\",\"$L45\",null,{\"fonts\":\"$16:props:children:props:children:2:props:children:props:children:props:children:props:value:docsConfig:fonts\",\"children\":[\"$\",\"$L46\",null,{\"bannersByLocale\":{},\"subdomain\":\"langchain-5e9cc07a\",\"children\":[[\"$\",\"$L47\",null,{\"theme\":\"aspen\"}],[\"$\",\"$L48\",null,{\"subdomain\":\"langchain-5e9cc07a\",\"children\":[\"$\",\"$L49\",null,{\"toggles\":[],\"children\":[\"$\",\"$L4a\",null,{\"subdomain\":\"langchain-5e9cc07a\",\"hasChatPermissions\":false,\"assistantConfig\":{\"enableAskAiButton\":false,\"enableAskAiSearchBar\":true,\"deflection\":{\"enabled\":false,\"email\":\"support@langchain.dev\"}},\"starterQuestions\":\"$undefined\",\"children\":[[\"$\",\"$L4b\",null,{}],[\"$\",\"$L4c\",null,{\"children\":[\"$\",\"$L4d\",null,{\"topbar\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"topbar\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}],\"theme\":\"aspen\",\"children\":[[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}],\"$undefined\"]}]}]]}]}]}]]}]}]]]}]}]}]}]\n"])</script><div id="screenity-ui"><div class="screenity-shadow-dom"><div><div></div><div></div></div><style type="text/css">#screenity-ui, #screenity-ui div {background-color: unset;padding: unset;width: unset;box-shadow: unset;display: unset;margin: unset;border-radius: unset;}.screenity-outline {position: absolute;z-index: 99999999999;border: 2px solid #3080F8;outline-offset: -2px;pointer-events: none;border-radius: 5px!important;}.screenity-blur {filter: blur(10px)!important;}.screenity-shadow-dom * {transition: unset;}.screenity-shadow-dom .TooltipContent {  border-radius: 30px!important;background-color: #29292F!important;  padding: 10px 15px!important;  font-size: 12px;margin-bottom: 10px!important;bottom: 100px;  line-height: 1;font-family: 'Satoshi-Medium', sans-serif;z-index: 99999999!important;  color: #FFF;  box-shadow: hsl(206 22% 7% / 35%) 0px 10px 38px -10px, hsl(206 22% 7% / 20%) 0px 10px 20px -15px!important;  user-select: none;transition: opacity 0.3 ease-in-out;  will-change: transform, opacity;animation-duration: 400ms;  animation-timing-function: cubic-bezier(0.16, 1, 0.3, 1);  will-change: transform, opacity;}.screenity-shadow-dom .hide-tooltip {display: none!important;}.screenity-shadow-dom .tooltip-tall {margin-bottom: 20px;}.screenity-shadow-dom .tooltip-small {margin-bottom: 5px;}.screenity-shadow-dom .TooltipContent[data-state='delayed-open'][data-side='top'] {animation-name: slideDownAndFade;}.screenity-shadow-dom .TooltipContent[data-state='delayed-open'][data-side='right'] {  animation-name: slideLeftAndFade;}.screenity-shadow-dom.TooltipContent[data-state='delayed-open'][data-side='bottom'] {  animation-name: slideUpAndFade;}.screenity-shadow-dom.TooltipContent[data-state='delayed-open'][data-side='left'] {  animation-name: slideRightAndFade;}@keyframes slideUpAndFade {  from {    opacity: 0;    transform: translateY(2px);  }  to {    opacity: 1;    transform: translateY(0);  }}@keyframes slideRightAndFade {  from {    opacity: 0;    transform: translateX(-2px);  }  to {    opacity: 1;    transform: translateX(0);  }}@keyframes slideDownAndFade {  from {    opacity: 0;    transform: translateY(-2px);  }  to {    opacity: 1;    transform: translateY(0);  }}@keyframes slideLeftAndFade {  from {    opacity: 0;    transform: translateX(2px);  }  to {    opacity: 1;    transform: translateX(0);  }}#screenity-ui [data-radix-popper-content-wrapper] { z-index: 999999999999!important; } .screenity-shadow-dom .CanvasContainer {position: fixed;pointer-events: all!important;top: 0px!important;left: 0px!important;z-index: 99999999999!important;}.screenity-shadow-dom .canvas {position: fixed;top: 0px!important;left: 0px!important;z-index: 99999999999!important;background: transparent!important;}.screenity-shadow-dom .canvas-container {top: 0px!important;left: 0px!important;z-index: 99999999999;position: fixed!important;background: transparent!important;}.ScreenityDropdownMenuContent {z-index: 99999999999!important;  min-width: 200px;  background-color: white;  margin-top: 4px;  margin-right: 8px;  padding-top: 12px;  padding-bottom: 12px;  border-radius: 15px;  z-index: 99999;  font-family: 'Satoshi-Medium', sans-serif;  color: #29292F;  box-shadow: 0px 10px 38px -10px rgba(22, 23, 24, 0.35),    0px 10px 20px -15px rgba(22, 23, 24, 0.2);  animation-duration: 400ms;  animation-timing-function: cubic-bezier(0.16, 1, 0.3, 1);  will-change: transform, opacity;}.ScreenityDropdownMenuContent[data-side="top"] {  animation-name: slideDownAndFade;}.ScreenityDropdownMenuContent[data-side="right"] {  animation-name: slideLeftAndFade;}.ScreenityDropdownMenuContent[data-side="bottom"] {  animation-name: slideUpAndFade;}.ScreenityDropdownMenuContent[data-side="left"] {  animation-name: slideRightAndFade;}.ScreenityItemIndicator {  position: absolute;  right: 12px;   width: 18px;  height: 18px;  background: #3080F8;  border-radius: 50%;  display: inline-flex;  align-items: center;  justify-content: center;}.ScreenityDropdownMenuItem,.ScreenityDropdownMenuRadioItem {  font-size: 14px;  line-height: 1;  display: flex;  align-items: center;  height: 40px;  padding: 0 5px;  position: relative;  padding-left: 22px;  padding-right: 22px;  user-select: none;  outline: none;}.ScreenityDropdownMenuItem:hover {    background-color: #F6F7FB !important;    cursor: pointer;}.ScreenityDropdownMenuItem[data-disabled] {  color: #6E7684; !important;  cursor: not-allowed;  background-color: #F6F7FB !important;}@keyframes slideUpAndFade {  from {    opacity: 0;    transform: translateY(2px);  }  to {    opacity: 1;    transform: translateY(0);  }}@keyframes slideRightAndFade {  from {    opacity: 0;    transform: translateX(-2px);  }  to {    opacity: 1;    transform: translateX(0);  }}@keyframes slideDownAndFade {  from {    opacity: 0;    transform: translateY(-2px);  }  to {    opacity: 1;    transform: translateY(0);  }}@keyframes slideLeftAndFade {  from {    opacity: 0;    transform: translateX(2px);  }  to {    opacity: 1;    transform: translateX(0);  }}</style></div></div><textarea tabindex="-1" aria-hidden="true" style="min-height: 0px !important; max-height: none !important; height: 0px !important; visibility: hidden !important; overflow: hidden !important; position: absolute !important; z-index: -1000 !important; top: 0px !important; right: 0px !important; display: block !important; border-width: 0px; box-sizing: border-box; font-family: Inter, &quot;Inter Fallback&quot;, -apple-system, &quot;system-ui&quot;, &quot;Segoe UI&quot;, system-ui, sans-serif, -apple-system, &quot;system-ui&quot;, &quot;Segoe UI&quot;, system-ui, sans-serif; font-size: 14px; font-style: normal; font-weight: 400; letter-spacing: normal; line-height: 20px; padding: 10px 40px 10px 14px; tab-size: 4; text-indent: 0px; text-rendering: auto; text-transform: none; width: 382px; word-break: normal; word-spacing: 0px; scrollbar-gutter: auto;"></textarea><script id="gtm" data-nscript="afterInteractive">          (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-MBBX68ST');</script><script id="0" data-nscript="afterInteractive">/** * Language Toggle Script * * Enables smart navigation when switching between Python and TypeScript docs. * When a user clicks the language dropdown, this redirects them to the equivalent * page in the target language (preserving the section hash) instead of the default * overview page. * * How it works: * 1. Click listener detects language toggle clicks and stores current URL+hash * 2. History API interception (pushState/replaceState) and popstate/hashchange *    listeners detect when Mintlify's client-side routing changes the path * 3. On path change, check if we're switching languages and redirect to equivalent page */(function () {  "use strict";  const PYTHON_PREFIX = "/oss/python/";  const JS_PREFIX = "/oss/javascript/";  // Selector for language dropdown items (Python/TypeScript links)  const LANGUAGE_TOGGLE_SELECTOR = "[data-dropdown-item]";  let previousUrl = null;  /**   * Convert a path from one language to another   * e.g., /oss/javascript/foo â†’ /oss/python/foo   */  function getEquivalentPath(sourcePath, targetLang) {    const sourcePrefix = targetLang === "python" ? JS_PREFIX : PYTHON_PREFIX;    const targetPrefix = targetLang === "python" ? PYTHON_PREFIX : JS_PREFIX;    if (sourcePath.startsWith(sourcePrefix)) {      return targetPrefix + sourcePath.substring(sourcePrefix.length);    }    return null;  }  /**   * Detect which language a path belongs to   * Returns "python", "javascript", or null   */  function getPathLanguage(path) {    if (path.startsWith(PYTHON_PREFIX)) return "python";    if (path.startsWith(JS_PREFIX)) return "javascript";    return null;  }  /**   * Store current URL (path + hash) in memory   * Only stores language-specific pages   */  function updateCurrent() {    const lang = getPathLanguage(location.pathname);    if (lang) {      previousUrl = location.pathname + location.hash;    }  }  /**   * Check if we should redirect to an equivalent page in a different language   * This runs after every path change detected by the MutationObserver   */  function checkRedirect() {    const currentLang = getPathLanguage(location.pathname);    if (!currentLang) return;    if (!previousUrl) {      updateCurrent();      return;    }    // Split path and hash (e.g., "/oss/python/foo#bar" â†’ ["/oss/python/foo", "bar"])    const [prevPath, prevHash = ""] = previousUrl.split("#");    const prevLang = getPathLanguage(prevPath);    // Only redirect if we're switching between languages    if (prevLang && prevLang !== currentLang) {      const equivalentPath = getEquivalentPath(prevPath, currentLang);      if (equivalentPath && equivalentPath !== location.pathname) {        // Clear previous URL before redirect to prevent redirect loops        previousUrl = null;        // Redirect with the hash from the previous page        location.replace(equivalentPath + (prevHash ? "#" + prevHash : ""));        return;      }    }    // If no redirect needed, store current location for next navigation    updateCurrent();  }  // Store current URL when language toggle is clicked  // This captures the hash before Mintlify's client-side routing changes the page  document.addEventListener(    "click",    function (e) {      const toggle = e.target.closest(LANGUAGE_TOGGLE_SELECTOR);      if (toggle) {        updateCurrent();      }    },    true,  );  // Watch for URL changes via History API (used by Mintlify's client-side routing)  // This is more efficient than MutationObserver - only fires on actual URL changes  let lastPath = location.pathname;  function onPathChange() {    if (location.pathname !== lastPath) {      lastPath = location.pathname;      checkRedirect();    }  }  // Handle back/forward navigation  window.addEventListener("popstate", onPathChange);  // Handle hash changes (when user clicks anchor links)  window.addEventListener("hashchange", onPathChange);  // Intercept pushState/replaceState calls  const originalPushState = history.pushState;  const originalReplaceState = history.replaceState;  history.pushState = function (...args) {    originalPushState.apply(this, args);    onPathChange();  };  history.replaceState = function (...args) {    originalReplaceState.apply(this, args);    onPathChange();  };  // Run initial check in case user landed here via language toggle  checkRedirect();})();</script><next-route-announcer style="position: absolute;"><template shadowrootmode="open"><div aria-live="assertive" id="__next-route-announcer__" role="alert" style="position: absolute; border: 0px; height: 1px; margin: -1px; padding: 0px; width: 1px; clip: rect(0px, 0px, 0px, 0px); overflow: hidden; white-space: nowrap; overflow-wrap: normal;">Agents - Docs by LangChain</div></template></next-route-announcer><script id="hs-script-loader" text="" charset="" type="text/javascript" src="./Agents01_files/242623570.js"></script>    <script type="text/javascript" id="" charset="">!function(){var a;var b="334496741e114fd";var c=function(){Reo.init({clientID:"334496741e114fd"})};(a=document.createElement("script")).src="https://static.reo.dev/"+b+"/reo.js";a.defer=!0;a.onload=c;document.head.appendChild(a)}();</script>    <iframe height="0" width="0" style="display: none; visibility: hidden;" src="./Agents01_files/saved_resource.html"></iframe><script type="text/javascript" id="" charset="">!function(){var d="analytics",a=window[d]=window[d]||[];if(!a.initialize)if(a.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{a.invoked=!0;a.methods="trackSubmit trackClick trackLink trackForm pageview identify reset group track ready alias debug page screen once off on addSourceMiddleware addIntegrationMiddleware setAnonymousId addDestinationMiddleware register".split(" ");a.factory=function(b){return function(){if(window[d].initialized)return window[d][b].apply(window[d],arguments);var e=Array.prototype.slice.call(arguments);if("track screen alias group page identify".split(" ").indexOf(b)>-1){var c=document.querySelector("link[rel\x3d'canonical']");e.push({__t:"bpc",c:c&&c.getAttribute("href")||void 0,p:location.pathname,u:location.href,s:location.search,t:document.title,r:document.referrer})}e.unshift(b);a.push(e);return a}};for(var f=0;f<a.methods.length;f++){var g=a.methods[f];a[g]=a.factory(g)}a.load=function(b,e){var c=document.createElement("script");c.type="text/javascript";c.async=!0;c.setAttribute("data-global-segment-analytics-key",d);c.src="https://cdn.segment.com/analytics.js/v1/"+b+"/analytics.min.js";b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(c,b);a._loadOptions=e};a._writeKey="fN405MKyizQ5ye7K0GkpDW2nYXQcjaeA";a.SNIPPET_VERSION="5.2.0";a.load("fN405MKyizQ5ye7K0GkpDW2nYXQcjaeA",{storage:{priority:["cookie","localStorage","memory"],cookie:{domain:".langchain.com",maxage:31536E3}}});a.page()}}();</script><div id="tmeppozh"><div style="height: 100vh;width: 100vw;position: fixed;left:-10000px;visibility: hidden;"><iframe src="./Agents01_files/saved_resource(1).html"></iframe></div></div><div data-rmiz-portal=""></div><script type="text/javascript" id="" charset="">analytics.page();</script><script type="text/javascript" id="" charset="">analytics.page();</script></body><div style="all: initial;"><div id="__hcfy__" style="all: initial;"><template shadowrootmode="open"><style>#root{-webkit-text-size-adjust:100%;box-sizing:border-box;font-size:14px;font-weight:400;letter-spacing:0;line-height:1.28581;text-transform:none;color:#182026;font-family:-apple-system,"BlinkMacSystemFont","Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Open Sans","Helvetica Neue","Icons16",sans-serif;touch-action:manipulation}#root>.bp5-portal{z-index:9999999999}</style><link rel="stylesheet" href="chrome-extension://ikhdkkncnoglghljlkmcimlnlhkeamad/normalize.css"><link rel="stylesheet" href="chrome-extension://ikhdkkncnoglghljlkmcimlnlhkeamad/blueprint.css"><link rel="stylesheet" href="chrome-extension://ikhdkkncnoglghljlkmcimlnlhkeamad/blueprint-select.css"><link rel="stylesheet" href="chrome-extension://ikhdkkncnoglghljlkmcimlnlhkeamad/cropper.css"><style>#translate-panel{background-color:#f6f7f9;display:flex;flex-direction:column;padding-bottom:8px}.bp5-dark #translate-panel{background-color:#1c2127}#translate-panel .fixed{flex-shrink:0;margin-bottom:10px}#translate-panel .body{flex-grow:1;overflow:auto;overscroll-behavior:contain}#translate-panel .body::-webkit-scrollbar{width:8px;background-color:rgba(0,0,0,0);-webkit-border-radius:100px}#translate-panel .body::-webkit-scrollbar:hover{background-color:rgba(0,0,0,.09)}#translate-panel .body::-webkit-scrollbar-thumb:vertical{background:rgba(0,0,0,.5);-webkit-border-radius:100px}#translate-panel .body::-webkit-scrollbar-thumb:vertical:active{background:rgba(0,0,0,.61);-webkit-border-radius:100px}#translate-panel.size-small,#translate-panel.size-small h6.bp5-heading,#translate-panel.size-small .bp5-control.bp5-large,#translate-panel.size-small textarea.bp5-input.bp5-small{font-size:14px}#translate-panel.size-small .phonetic-item,#translate-panel.size-small .quick-settings a{font-size:12px}#translate-panel.size-middle,#translate-panel.size-middle h6.bp5-heading,#translate-panel.size-middle .bp5-control.bp5-large,#translate-panel.size-middle textarea.bp5-input{font-size:18px}#translate-panel.size-middle .phonetic-item,#translate-panel.size-middle .quick-settings a{font-size:14px}#translate-panel.size-large,#translate-panel.size-large h6.bp5-heading,#translate-panel.size-large .bp5-control.bp5-large,#translate-panel.size-large textarea.bp5-input.bp5-large{font-size:22px}#translate-panel.size-large .source,#translate-panel.size-large .phonetic-item,#translate-panel.size-large .quick-settings a{font-size:18px}#translate-panel .bp5-button.bp5-small,#translate-panel .bp5-small .bp5-button{min-height:20px;min-width:20px}#translate-panel .header{display:flex;align-items:center;padding:4px 6px 4px 10px;border-bottom:1px solid #d1d1d1}.bp5-dark #translate-panel .header{border-bottom-color:rgba(17,20,24,.4)}#translate-panel .header .drag-block{min-width:5px;flex-shrink:0;flex-grow:1;align-self:stretch}#translate-panel .header .left{flex-shrink:0;display:flex}#translate-panel .header .right{flex-shrink:0;display:flex;align-items:center}#translate-panel .header .right .bp5-icon-arrow-right{flex-shrink:0;margin:0 5px}#translate-panel .header .right>.bp5-button{flex-shrink:0;margin:0 1px}#translate-panel .header .right>.bp5-button:last-child{margin-right:0}#translate-panel .quick-settings{padding:4px 9px;margin:0 1px}#translate-panel .quick-settings>div{margin-bottom:5px}#translate-panel .quick-settings .bp5-control{margin-bottom:0}#translate-panel .query-text{position:relative;padding:10px 10px 2px 10px}#translate-panel .query-text textarea.bp5-input{min-height:44px;font-family:system-ui,-apple-system,"Segoe UI","Roboto","Ubuntu","Cantarell","Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";overscroll-behavior:contain}#translate-panel .query-text .translate-btn{position:absolute;opacity:.6}#translate-panel .query-text .translate-btn:hover{opacity:1}#translate-panel .body{padding:0 10px}#translate-panel .body .bp5-card:first-child{margin-top:1px}#translate-panel .body .bp5-card:last-child{margin-bottom:1px}#translate-panel .body .no-api{margin:20px 0}.result-block{margin:8px 0;padding:2px 5px}.result-block .bp5-button{visibility:hidden}.result-block .error .bp5-button,.result-block:hover .bp5-button{visibility:visible}.result-block .legend{display:flex;align-items:center;justify-content:space-between}.result-block .legend .legend-left{display:flex;align-items:center}.result-block .legend .api-ico,.result-block .legend .bp5-heading{flex-shrink:0;white-space:nowrap}.result-block .legend .api-ico{display:inline-block;width:14px;height:14px;background-size:contain;margin-right:3px}.result-block .legend .bp5-heading{margin-bottom:0;margin-right:10px}.result-block .legend .source{cursor:pointer;font-size:12px;display:inline-flex;align-items:center}.result-block .legend .source .source-text{overflow:hidden}.result-block .legend .source .bp5-icon{position:relative;top:-1px;margin-left:1px}.result-block .phonetic{display:flex;flex-wrap:wrap}.result-block .phonetic .phonetic-item{display:flex;align-items:center;font-size:12px}.result-block .phonetic .phonetic-item:not(:last-child){margin-right:12px}.result-block .common-result p{line-height:1.3;margin:2px 0;overflow-wrap:break-word}.result-block .common-result .dict a{text-decoration:underline}.result-block .error{font-size:12px;padding:5px 10px}.result-block .dict-pos{margin-right:5px}.external-translators{margin-bottom:3px;padding:0;display:flex;flex-wrap:wrap}.external-translators>div{margin:0 5px 5px 0}.quick-links a{margin:0 5px 5px 0}#popper-container{width:250px;max-width:100%;position:absolute;left:0;top:0;z-index:9999999998;touch-action:none;transition:opacity .2s;background-color:#f6f7f9}.bp5-dark #popper-container{background-color:#1c2127}#popper-container.show{opacity:1;pointer-events:auto;user-select:auto}#popper-container,#popper-container[data-popper-reference-hidden=true]{opacity:0;pointer-events:none;user-select:none}#popper-container .drag-block{cursor:grab}#popper-container.pin{position:fixed}#popper-container.pin .arrow{display:none}#popper-container .arrow,#popper-container .arrow::before{position:absolute;width:8px;height:8px;z-index:-1}#popper-container .arrow::before{content:"";transform:rotate(45deg);background:#f6f7f9}.bp5-dark #popper-container .arrow::before{background-color:#1c2127}#popper-container .arrow{display:none}#popper-container.show[data-popper-placement]:not([data-popper-reference-hidden=true]) .arrow{display:block}#popper-container[data-popper-placement^=top] .arrow{bottom:-5px}#popper-container[data-popper-placement^=top] .arrow::before{border-right:1px solid #d1d1d1;border-bottom:1px solid #d1d1d1}#popper-container[data-popper-placement^=bottom] .arrow{top:-5px}#popper-container[data-popper-placement^=bottom] .arrow::before{border-left:1px solid #d1d1d1;border-top:1px solid #d1d1d1}#popper-container[data-popper-placement^=left] .arrow{right:-5px}#popper-container[data-popper-placement^=left] .arrow::before{border-right:1px solid #d1d1d1;border-top:1px solid #d1d1d1}#popper-container[data-popper-placement^=right] .arrow{left:-5px}#popper-container[data-popper-placement^=right] .arrow::before{border-left:1px solid #d1d1d1;border-bottom:1px solid #d1d1d1}#translate-btn{display:none;position:absolute;z-index:9999999999;left:0;top:0}#translate-btn .bp5-button{padding:2px;min-width:0;min-height:0}#translate-btn .btn-icon{width:18px;height:18px;background-image:url(chrome-extension://ikhdkkncnoglghljlkmcimlnlhkeamad/logo.png);background-size:contain}.bp5-dark #translate-btn .btn-icon{background-image:url(chrome-extension://ikhdkkncnoglghljlkmcimlnlhkeamad/logowhite36.png)}#translate-btn.show{display:block}.translate-type-selector .bp5-label{display:inline}.translate-type-selector .bp5-radio{margin-bottom:0}#ocr-container{position:fixed;z-index:99999999999999;left:0;top:0;right:0;bottom:0}#ocr-container .toolbar{display:none;position:absolute;z-index:1}#ocr-container img{max-width:100%}#app{cursor:default}.switch-pin{flex-shrink:0;cursor:pointer}.switch-pin .bp5-icon-pin{transition:transform .2s,color .2s;transform:rotate(-45deg)}.pin .switch-pin .bp5-icon-pin{transform:rotate(-70deg)}.cut-btn{margin-left:2px}.app-toaster-container{position:fixed !important;z-index:9999999999 !important}.app-toaster-container .bp5-toast{min-width:auto}#web-trs-panel .app-toaster-container{padding-right:0;padding-left:0}#web-trs-panel .page-trs-form-group{margin:0 0 0 0;align-items:center}#web-trs-panel .page-trs-form-group>label{width:70px}</style><div id="root" dir="ltr" class="bp5-focus-disabled"><div id="app"><div id="translate-btn" style=""><button type="button" class="bp5-button"><span class="btn-icon"></span></button></div><div id="popper-container" class="bp5-elevation-4" style="width: 290px; transform: translate3d(582px, 452px, 0px); position: absolute; top: 0px; left: 0px;"><div id="translate-panel" class="size-small" style="max-height: 469.5px;"><div class="fixed"><div class="header"><div class="left"><div class="switch-pin"><button type="button" class="bp5-button bp5-minimal bp5-small"><span aria-hidden="true" class="bp5-icon bp5-icon-pin"><svg data-icon="pin" height="14" role="img" viewBox="0 0 16 16" width="14"><path d="M9.41.92c-.51.51-.41 1.5.15 2.56L4.34 7.54C2.8 6.48 1.45 6.05.92 6.58l3.54 3.54-3.54 4.95 4.95-3.54 3.54 3.54c.53-.53.1-1.88-.96-3.42l4.06-5.22c1.06.56 2.04.66 2.55.15L9.41.92z" fill-rule="evenodd"></path></svg></span></button></div><button type="button" title="å›¾ç‰‡ç¿»è¯‘" class="bp5-button bp5-minimal bp5-small"><span aria-hidden="true" class="bp5-icon bp5-icon-media"><svg data-icon="media" height="14" role="img" viewBox="0 0 16 16" width="14"><path d="M11.99 6.99c.55 0 1-.45 1-1s-.45-1-1-1-1 .45-1 1 .45 1 1 1zm3-5h-14c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h14c.55 0 1-.45 1-1v-10c0-.55-.45-1-1-1zm-1 9l-5-3-1 2-3-4-3 5v-7h12v7z" fill-rule="evenodd"></path></svg></span></button><button type="button" title="è¯­éŸ³ç¿»è¯‘" class="bp5-button bp5-minimal bp5-small"><span class="bp5-icon"><svg version="1.1" id="Capa_1" width="14" height="14" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 490.9 490.9" xml:space="preserve"><g><g><path d="M245.5,322.9c53,0,96.2-43.2,96.2-96.2V96.2c0-53-43.2-96.2-96.2-96.2s-96.2,43.2-96.2,96.2v130.5 C149.3,279.8,192.5,322.9,245.5,322.9z M173.8,96.2c0-39.5,32.2-71.7,71.7-71.7s71.7,32.2,71.7,71.7v130.5 c0,39.5-32.2,71.7-71.7,71.7s-71.7-32.2-71.7-71.7V96.2z"></path><path d="M94.4,214.5c-6.8,0-12.3,5.5-12.3,12.3c0,85.9,66.7,156.6,151.1,162.8v76.7h-63.9c-6.8,0-12.3,5.5-12.3,12.3 s5.5,12.3,12.3,12.3h152.3c6.8,0,12.3-5.5,12.3-12.3s-5.5-12.3-12.3-12.3h-63.9v-76.7c84.4-6.3,151.1-76.9,151.1-162.8 c0-6.8-5.5-12.3-12.3-12.3s-12.3,5.5-12.3,12.3c0,76.6-62.3,138.9-138.9,138.9s-138.9-62.3-138.9-138.9 C106.6,220,101.2,214.5,94.4,214.5z"></path></g></g></svg></span></button></div><div class="drag-block" title="æŒ‰ä½ä¸æ”¾å¯ä»¥æ‹–åŠ¨"></div><div class="right"><button type="button" title="æ·»åŠ åˆ°æ”¶è—å¤¹" class="bp5-button bp5-minimal bp5-small"><span aria-hidden="true" class="bp5-icon bp5-icon-star-empty"><svg data-icon="star-empty" height="14" role="img" viewBox="0 0 16 16" width="14"><path d="M16 6.11l-5.53-.84L8 0 5.53 5.27 0 6.11l4 4.1L3.06 16 8 13.27 12.94 16 12 10.21l4-4.1zM4.91 13.2l.59-3.62L3 7.02l3.45-.53L8 3.2l1.55 3.29 3.45.53-2.5 2.56.59 3.62L8 11.49 4.91 13.2z" fill-rule="evenodd"></path></svg></span></button><span class="bp5-popover-target"><button type="button" class="bp5-button bp5-minimal bp5-small settings" title="å¿«æ·è®¾ç½®" aria-expanded="false" aria-haspopup="menu"><span aria-hidden="true" class="bp5-icon bp5-icon-cog"><svg data-icon="cog" height="14" role="img" viewBox="0 0 16 16" width="14"><path d="M15.19 6.39h-1.85c-.11-.37-.27-.71-.45-1.04l1.36-1.36c.31-.31.31-.82 0-1.13l-1.13-1.13a.803.803 0 00-1.13 0l-1.36 1.36c-.33-.17-.67-.33-1.04-.44V.79c0-.44-.36-.8-.8-.8h-1.6c-.44 0-.8.36-.8.8v1.86c-.39.12-.75.28-1.1.47l-1.3-1.3c-.3-.3-.79-.3-1.09 0L1.82 2.91c-.3.3-.3.79 0 1.09l1.3 1.3c-.2.34-.36.7-.48 1.09H.79c-.44 0-.8.36-.8.8v1.6c0 .44.36.8.8.8h1.85c.11.37.27.71.45 1.04l-1.36 1.36c-.31.31-.31.82 0 1.13l1.13 1.13c.31.31.82.31 1.13 0l1.36-1.36c.33.18.67.33 1.04.44v1.86c0 .44.36.8.8.8h1.6c.44 0 .8-.36.8-.8v-1.86c.39-.12.75-.28 1.1-.47l1.3 1.3c.3.3.79.3 1.09 0l1.09-1.09c.3-.3.3-.79 0-1.09l-1.3-1.3c.19-.35.36-.71.48-1.1h1.85c.44 0 .8-.36.8-.8v-1.6a.816.816 0 00-.81-.79zm-7.2 4.6c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" title="å…³é—­(Esc)" class="bp5-button bp5-minimal bp5-small"><span aria-hidden="true" class="bp5-icon bp5-icon-cross"><svg data-icon="cross" height="18" role="img" viewBox="0 0 16 16" width="18"><path d="M9.41 8l3.29-3.29c.19-.18.3-.43.3-.71a1.003 1.003 0 00-1.71-.71L8 6.59l-3.29-3.3a1.003 1.003 0 00-1.42 1.42L6.59 8 3.3 11.29c-.19.18-.3.43-.3.71a1.003 1.003 0 001.71.71L8 9.41l3.29 3.29c.18.19.43.3.71.3a1.003 1.003 0 00.71-1.71L9.41 8z" fill-rule="evenodd"></path></svg></span></button></div></div><div class="bp5-collapse"><div class="bp5-collapse-body" aria-hidden="true"><div class="quick-settings bp5-card bp5-elevation-0"><div><span aria-controls="listbox-0" class="lang-select bp5-popover-target" aria-expanded="false" aria-haspopup="listbox" role="combobox"><button type="button" class="bp5-button bp5-small"><span class="bp5-button-text">è‡ªåŠ¨æ£€æµ‹</span><span aria-hidden="true" class="bp5-icon bp5-icon-caret-down"><svg data-icon="caret-down" height="16" role="img" viewBox="0 0 16 16" width="16"><path d="M12 6.5c0-.28-.22-.5-.5-.5h-7a.495.495 0 00-.37.83l3.5 4c.09.1.22.17.37.17s.28-.07.37-.17l3.5-4c.08-.09.13-.2.13-.33z" fill-rule="evenodd"></path></svg></span></button></span><span aria-hidden="true" class="bp5-icon bp5-icon-arrow-right" style="margin: 0px 10px;"><svg data-icon="arrow-right" height="12" role="img" viewBox="0 0 16 16" width="12"><path d="M14.7 7.29l-5-5a.965.965 0 00-.71-.3 1.003 1.003 0 00-.71 1.71l3.29 3.29H1.99c-.55 0-1 .45-1 1s.45 1 1 1h9.59l-3.29 3.29a1.003 1.003 0 001.42 1.42l5-5c.18-.18.29-.43.29-.71s-.12-.52-.3-.7z" fill-rule="evenodd"></path></svg></span><span aria-controls="listbox-1" class="lang-select bp5-popover-target" aria-expanded="false" aria-haspopup="listbox" role="combobox"><button type="button" class="bp5-button bp5-small"><span class="bp5-button-text">ä¸­æ–‡(ç®€ä½“)</span><span aria-hidden="true" class="bp5-icon bp5-icon-caret-down"><svg data-icon="caret-down" height="16" role="img" viewBox="0 0 16 16" width="16"><path d="M12 6.5c0-.28-.22-.5-.5-.5h-7a.495.495 0 00-.37.83l3.5 4c.09.1.22.17.37.17s.28-.07.37-.17l3.5-4c.08-.09.13-.2.13-.33z" fill-rule="evenodd"></path></svg></span></button></span></div><div><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox" checked=""><span class="bp5-control-indicator"></span>è°·æ­Œ</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox" checked=""><span class="bp5-control-indicator"></span>DeepL(å†…ç½®)</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>DeepL</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>ChatGPT</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>Claude</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>Gemini</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>Grok</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>Ol</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>ç¡…åŸº</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>æ··å…ƒ</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>æ–‡å¿ƒ</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>æ–‡å¿ƒï¼ˆæ—§ï¼‰</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>æ™ºè°±</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>è±†åŒ…</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>é€šä¹‰</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>DeepSeek</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>é›¶ä¸€</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>MiniMax</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>ç™¾å·</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>Kimi</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>ç™¾åº¦</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>ç™¾åº¦(ä¸“ä¸šç‰ˆ)</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>è…¾è®¯</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>å½©äº‘</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>é˜¿é‡Œ</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>é˜¿é‡Œ(ä¸“ä¸šç‰ˆ)</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>æœ‰é“</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>ç«å±±</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox" checked=""><span class="bp5-control-indicator"></span>å¿…åº”è¯å…¸</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>æœç‹—</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox" checked=""><span class="bp5-control-indicator"></span>Yandex</label><div style="margin-top: 4px;"><a class="bp5-text-small">è´­ä¹°å¥—é¤åŒ…åŽå¯ç›´æŽ¥ä½¿ç”¨ä»¥ä¸Šæ‰€æœ‰æœåŠ¡</a></div></div><div><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>è‡ªåŠ¨æœ—è¯»</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>è‡ªåŠ¨å¤åˆ¶</label></div><div role="radiogroup" class="bp5-radio-group"><label class="bp5-control bp5-radio bp5-inline"><input name="Blueprint5.RadioGroup-0" type="radio" value="small" checked=""><span class="bp5-control-indicator"></span>å°</label><label class="bp5-control bp5-radio bp5-inline"><input name="Blueprint5.RadioGroup-0" type="radio" value="middle"><span class="bp5-control-indicator"></span>ä¸­</label><label class="bp5-control bp5-radio bp5-inline"><input name="Blueprint5.RadioGroup-0" type="radio" value="large"><span class="bp5-control-indicator"></span>å¤§</label></div><div><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>æ˜¾ç¤ºæ–‡æœ¬æ¡†</label><label class="bp5-control bp5-checkbox bp5-inline" style="margin-right: 0px;"><input type="checkbox"><span class="bp5-control-indicator"></span>é¼ æ ‡æ‚¬æµ®å–è¯</label></div><a class="bp5-text-small">æ‰“å¼€å®Œæ•´è®¾ç½®</a></div></div></div></div><div class="body"><div class="result-block bp5-card bp5-elevation-0"><div class="legend"><div class="legend-left"><span class="api-ico" style="background-image: url(&quot;chrome-extension://ikhdkkncnoglghljlkmcimlnlhkeamad/google.ico&quot;);"></span><h6 class="bp5-heading">è°·æ­Œç¿»è¯‘</h6><span aria-controls="listbox-13" class="lang-select bp5-popover-target" aria-expanded="false" aria-haspopup="listbox" role="combobox"><span class="source"><span class="source-text">è‹±è¯­</span><span aria-hidden="true" class="bp5-icon bp5-icon-caret-down"><svg data-icon="caret-down" height="12" role="img" viewBox="0 0 16 16" width="12"><path d="M12 6.5c0-.28-.22-.5-.5-.5h-7a.495.495 0 00-.37.83l3.5 4c.09.1.22.17.37.17s.28-.07.37-.17l3.5-4c.08-.09.13-.2.13-.33z" fill-rule="evenodd"></path></svg></span></span></span><button type="button" title="æœ—è¯»" class="bp5-button bp5-minimal bp5-small"><span aria-hidden="true" class="bp5-icon bp5-icon-volume-up"><svg data-icon="volume-up" height="12" role="img" viewBox="0 0 16 16" width="12"><path d="M7 1.86c-.28 0-.53.11-.71.29l-2.7 2.71H1c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1h2.59l2.71 2.71a1.003 1.003 0 001.71-.71v-10c-.01-.55-.46-1-1.01-1zm6.74-.99l-1.58 1.22A9.985 9.985 0 0114 7.86c0 2.16-.69 4.15-1.85 5.78l1.58 1.22c1.42-1.97 2.26-4.38 2.26-7 .01-2.61-.84-5.02-2.25-6.99zM8.98 4.52C9.62 5.48 10 6.63 10 7.86s-.38 2.39-1.02 3.34l1.59 1.22c.9-1.29 1.43-2.86 1.43-4.56 0-1.7-.53-3.27-1.43-4.56L8.98 4.52z" fill-rule="evenodd"></path></svg></span></button></div><div style="flex-shrink: 0;"><button type="button" title="æ”¶èµ·" class="bp5-button bp5-minimal bp5-small"><span aria-hidden="true" class="bp5-icon bp5-icon-chevron-up"><svg data-icon="chevron-up" height="14" role="img" viewBox="0 0 16 16" width="14"><path d="M12.71 9.29l-4-4C8.53 5.11 8.28 5 8 5s-.53.11-.71.29l-4 4a1.003 1.003 0 001.42 1.42L8 7.41l3.29 3.29c.18.19.43.3.71.3a1.003 1.003 0 00.71-1.71z" fill-rule="evenodd"></path></svg></span></button><button type="button" title="å¤åˆ¶ç¿»è¯‘ç»“æžœ" class="bp5-button bp5-minimal bp5-small"><span aria-hidden="true" class="bp5-icon bp5-icon-duplicate"><svg data-icon="duplicate" height="12" role="img" viewBox="0 0 16 16" width="12"><path d="M15 0H5c-.55 0-1 .45-1 1v2h2V2h8v7h-1v2h2c.55 0 1-.45 1-1V1c0-.55-.45-1-1-1zm-4 4H1c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h10c.55 0 1-.45 1-1V5c0-.55-.45-1-1-1zm-1 10H2V6h8v8z" fill-rule="evenodd"></path></svg></span></button><a role="button" target="_blank" title="æŸ¥çœ‹è¯¦ç»†ç»“æžœ" class="bp5-button bp5-minimal bp5-small" aria-disabled="false" href="https://translate.google.com/?sl=en&amp;tl=zh-CN&amp;text=Agents%20combine%20language%20models%20with%20tools%20to%20create%20systems%20that%20can%20reason%20about%20tasks%2C%20decide%20which%20tools%20to%20use%2C%20and%20iteratively%20work%20towards%20solutions.%0Acreate_agent%20provides%20a%20production-ready%20agent%20implementation.%0AAn%20LLM%20Agent%20runs%20tools%20in%20a%20loop%20to%20achieve%20a%20goal.%20An%20agent%20runs%20until%20a%20stop%20condition%20is%20met%20-%20i.e.%2C%20when%20the%20model%20emits%20a%20final%20output%20or%20an%20iteration%20limit%20is%20reached.&amp;op=translate"><span aria-hidden="true" class="bp5-icon bp5-icon-share"><svg data-icon="share" height="12" role="img" viewBox="0 0 16 16" width="12"><path d="M10.99 13.99h-9v-9h4.76l2-2H.99c-.55 0-1 .45-1 1v11c0 .55.45 1 1 1h11c.55 0 1-.45 1-1V7.24l-2 2v4.75zm4-14h-5c-.55 0-1 .45-1 1s.45 1 1 1h2.59L7.29 7.28a1 1 0 00-.3.71 1.003 1.003 0 001.71.71l5.29-5.29V6c0 .55.45 1 1 1s1-.45 1-1V1c0-.56-.45-1.01-1-1.01z" fill-rule="evenodd"></path></svg></span></a></div></div><div class="bp5-collapse" style="height: auto; overflow-y: visible; transition: none;"><div class="bp5-collapse-body" aria-hidden="false" style="transform: translateY(0px); transition: none;"><div style="display: none;"><p class="">1</p><p class="" style="width: 150px;">1</p></div><div class="common-result"><div class="general-result"><p>æ™ºèƒ½ä½“å°†è¯­è¨€æ¨¡åž‹ä¸Žå·¥å…·ç›¸ç»“åˆï¼Œåˆ›å»ºå¯ä»¥æŽ¨ç†ä»»åŠ¡ã€å†³å®šä½¿ç”¨å“ªäº›å·¥å…·å¹¶è¿­ä»£è§£å†³æ–¹æ¡ˆçš„ç³»ç»Ÿã€‚<button type="button" title="æœ—è¯»" class="bp5-button bp5-minimal bp5-small"><span aria-hidden="true" class="bp5-icon bp5-icon-volume-up"><svg data-icon="volume-up" height="12" role="img" viewBox="0 0 16 16" width="12"><path d="M7 1.86c-.28 0-.53.11-.71.29l-2.7 2.71H1c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1h2.59l2.71 2.71a1.003 1.003 0 001.71-.71v-10c-.01-.55-.46-1-1.01-1zm6.74-.99l-1.58 1.22A9.985 9.985 0 0114 7.86c0 2.16-.69 4.15-1.85 5.78l1.58 1.22c1.42-1.97 2.26-4.38 2.26-7 .01-2.61-.84-5.02-2.25-6.99zM8.98 4.52C9.62 5.48 10 6.63 10 7.86s-.38 2.39-1.02 3.34l1.59 1.22c.9-1.29 1.43-2.86 1.43-4.56 0-1.7-.53-3.27-1.43-4.56L8.98 4.52z" fill-rule="evenodd"></path></svg></span></button></p><p>create_agent æä¾›ç”Ÿäº§å°±ç»ªçš„ä»£ç†å®žçŽ°ã€‚<button type="button" title="æœ—è¯»" class="bp5-button bp5-minimal bp5-small"><span aria-hidden="true" class="bp5-icon bp5-icon-volume-up"><svg data-icon="volume-up" height="12" role="img" viewBox="0 0 16 16" width="12"><path d="M7 1.86c-.28 0-.53.11-.71.29l-2.7 2.71H1c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1h2.59l2.71 2.71a1.003 1.003 0 001.71-.71v-10c-.01-.55-.46-1-1.01-1zm6.74-.99l-1.58 1.22A9.985 9.985 0 0114 7.86c0 2.16-.69 4.15-1.85 5.78l1.58 1.22c1.42-1.97 2.26-4.38 2.26-7 .01-2.61-.84-5.02-2.25-6.99zM8.98 4.52C9.62 5.48 10 6.63 10 7.86s-.38 2.39-1.02 3.34l1.59 1.22c.9-1.29 1.43-2.86 1.43-4.56 0-1.7-.53-3.27-1.43-4.56L8.98 4.52z" fill-rule="evenodd"></path></svg></span></button></p><p>LLM Agent å¾ªçŽ¯è¿è¡Œå·¥å…·æ¥å®žçŽ°ç›®æ ‡ã€‚ä»£ç†è¿è¡Œç›´åˆ°æ»¡è¶³åœæ­¢æ¡ä»¶ - å³å½“æ¨¡åž‹å‘å‡ºæœ€ç»ˆè¾“å‡ºæˆ–è¾¾åˆ°è¿­ä»£é™åˆ¶æ—¶ã€‚<button type="button" title="æœ—è¯»" class="bp5-button bp5-minimal bp5-small"><span aria-hidden="true" class="bp5-icon bp5-icon-volume-up"><svg data-icon="volume-up" height="12" role="img" viewBox="0 0 16 16" width="12"><path d="M7 1.86c-.28 0-.53.11-.71.29l-2.7 2.71H1c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1h2.59l2.71 2.71a1.003 1.003 0 001.71-.71v-10c-.01-.55-.46-1-1.01-1zm6.74-.99l-1.58 1.22A9.985 9.985 0 0114 7.86c0 2.16-.69 4.15-1.85 5.78l1.58 1.22c1.42-1.97 2.26-4.38 2.26-7 .01-2.61-.84-5.02-2.25-6.99zM8.98 4.52C9.62 5.48 10 6.63 10 7.86s-.38 2.39-1.02 3.34l1.59 1.22c.9-1.29 1.43-2.86 1.43-4.56 0-1.7-.53-3.27-1.43-4.56L8.98 4.52z" fill-rule="evenodd"></path></svg></span></button></p></div></div></div></div></div><div class="result-block bp5-card bp5-elevation-0"><div class="bp5-callout bp5-intent-warning bp5-callout-has-body-content"><p>DeepL é¦–æ¬¡ç¿»è¯‘é€Ÿåº¦è¾ƒæ…¢ï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚è‹¥é‡åˆ°é—®é¢˜ï¼ˆæŠ¥é”™ã€ç¿»è¯‘ç»“æžœä¸å…¨ç­‰ï¼‰è¯·ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®ã€‚</p><a role="button" href="https://hcfy.ai/docs/services/free/#deepl" target="_blank" class="bp5-button bp5-small bp5-intent-primary" aria-disabled="false" style="visibility: visible;"><span class="bp5-button-text">æŸ¥çœ‹è§£å†³æ–¹æ¡ˆ</span></a><a style="margin-left: 15px;">ä¸å†æç¤º</a></div><div class="legend"><div class="legend-left"><span class="api-ico" style="background-image: url(&quot;chrome-extension://ikhdkkncnoglghljlkmcimlnlhkeamad/deepl.png&quot;);"></span><h6 class="bp5-heading">DeepLï¼ˆå†…ç½®ï¼‰</h6><span aria-controls="listbox-16" class="lang-select bp5-popover-target" aria-expanded="false" aria-haspopup="listbox" role="combobox"><span class="source"><span class="source-text">è‹±è¯­</span><span aria-hidden="true" class="bp5-icon bp5-icon-caret-down"><svg data-icon="caret-down" height="12" role="img" viewBox="0 0 16 16" width="12"><path d="M12 6.5c0-.28-.22-.5-.5-.5h-7a.495.495 0 00-.37.83l3.5 4c.09.1.22.17.37.17s.28-.07.37-.17l3.5-4c.08-.09.13-.2.13-.33z" fill-rule="evenodd"></path></svg></span></span></span><button type="button" title="æœ—è¯»" class="bp5-button bp5-minimal bp5-small"><span aria-hidden="true" class="bp5-icon bp5-icon-volume-up"><svg data-icon="volume-up" height="12" role="img" viewBox="0 0 16 16" width="12"><path d="M7 1.86c-.28 0-.53.11-.71.29l-2.7 2.71H1c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1h2.59l2.71 2.71a1.003 1.003 0 001.71-.71v-10c-.01-.55-.46-1-1.01-1zm6.74-.99l-1.58 1.22A9.985 9.985 0 0114 7.86c0 2.16-.69 4.15-1.85 5.78l1.58 1.22c1.42-1.97 2.26-4.38 2.26-7 .01-2.61-.84-5.02-2.25-6.99zM8.98 4.52C9.62 5.48 10 6.63 10 7.86s-.38 2.39-1.02 3.34l1.59 1.22c.9-1.29 1.43-2.86 1.43-4.56 0-1.7-.53-3.27-1.43-4.56L8.98 4.52z" fill-rule="evenodd"></path></svg></span></button></div><div style="flex-shrink: 0;"><button type="button" title="æ”¶èµ·" class="bp5-button bp5-minimal bp5-small"><span aria-hidden="true" class="bp5-icon bp5-icon-chevron-up"><svg data-icon="chevron-up" height="14" role="img" viewBox="0 0 16 16" width="14"><path d="M12.71 9.29l-4-4C8.53 5.11 8.28 5 8 5s-.53.11-.71.29l-4 4a1.003 1.003 0 001.42 1.42L8 7.41l3.29 3.29c.18.19.43.3.71.3a1.003 1.003 0 00.71-1.71z" fill-rule="evenodd"></path></svg></span></button><button type="button" title="å¤åˆ¶ç¿»è¯‘ç»“æžœ" class="bp5-button bp5-minimal bp5-small"><span aria-hidden="true" class="bp5-icon bp5-icon-duplicate"><svg data-icon="duplicate" height="12" role="img" viewBox="0 0 16 16" width="12"><path d="M15 0H5c-.55 0-1 .45-1 1v2h2V2h8v7h-1v2h2c.55 0 1-.45 1-1V1c0-.55-.45-1-1-1zm-4 4H1c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h10c.55 0 1-.45 1-1V5c0-.55-.45-1-1-1zm-1 10H2V6h8v8z" fill-rule="evenodd"></path></svg></span></button><a role="button" target="_blank" title="æŸ¥çœ‹è¯¦ç»†ç»“æžœ" class="bp5-button bp5-minimal bp5-small" aria-disabled="false" href="https://www.deepl.com/translator#en/zh/Agents%20combine%20language%20models%20with%20tools%20to%20create%20systems%20that%20can%20reason%20about%20tasks%2C%20decide%20which%20tools%20to%20use%2C%20and%20iteratively%20work%20towards%20solutions.%0Acreate_agent%20provides%20a%20production-ready%20agent%20implementation.%0AAn%20LLM%20Agent%20runs%20tools%20in%20a%20loop%20to%20achieve%20a%20goal.%20An%20agent%20runs%20until%20a%20stop%20condition%20is%20met%20-%20i.e.%2C%20when%20the%20model%20emits%20a%20final%20output%20or%20an%20iteration%20limit%20is%20reached."><span aria-hidden="true" class="bp5-icon bp5-icon-share"><svg data-icon="share" height="12" role="img" viewBox="0 0 16 16" width="12"><path d="M10.99 13.99h-9v-9h4.76l2-2H.99c-.55 0-1 .45-1 1v11c0 .55.45 1 1 1h11c.55 0 1-.45 1-1V7.24l-2 2v4.75zm4-14h-5c-.55 0-1 .45-1 1s.45 1 1 1h2.59L7.29 7.28a1 1 0 00-.3.71 1.003 1.003 0 001.71.71l5.29-5.29V6c0 .55.45 1 1 1s1-.45 1-1V1c0-.56-.45-1.01-1-1.01z" fill-rule="evenodd"></path></svg></span></a></div></div><div class="bp5-collapse" style="height: auto; overflow-y: visible; transition: none;"><div class="bp5-collapse-body" aria-hidden="false" style="transform: translateY(0px); transition: none;"><div style="display: none;"><p class="">1</p><p class="" style="width: 150px;">1</p></div><div class="common-result"><div class="general-result"><p>æ™ºèƒ½ä½“å°†è¯­è¨€æ¨¡åž‹ä¸Žå·¥å…·ç›¸ç»“åˆï¼Œæž„å»ºå‡ºèƒ½å¤Ÿå¯¹ä»»åŠ¡è¿›è¡ŒæŽ¨ç†ã€å†³å®šä½¿ç”¨ä½•ç§å·¥å…·å¹¶è¿­ä»£æŽ¨è¿›è§£å†³æ–¹æ¡ˆçš„ç³»ç»Ÿã€‚<button type="button" title="æœ—è¯»" class="bp5-button bp5-minimal bp5-small"><span aria-hidden="true" class="bp5-icon bp5-icon-volume-up"><svg data-icon="volume-up" height="12" role="img" viewBox="0 0 16 16" width="12"><path d="M7 1.86c-.28 0-.53.11-.71.29l-2.7 2.71H1c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1h2.59l2.71 2.71a1.003 1.003 0 001.71-.71v-10c-.01-.55-.46-1-1.01-1zm6.74-.99l-1.58 1.22A9.985 9.985 0 0114 7.86c0 2.16-.69 4.15-1.85 5.78l1.58 1.22c1.42-1.97 2.26-4.38 2.26-7 .01-2.61-.84-5.02-2.25-6.99zM8.98 4.52C9.62 5.48 10 6.63 10 7.86s-.38 2.39-1.02 3.34l1.59 1.22c.9-1.29 1.43-2.86 1.43-4.56 0-1.7-.53-3.27-1.43-4.56L8.98 4.52z" fill-rule="evenodd"></path></svg></span></button></p><p>create_agent æä¾›äº†ä¸€ä¸ªå¯æŠ•å…¥ç”Ÿäº§çŽ¯å¢ƒçš„æ™ºèƒ½ä½“å®žçŽ°æ–¹æ¡ˆã€‚<button type="button" title="æœ—è¯»" class="bp5-button bp5-minimal bp5-small"><span aria-hidden="true" class="bp5-icon bp5-icon-volume-up"><svg data-icon="volume-up" height="12" role="img" viewBox="0 0 16 16" width="12"><path d="M7 1.86c-.28 0-.53.11-.71.29l-2.7 2.71H1c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1h2.59l2.71 2.71a1.003 1.003 0 001.71-.71v-10c-.01-.55-.46-1-1.01-1zm6.74-.99l-1.58 1.22A9.985 9.985 0 0114 7.86c0 2.16-.69 4.15-1.85 5.78l1.58 1.22c1.42-1.97 2.26-4.38 2.26-7 .01-2.61-.84-5.02-2.25-6.99zM8.98 4.52C9.62 5.48 10 6.63 10 7.86s-.38 2.39-1.02 3.34l1.59 1.22c.9-1.29 1.43-2.86 1.43-4.56 0-1.7-.53-3.27-1.43-4.56L8.98 4.52z" fill-rule="evenodd"></path></svg></span></button></p><p>å¤§åž‹è¯­è¨€æ¨¡åž‹æ™ºèƒ½ä½“é€šè¿‡å¾ªçŽ¯è°ƒç”¨å·¥å…·æ¥è¾¾æˆç›®æ ‡ã€‚æ™ºèƒ½ä½“å°†æŒç»­è¿è¡Œç›´è‡³æ»¡è¶³åœæ­¢æ¡ä»¶â€”â€”å³æ¨¡åž‹è¾“å‡ºæœ€ç»ˆç»“æžœæˆ–è¾¾åˆ°è¿­ä»£æ¬¡æ•°ä¸Šé™ã€‚<button type="button" title="æœ—è¯»" class="bp5-button bp5-minimal bp5-small"><span aria-hidden="true" class="bp5-icon bp5-icon-volume-up"><svg data-icon="volume-up" height="12" role="img" viewBox="0 0 16 16" width="12"><path d="M7 1.86c-.28 0-.53.11-.71.29l-2.7 2.71H1c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1h2.59l2.71 2.71a1.003 1.003 0 001.71-.71v-10c-.01-.55-.46-1-1.01-1zm6.74-.99l-1.58 1.22A9.985 9.985 0 0114 7.86c0 2.16-.69 4.15-1.85 5.78l1.58 1.22c1.42-1.97 2.26-4.38 2.26-7 .01-2.61-.84-5.02-2.25-6.99zM8.98 4.52C9.62 5.48 10 6.63 10 7.86s-.38 2.39-1.02 3.34l1.59 1.22c.9-1.29 1.43-2.86 1.43-4.56 0-1.7-.53-3.27-1.43-4.56L8.98 4.52z" fill-rule="evenodd"></path></svg></span></button></p></div></div></div></div></div><div class="result-block bp5-card bp5-elevation-0"><div class="legend"><div class="legend-left"><span class="api-ico" style="background-image: url(&quot;chrome-extension://ikhdkkncnoglghljlkmcimlnlhkeamad/yandex.png&quot;);"></span><h6 class="bp5-heading">Yandex ç¿»è¯‘</h6><span aria-controls="listbox-15" class="lang-select bp5-popover-target" aria-expanded="false" aria-haspopup="listbox" role="combobox"><span class="source"><span class="source-text">è‹±è¯­</span><span aria-hidden="true" class="bp5-icon bp5-icon-caret-down"><svg data-icon="caret-down" height="12" role="img" viewBox="0 0 16 16" width="12"><path d="M12 6.5c0-.28-.22-.5-.5-.5h-7a.495.495 0 00-.37.83l3.5 4c.09.1.22.17.37.17s.28-.07.37-.17l3.5-4c.08-.09.13-.2.13-.33z" fill-rule="evenodd"></path></svg></span></span></span><button type="button" title="æœ—è¯»" class="bp5-button bp5-minimal bp5-small"><span aria-hidden="true" class="bp5-icon bp5-icon-volume-up"><svg data-icon="volume-up" height="12" role="img" viewBox="0 0 16 16" width="12"><path d="M7 1.86c-.28 0-.53.11-.71.29l-2.7 2.71H1c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1h2.59l2.71 2.71a1.003 1.003 0 001.71-.71v-10c-.01-.55-.46-1-1.01-1zm6.74-.99l-1.58 1.22A9.985 9.985 0 0114 7.86c0 2.16-.69 4.15-1.85 5.78l1.58 1.22c1.42-1.97 2.26-4.38 2.26-7 .01-2.61-.84-5.02-2.25-6.99zM8.98 4.52C9.62 5.48 10 6.63 10 7.86s-.38 2.39-1.02 3.34l1.59 1.22c.9-1.29 1.43-2.86 1.43-4.56 0-1.7-.53-3.27-1.43-4.56L8.98 4.52z" fill-rule="evenodd"></path></svg></span></button></div><div style="flex-shrink: 0;"><button type="button" title="æ”¶èµ·" class="bp5-button bp5-minimal bp5-small"><span aria-hidden="true" class="bp5-icon bp5-icon-chevron-up"><svg data-icon="chevron-up" height="14" role="img" viewBox="0 0 16 16" width="14"><path d="M12.71 9.29l-4-4C8.53 5.11 8.28 5 8 5s-.53.11-.71.29l-4 4a1.003 1.003 0 001.42 1.42L8 7.41l3.29 3.29c.18.19.43.3.71.3a1.003 1.003 0 00.71-1.71z" fill-rule="evenodd"></path></svg></span></button><button type="button" title="å¤åˆ¶ç¿»è¯‘ç»“æžœ" class="bp5-button bp5-minimal bp5-small"><span aria-hidden="true" class="bp5-icon bp5-icon-duplicate"><svg data-icon="duplicate" height="12" role="img" viewBox="0 0 16 16" width="12"><path d="M15 0H5c-.55 0-1 .45-1 1v2h2V2h8v7h-1v2h2c.55 0 1-.45 1-1V1c0-.55-.45-1-1-1zm-4 4H1c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h10c.55 0 1-.45 1-1V5c0-.55-.45-1-1-1zm-1 10H2V6h8v8z" fill-rule="evenodd"></path></svg></span></button><a role="button" target="_blank" title="æŸ¥çœ‹è¯¦ç»†ç»“æžœ" class="bp5-button bp5-minimal bp5-small" aria-disabled="false" href="https://translate.yandex.com/?source_lang=en&amp;target_lang=zh&amp;text=Agents%20combine%20language%20models%20with%20tools%20to%20create%20systems%20that%20can%20reason%20about%20tasks%2C%20decide%20which%20tools%20to%20use%2C%20and%20iteratively%20work%20towards%20solutions.%0Acreate_agent%20provides%20a%20production-ready%20agent%20implementation.%0AAn%20LLM%20Agent%20runs%20tools%20in%20a%20loop%20to%20achieve%20a%20goal.%20An%20agent%20runs%20until%20a%20stop%20condition%20is%20met%20-%20i.e.%2C%20when%20the%20model%20emits%20a%20final%20output%20or%20an%20iteration%20limit%20is%20reached."><span aria-hidden="true" class="bp5-icon bp5-icon-share"><svg data-icon="share" height="12" role="img" viewBox="0 0 16 16" width="12"><path d="M10.99 13.99h-9v-9h4.76l2-2H.99c-.55 0-1 .45-1 1v11c0 .55.45 1 1 1h11c.55 0 1-.45 1-1V7.24l-2 2v4.75zm4-14h-5c-.55 0-1 .45-1 1s.45 1 1 1h2.59L7.29 7.28a1 1 0 00-.3.71 1.003 1.003 0 001.71.71l5.29-5.29V6c0 .55.45 1 1 1s1-.45 1-1V1c0-.56-.45-1.01-1-1.01z" fill-rule="evenodd"></path></svg></span></a></div></div><div class="bp5-collapse" style="height: auto; overflow-y: visible; transition: none;"><div class="bp5-collapse-body" aria-hidden="false" style="transform: translateY(0px); transition: none;"><div style="display: none;"><p class="">1</p><p class="" style="width: 150px;">1</p></div><div class="common-result"><div class="general-result"><p>ä»£ç†ç»“åˆçš„è¯­è¨€æ¨¡åž‹ä¸Žå·¥å…·çš„åˆ›å»ºç³»ç»Ÿï¼Œå¯ä»¥ç†è§£çš„ä»»åŠ¡ï¼Œå†³å®šå“ªäº›å·¥å…·çš„ä½¿ç”¨ï¼Œå¹¶åå¤çš„å·¥ä½œæœè§£å†³æ–¹æ¡ˆã€‚<button type="button" title="æœ—è¯»" class="bp5-button bp5-minimal bp5-small"><span aria-hidden="true" class="bp5-icon bp5-icon-volume-up"><svg data-icon="volume-up" height="12" role="img" viewBox="0 0 16 16" width="12"><path d="M7 1.86c-.28 0-.53.11-.71.29l-2.7 2.71H1c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1h2.59l2.71 2.71a1.003 1.003 0 001.71-.71v-10c-.01-.55-.46-1-1.01-1zm6.74-.99l-1.58 1.22A9.985 9.985 0 0114 7.86c0 2.16-.69 4.15-1.85 5.78l1.58 1.22c1.42-1.97 2.26-4.38 2.26-7 .01-2.61-.84-5.02-2.25-6.99zM8.98 4.52C9.62 5.48 10 6.63 10 7.86s-.38 2.39-1.02 3.34l1.59 1.22c.9-1.29 1.43-2.86 1.43-4.56 0-1.7-.53-3.27-1.43-4.56L8.98 4.52z" fill-rule="evenodd"></path></svg></span></button></p><p>create_agentæä¾›äº†æŠ•å…¥ç”Ÿäº§çš„ä»£ç†æ‰§è¡Œæƒ…å†µã€‚<button type="button" title="æœ—è¯»" class="bp5-button bp5-minimal bp5-small"><span aria-hidden="true" class="bp5-icon bp5-icon-volume-up"><svg data-icon="volume-up" height="12" role="img" viewBox="0 0 16 16" width="12"><path d="M7 1.86c-.28 0-.53.11-.71.29l-2.7 2.71H1c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1h2.59l2.71 2.71a1.003 1.003 0 001.71-.71v-10c-.01-.55-.46-1-1.01-1zm6.74-.99l-1.58 1.22A9.985 9.985 0 0114 7.86c0 2.16-.69 4.15-1.85 5.78l1.58 1.22c1.42-1.97 2.26-4.38 2.26-7 .01-2.61-.84-5.02-2.25-6.99zM8.98 4.52C9.62 5.48 10 6.63 10 7.86s-.38 2.39-1.02 3.34l1.59 1.22c.9-1.29 1.43-2.86 1.43-4.56 0-1.7-.53-3.27-1.43-4.56L8.98 4.52z" fill-rule="evenodd"></path></svg></span></button></p><p>ä¸€ä¸ªæ³•å­¦ç¡•å£«è¿è¡Œä»£ç†çš„å·¥å…·åœ¨ä¸€ä¸ªå›žè·¯æ¥å®žçŽ°ä¸€ä¸ªç›®æ ‡ã€‚ ä»£ç†è¿è¡Œï¼Œç›´åˆ°ç»ˆæ­¢æ¡ä»¶å¾—åˆ°æ»¡è¶³å³æ—¶çš„æ¨¡å¼å‘å‡ºçš„ä¸€ä¸ªæœ€ç»ˆçš„è¾“å‡ºæˆ–ä¸€ä¸ªè¿­ä»£è¾¾åˆ°æžé™ã€‚<button type="button" title="æœ—è¯»" class="bp5-button bp5-minimal bp5-small"><span aria-hidden="true" class="bp5-icon bp5-icon-volume-up"><svg data-icon="volume-up" height="12" role="img" viewBox="0 0 16 16" width="12"><path d="M7 1.86c-.28 0-.53.11-.71.29l-2.7 2.71H1c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1h2.59l2.71 2.71a1.003 1.003 0 001.71-.71v-10c-.01-.55-.46-1-1.01-1zm6.74-.99l-1.58 1.22A9.985 9.985 0 0114 7.86c0 2.16-.69 4.15-1.85 5.78l1.58 1.22c1.42-1.97 2.26-4.38 2.26-7 .01-2.61-.84-5.02-2.25-6.99zM8.98 4.52C9.62 5.48 10 6.63 10 7.86s-.38 2.39-1.02 3.34l1.59 1.22c.9-1.29 1.43-2.86 1.43-4.56 0-1.7-.53-3.27-1.43-4.56L8.98 4.52z" fill-rule="evenodd"></path></svg></span></button></p></div></div></div></div></div><div class="result-block bp5-card bp5-elevation-0"><div class="legend"><div class="legend-left"><span class="api-ico" style="background-image: url(&quot;chrome-extension://ikhdkkncnoglghljlkmcimlnlhkeamad/bing.ico&quot;);"></span><h6 class="bp5-heading">å¿…åº”è¯å…¸</h6><span aria-controls="listbox-14" class="lang-select bp5-popover-target" aria-expanded="false" aria-haspopup="listbox" role="combobox"><span class="source"><span class="source-text"></span><span aria-hidden="true" class="bp5-icon bp5-icon-caret-down"><svg data-icon="caret-down" height="12" role="img" viewBox="0 0 16 16" width="12"><path d="M12 6.5c0-.28-.22-.5-.5-.5h-7a.495.495 0 00-.37.83l3.5 4c.09.1.22.17.37.17s.28-.07.37-.17l3.5-4c.08-.09.13-.2.13-.33z" fill-rule="evenodd"></path></svg></span></span></span><button type="button" title="æœ—è¯»" class="bp5-button bp5-minimal bp5-small"><span aria-hidden="true" class="bp5-icon bp5-icon-volume-up"><svg data-icon="volume-up" height="12" role="img" viewBox="0 0 16 16" width="12"><path d="M7 1.86c-.28 0-.53.11-.71.29l-2.7 2.71H1c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1h2.59l2.71 2.71a1.003 1.003 0 001.71-.71v-10c-.01-.55-.46-1-1.01-1zm6.74-.99l-1.58 1.22A9.985 9.985 0 0114 7.86c0 2.16-.69 4.15-1.85 5.78l1.58 1.22c1.42-1.97 2.26-4.38 2.26-7 .01-2.61-.84-5.02-2.25-6.99zM8.98 4.52C9.62 5.48 10 6.63 10 7.86s-.38 2.39-1.02 3.34l1.59 1.22c.9-1.29 1.43-2.86 1.43-4.56 0-1.7-.53-3.27-1.43-4.56L8.98 4.52z" fill-rule="evenodd"></path></svg></span></button></div><div style="flex-shrink: 0;"><button type="button" title="æ”¶èµ·" class="bp5-button bp5-minimal bp5-small"><span aria-hidden="true" class="bp5-icon bp5-icon-chevron-up"><svg data-icon="chevron-up" height="14" role="img" viewBox="0 0 16 16" width="14"><path d="M12.71 9.29l-4-4C8.53 5.11 8.28 5 8 5s-.53.11-.71.29l-4 4a1.003 1.003 0 001.42 1.42L8 7.41l3.29 3.29c.18.19.43.3.71.3a1.003 1.003 0 00.71-1.71z" fill-rule="evenodd"></path></svg></span></button><button type="button" disabled="" title="å¤åˆ¶ç¿»è¯‘ç»“æžœ" tabindex="-1" class="bp5-button bp5-disabled bp5-minimal bp5-small"><span aria-hidden="true" class="bp5-icon bp5-icon-duplicate"><svg data-icon="duplicate" height="12" role="img" viewBox="0 0 16 16" width="12"><path d="M15 0H5c-.55 0-1 .45-1 1v2h2V2h8v7h-1v2h2c.55 0 1-.45 1-1V1c0-.55-.45-1-1-1zm-4 4H1c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h10c.55 0 1-.45 1-1V5c0-.55-.45-1-1-1zm-1 10H2V6h8v8z" fill-rule="evenodd"></path></svg></span></button><a role="button" target="_blank" title="æŸ¥çœ‹è¯¦ç»†ç»“æžœ" class="bp5-button bp5-minimal bp5-small" aria-disabled="false" href="https://www.bing.com/dict/search?q=Agents%20combine%20language%20models%20with%20tools%20to%20create%20systems%20that%20can%20reason%20about%20tasks%2C%20decide%20which%20tools%20to%20use%2C%20and%20iteratively%20work%20towards%20solutions.%0Acreate_agent%20provides%20a%20production-ready%20agent%20implementation.%0AAn%20LLM%20Agent%20runs%20tools%20in%20a%20loop%20to%20achieve%20a%20goal.%20An%20agent%20runs%20until%20a%20stop%20condition%20is%20met%20-%20i.e.%2C%20when%20the%20model%20emits%20a%20final%20output%20or%20an%20iteration%20limit%20is%20reached.&amp;cc=cn"><span aria-hidden="true" class="bp5-icon bp5-icon-share"><svg data-icon="share" height="12" role="img" viewBox="0 0 16 16" width="12"><path d="M10.99 13.99h-9v-9h4.76l2-2H.99c-.55 0-1 .45-1 1v11c0 .55.45 1 1 1h11c.55 0 1-.45 1-1V7.24l-2 2v4.75zm4-14h-5c-.55 0-1 .45-1 1s.45 1 1 1h2.59L7.29 7.28a1 1 0 00-.3.71 1.003 1.003 0 001.71.71l5.29-5.29V6c0 .55.45 1 1 1s1-.45 1-1V1c0-.56-.45-1.01-1-1.01z" fill-rule="evenodd"></path></svg></span></a></div></div><div class="bp5-collapse" style="height: auto; overflow-y: visible; transition: none;"><div class="bp5-collapse-body" aria-hidden="false" style="transform: translateY(0px); transition: none;"><div style="display: none;"><p class="">1</p><p class="" style="width: 150px;">1</p></div><div class="error"><div class="bp5-non-ideal-state bp5-non-ideal-state-vertical"><div class="bp5-non-ideal-state-text"><div style="text-align: left;"><p>æ— ç¿»è¯‘ç»“æžœã€‚<a href="https://hcfy.ai/docs/services/free#bingdict" target="_blank" rel="noreferrer">æŸ¥çœ‹è§£å†³æ–¹æ¡ˆ</a></p></div></div><div style="display: flex;"><button type="button" class="bp5-button bp5-small"><span class="bp5-button-text">é‡è¯•</span></button></div></div></div><div class="common-result"></div></div></div></div><div class="bp5-callout bp5-callout-has-body-content" style="margin-bottom: 8px; font-size: 12px;">ä¸‹æ–¹æ˜¯é¢„å®šä¹‰çš„ä¸‰ä¸ªå¿«æ·é“¾æŽ¥ï¼Œä½ å¯ä»¥å‰å¾€<a>â€œè®¾ç½®â€ - â€œç¿»è¯‘é¢æ¿â€</a> - â€œå¿«æ·é“¾æŽ¥â€ä¸­ä¿®æ”¹æˆ–åˆ é™¤å®ƒä»¬ã€‚<a>ä¸å†æç¤º</a></div><div class="quick-links"><a href="https://www.google.com/search?q=Agents%20combine%20language%20models%20with%20tools%20to%20create%20systems%20that%20can%20reason%20about%20tasks%2C%20decide%20which%20tools%20to%20use%2C%20and%20iteratively%20work%20towards%20solutions.%0Acreate_agent%20provides%20a%20production-ready%20agent%20implementation.%0AAn%20LLM%20Agent%20runs%20tools%20in%20a%20loop%20to%20achieve%20a%20goal.%20An%20agent%20runs%20until%20a%20stop%20condition%20is%20met%20-%20i.e.%2C%20when%20the%20model%20emits%20a%20final%20output%20or%20an%20iteration%20limit%20is%20reached." target="_blank" rel="noreferrer">è°·æ­Œæœç´¢</a><a href="https://zh.wikipedia.org/w/index.php?search=Agents%20combine%20language%20models%20with%20tools%20to%20create%20systems%20that%20can%20reason%20about%20tasks%2C%20decide%20which%20tools%20to%20use%2C%20and%20iteratively%20work%20towards%20solutions.%0Acreate_agent%20provides%20a%20production-ready%20agent%20implementation.%0AAn%20LLM%20Agent%20runs%20tools%20in%20a%20loop%20to%20achieve%20a%20goal.%20An%20agent%20runs%20until%20a%20stop%20condition%20is%20met%20-%20i.e.%2C%20when%20the%20model%20emits%20a%20final%20output%20or%20an%20iteration%20limit%20is%20reached." target="_blank" rel="noreferrer">ç»´åŸºç™¾ç§‘</a><a href="https://dictionary.cambridge.org/dictionary/english-chinese-simplified/Agents%20combine%20language%20models%20with%20tools%20to%20create%20systems%20that%20can%20reason%20about%20tasks%2C%20decide%20which%20tools%20to%20use%2C%20and%20iteratively%20work%20towards%20solutions.%0Acreate_agent%20provides%20a%20production-ready%20agent%20implementation.%0AAn%20LLM%20Agent%20runs%20tools%20in%20a%20loop%20to%20achieve%20a%20goal.%20An%20agent%20runs%20until%20a%20stop%20condition%20is%20met%20-%20i.e.%2C%20when%20the%20model%20emits%20a%20final%20output%20or%20an%20iteration%20limit%20is%20reached." target="_blank" rel="noreferrer">å‰‘æ¡¥è¯å…¸</a></div></div></div><div class="arrow" style=""></div></div><div id="web-trs-panel"></div></div><div class="bp5-portal"><div aria-live="polite" class="bp5-overlay"></div></div></div></template></div></div></html>]]></content>
    
    
      
      
    <summary type="html">&lt;!DOCTYPE html&gt;
&lt;!-- saved from url=(0054)https://docs.langchain.com/oss/python/langchain/agents --&gt;
&lt;html lang=&quot;en&quot; class=&quot;__variable_47c97</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>LangChainå­¦ä¹ æ—¥å¿—: Agent</title>
    <link href="https://atffang.github.io/2026/01/10/langchainAgent/"/>
    <id>https://atffang.github.io/2026/01/10/langchainAgent/</id>
    <published>2026-01-10T07:33:25.000Z</published>
    <updated>2026-01-10T08:40:37.973Z</updated>
    
    <content type="html"><![CDATA[<p>å°è¯•ä½¿ç”¨LangChainçš„AgentsåŠŸèƒ½ã€‚<br><span id="more"></span></p><h3 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h3><p>LangChain å®˜æ–¹æ–‡æ¡£çš„ Core components ç¬¬ä¸€é¡¹å°±æ˜¯ <span style="color: #BB8ED0; font-weight: bold;">Agents </span> ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹<a href="https://docs.langchain.com/oss/python/langchain/agents">å®˜æ–¹æ˜¯å¦‚ä½•ä»‹ç»çš„</a> ï¼š</p><div style="background-color: #f0f0f0; color: #000000; font-family: 'Times New Roman' !important; padding: 10px;">Agents combine language models with tools to create systems that can reason about tasks, decide which tools to use, and iteratively work towards solutions.<br><br>'create_agent' provides a production-ready agent implementation.<br><br>An LLM Agent runs tools in a loop to achieve a goal. An agent runs until a stop condition is met - i.e., when the model emits a final output or an iteration limit is reached.</div><br>è¿™æ®µè¯å‘Šè¯‰æˆ‘ä»¬ä¸‰ä¸ªä¿¡æ¯ï¼š- Agent æ˜¯å°†<span style="color: #BB8ED0; font-weight: bold;">è¯­è¨€æ¨¡åž‹ï¼ˆLLMï¼‰</span>ä¸Ž<span style="color: #BB8ED0; font-weight: bold;">å·¥å…·ï¼ˆToolsï¼‰</span>ç»“åˆçš„ç³»ç»Ÿã€‚å®ƒçš„ç‰¹ç‚¹æ˜¯å…·å¤‡æŽ¨ç†èƒ½åŠ›ï¼Œèƒ½è‡ªä¸»å†³å®šè¯¥ç”¨ä»€ä¹ˆå·¥å…·ï¼Œå¹¶é€šè¿‡åå¤è¿­ä»£æ¥è§£å†³ä»»åŠ¡ã€‚- å¯ä»¥ä½¿ç”¨ `create_agent` å‡½æ•°å®žçŽ°- Agent çš„è¿è¡Œæ˜¯ä¸€ä¸ª**å¾ªçŽ¯è¿‡ç¨‹**ï¼šå®ƒä¼šä¸æ–­è¿è¡Œå·¥å…·ï¼Œç›´åˆ°æ»¡è¶³åœæ­¢æ¡ä»¶ä¸ºæ­¢ã€‚å¹¶ä¸”ç»™å‡ºäº†ç®€å•çš„å·¥ä½œæµç¨‹ï¼š<img src="/2026/01/10/langchainAgent/agent01.png" class="" title="sucessful">### Core components#### Model<span style="color: #89986D; font-weight: bold;">Model å°±æ˜¯ Agent çš„æŽ¨ç†å¼•æ“Žï¼Œè´Ÿè´£æ€è€ƒã€å†³ç­–å’Œç”Ÿæˆå›žå¤ã€‚</span>å¯¹äºŽ LLM æ¨¡åž‹çš„è°ƒç”¨åˆ†ä¸ºä¸¤ç§æ¨¡å¼ï¼š- **Static Model**ï¼šæœ€å¸¸ç”¨çš„æ–¹å¼ã€‚åœ¨åˆ›å»º Agent æ—¶å°±å›ºå®šå¥½ï¼ˆä¾‹å¦‚æŒ‡å®šç”¨ `gpt-4o`ï¼‰ï¼Œæ•´ä¸ªè¿è¡Œè¿‡ç¨‹ä¸­ä¸ä¼šå˜ã€‚- **Dynamic Model**ï¼šä¸€ç§é«˜çº§ç”¨æ³•ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶æ ¹æ®ä¸Šä¸‹æ–‡åŠ¨æ€é€‰æ‹©æ¨¡åž‹ã€‚æ¯”å¦‚åœ¨ç®€å•çš„é—®é¢˜ä¸Šä½¿ç”¨ä¾¿å®œçš„æ¨¡åž‹ã€‚#### Tools<span style="color: #89986D; font-weight: bold;">Tools å°±æ˜¯ Agent ä¸Žå¤–éƒ¨ä¸–ç•Œäº¤äº’çš„å·¥å…·ã€‚</span>é€šå¸¸æ˜¯æ ‡å‡†çš„ Python å‡½æ•°ï¼ŒåŠ ä¸Š `@tool` è£…é¥°å™¨ã€‚æ ¹æ®æ–‡æ¡£çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡``create_agent``ç®€å•å®šä¹‰ä¸€ä¸ª Tool ï¼š<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.tools <span class="keyword">import</span> tool</span><br><span class="line"><span class="keyword">from</span> langchain.agents <span class="keyword">import</span> create_agent</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@tool</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">search</span>(<span class="params">query: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Search for information.&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;Results for: <span class="subst">&#123;query&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@tool</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_weather</span>(<span class="params">location: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Get weather information for a location.&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;Weather in <span class="subst">&#123;location&#125;</span>: Sunny, 72Â°F&quot;</span></span><br><span class="line"></span><br><span class="line">agent = create_agent(model, tools=[search, get_weather])</span><br></pre></td></tr></table></figure>è€Œå¦‚æžœè¦è‡ªå®šä¹‰Toolé”™è¯¯çš„å¤„ç†æ–¹å¼ï¼Œå°±ä½¿ç”¨ `@wrap_tool_call` è£…é¥°å™¨åˆ›å»ºä¸­é—´ä»¶ï¼š<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.agents <span class="keyword">import</span> create_agent</span><br><span class="line"><span class="keyword">from</span> langchain.agents.middleware <span class="keyword">import</span> wrap_tool_call</span><br><span class="line"><span class="keyword">from</span> langchain.messages <span class="keyword">import</span> ToolMessage</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@wrap_tool_call</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">handle_tool_errors</span>(<span class="params">request, handler</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Handle tool execution errors with custom messages.&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> handler(request)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="comment"># Return a custom error message to the model</span></span><br><span class="line">        <span class="keyword">return</span> ToolMessage(</span><br><span class="line">            content=<span class="string">f&quot;Tool error: Please check your input and try again. (<span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>)&quot;</span>,</span><br><span class="line">            tool_call_id=request.tool_call[<span class="string">&quot;id&quot;</span>]</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">agent = create_agent(</span><br><span class="line">    model=<span class="string">&quot;gpt-4o&quot;</span>,</span><br><span class="line">    tools=[search, get_weather],</span><br><span class="line">    middleware=[handle_tool_errors]</span><br><span class="line">)</span><br></pre></td></tr></table></figure>#### System Prompté¡¾åæ€ä¹‰ï¼ŒSystem Prompt å°±æ˜¯ç³»ç»Ÿå±‚é¢çš„æç¤ºè¯ï¼Œ<span style="color: #89986D; font-weight: bold;">ç”¨äºŽè®¾å®š Agent çš„è¡Œä¸ºè§„èŒƒå’Œè§’è‰²ã€‚</span>æœ€ç®€å•çš„å®šä¹‰æ–¹å¼å°±æ˜¯åœ¨æž„å»ºagentç¤ºä¾‹æ—¶ä¼ å…¥ï¼š<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">agent = create_agent(</span><br><span class="line">    model,</span><br><span class="line">    tools,</span><br><span class="line">    system_prompt=<span class="string">&quot;You are a helpful assistant. Be concise and accurate.&quot;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>è¿™æ˜¯ä¼ å…¥Strï¼Œå¤æ‚ä¸€äº›ï¼Œå¯ä»¥ä¼ å…¥LangChainçš„  [`SystemMessage`](https://reference.langchain.com/python/langchain/messages/?_gl=1*njhwp7*_gcl_au*MzYwNTQyNDYwLjE3Njc5MjM3MTU.*_ga*MTQ2MjI5MjY5MC4xNzY3OTIzNzE2*_ga_47WX3HKKY2*czE3NjgwMzAwNzkkbzQkZzEkdDE3NjgwMzAzMjQkajYwJGwwJGgw#langchain.messages.SystemMessage).<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.agents <span class="keyword">import</span> create_agent</span><br><span class="line"><span class="keyword">from</span> langchain.messages <span class="keyword">import</span> SystemMessage, HumanMessage</span><br><span class="line"></span><br><span class="line">literary_agent = create_agent(</span><br><span class="line">    model=<span class="string">&quot;anthropic:claude-sonnet-4-5&quot;</span>,</span><br><span class="line">    system_prompt=SystemMessage(</span><br><span class="line">        content=[</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">&quot;type&quot;</span>: <span class="string">&quot;text&quot;</span>,</span><br><span class="line">                <span class="string">&quot;text&quot;</span>: <span class="string">&quot;You are an AI assistant tasked with analyzing literary works.&quot;</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">&quot;type&quot;</span>: <span class="string">&quot;text&quot;</span>,</span><br><span class="line">                <span class="string">&quot;text&quot;</span>: <span class="string">&quot;&lt;the entire contents of &#x27;Pride and Prejudice&#x27;&gt;&quot;</span>,</span><br><span class="line">                <span class="string">&quot;cache_control&quot;</span>: &#123;<span class="string">&quot;type&quot;</span>: <span class="string">&quot;ephemeral&quot;</span>&#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    )</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">result = literary_agent.invoke(</span><br><span class="line">    &#123;<span class="string">&quot;messages&quot;</span>: [HumanMessage(<span class="string">&quot;Analyze the major themes in &#x27;Pride and Prejudice&#x27;.&quot;</span>)]&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>#### Invocation<span style="color: #89986D; font-weight: bold;">å¯åŠ¨ Agentã€‚</span>Agent çš„è¿è¡Œæ˜¯åŸºäºŽ **State (çŠ¶æ€)** çš„æ›´æ–°ï¼Œé€šå¸¸åªéœ€è¦ç»™å®ƒä¼ å…¥ä¸€ä¸ªæ–°çš„æ¶ˆæ¯ï¼ˆMessageï¼‰ï¼Œå®ƒå°±ä¼šå¼€å§‹æ ¹æ®å›¾ï¼ˆGraphï¼‰çš„é€»è¾‘è¿è¡Œï¼Œç›´åˆ°å¾—å‡ºç»“æžœã€‚æ¯”å¦‚ï¼š<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">result = agent.invoke(</span><br><span class="line">    &#123;<span class="string">&quot;messages&quot;</span>: [&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;What&#x27;s the weather in San Francisco?&quot;</span>&#125;]&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>é™¤äº†ä»¥ä¸ŠåŸºç¡€çš„å¿…è¦çš„æ­¥éª¤ï¼ŒLangChain è¿˜ä¸º Agents æä¾›äº†ä¸€äº›é«˜çº§åŠŸèƒ½ã€‚æˆ‘ä»¬ç®€å•äº†è§£ä¸€ä¸‹ï¼š<div style="background-color: #f7f9fc; border: 1px solid #e1e4e8; border-radius: 15px; padding: 25px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;">    <h3 style="margin-top: 0; color: #333; border-bottom: 2px solid #5aa9e6; padding-bottom: 10px; display: inline-block;">Agent Advanced concepts</h3>    <div style="margin-bottom: 15px;">        <h4 style="margin: 0; color: #2d3748;">1. Structured Output (ç»“æž„åŒ–è¾“å‡º)</h4>        <p style="margin: 5px 0 0 0; color: #555; font-size: 0.95em; line-height: 1.5;">            å¯ä»¥å¼ºåˆ¶è¿”å›ž JSON æ•°æ®ï¼ˆæ¯”å¦‚æå–å‡ºçš„å§“åã€æ—¥æœŸã€è®¢å•å·ï¼‰ï¼Œæ–¹ä¾¿ç¨‹åºç›´æŽ¥åŽç»­å¤„ç†ã€‚        </p>    </div><pre><code>&lt;div style=&quot;margin-bottom: 15px;&quot;&gt;    &lt;h4 style=&quot;margin: 0; color: #2d3748;&quot;&gt;2. Memory (è®°å¿†æœºåˆ¶)&lt;/h4&gt;    &lt;p style=&quot;margin: 5px 0 0 0; color: #555; font-size: 0.95em; line-height: 1.5;&quot;&gt;        &lt;strong&gt;çŸ­æœŸè®°å¿†ï¼š&lt;/strong&gt; é€šè¿‡ State å®žçŽ°è®°ä½è¿™è½®å¯¹è¯é‡Œä½ åˆšæ‰è¯´äº†ä»€ä¹ˆã€‚&lt;br&gt;        &lt;strong&gt;é•¿æœŸè®°å¿†ï¼š&lt;/strong&gt; é€šè¿‡æ•°æ®åº“å®žçŽ°åŽ†å²è®°å¿†ã€‚    &lt;/p&gt;&lt;/div&gt;&lt;div style=&quot;margin-bottom: 15px;&quot;&gt;    &lt;h4 style=&quot;margin: 0; color: #2d3748;&quot;&gt;3. Streaming (æµå¼è¾“å‡º)&lt;/h4&gt;    &lt;p style=&quot;margin: 5px 0 0 0; color: #555; font-size: 0.95em; line-height: 1.5;&quot;&gt;        å®žçŽ°&lt;strong&gt;è¾¹æƒ³è¾¹è¯´&lt;/strong&gt;ã€‚&lt;br&gt;         Agent å¯ä»¥ä¸€è¾¹è°ƒç”¨å·¥å…·ï¼Œä¸€è¾¹å°±åœ¨å±å¹•ä¸Šå³æ—¶æ‰“å°å‡ºå®ƒçš„æ€è€ƒè¿‡ç¨‹ã€‚    &lt;/p&gt;&lt;/div&gt;&lt;div&gt;    &lt;h4 style=&quot;margin: 0; color: #2d3748;&quot;&gt;4. Middleware (ä¸­é—´ä»¶)&lt;/h4&gt;    &lt;p style=&quot;margin: 5px 0 0 0; color: #555; font-size: 0.95em; line-height: 1.5;&quot;&gt;        å®ƒå¯ä»¥åœ¨ Agent è¯´è¯å‰ã€è¯´è¯åŽï¼Œæˆ–è€…å·¥å…·æŠ¥é”™æ—¶å·¥ä½œã€‚æ¯”å¦‚åœ¨å·¥å…·æŠ¥é”™æ—¶ï¼Œè‡ªåŠ¨è®© Agent é‡è¯•ï¼Œè€Œä¸æ˜¯ç›´æŽ¥è®©ç¨‹åºå´©æºƒã€‚    &lt;/p&gt;&lt;/div&gt;</code></pre><p>&lt;/div&gt;</p><p>è¿™äº›Agentsçš„åŠŸèƒ½ä¼¼ä¹Žå°è£…çš„è¿˜ä¸é”™ï¼Œé‚£æˆ‘ä»¬æ¥å®žé™…å°è¯•ä¸€ä¸‹ã€‚</p><h3 id="å®žæˆ˜"><a href="#å®žæˆ˜" class="headerlink" title="å®žæˆ˜"></a>å®žæˆ˜</h3>]]></content>
    
    
    <summary type="html">&lt;p&gt;å°è¯•ä½¿ç”¨LangChainçš„AgentsåŠŸèƒ½ã€‚&lt;br&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>LangChainå­¦ä¹ æ—¥å¿—: RAG</title>
    <link href="https://atffang.github.io/2026/01/09/langchainRAG/"/>
    <id>https://atffang.github.io/2026/01/09/langchainRAG/</id>
    <published>2026-01-09T02:12:47.000Z</published>
    <updated>2026-01-09T06:38:12.933Z</updated>
    
    <content type="html"><![CDATA[<p>å°è¯•ä½¿ç”¨LangChainæ¥å®žçŽ°RAGï¼ˆæ£€ç´¢å¢žå¼ºç”Ÿæˆï¼‰åŠŸèƒ½ã€‚</p><span id="more"></span><h3 id="ragç®€ä»‹"><a class="markdownIt-Anchor" href="#ragç®€ä»‹"></a> RAGç®€ä»‹</h3><p>æœ¬æ–‡å°†ç®€å•ä»‹ç»<span style="color: #BB8ED0; font-weight: bold;">RAGï¼ˆRetrieval-Augmented Generationï¼Œæ£€ç´¢å¢žå¼ºç”Ÿæˆï¼‰</span>åœ¨LangChainä¸­çš„å®žçŽ°</p><p>RAGæ˜¯ä¸€ç§å°†<strong>æ£€ç´¢æŠ€æœ¯</strong>ä¸Ž<strong>ç”ŸæˆæŠ€æœ¯</strong>ç›¸ç»“åˆçš„æž¶æž„ï¼Œå½“ç”¨æˆ·æå‡ºé—®é¢˜æ—¶ï¼ŒRAG ç³»ç»Ÿé¦–å…ˆä»Žå¤–éƒ¨çŸ¥è¯†åº“ä¸­æ£€ç´¢å‡ºä¸Žé—®é¢˜ç›¸å…³çš„æ–‡æ¡£ç‰‡æ®µï¼Œç„¶åŽå°†è¿™äº›ç‰‡æ®µä¸Žç”¨æˆ·çš„é—®é¢˜ä¸€èµ·å–‚ç»™å¤§æ¨¡åž‹ï¼Œä»¥åŸºäºŽå‚è€ƒèµ„æ–™ç»™å‡ºæ›´å‡†ç¡®ã€æ›´å®žæ—¶çš„å›žç­”ã€‚</p><p>åœ¨å¤§è¯­è¨€æ¨¡åž‹ï¼ˆLLMï¼‰çš„è§†è§’ä¸‹ï¼Œäººç±»çŸ¥è¯†è¢«åˆ†ä¸ºä¸¤ç§å½¢æ€ï¼š</p><ol><li><p><span style="color: #89986D; font-weight: bold;">å‚æ•°åŒ–è®°å¿†ï¼ˆParametric Memoryï¼‰ï¼šæŒ‡æ¨¡åž‹åœ¨é¢„è®­ç»ƒé˜¶æ®µé€šè¿‡æµ·é‡æ–‡æœ¬å­¦ä¹ åˆ°çš„ã€å›ºåŒ–åœ¨ç¥žç»å…ƒæƒé‡ï¼ˆParametersï¼‰ä¸­çš„çŸ¥è¯†ã€‚</span></p></li><li><p><span style="color: #89986D; font-weight: bold;">éžå‚æ•°åŒ–è®°å¿†ï¼ˆNon-parametric Memoryï¼‰ï¼šæŒ‡æ¨¡åž‹ä¹‹å¤–çš„ç»“æž„åŒ–æˆ–éžç»“æž„åŒ–çŸ¥è¯†åº“ï¼ˆå¦‚ç»´åŸºç™¾ç§‘ã€ä¼ä¸šç§æœ‰æ–‡æ¡£ï¼‰ã€‚</span></p></li></ol><p><strong>RAG</strong>çš„æœ¬è´¨ï¼Œå°±æ˜¯å°†è¿™ä¸¤ç§è®°å¿†ç»“åˆï¼Œé€šè¿‡ä¸€ä¸ª<strong>å¾®åˆ†è®¿é—®æœºåˆ¶ï¼ˆDifferentiable Access Mechanismï¼‰</strong>ï¼Œè®©æ¨¡åž‹åœ¨ç”Ÿæˆå›žç­”å‰ï¼Œå…ˆåŽ»â€œç¿»é˜…â€å¤–éƒ¨çš„éžå‚æ•°åŒ–è®°å¿†ã€‚</p><h4 id="rag-çš„æ•°å­¦å½¢å¼åŒ–å®šä¹‰"><a class="markdownIt-Anchor" href="#rag-çš„æ•°å­¦å½¢å¼åŒ–å®šä¹‰"></a> RAG çš„æ•°å­¦å½¢å¼åŒ–å®šä¹‰</h4><p>åœ¨åŽŸå§‹è®ºæ–‡ä¸­ï¼ˆå³æ¥è‡ªçš„ NeurIPS2020 çš„è‘—åè®ºæ–‡<span style="color: #BB8ED0;">Retrieval-Augmented Generation for Knowledge-Intensive NLP Tasks</span>ï¼‰ï¼ŒRAG è¢«å®šä¹‰ä¸ºä¸€ä¸ª<strong>éšå˜é‡æ¨¡åž‹ï¼ˆLatent Variable Modelï¼‰</strong>ã€‚</p><p>å‡è®¾ç”¨æˆ·è¾“å…¥ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span>ï¼Œç³»ç»Ÿæ£€ç´¢åˆ°çš„æ–‡æ¡£ç‰‡æ®µä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span>ï¼ˆä½œä¸ºéšå˜é‡ï¼‰ï¼Œæœ€ç»ˆç”Ÿæˆçš„ç­”æ¡ˆä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>ã€‚RAG çš„æ ¸å¿ƒç›®æ ‡æ˜¯è®¡ç®—åœ¨ç»™å®šè¾“å…¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> çš„æƒ…å†µä¸‹ï¼Œç”Ÿæˆè¾“å‡º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> çš„æ¡ä»¶æ¦‚çŽ‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>y</mi><mi mathvariant="normal">âˆ£</mi><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(y|x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord">âˆ£</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>ã€‚è¿™ä¸€è¿‡ç¨‹ç”±<span style="color: #BB8ED0; font-weight: bold;">æ£€ç´¢ç»„ä»¶ï¼ˆRetrieverï¼‰</span>å’Œ<span style="color: #BB8ED0; font-weight: bold;">ç”Ÿæˆç»„ä»¶ï¼ˆGeneratorï¼‰</span>ç»„æˆã€‚</p><h5 id="retriever"><a class="markdownIt-Anchor" href="#retriever"></a> Retriever</h5><p>æ£€ç´¢å™¨çš„ä»»åŠ¡æ˜¯è®¡ç®—ç»™å®šè¾“å…¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> æ—¶ï¼Œæ–‡æ¡£ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span> çš„è¢«é€‰ä¸­çš„æ¦‚çŽ‡ä¸ºï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>p</mi><mi>Î·</mi></msub><mo stretchy="false">(</mo><mi>z</mi><mi mathvariant="normal">âˆ£</mi><mi>x</mi><mo stretchy="false">)</mo><mo>âˆ</mo><mi>exp</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">(</mo><mi>z</mi><msup><mo stretchy="false">)</mo><mi mathvariant="normal">âŠ¤</mi></msup><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p_\eta(z|x) \propto \exp(d(z)^\top q(x))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">Î·</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mord">âˆ£</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.149108em;vertical-align:-0.25em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">âŠ¤</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p><p>å…¶ä¸­ï¼š</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>ï¼šæ˜¯ç”± BERT æž„å»ºçš„æŸ¥è¯¢ç¼–ç å™¨ï¼ˆQuery Encoderï¼‰ç”Ÿæˆçš„ç¨ å¯†å‘é‡ã€‚</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d(z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span></span></span></span>ï¼šæ˜¯ç”± BERT æž„å»ºçš„æ–‡æ¡£ç¼–ç å™¨ï¼ˆDocument Encoderï¼‰ç”Ÿæˆçš„æ–‡æ¡£å‘é‡ã€‚</li><li>æ­¤å…¬å¼æœ¬è´¨ä¸Šæ˜¯è®¡ç®—ä¸¤ä¸ªå‘é‡çš„<strong>ç‚¹ç§¯ç›¸ä¼¼åº¦</strong>ã€‚</li></ul><h5 id="generator"><a class="markdownIt-Anchor" href="#generator"></a> Generator</h5><p>ç”Ÿæˆå™¨çš„ä»»åŠ¡æ˜¯æ ¹æ®è¾“å…¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> å’Œæ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span>ï¼Œè®¡ç®—ç”Ÿæˆ token <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> çš„æ¦‚çŽ‡ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>p</mi><mi>Î¸</mi></msub><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mi mathvariant="normal">âˆ£</mi><mi>x</mi><mo separator="true">,</mo><mi>z</mi><mo separator="true">,</mo><msub><mi>y</mi><mrow><mn>1</mn><mo>:</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p_\theta(y_i | x, z, y_{1:i-1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">âˆ£</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>è¿™é€šå¸¸ç”±ä¸€ä¸ªé¢„è®­ç»ƒçš„ Seq2Seq æ¨¡åž‹ï¼ˆå¦‚è®ºæ–‡ä¸­çš„ BARTï¼‰æ¥å®Œæˆã€‚</p><h4 id="ä¸¤ç§-rag-å»ºæ¨¡èŒƒå¼"><a class="markdownIt-Anchor" href="#ä¸¤ç§-rag-å»ºæ¨¡èŒƒå¼"></a> ä¸¤ç§ RAG å»ºæ¨¡èŒƒå¼</h4><p>è®ºæ–‡æå‡ºäº†ä¸¤ç§å¤„ç†éšå˜é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span> çš„æ–¹å¼ï¼Œè¿™ç›´æŽ¥å†³å®šäº† RAG ç³»ç»Ÿçš„è¿è¡Œé€»è¾‘ã€‚</p><h5 id="rag-sequenceåºåˆ—åŒ–æ£€ç´¢å¢žå¼º"><a class="markdownIt-Anchor" href="#rag-sequenceåºåˆ—åŒ–æ£€ç´¢å¢žå¼º"></a> RAG-Sequenceï¼šåºåˆ—åŒ–æ£€ç´¢å¢žå¼º</h5><p>è¯¥æ¨¡åž‹å‡è®¾ä¸€æ•´ä¸ªåºåˆ—çš„ç”Ÿæˆåªä¾èµ–äºŽåŒä¸€ç¯‡æ–‡æ¡£ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span>ã€‚æ¨¡åž‹ä¼šå…ˆä¸ºæ¯ä¸ªæ£€ç´¢åˆ°çš„æ–‡æ¡£è®¡ç®—å®Œæ•´çš„ç”Ÿæˆæ¦‚çŽ‡ï¼Œæœ€åŽè¿›è¡ŒåŠ æƒæ±‚å’Œã€‚</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>p</mi><mtext>RAG-Sequence</mtext></msub><mo stretchy="false">(</mo><mi>y</mi><mi mathvariant="normal">âˆ£</mi><mi>x</mi><mo stretchy="false">)</mo><mo>â‰ˆ</mo><munder><mo>âˆ‘</mo><mrow><mi>z</mi><mo>âˆˆ</mo><mtext>top-k</mtext><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">(</mo><mo>â‹…</mo><mi mathvariant="normal">âˆ£</mi><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></munder><msub><mi>p</mi><mi>Î·</mi></msub><mo stretchy="false">(</mo><mi>z</mi><mi mathvariant="normal">âˆ£</mi><mi>x</mi><mo stretchy="false">)</mo><munderover><mo>âˆ</mo><mi>i</mi><mi>N</mi></munderover><msub><mi>p</mi><mi>Î¸</mi></msub><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mi mathvariant="normal">âˆ£</mi><mi>x</mi><mo separator="true">,</mo><mi>z</mi><mo separator="true">,</mo><msub><mi>y</mi><mrow><mn>1</mn><mo>:</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p_{\text{RAG-Sequence}}(y|x) \approx \sum_{z \in \text{top-k}(p(\cdot|x))} p_\eta(z|x) \prod_i^N p_\theta(y_i|x, z, y_{1:i-1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">RAG-Sequence</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord">âˆ£</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.344341em;vertical-align:-1.516005em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.808995em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="mrel mtight">âˆˆ</span><span class="mord text mtight"><span class="mord mtight">top-k</span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">p</span><span class="mopen mtight">(</span><span class="mord mtight">â‹…</span><span class="mord mtight">âˆ£</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.516005em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">Î·</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mord">âˆ£</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">âˆ£</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><h5 id="rag-tokentoken-çº§æ£€ç´¢å¢žå¼º"><a class="markdownIt-Anchor" href="#rag-tokentoken-çº§æ£€ç´¢å¢žå¼º"></a> RAG-Tokenï¼šToken çº§æ£€ç´¢å¢žå¼º</h5><p>è¯¥æ¨¡åž‹æ›´åŠ çµæ´»ï¼Œå…è®¸åœ¨ç”Ÿæˆæ¯ä¸€ä¸ªè¯ï¼ˆTokenï¼‰æ—¶ï¼Œéƒ½å‚è€ƒä¸åŒçš„æ–‡æ¡£ã€‚è¿™æ„å‘³ç€æœ€ç»ˆç”Ÿæˆçš„å¥å­å¯èƒ½æ˜¯ç”±å¤šç¯‡æ–‡æ¡£å…±åŒæ”¯æ’‘çš„ã€‚</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>p</mi><mtext>RAG-Token</mtext></msub><mo stretchy="false">(</mo><mi>y</mi><mi mathvariant="normal">âˆ£</mi><mi>x</mi><mo stretchy="false">)</mo><mo>â‰ˆ</mo><munderover><mo>âˆ</mo><mi>i</mi><mi>N</mi></munderover><munder><mo>âˆ‘</mo><mrow><mi>z</mi><mo>âˆˆ</mo><mtext>top-k</mtext><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">(</mo><mo>â‹…</mo><mi mathvariant="normal">âˆ£</mi><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></munder><msub><mi>p</mi><mi>Î·</mi></msub><mo stretchy="false">(</mo><mi>z</mi><mi mathvariant="normal">âˆ£</mi><mi>x</mi><mo stretchy="false">)</mo><msub><mi>p</mi><mi>Î¸</mi></msub><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mi mathvariant="normal">âˆ£</mi><mi>x</mi><mo separator="true">,</mo><mi>z</mi><mo separator="true">,</mo><msub><mi>y</mi><mrow><mn>1</mn><mo>:</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p_{\text{RAG-Token}}(y|x) \approx \prod_i^N \sum_{z \in \text{top-k}(p(\cdot|x))} p_\eta(z|x) p_\theta(y_i|x, z, y_{1:i-1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">RAG-Token</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord">âˆ£</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.344341em;vertical-align:-1.516005em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.808995em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="mrel mtight">âˆˆ</span><span class="mord text mtight"><span class="mord mtight">top-k</span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">p</span><span class="mopen mtight">(</span><span class="mord mtight">â‹…</span><span class="mord mtight">âˆ£</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.516005em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">Î·</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mord">âˆ£</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">âˆ£</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><h4 id="æŠ€æœ¯æµç¨‹"><a class="markdownIt-Anchor" href="#æŠ€æœ¯æµç¨‹"></a> æŠ€æœ¯æµç¨‹</h4><p>åŸºäºŽä¸Šè¿°åŽŸç†ï¼Œä¸€ä¸ªæ ‡å‡†çš„ RAG å·¥ä½œæµå¯ä»¥è¢«æ‹†è§£ä¸ºä»¥ä¸‹äº”ä¸ªæ­¥éª¤ï¼Œè¿™ä¹Ÿæ˜¯åŽç»­ç« èŠ‚æˆ‘ä»¬å°†ä½¿ç”¨ LangChain å®žçŽ°çš„æ ¸å¿ƒæµç¨‹ï¼š</p><ol><li><span style="color: #BB8ED0; font-weight: bold;">ç´¢å¼•ï¼ˆIndexingï¼‰</span>ï¼šå°†éžå‚æ•°åŒ–è®°å¿†ï¼ˆæ–‡æ¡£ï¼‰åˆ‡å—å¹¶è½¬åŒ–ä¸ºå‘é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d(z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span></span></span></span>ã€‚</li><li><span style="color: #BB8ED0; font-weight: bold;">æ£€ç´¢ï¼ˆRetrievalï¼‰</span>ï¼šæ ¹æ®ç”¨æˆ·æŸ¥è¯¢ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>ï¼Œåœ¨å‘é‡ç©ºé—´ä¸­å¯»æ‰¾æœ€ç›¸ä¼¼çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>o</mi><mi>p</mi><mo>âˆ’</mo><mi>K</mi></mrow><annotation encoding="application/x-tex">Top-K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal">o</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> ä¸ªæ–‡æ¡£ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span>ã€‚</li><li><span style="color: #BB8ED0; font-weight: bold;">å¢žå¼ºï¼ˆAugmentationï¼‰</span>ï¼šå°† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> ä¸Ž <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span> æ‹¼æŽ¥ï¼Œæž„å»ºå‡ºå†…å®¹ä¸°å¯Œçš„ Promptã€‚</li><li><span style="color: #BB8ED0; font-weight: bold;">ç”Ÿæˆï¼ˆGenerationï¼‰</span>ï¼šLLM åŸºäºŽå¢žå¼ºåŽçš„ä¿¡æ¯ï¼Œè®¡ç®— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>y</mi><mi mathvariant="normal">âˆ£</mi><mi>x</mi><mo separator="true">,</mo><mi>z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(y|x, z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord">âˆ£</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span></span></span></span> å¹¶è¾“å‡ºç­”æ¡ˆã€‚</li><li><span style="color: #BB8ED0; font-weight: bold;">å¼•ç”¨ï¼ˆCitationï¼‰</span>ï¼šç”±äºŽæˆ‘ä»¬å¯ä»¥è¿½è¸ªåˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span>ï¼Œç³»ç»Ÿå¯ä»¥ç»™å‡ºç­”æ¡ˆçš„å‡ºå¤„ï¼Œæ˜¾è‘—æå‡å¯ä¿¡åº¦ã€‚</li></ol><p>å¤§æ¦‚äº†è§£RAGä¹‹åŽï¼Œæˆ‘ä»¬æ¥æž„å»ºä¸€ä¸ªæœ€æœ€ç®€å•çš„åŸºäºŽLangChainçš„RAGåº”ç”¨çš„ä¾‹å­â¬‡ï¸</p><h3 id="infra"><a class="markdownIt-Anchor" href="#infra"></a> Infra</h3><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨Python + Postgresqlè¿›è¡Œæž„å»ºã€‚</p><p>é¦–å…ˆï¼Œéœ€è¦ä¸€ä¸ªå®‰è£…äº† <code>pgvector</code> æ‰©å±•çš„ PostgreSQL å®žä¾‹ã€‚å…ˆå®‰è£…<code>pgvector</code>ï¼Œä»¥æˆ‘çš„macä¸ºä¾‹ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install pgvector</span><br></pre></td></tr></table></figure><p>ç„¶åŽå¯¹æˆ‘ä»¬çš„ç›®æ ‡æ•°æ®åº“æ·»åŠ æ‹“å±•ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> EXTENSION IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> vector;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬éœ€è¦å®‰è£… LangChain çš„æ ¸å¿ƒåŒ…ã€PostgreSQL é©±åŠ¨ä»¥åŠé˜¿é‡Œé€šä¹‰çš„ SDKã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install langchain langchain-community langchain-postgres </span><br><span class="line">pip install psycopg2-binary dashscope</span><br></pre></td></tr></table></figure><p>å¤–åŠ ä¸€äº›æ–‡æ¡£åŠ è½½åº“</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pypdf docx2txt</span><br></pre></td></tr></table></figure><h3 id="æ•°æ®é¢„å¤„ç†å…¥åº“"><a class="markdownIt-Anchor" href="#æ•°æ®é¢„å¤„ç†å…¥åº“"></a> æ•°æ®é¢„å¤„ç†å…¥åº“</h3><p>è¿™ä¸€æ­¥å®žçŽ°äº† RAG åŽŸç†ä¸­çš„éžå‚æ•°åŒ–è®°å¿†ï¼ˆNon-parametric Memoryï¼‰æž„å»ºè¿‡ç¨‹ã€‚æˆ‘ä»¬éœ€è¦å°†åŽŸå§‹æ–‡æ¡£è½¬åŒ–ä¸ºæ£€ç´¢å™¨ï¼ˆRetrieverï¼‰å¯ä»¥è¯†åˆ«çš„å‘é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d(z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span></span></span></span>ã€‚</p><p>LangChain æä¾›äº†ä¸°å¯Œçš„ <code>document_loaders</code>ï¼Œä»¥æœ€å¸¸è§çš„txtã€pdfã€wordä¸ºä¾‹ï¼š</p><p><span style="color: #89986D; font-weight: bold;">txt</span></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_community.document_loaders <span class="keyword">import</span> TextLoader</span><br><span class="line"></span><br><span class="line">loader = TextLoader(<span class="string">&quot;./data/example.txt&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">txt_docs = loader.load()</span><br></pre></td></tr></table></figure><p><span style="color: #89986D; font-weight: bold;">pdf</span></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_community.document_loaders <span class="keyword">import</span> PyPDFLoader</span><br><span class="line"></span><br><span class="line">loader = PyPDFLoader(<span class="string">&quot;./data/example.pdf&quot;</span>)</span><br><span class="line">pdf_docs = loader.load()</span><br></pre></td></tr></table></figure><p><span style="color: #89986D; font-weight: bold;">word</span></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_community.document_loaders <span class="keyword">import</span> Docx2txtLoader</span><br><span class="line"></span><br><span class="line">loader = Docx2txtLoader(<span class="string">&quot;./data/example.docx&quot;</span>)</span><br><span class="line">word_docs = loader.load()</span><br></pre></td></tr></table></figure><p>ä¸ºäº†æ¼”ç¤ºï¼Œæˆ‘åœ¨ç½‘ä¸Šæ‰¾äº†æœ¬ç²¾ç¾Žçš„å®¶ç”¨èœè°±å¤§å…¨pdfï¼š</p><img src="/2026/01/09/langchainRAG/pdf.png" class="" title="sucessful"><p>çœ‹é¥¿äº†ã€‚</p><p>å¯¹äºŽä¸­æ–‡ RAGï¼Œæˆ‘ä»¬ä½¿ç”¨<span style="color: #BB8ED0; font-weight: bold;">BGE (BAAI General Embedding)</span>å¼€æºæ¨¡åž‹ï¼Œå…ˆä¸‹è½½ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install sentence-transformers</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ langchain åŠ è½½pdfæ–‡æ¡£ï¼Œåˆ‡åˆ†ï¼Œå¹¶å­˜å…¥æ•°æ®åº“ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_community.document_loaders <span class="keyword">import</span> PyPDFLoader</span><br><span class="line"><span class="keyword">from</span> langchain_text_splitters <span class="keyword">import</span> RecursiveCharacterTextSplitter</span><br><span class="line"><span class="keyword">from</span> langchain_community.embeddings <span class="keyword">import</span> HuggingFaceEmbeddings</span><br><span class="line"><span class="keyword">from</span> langchain_postgres.vectorstores <span class="keyword">import</span> PGVector</span><br><span class="line"></span><br><span class="line">FILE_PATH = <span class="string">&quot;/Users/fangtianyao/Downloads/å®¶åº­å®žç”¨èœè°±å¤§å…¨.pdf&quot;</span></span><br><span class="line">CONNECTION_STRING = <span class="string">&quot;postgresql+psycopg2://postgres:postgres@localhost:5432/rag&quot;</span></span><br><span class="line">COLLECTION_NAME = <span class="string">&quot;recipe_collection_bge&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="comment"># 1. åŠ è½½æœ¬åœ° Embedding æ¨¡åž‹ (BGE-small-zh)</span></span><br><span class="line">    embeddings = HuggingFaceEmbeddings(</span><br><span class="line">        model_name=<span class="string">&quot;BAAI/bge-small-zh-v1.5&quot;</span>,</span><br><span class="line">        model_kwargs=&#123;<span class="string">&#x27;device&#x27;</span>: <span class="string">&#x27;cpu&#x27;</span>&#125;,</span><br><span class="line">        encode_kwargs=&#123;<span class="string">&#x27;normalize_embeddings&#x27;</span>: <span class="literal">True</span>&#125;</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. åŠ è½½ PDF</span></span><br><span class="line">    loader = PyPDFLoader(FILE_PATH)</span><br><span class="line">    documents = loader.load()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. åˆ‡åˆ†æ–‡æ¡£</span></span><br><span class="line">    text_splitter = RecursiveCharacterTextSplitter(chunk_size=<span class="number">600</span>, chunk_overlap=<span class="number">50</span>)</span><br><span class="line">    chunks = text_splitter.split_documents(documents)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 4. å­˜å…¥ PostgreSQL</span></span><br><span class="line">    vector_store = PGVector.from_documents(</span><br><span class="line">        embedding=embeddings,</span><br><span class="line">        documents=chunks,</span><br><span class="line">        collection_name=COLLECTION_NAME,</span><br><span class="line">        connection=CONNECTION_STRING,</span><br><span class="line">        use_jsonb=<span class="literal">True</span>,</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>LangChainä¼šè‡ªåŠ¨åˆ›å»º <code>langchain_pg_embedding</code> å’Œ <code>langchain_pg_collection</code> ä¸¤ä¸ªæ•°æ®åº“ï¼Œå…¶ä¸­ <code>embedding</code> å­—æ®µä¼šè¢«å®šä¹‰ä¸º <code>vector</code> ç±»åž‹ã€‚</p><h3 id="ç®€å•çš„ragå¯¹è¯"><a class="markdownIt-Anchor" href="#ç®€å•çš„ragå¯¹è¯"></a> ç®€å•çš„RAGå¯¹è¯</h3><p>æˆ‘ä»¬å‚è€ƒæ–‡æ¡£<a href="https://docs.langchain.com/oss/python/integrations/chat/tongyi">https://docs.langchain.com/oss/python/integrations/chat/tongyi</a> ï¼ŒåŸºäºŽé˜¿é‡Œäº‘çš„ <span style="color: #BB8ED0; font-weight: bold;">ChatTongyi</span> æž„å»ºRAGæœåŠ¡ã€‚å¯ä»¥çœ‹åˆ°ï¼Œé˜¿é‡Œäº‘çš„æ¨¡åž‹å¯é€‰æ‹©æ€§å¾ˆé«˜ã€‚</p><img src="/2026/01/09/langchainRAG/aliyun.png" class="" title="sucessful"><p>ç”³è¯·ä¸€ä¸ªé˜¿é‡Œäº‘ç™¾ç‚¼çš„ API-Key ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°ã€‚æˆ‘ä»¬å…ˆæµ‹è¯•ä¸€ä¸‹LangChainè°ƒç”¨é˜¿é‡Œäº‘APIçš„èƒ½åŠ›ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> langchain_community.chat_models <span class="keyword">import</span> ChatTongyi</span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate</span><br><span class="line"><span class="keyword">from</span> langchain_core.output_parsers <span class="keyword">import</span> StrOutputParser</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½® API Key</span></span><br><span class="line">os.environ[<span class="string">&quot;DASHSCOPE_API_KEY&quot;</span>] = <span class="string">&quot;********&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå§‹åŒ–æ¨¡åž‹</span></span><br><span class="line">llm = ChatTongyi(model_name=<span class="string">&quot;qwen-max&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç®€å•çš„æµ‹è¯•é“¾è·¯</span></span><br><span class="line">prompt = ChatPromptTemplate.from_template(<span class="string">&quot;è®²ä¸ªå…³äºŽ&#123;topic&#125;çš„ç¬‘è¯&quot;</span>)</span><br><span class="line">chain = prompt | llm | StrOutputParser()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(chain.invoke(&#123;<span class="string">&quot;topic&quot;</span>: <span class="string">&quot;ç¨‹åºå‘˜&quot;</span>&#125;))</span><br></pre></td></tr></table></figure><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">å½“ç„¶å¯ä»¥ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªç¨‹åºå‘˜å¯èƒ½ä¼šä¼šå¿ƒä¸€ç¬‘çš„ç¬‘è¯ï¼š</span><br><span class="line"></span><br><span class="line">ä¸ºä»€ä¹ˆç¨‹åºå‘˜ä¸å–œæ¬¢åœ¨æˆ·å¤–å·¥ä½œï¼Ÿ</span><br><span class="line">å› ä¸ºé‚£é‡Œæœ‰å¤ªå¤šçš„ bugsï¼ˆè™«å­/é”™è¯¯ï¼‰ï¼</span><br><span class="line"></span><br><span class="line">è¿™é‡Œçš„â€œbugsâ€ä¸€è¯åŒå…³ï¼Œæ—¢æŒ‡è‡ªç„¶ç•Œä¸­çš„æ˜†è™«ï¼Œä¹ŸæŒ‡ç¼–ç¨‹ä¸­é‡åˆ°çš„ç¨‹åºé”™è¯¯ã€‚å¸Œæœ›è¿™ä¸ªå°ç¬‘è¯èƒ½ç»™ä½ å¸¦æ¥ä¸€ä¸è½»æ¾å’Œå¿«ä¹ï¼</span><br></pre></td></tr></table></figure><p>å¥½æ— èŠçš„ç¬‘è¯â€¦â€¦ï¼Œä¸è¿‡è‡³å°‘è¯æ˜Žæˆ‘ä»¬æµ‹è¯•æˆåŠŸäº†ï¼é‚£ä¹ˆçŽ°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥å¼•å…¥ä¹‹å‰æž„å»ºçš„å‘é‡æ•°æ®åº“ã€‚å¯¼å…¥åŒ…ï¼Œè¿žæŽ¥æ•°æ®åº“ï¼Œå¹¶åˆå§‹åŒ–å’Œå…¥åº“æ—¶ä¸€è‡´çš„ Embedding æ¨¡åž‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> langchain_community.chat_models <span class="keyword">import</span> ChatTongyi</span><br><span class="line"><span class="keyword">from</span> langchain_postgres.vectorstores <span class="keyword">import</span> PGVector</span><br><span class="line"><span class="keyword">from</span> langchain_community.embeddings <span class="keyword">import</span> HuggingFaceEmbeddings</span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate</span><br><span class="line"><span class="keyword">from</span> langchain_core.output_parsers <span class="keyword">import</span> StrOutputParser</span><br><span class="line"><span class="keyword">from</span> langchain_core.runnables <span class="keyword">import</span> RunnablePassthrough</span><br><span class="line"></span><br><span class="line">os.environ[<span class="string">&quot;DASHSCOPE_API_KEY&quot;</span>] = <span class="string">&quot;******&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•°æ®åº“é…ç½®</span></span><br><span class="line">CONNECTION_STRING = <span class="string">&quot;postgresql+psycopg2://postgres:postgres@localhost:5432/rag&quot;</span></span><br><span class="line">COLLECTION_NAME = <span class="string">&quot;recipe_collection_bge&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå§‹åŒ– Embedding æ¨¡åž‹</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æ­£åœ¨åŠ è½½æœ¬åœ° BGE æ¨¡åž‹...&quot;</span>)</span><br><span class="line">embeddings = HuggingFaceEmbeddings(</span><br><span class="line">    model_name=<span class="string">&quot;BAAI/bge-small-zh-v1.5&quot;</span>,</span><br><span class="line">    model_kwargs=&#123;<span class="string">&#x27;device&#x27;</span>: <span class="string">&#x27;cpu&#x27;</span>&#125;,</span><br><span class="line">    encode_kwargs=&#123;<span class="string">&#x27;normalize_embeddings&#x27;</span>: <span class="literal">True</span>&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿žæŽ¥çŽ°æœ‰çš„å‘é‡æ•°æ®åº“</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æ­£åœ¨è¿žæŽ¥æ•°æ®åº“é›†åˆ: <span class="subst">&#123;COLLECTION_NAME&#125;</span>...&quot;</span>)</span><br><span class="line">vector_store = PGVector(</span><br><span class="line">    connection=CONNECTION_STRING,</span><br><span class="line">    embeddings=embeddings,</span><br><span class="line">    collection_name=COLLECTION_NAME,</span><br><span class="line">    use_jsonb=<span class="literal">True</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºæ£€ç´¢å™¨ (Retriever)</span></span><br><span class="line">retriever = vector_store.as_retriever(search_kwargs=&#123;<span class="string">&quot;k&quot;</span>: <span class="number">3</span>&#125;)</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ <code>retriever = vector_store.as_retriever(search_kwargs=&#123;&quot;k&quot;: 3&#125;)</code> åˆ›å»ºäº†æ£€ç´¢å™¨ï¼Œè€Œå‚æ•° <code>&quot;k&quot;: 3</code> ä»£è¡¨äº†è¡¨ç¤ºæ¯æ¬¡æ£€ç´¢æœ€ç›¸ä¼¼çš„ 3 æ¡è®°å½•ã€‚éšåŽï¼Œå®šä¹‰ LLM å’Œ Promptï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®šä¹‰ LLM å’Œ Prompt (LCEL é£Žæ ¼) </span></span><br><span class="line"><span class="comment"># åˆå§‹åŒ–é€šä¹‰åƒé—® (Qwen-Max)</span></span><br><span class="line">llm = ChatTongyi(model_name=<span class="string">&quot;qwen-max&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼–å†™æç¤ºè¯æ¨¡æ¿</span></span><br><span class="line">template = <span class="string">&quot;&quot;&quot;ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ™ºèƒ½å¤§åŽ¨ã€‚è¯·åŸºäºŽä¸‹é¢çš„ã€å‚è€ƒèµ„æ–™ã€‘å›žç­”ç”¨æˆ·çš„é—®é¢˜ã€‚</span></span><br><span class="line"><span class="string">å¦‚æžœå‚è€ƒèµ„æ–™é‡Œæ²¡æœ‰æåˆ°çš„å†…å®¹ï¼Œè¯·è¯šå®žåœ°è¯´â€œèµ„æ–™ä¸­æœªæåŠâ€ï¼Œä¸è¦ç¼–é€ ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ã€å‚è€ƒèµ„æ–™ã€‘ï¼š</span></span><br><span class="line"><span class="string">&#123;context&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ã€ç”¨æˆ·é—®é¢˜ã€‘ï¼š</span></span><br><span class="line"><span class="string">&#123;question&#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">prompt = ChatPromptTemplate.from_template(template)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾…åŠ©å‡½æ•°ï¼šå°†æ£€ç´¢åˆ°çš„æ–‡æ¡£åˆ—è¡¨åˆå¹¶æˆä¸€ä¸ªå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">format_docs</span>(<span class="params">docs</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;\n\n&quot;</span>.join([doc.page_content <span class="keyword">for</span> doc <span class="keyword">in</span> docs])</span><br></pre></td></tr></table></figure><p>æž„å»º RAG é“¾ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">rag_chain = (</span><br><span class="line">    &#123;<span class="string">&quot;context&quot;</span>: retriever | format_docs, <span class="string">&quot;question&quot;</span>: RunnablePassthrough()&#125;</span><br><span class="line">    | prompt</span><br><span class="line">    | llm</span><br><span class="line">    | StrOutputParser()</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯æœ€é‡è¦çš„ä¸€æ­¥ã€‚ä¸Šè¿°ä»£ç ä½¿ç”¨çš„æ˜¯ <strong>LCELï¼ˆLangChain Expression Languageï¼Œè¡¨è¾¾å¼è¯­è¨€ï¼‰</strong>ï¼Œ<code>|</code> ç¬¦å·pipelineä¸­æ¯ä¸€é“å·¥åºçš„é—´éš”ã€‚æˆ‘ä»¬æŠŠè¿™ä¸ªé“¾æ‹†è§£æˆä¸‰ä¸ªé˜¶æ®µï¼š</p><p><span style="color: #89986D; font-weight: bold;">STEP1 æ•°æ®å¹¶è¡Œå¤„ç†</span>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;context&quot;</span>: retriever | format_docs, <span class="string">&quot;question&quot;</span>: RunnablePassthrough()&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸€éƒ¨åˆ†æ˜¯ä¸€ä¸ªå­—å…¸ã€‚å½“ä½ è°ƒç”¨ <code>rag_chain.invoke(&quot;å¦‚ä½•åšçº¢çƒ§è‚‰ï¼Ÿ&quot;)</code> æ—¶ï¼Œè¿™ä¸ªåˆå§‹å­—ç¬¦ä¸²ä¼š<strong>åŒæ—¶</strong>å–‚ç»™ä¸¤ä¸ªåˆ†æ”¯ï¼š</p><ul><li><strong><code>question</code> åˆ†æ”¯</strong>ï¼š<ul><li><code>RunnablePassthrough()</code> ä¸å¯¹è¾“å…¥åšä»»ä½•å¤„ç†ï¼Œç›´æŽ¥æŠŠâ€œå¦‚ä½•åšçº¢çƒ§è‚‰ï¼Ÿâ€åŽŸæ ·ä¼ ç»™ <code>question</code> å­—æ®µã€‚</li></ul></li><li><strong><code>context</code> åˆ†æ”¯</strong>ï¼ˆè¿™æ˜¯ä¸€ä¸ªå­é“¾ï¼‰ï¼š<ul><li><strong>ç¬¬ä¸€æ­¥</strong>ï¼š<code>retriever</code> æŽ¥æ”¶åˆ°é—®é¢˜ï¼ŒåŽ» PostgreSQL å‘é‡åº“é‡Œå¯»æ‰¾æœ€ç›¸ä¼¼çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> ä¸ªæ–‡æ¡£ç‰‡æ®µï¼ˆæ­¤æ—¶è¾“å‡ºçš„æ˜¯ä¸€ä¸ª <code>Document</code> å¯¹è±¡åˆ—è¡¨ï¼‰ã€‚</li><li><strong>ç¬¬äºŒæ­¥</strong>ï¼šé€šè¿‡ <code>|</code> ä¼ ç»™ <code>format_docs</code> å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°æŠŠå¤šä¸ªæ–‡æ¡£å¯¹è±¡é‡Œçš„æ–‡å­—æç‚¼å‡ºæ¥ï¼Œæ‹¼æŽ¥æˆä¸€ä¸ªå¤§å­—ç¬¦ä¸²ã€‚</li><li>æœ€ç»ˆ <code>context</code> å­—æ®µå¾—åˆ°äº†åº“é‡Œçš„èœè°±çŸ¥è¯†ã€‚</li></ul></li></ul><p><span style="color: #89986D; font-weight: bold;">STEP2 æŽ¨ç†</span></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">... </span>| prompt | llm</span><br></pre></td></tr></table></figure><ul><li><strong>æ³¨å…¥ Prompt (<code>| prompt</code>)</strong>ï¼š<ul><li>æ­¤æ—¶ï¼Œå‰é¢çš„è¾“å‡ºæ˜¯ä¸€ä¸ªå­—å…¸ï¼š<code>&#123;&quot;context&quot;: &quot;...&quot;, &quot;question&quot;: &quot;å¦‚ä½•åšçº¢çƒ§è‚‰ï¼Ÿ&quot;&#125;</code>ã€‚<code>ChatPromptTemplate</code> ä¼šè‡ªåŠ¨å¯»æ‰¾å¯¹åº”çš„å˜é‡ï¼ŒæŠŠå®ƒä»¬å¡«å…¥ä½ å®šä¹‰çš„æ¨¡æ¿ä¸­ï¼Œç”Ÿæˆä¸€æ®µå‘ç»™ AI çš„å®Œæ•´æŒ‡ä»¤ã€‚</li></ul></li><li><strong>è°ƒç”¨å¤§æ¨¡åž‹ (<code>| llm</code>)</strong>ï¼š<ul><li>å°†å¡«å……å¥½çš„æŒ‡ä»¤ä¼ ç»™é€šä¹‰åƒé—® <code>ChatTongyi</code>ã€‚</li></ul></li></ul><p><span style="color: #89986D; font-weight: bold;">STEP3 è¾“å‡ºè§£æž</span>ï¼š</p> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">... </span>| StrOutputParser()</span><br></pre></td></tr></table></figure><p><code>StrOutputParser()</code> ä¼šä»ŽLLMè¿”å›žçš„ <code>AIMessage</code> å¯¹è±¡ä¸­æå– <code>content</code> å±žæ€§ã€‚</p><p>æœ€åŽï¼Œåªè¦è°ƒç”¨ <code>rag_chain.stream()</code>ï¼Œå°±èƒ½èŽ·å¾—æµå¼è¾“å‡ºçš„å›žç­”ã€‚ç»™å‡ºå®Œæ•´çš„ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> langchain_community.chat_models <span class="keyword">import</span> ChatTongyi</span><br><span class="line"><span class="keyword">from</span> langchain_postgres.vectorstores <span class="keyword">import</span> PGVector</span><br><span class="line"><span class="keyword">from</span> langchain_community.embeddings <span class="keyword">import</span> HuggingFaceEmbeddings</span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate</span><br><span class="line"><span class="keyword">from</span> langchain_core.output_parsers <span class="keyword">import</span> StrOutputParser</span><br><span class="line"><span class="keyword">from</span> langchain_core.runnables <span class="keyword">import</span> RunnablePassthrough</span><br><span class="line"></span><br><span class="line">os.environ[<span class="string">&quot;DASHSCOPE_API_KEY&quot;</span>] = <span class="string">&quot;sk-873463eacac84219b830314fb5f10992&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•°æ®åº“é…ç½®</span></span><br><span class="line">CONNECTION_STRING = <span class="string">&quot;postgresql+psycopg2://postgres:postgres@localhost:5432/rag&quot;</span></span><br><span class="line">COLLECTION_NAME = <span class="string">&quot;recipe_collection_bge&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå§‹åŒ– Embedding æ¨¡åž‹</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æ­£åœ¨åŠ è½½æœ¬åœ° BGE æ¨¡åž‹...&quot;</span>)</span><br><span class="line">embeddings = HuggingFaceEmbeddings(</span><br><span class="line">    model_name=<span class="string">&quot;BAAI/bge-small-zh-v1.5&quot;</span>,</span><br><span class="line">    model_kwargs=&#123;<span class="string">&#x27;device&#x27;</span>: <span class="string">&#x27;cpu&#x27;</span>&#125;,</span><br><span class="line">    encode_kwargs=&#123;<span class="string">&#x27;normalize_embeddings&#x27;</span>: <span class="literal">True</span>&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿žæŽ¥çŽ°æœ‰çš„å‘é‡æ•°æ®åº“</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æ­£åœ¨è¿žæŽ¥æ•°æ®åº“é›†åˆ: <span class="subst">&#123;COLLECTION_NAME&#125;</span>...&quot;</span>)</span><br><span class="line">vector_store = PGVector(</span><br><span class="line">    connection=CONNECTION_STRING,</span><br><span class="line">    embeddings=embeddings,</span><br><span class="line">    collection_name=COLLECTION_NAME,</span><br><span class="line">    use_jsonb=<span class="literal">True</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºæ£€ç´¢å™¨ (Retriever)</span></span><br><span class="line"><span class="comment"># k=3 è¡¨ç¤ºæ¯æ¬¡æ£€ç´¢æœ€ç›¸ä¼¼çš„ 3 æ¡èœè°±</span></span><br><span class="line">retriever = vector_store.as_retriever(search_kwargs=&#123;<span class="string">&quot;k&quot;</span>: <span class="number">3</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰ LLM å’Œ Prompt (LCEL é£Žæ ¼) </span></span><br><span class="line"><span class="comment"># åˆå§‹åŒ–é€šä¹‰åƒé—® (Qwen-Max)</span></span><br><span class="line">llm = ChatTongyi(model_name=<span class="string">&quot;qwen-max&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼–å†™æç¤ºè¯æ¨¡æ¿</span></span><br><span class="line">template = <span class="string">&quot;&quot;&quot;ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ™ºèƒ½å¤§åŽ¨ã€‚è¯·åŸºäºŽä¸‹é¢çš„ã€å‚è€ƒèµ„æ–™ã€‘å›žç­”ç”¨æˆ·çš„é—®é¢˜ã€‚</span></span><br><span class="line"><span class="string">å¦‚æžœå‚è€ƒèµ„æ–™é‡Œæ²¡æœ‰æåˆ°çš„å†…å®¹ï¼Œè¯·è¯šå®žåœ°è¯´â€œèµ„æ–™ä¸­æœªæåŠâ€ï¼Œä¸è¦ç¼–é€ ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ã€å‚è€ƒèµ„æ–™ã€‘ï¼š</span></span><br><span class="line"><span class="string">&#123;context&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ã€ç”¨æˆ·é—®é¢˜ã€‘ï¼š</span></span><br><span class="line"><span class="string">&#123;question&#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">prompt = ChatPromptTemplate.from_template(template)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾…åŠ©å‡½æ•°ï¼šå°†æ£€ç´¢åˆ°çš„æ–‡æ¡£åˆ—è¡¨åˆå¹¶æˆä¸€ä¸ªå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">format_docs</span>(<span class="params">docs</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;\n\n&quot;</span>.join([doc.page_content <span class="keyword">for</span> doc <span class="keyword">in</span> docs])</span><br><span class="line"></span><br><span class="line"><span class="comment"># æž„å»º RAG é“¾ (The Chain) </span></span><br><span class="line">rag_chain = (</span><br><span class="line">    &#123;<span class="string">&quot;context&quot;</span>: retriever | format_docs, <span class="string">&quot;question&quot;</span>: RunnablePassthrough()&#125;</span><br><span class="line">    | prompt</span><br><span class="line">    | llm</span><br><span class="line">    | StrOutputParser()</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰§è¡Œå¯¹è¯</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        question = <span class="built_in">input</span>(<span class="string">&quot;\nè¯·é—®æœ‰ä»€ä¹ˆå¯ä»¥å¸®æ‚¨: &quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> question.lower() <span class="keyword">in</span> [<span class="string">&quot;quit&quot;</span>, <span class="string">&quot;exit&quot;</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\næ­£åœ¨æ€è€ƒå¹¶æ£€ç´¢æ•°æ®åº“...&quot;</span>, end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># ä½¿ç”¨æµå¼è¾“å‡º (Stream) æå‡ä½“éªŒ</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;\nå›žç­”: &quot;</span>, end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">            <span class="keyword">for</span> chunk <span class="keyword">in</span> rag_chain.stream(question):</span><br><span class="line">                <span class="built_in">print</span>(chunk, end=<span class="string">&quot;&quot;</span>, flush=<span class="literal">True</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\nå‘ç”Ÿé”™è¯¯: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>è¯¢é—®ä»–èœè°±ä¸­çš„èœâ€œæ¯›è›¤æ‹Œè èœâ€æ€Žä¹ˆåšï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">è¯·é—®æœ‰ä»€ä¹ˆå¯ä»¥å¸®æ‚¨: æˆ‘æƒ³åˆ¶ä½œæ¯›è›¤æ‹Œè èœ</span><br><span class="line"></span><br><span class="line">æ­£åœ¨æ€è€ƒå¹¶æ£€ç´¢æ•°æ®åº“...</span><br><span class="line">å›žç­”: æ‚¨æƒ³åˆ¶ä½œçš„æ˜¯â€œæ¯›è›¤æ‹Œè èœâ€ã€‚æ ¹æ®æä¾›çš„å‚è€ƒèµ„æ–™ï¼Œä¸‹é¢æ˜¯å…·ä½“çš„æ­¥éª¤ï¼š</span><br><span class="line"></span><br><span class="line">### ææ–™</span><br><span class="line">- æ¯›è›¤Â·250å…‹</span><br><span class="line">- è èœÂ·250å…‹</span><br><span class="line">- ç”Ÿå§œÂ·1å°å—</span><br><span class="line">- å¤§è’œÂ·4ç“£</span><br><span class="line"></span><br><span class="line">### è°ƒæ–™</span><br><span class="line">- é¦™æ²¹Â·2å°åŒ™</span><br><span class="line">- é¦™é†‹Â·1å°åŒ™</span><br><span class="line">- ç²¾ç›Â·1å°åŒ™</span><br><span class="line">- å‘³ç²¾Â· å°åŒ™</span><br><span class="line"></span><br><span class="line">### åšæ³•</span><br><span class="line">1. **å‡†å¤‡ææ–™**ï¼šé¦–å…ˆå°†æ¯›è›¤ç…®ç†ŸåŽå–å‡ºè‚‰å¤‡ç”¨ï¼›åŒæ—¶å°†ç”Ÿå§œå’Œå¤§è’œæ¸…æ´—å¹²å‡€åŽåˆ‡æˆæœ«ã€‚</span><br><span class="line">2. **å¤„ç†è èœ**ï¼šå°†è èœæ‹©æ´—å¹²å‡€ï¼Œç„¶åŽæ”¾å…¥æ²¸æ°´ä¸­ç„¯çƒ«ç‰‡åˆ»ã€‚ä¹‹åŽç”¨å‡‰æ°´å†²å‡‰ä»¥åŽ»é™¤å¤šä½™çš„çƒ­é‡ï¼Œå¹¶ä¸”æ²¥å¹²æ°´åˆ†åŽåˆ‡æˆæ®µã€‚</span><br><span class="line">3. **è°ƒæ‹Œ**ï¼šå°†å¤„ç†å¥½çš„æ¯›è›¤ã€åˆ‡å¥½çš„è èœä»¥åŠä¹‹å‰å‡†å¤‡çš„è°ƒæ–™ï¼ˆåŒ…æ‹¬ç›ã€é¦™é†‹ã€å‘³ç²¾ã€é¦™æ²¹ã€å§œæœ«å’Œè’œæœ«ï¼‰æ··åˆåœ¨ä¸€èµ·å……åˆ†æ…æ‹Œå‡åŒ€ã€‚</span><br><span class="line">4. **å®Œæˆ**ï¼šæœ€åŽå°†è°ƒæ‹Œå¥½çš„é£Ÿæè£…ç›˜å³å¯äº«ç”¨ã€‚</span><br><span class="line"></span><br><span class="line">æŒ‰ç…§ä»¥ä¸Šæ­¥éª¤æ“ä½œï¼Œæ‚¨å°±èƒ½åšå‡ºä¸€é“å‘³é“é²œç¾Žã€æ¸…æ·¡çˆ½å£çš„æ¯›è›¤æ‹Œè èœäº†ã€‚å¸Œæœ›è¿™å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ï¼</span><br></pre></td></tr></table></figure><p>å¯¹æ¯”èœè°±ä¸­çš„åšæ³•ï¼š</p><img src="/2026/01/09/langchainRAG/maoge.png" class="" title="sucessful"><p>éžå¸¸æˆåŠŸâœŒï¸</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;å°è¯•ä½¿ç”¨LangChainæ¥å®žçŽ°RAGï¼ˆæ£€ç´¢å¢žå¼ºç”Ÿæˆï¼‰åŠŸèƒ½ã€‚&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>è®ºæ–‡ç²¾è¯» DyGLIP: A Dynamic Graph Model with Link Prediction forAccurate Multi-Camera Multiple Object Tracking</title>
    <link href="https://atffang.github.io/2025/12/29/DyGLIP/"/>
    <id>https://atffang.github.io/2025/12/29/DyGLIP/</id>
    <published>2025-12-29T06:53:15.000Z</published>
    <updated>2025-12-29T07:10:15.387Z</updated>
    
    <content type="html"><![CDATA[<p>è®ºæ–‡ç²¾è¯» DyGLIP: A Dynamic Graph Model with Link Prediction forAccurate Multi-Camera Multiple Object Tracking</p><span id="more"></span><h1 id="dyglip-a-dynamic-graph-model-with-link-prediction-for-accurate-multi-camera-multiple-object-tracking"><a class="markdownIt-Anchor" href="#dyglip-a-dynamic-graph-model-with-link-prediction-for-accurate-multi-camera-multiple-object-tracking"></a> DyGLIP: A Dynamic Graph Model With Link Prediction for Accurate Multi-Camera Multiple Object Tracking</h1><p><strong>ä½œè€…</strong>ï¼šKha Gia Quach, Pha Nguyen, Huu Le<br />CVPR 2021</p><h2 id="ä»»åŠ¡å®šä¹‰ä¸Žæ•´ä½“æ€è·¯"><a class="markdownIt-Anchor" href="#ä»»åŠ¡å®šä¹‰ä¸Žæ•´ä½“æ€è·¯"></a> ä»»åŠ¡å®šä¹‰ä¸Žæ•´ä½“æ€è·¯</h2><h3 id="é—®é¢˜èƒŒæ™¯ä¸Žä»»åŠ¡å®šä¹‰"><a class="markdownIt-Anchor" href="#é—®é¢˜èƒŒæ™¯ä¸Žä»»åŠ¡å®šä¹‰"></a> é—®é¢˜èƒŒæ™¯ä¸Žä»»åŠ¡å®šä¹‰</h3><p>æœ¬ç ”ç©¶èšç„¦äºŽè®¡ç®—æœºè§†è§‰é¢†åŸŸä¸­çš„æ ¸å¿ƒéš¾é¢˜â€”â€”<strong>å¤šæ‘„åƒå¤´å¤šç›®æ ‡è·Ÿè¸ª (Multi-Camera Multiple Object Tracking, MC-MOT)</strong> ã€‚è¯¥ä»»åŠ¡çš„ç›®æ ‡æ˜¯åœ¨ä¸€ä¸ªç”±å¤šä¸ªæ‘„åƒå¤´ç»„æˆçš„ç›‘æŽ§ç½‘ç»œä¸­ï¼ŒåŒæ—¶é”å®šå¹¶è·Ÿè¸ªæ‰€æœ‰ç›®æ ‡çš„å…¨å±€è¿åŠ¨è½¨è¿¹ ã€‚åœ¨ MC-MOT çš„æµæ°´çº¿ä¸­ï¼Œå°½ç®¡å•æ‘„åƒå¤´è·Ÿè¸ªå·²ç»å–å¾—äº†é•¿è¶³è¿›æ­¥ï¼Œä½†<strong>æ•°æ®å…³è”</strong> (Data Association) ä»ç„¶æ˜¯æœ€å…·æŒ‘æˆ˜æ€§çš„çŽ¯èŠ‚ï¼Œç³»ç»Ÿé¢ä¸´ç€æžç«¯çš„çŽ¯å¢ƒæŒ‘æˆ˜ï¼š</p><ul><li><strong>å¤–è§‚ä¸€è‡´æ€§ç ´å</strong>ï¼š å½“ç›®æ ‡åœ¨ä¸åŒæ‘„åƒå¤´ä¹‹é—´ç§»åŠ¨æ—¶ï¼Œå…‰ç…§æ¡ä»¶çš„ä¸ä¸€è‡´ï¼ˆå¦‚ä»Žå®¤å†…åˆ°å®¤å¤–ï¼‰ä¼šå¯¼è‡´åŒä¸€ç›®æ ‡çš„ç‰¹å¾å‘é‡å‘ç”Ÿå‰§çƒˆå˜åŒ– ã€‚</li><li><strong>éžé‡å è§†åŸŸ (Non-overlapping FOVs)</strong>ï¼š æ‘„åƒå¤´ä¹‹é—´å¯èƒ½å­˜åœ¨ç›²åŒºï¼Œå¯¼è‡´ç›®æ ‡è½¨è¿¹ä¸­æ–­ï¼Œä¸”æ— æ³•é€šè¿‡å‡ ä½•é‡å ç›´æŽ¥åŒ¹é… ã€‚</li><li><strong>é®æŒ¡ä¸Žè¿åŠ¨æ¨¡å¼å·®å¼‚</strong>ï¼š ç›®æ ‡çš„è¿åŠ¨æ¨¡å¼å¤šå˜ï¼Œä¸”ç»å¸¸å‘ç”Ÿè½¨è¿¹é®æŒ¡ ã€‚</li></ul><p>ä¼ ç»Ÿçš„ä¾èµ–çŽ°æˆæ£€æµ‹å™¨æˆ– ReID æ¨¡åž‹æå–é™æ€ç‰¹å¾å‘é‡çš„æ–¹æ³•ï¼Œåœ¨è¿™äº›å¤æ‚åœºæ™¯ä¸‹å¾€å¾€å¤±æ•ˆï¼Œå¯¼è‡´èº«ä»½ï¼ˆIDï¼‰åˆ†é…é”™è¯¯ ã€‚å› æ­¤ï¼Œæœ¬ä»»åŠ¡çš„æ ¸å¿ƒç›®æ ‡æ˜¯ï¼š</p><ul><li><span style="color: #89986D; font-weight: bold;">è®¾è®¡ä¸€ç§é²æ£’çš„æ•°æ®å…³è”æœºåˆ¶ï¼Œèƒ½å¤Ÿé€‚åº”åŠ¨æ€å˜åŒ–çš„ç‰¹å¾è¡¨ç¤ºï¼Œå¹¶ä¼˜é›…åœ°è§£å†³è·¨æ‘„åƒå¤´ï¼ˆæ— è®ºæ˜¯å¦é‡å ï¼‰çš„ç›®æ ‡èº«ä»½åŒ¹é…é—®é¢˜ã€‚</span></li></ul><h3 id="æ•´ä½“è§£å†³æ€è·¯"><a class="markdownIt-Anchor" href="#æ•´ä½“è§£å†³æ€è·¯"></a> æ•´ä½“è§£å†³æ€è·¯</h3><p>DyGLIP æ‘’å¼ƒäº†ä¼ ç»Ÿæ–¹æ³•ä¸­å¸¸ç”¨çš„é™æ€èšç±»ï¼ˆClusteringï¼‰æˆ–çŸ©é˜µåˆ†è§£ï¼ˆMatrix Factorizationï¼‰æ€è·¯ ï¼Œæå‡ºäº†ä¸€ç§å…¨æ–°çš„è§†è§’ï¼š</p><ul><li><span style="color: #89986D; font-weight: bold;">å°†æ•°æ®å…³è”é—®é¢˜é‡æž„ä¸ºåŠ¨æ€å›¾ä¸Šçš„é“¾è·¯é¢„æµ‹é—®é¢˜ (Link Prediction on a Dynamic Graph) ã€‚</span><br />æˆ‘ä»¬åˆ†ä¸‰ä¸ªä¸»è¦åˆ›æ–°ç‚¹çœ‹å¾…è¿™ä¸ªè§†è§’ã€‚</li></ul><p>é¦–å…ˆæ˜¯ <span style="color: #BB8ED0; font-weight: bold;">åŠ¨æ€å›¾æ¼”åŒ–</span> ã€‚ç³»ç»Ÿä¸å†æž„å»ºä¸€ä¸ªå›ºå®šçš„å…¨å±€å›¾ï¼Œè€Œæ˜¯ç»´æŠ¤ä¸€ä¸ªéšæ—¶é—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span></span></span></span> æ¼”åŒ–çš„<strong>åŠ¨æ€å›¾</strong>ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi mathvariant="script">G</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mo stretchy="false">(</mo><msup><mi mathvariant="script">V</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup><mo separator="true">,</mo><msup><mi mathvariant="script">E</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{G}^{(t)}=(\mathcal{V}^{(t)},\mathcal{E}^{(t)})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.03522em;vertical-align:-0.09722em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.0593em;">G</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">V</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.08944em;">E</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><ul><li><span style="color: #57595B; font-weight: bold;">å›¾çš„é¡¶ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="script">V</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\mathcal{V}^{(t)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">V</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span> ä»£è¡¨äº†æˆªè‡³å½“å‰æ—¶åˆ»æ‰€æœ‰å·²çŸ¥çš„ Trackletsï¼ˆçŸ­è½¨è¿¹ï¼‰ã€‚åœ¨æ¯ä¸€ä¸ªæ—¶é—´æ­¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span></span></span></span>ï¼Œå•æ‘„åƒå¤´è·Ÿè¸ªå™¨ï¼ˆå¦‚ DeepSORTï¼‰äº§ç”Ÿçš„æ–° Tracklets ä¼šä½œä¸ºæ–°èŠ‚ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="script">N</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\mathcal{N}^{(t)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span> åŠ å…¥å›¾ä¸­ã€‚</span></li><li><span style="color: #57595B; font-weight: bold;">ä»»åŠ¡è½¬åŒ–ä¸ºé¢„æµ‹æ–°åŠ å…¥çš„èŠ‚ç‚¹ä¸Žå›¾ä¸­å·²æœ‰èŠ‚ç‚¹ä¹‹é—´æ˜¯å¦å­˜åœ¨è¾¹ï¼ˆEdgeï¼‰ã€‚å¦‚æžœè¾¹å­˜åœ¨ï¼Œåˆ™æ„å‘³ç€å®ƒä»¬å±žäºŽåŒä¸€ç›®æ ‡ ã€‚</span></li></ul><p>å…¶æ¬¡æ˜¯ <span style="color: #BB8ED0; font-weight: bold;">åŠ¨æ€å›¾æ³¨æ„åŠ›æœºåˆ¶</span> ã€‚DyGLIP è®¤ä¸ºç›´æŽ¥ä½¿ç”¨åŽŸå§‹æ£€æµ‹ç‰¹å¾è¿›è¡Œå…³è”æ˜¯ä¸å¯é çš„ ã€‚è¯¥æ¨¡åž‹å¼•å…¥äº†ä¸€ä¸ª<strong>åŠ¨æ€å›¾æ³¨æ„åŠ›æœºåˆ¶ (Dynamic Graph with Self-Attention)</strong>ï¼ŒåŒ…å«ä¸¤ä¸ªå…³é”®æ¨¡å—ï¼š</p><ul><li><span style="color: #57595B; font-weight: bold;">ç»“æž„æ³¨æ„åŠ› (Structural Attention)ï¼š ç»“åˆæ‘„åƒå¤´ä½ç½®ç¼–ç ï¼Œæ•æ‰åŒä¸€æ—¶åˆ»ç›®æ ‡åœ¨ç©ºé—´æ‹“æ‰‘ä¸Šçš„å…³ç³» ã€‚</span></li><li><span style="color: #57595B; font-weight: bold;">æ—¶åºæ³¨æ„åŠ› (Temporal Attention)ï¼š æ•æ‰ç›®æ ‡ç‰¹å¾éšæ—¶é—´æŽ¨ç§»çš„æ¼”å˜è§„å¾‹ã€‚</span></li></ul><p>æœ€åŽæ˜¯ <span style="color: #BB8ED0; font-weight: bold;">ç»Ÿä¸€å¤„ç†é‡å ä¸Žéžé‡å è§†åŸŸ</span> ã€‚ä¸åŒäºŽéƒ¨åˆ†å‰äººå·¥ä½œä¾èµ–æ‘„åƒå¤´çš„é‡å åŒºåŸŸè¿›è¡Œå‡ ä½•åŒ¹é… ï¼ŒDyGLIP é€šè¿‡å­¦ä¹ ç‰¹å¾çš„æ—¶ç©ºæ¼”å˜ï¼Œæ— éœ€æ˜¾å¼çš„è§†åŸŸé‡å å‡è®¾ã€‚è¿™ä½¿å¾—è¯¥æ¨¡åž‹èƒ½å¤Ÿé€šç”¨äºŽå„ç§æ‘„åƒå¤´æ‹“æ‰‘ç»“æž„ã€‚</p><h2 id="æŠ€æœ¯è·¯çº¿"><a class="markdownIt-Anchor" href="#æŠ€æœ¯è·¯çº¿"></a> æŠ€æœ¯è·¯çº¿</h2><p><strong>DyGLIP</strong> çš„æ•´ä½“æž¶æž„æ˜¯ä¸€ä¸ªç«¯åˆ°ç«¯çš„æµæ°´çº¿ï¼Œæ ¸å¿ƒåœ¨äºŽå°†<strong>å•æ‘„åƒå¤´è·Ÿè¸ª</strong>äº§ç”Ÿçš„æ•°æ®æµï¼Œè¾“å…¥åˆ°ä¸€ä¸ª<strong>åŠ¨æ€å›¾ç¥žç»ç½‘ç»œ</strong>ä¸­ï¼Œé€šè¿‡æ—¶ç©ºæ³¨æ„åŠ›æœºåˆ¶é‡å¡‘ç‰¹å¾ï¼Œæœ€ç»ˆè¾“å‡ºå…¨å±€ ID åˆ†é…ç»“æžœã€‚</p><h3 id="å•æ‘„åƒå¤´å±€éƒ¨è·Ÿè¸ª"><a class="markdownIt-Anchor" href="#å•æ‘„åƒå¤´å±€éƒ¨è·Ÿè¸ª"></a> å•æ‘„åƒå¤´å±€éƒ¨è·Ÿè¸ª</h3><p>ä¾èµ–äºŽçŽ°æœ‰çš„å•æ‘„åƒå¤´å¤šç›®æ ‡è·Ÿè¸ªï¼ˆSingle-Camera MOTï¼‰ç®—æ³•ï¼Œé€‰æ‹©äº† DeepSORT  ä½œä¸ºåŸºç¡€è·Ÿè¸ªå™¨ã€‚</p><p>åœ¨æ—¶åˆ» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span></span></span></span>ï¼Œç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">c</span></span></span></span> ä¸ªæ‘„åƒå¤´ç”Ÿæˆä¸€ç»„<strong>å±€éƒ¨çŸ­è½¨è¿¹ï¼ˆTrackletsï¼‰</strong>ï¼Œè®°ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mi>c</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>=</mo><mo stretchy="false">{</mo><msubsup><mi>I</mi><mi>j</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msubsup><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\mathcal{L}_{c}^{(t)}=\{I_{j}^{(t)}\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.161392em;vertical-align:-0.11659199999999997em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.5834080000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.11659199999999997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.4577719999999998em;vertical-align:-0.4129719999999999em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.4129719999999999em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span> ã€‚</p><p>æ¯ä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>I</mi><mi>j</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">I_{j}^{(t)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4577719999999998em;vertical-align:-0.4129719999999999em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.4129719999999999em;"><span></span></span></span></span></span></span></span></span></span> åŒ…å«ä¸€ä¸ª<strong>ç‰¹å¾å‘é‡ï¼ˆFeature Vectorï¼‰</strong>ï¼Œç”±æ£€æµ‹å™¨æˆ– Re-ID æ¨¡åž‹æå–ã€‚</p><h3 id="åŠ¨æ€å›¾æž„å»º"><a class="markdownIt-Anchor" href="#åŠ¨æ€å›¾æž„å»º"></a> åŠ¨æ€å›¾æž„å»º</h3><p>ç³»ç»Ÿç»´æŠ¤ä¸€ä¸ªéšæ—¶é—´ä¸æ–­ç”Ÿé•¿çš„ <span style="color: #BB8ED0; font-weight: bold;">åŠ¨æ€å›¾ç»“æž„</span> ã€‚<br />å›¾çš„å®šä¹‰æ˜¯ï¼Œåœ¨æ—¶åˆ» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span></span></span></span>ï¼Œæž„å»ºå›¾ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi mathvariant="script">G</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mo stretchy="false">(</mo><msup><mi mathvariant="script">V</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup><mo separator="true">,</mo><msup><mi mathvariant="script">E</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{G}^{(t)}=(\mathcal{V}^{(t)},\mathcal{E}^{(t)})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.03522em;vertical-align:-0.09722em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.0593em;">G</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">V</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.08944em;">E</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><ul><li>é¡¶ç‚¹é›† (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">V</mi></mrow><annotation encoding="application/x-tex">\mathcal{V}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">V</span></span></span></span></span>)ï¼šä»£è¡¨æ‰€æœ‰å·²çŸ¥çš„ <strong>Tracklets</strong></li><li>è¾¹é›† (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">E</mi></mrow><annotation encoding="application/x-tex">\mathcal{E}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08944em;">E</span></span></span></span></span>)ï¼šä»£è¡¨ Tracklets ä¹‹é—´çš„å…³è”å…³ç³»ï¼ˆå³æ˜¯å¦ä¸ºåŒä¸€äººï¼‰</li></ul><p>ä¸Žæž„å»ºå›ºå®šå›¾ä¸åŒï¼ŒDyGLIP é‡‡ç”¨<strong>å¢žé‡å¼æ›´æ–°</strong>ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi mathvariant="script">V</mi><mrow><mo stretchy="false">(</mo><mi mathvariant="script">t</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><msup><mi mathvariant="script">V</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>âˆª</mo><msup><mi mathvariant="script">N</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\mathcal{V^{(t)}}=\mathcal{V}^{(t-1)}\cup\mathcal{N}^{(t)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.938em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.938em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">V</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆª</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.938em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span></p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="script">V</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\mathcal{V}^{(t-1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">V</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span> æ˜¯ä¸Šä¸€æ—¶åˆ»å·²å­˜åœ¨çš„èŠ‚ç‚¹</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="script">N</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\mathcal{N}^{(t)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span> æ˜¯å½“å‰æ—¶åˆ»å„æ‘„åƒå¤´æ–°æ£€æµ‹åˆ°çš„ Tracklets é›†åˆ</li></ul><p>æ­¤å¤–ï¼Œåœ¨åˆå§‹åŒ–æ—¶ï¼Œæ¯ä¸ªèŠ‚ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> åˆå§‹å…³è”ä¸€ä¸ªç‰¹å¾å‘é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span>ï¼Œè¿™ä¸€ç‰¹å¾å‘é‡é€šå¸¸ä¸º Re-ID ç‰¹å¾ã€‚</p><h3 id="æ—¶ç©ºæ³¨æ„åŠ›ç‰¹å¾å¢žå¼º"><a class="markdownIt-Anchor" href="#æ—¶ç©ºæ³¨æ„åŠ›ç‰¹å¾å¢žå¼º"></a> æ—¶ç©ºæ³¨æ„åŠ›ç‰¹å¾å¢žå¼º</h3><p>ä¸ºäº†è§£å†³è·¨æ‘„åƒå¤´ç‰¹å¾ä¸ä¸€è‡´çš„é—®é¢˜ï¼ŒDyGLIP è®¾è®¡äº†ä¸€ä¸ª <span style="color: #BB8ED0; font-weight: bold;">åŒå±‚æ³¨æ„åŠ›æœºåˆ¶</span> ï¼š<strong>ç»“æž„æ³¨æ„åŠ› (Structural Attention)</strong> å’Œ <strong>æ—¶åºæ³¨æ„åŠ› (Temporal Attention)</strong></p><p><strong>ç»“æž„æ³¨æ„åŠ›</strong>çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼ŒèŠ‚ç‚¹ä¸åº”è¯¥æ˜¯å­¤ç«‹çš„ã€‚åœ¨æŸä¸€æ—¶åˆ»ï¼Œä¸€ä¸ªç›®æ ‡çš„ç‰¹å¾åº”è¯¥ä¸Žå…¶æ‰€å¤„çš„çŽ¯å¢ƒï¼ˆæ‘„åƒå¤´ä½ç½®ï¼‰ä»¥åŠå‘¨å›´çš„å…¶ä»–ç›®æ ‡ç‰¹å¾è¿›è¡Œå…³è”ã€‚<span style="color: #57595B; font-weight: bold;">å› æ­¤ï¼Œæ¨¡åž‹å¼•å…¥äº†æ‘„åƒå¤´ä½ç½®ç¼–ç ï¼Œå­¦ä¹ æ¯ä¸ªæ‘„åƒå¤´ç‰¹æœ‰çš„æˆåƒé£Žæ ¼ï¼ˆå¦‚åè‰²æˆ–ç•¸å˜ï¼‰ï¼Œå¹¶åˆ©ç”¨å‘¨å›´é‚»å±…èŠ‚ç‚¹çš„åˆ†å¸ƒæƒ…å†µï¼Œæ¶ˆé™¤å•æ‘„çŽ¯å¢ƒå¸¦æ¥çš„ç³»ç»Ÿæ€§åå·®ï¼ŒèŽ·å¾—æ›´å…·ä»£è¡¨æ€§çš„å±€éƒ¨æ‹“æ‰‘ç‰¹å¾ã€‚</span></p><p><strong>æ—¶åºæ³¨æ„åŠ›</strong>çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼Œä¸€ä¸ªäººçš„èº«ä»½æ˜¯è¿žç»­æ¼”å˜çš„ã€‚å¦‚æžœæ¨¡åž‹çŸ¥é“ç›®æ ‡åœ¨å‰ä¸€ç§’çš„é•¿ç›¸ï¼Œå°±èƒ½æ›´å¥½åœ°é¢„æµ‹ä»–åœ¨åŽä¸€ç§’çš„é•¿ç›¸ã€‚<span style="color: #57595B; font-weight: bold;">å› æ­¤ï¼Œæ¨¡åž‹é€šè¿‡ä¸€ä¸ªæ—¶é—´æ»‘åŠ¨çª—å£è§‚å¯Ÿç›®æ ‡åœ¨è¿‡åŽ»å‡ ä¸ªæ—¶åˆ»çš„ç‰¹å¾å˜åŒ–è¶‹åŠ¿ï¼Œæ•æ‰ç›®æ ‡ç‰¹å¾éšæ—¶é—´æŽ¨ç§»çš„åŠ¨æ€æ¼”åŒ–è§„å¾‹ã€‚</span></p><h4 id="ç»“æž„æ³¨æ„åŠ›å±‚-structural-attention-layer-sal"><a class="markdownIt-Anchor" href="#ç»“æž„æ³¨æ„åŠ›å±‚-structural-attention-layer-sal"></a> ç»“æž„æ³¨æ„åŠ›å±‚ (Structural Attention Layer, SAL)</h4><p>åœ¨è¿›å…¥æ³¨æ„åŠ›å±‚ä¹‹å‰ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸ä»…æºå¸¦å¤–è§‚ç‰¹å¾ï¼Œè¿˜èžåˆäº†ç©ºé—´ä¿¡æ¯ï¼Œå› æ­¤ï¼Œ<br />å¯¹äºŽæ—¶åˆ» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span></span></span></span> çš„å›¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="script">G</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\mathcal{G}^{(t)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9852199999999999em;vertical-align:-0.09722em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.0593em;">G</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span> ä¸­çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span>ï¼Œè¾“å…¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>e</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">e_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æ˜¯å¤–è§‚ç‰¹å¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span> ä¸Ž <strong>æ‘„åƒå¤´ä½ç½®ç¼–ç  (Camera Positional Encoding)</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">c_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> çš„æ‹¼æŽ¥ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>e</mi><mi>v</mi></msub><mo>=</mo><mo stretchy="false">{</mo><mi>f</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mi mathvariant="normal">âˆ£</mi><mi mathvariant="normal">âˆ£</mi><msub><mi>c</mi><mi>v</mi></msub><mo stretchy="false">}</mo><mo>âˆˆ</mo><msup><mi mathvariant="double-struck">R</mi><msub><mi>D</mi><mi>E</mi></msub></msup></mrow><annotation encoding="application/x-tex">e_{v}=\{f(v)||c_{v}\}\in\mathbb{R}^{D_{E}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mord">âˆ£</span><span class="mord">âˆ£</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8913309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:-0.02778em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p>å…¶ä¸­ï¼š</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>âˆˆ</mo><msup><mi mathvariant="double-struck">R</mi><msub><mi>D</mi><mi>F</mi></msub></msup></mrow><annotation encoding="application/x-tex">f(v) \in \mathbb{R}^{D_F}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:-0.02778em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>ï¼šåŽŸå§‹ ReID ç‰¹å¾å‘é‡</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>v</mi></msub><mo>âˆˆ</mo><msup><mi mathvariant="double-struck">R</mi><msub><mi>D</mi><mi>C</mi></msub></msup></mrow><annotation encoding="application/x-tex">c_v \in \mathbb{R}^{D_C}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:-0.02778em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>ï¼šæ‘„åƒå¤´çš„ç©ºé—´ä½ç½®ç¼–ç ï¼ˆCamera Positional Encodingï¼‰</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">âˆ£</mi><mi mathvariant="normal">âˆ£</mi></mrow><annotation encoding="application/x-tex">||</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">âˆ£</span><span class="mord">âˆ£</span></span></span></span>ï¼šè¡¨ç¤ºæ‹¼æŽ¥æ“ä½œï¼ˆConcatenationï¼‰</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>E</mi></msub><mo>=</mo><msub><mi>D</mi><mi>F</mi></msub><mo>+</mo><msub><mi>D</mi><mi>C</mi></msub></mrow><annotation encoding="application/x-tex">D_E = D_F + D_C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼šæ‹¼æŽ¥åŽçš„æ€»ç»´åº¦</li></ul><p>ä¸ºäº†è®¡ç®—èŠ‚ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">v_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> å¯¹èŠ‚ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">v_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> çš„é‡è¦æ€§ï¼ˆå³æƒé‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î±</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\alpha_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>ï¼‰ï¼ŒDyGLIP é‡‡ç”¨äº†ä¸€ç§<strong>åŸºäºŽé‚»åŸŸçš„æ³¨æ„åŠ›æœºåˆ¶</strong>ã€‚å¯¹äºŽç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span> ä¸ªæ³¨æ„åŠ›å¤´ï¼ˆHeadï¼‰ï¼Œå…¶ç³»æ•°è®¡ç®—å…¬å¼ä¸ºï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>Î±</mi><mrow><mi>i</mi><mi>j</mi></mrow><mi>l</mi></msubsup><mo>=</mo><mfrac><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mi>Ïƒ</mi><mo stretchy="false">(</mo><msubsup><mi>W</mi><mrow><mi>i</mi><mi>j</mi></mrow><mi>T</mi></msubsup><mo stretchy="false">[</mo><mi>c</mi><mi>o</mi><mi>n</mi><msubsup><mi>v</mi><mrow><mn>1</mn><mo>Ã—</mo><mn>1</mn></mrow><mi>l</mi></msubsup><mo stretchy="false">(</mo><msubsup><mi>e</mi><msub><mi>v</mi><mi>i</mi></msub><mi>t</mi></msubsup><mo stretchy="false">)</mo><mi mathvariant="normal">âˆ£</mi><mi mathvariant="normal">âˆ£</mi><mi>c</mi><mi>o</mi><mi>n</mi><msubsup><mi>v</mi><mrow><mn>1</mn><mo>Ã—</mo><mn>1</mn></mrow><mi>l</mi></msubsup><mo stretchy="false">(</mo><msubsup><mi>e</mi><msub><mi>v</mi><mi>j</mi></msub><mi>t</mi></msubsup><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><mrow><munder><mo>âˆ‘</mo><mrow><msub><mi>v</mi><mi>k</mi></msub><mo>âˆˆ</mo><msup><mi mathvariant="script">V</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup></mrow></munder><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mi>Ïƒ</mi><mo stretchy="false">(</mo><msubsup><mi>W</mi><mrow><mi>k</mi><mi>j</mi></mrow><mi>T</mi></msubsup><mo stretchy="false">[</mo><mi>c</mi><mi>o</mi><mi>n</mi><msubsup><mi>v</mi><mrow><mn>1</mn><mo>Ã—</mo><mn>1</mn></mrow><mi>l</mi></msubsup><mo stretchy="false">(</mo><msubsup><mi>e</mi><msub><mi>v</mi><mi>i</mi></msub><mi>t</mi></msubsup><mo stretchy="false">)</mo><mi mathvariant="normal">âˆ£</mi><mi mathvariant="normal">âˆ£</mi><mi>c</mi><mi>o</mi><mi>n</mi><msubsup><mi>v</mi><mrow><mn>1</mn><mo>Ã—</mo><mn>1</mn></mrow><mi>l</mi></msubsup><mo stretchy="false">(</mo><msubsup><mi>e</mi><msub><mi>v</mi><mi>k</mi></msub><mi>t</mi></msubsup><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\alpha_{ij}^{l}=\frac{exp(\sigma(W_{ij}^{T}[conv_{1\times1}^{l}(e_{v_{i}}^{t})||conv_{1\times1}^{l}(e_{v_{j}}^{t})]))}{\sum_{v_{k}\in\mathcal{V}^{(t)}}exp(\sigma(W_{kj}^{T}[conv_{1\times1}^{l}(e_{v_{i}}^{t})||conv_{1\times1}^{l}(e_{v_{k}}^{t})]))}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.282216em;vertical-align:-0.383108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.899108em;"><span style="top:-2.4530000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.8417519999999996em;vertical-align:-1.158324em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6834279999999997em;"><span style="top:-2.279092em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.27571499999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span><span class="mrel mtight">âˆˆ</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.08222em;">V</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8220357142857143em;"><span style="top:-2.8220357142857138em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.40557em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.823131em;"><span style="top:-2.3986920000000005em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.0448000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.4374159999999999em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.830908em;"><span style="top:-2.433692em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">Ã—</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0448000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3246389999999999em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7195559999999999em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.34709999999999996em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">âˆ£</span><span class="mord">âˆ£</span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.830908em;"><span style="top:-2.433692em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">Ã—</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0448000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3246389999999999em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7195559999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.35285999999999995em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">]</span><span class="mclose">)</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.8343199999999995em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-2.441336em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.394772em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-2.451892em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">Ã—</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.30643899999999996em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.34709999999999996em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">âˆ£</span><span class="mord">âˆ£</span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-2.451892em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">Ã—</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.30643899999999996em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.44432em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">]</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.158324em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>å…¶ä¸­ï¼š</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>o</mi><mi>n</mi><msubsup><mi>v</mi><mrow><mn>1</mn><mo>Ã—</mo><mn>1</mn></mrow><mi>l</mi></msubsup></mrow><annotation encoding="application/x-tex">conv_{1\times1}^{l}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1555469999999999em;vertical-align:-0.30643899999999996em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-2.451892em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">Ã—</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.30643899999999996em;"><span></span></span></span></span></span></span></span></span></span>ï¼šä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>Ã—</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">1 \times 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> çš„å·ç§¯å±‚ï¼ˆç›¸å½“äºŽå…¨è¿žæŽ¥å±‚ï¼‰ï¼Œç”¨äºŽå°†é«˜ç»´è¾“å…¥ç‰¹å¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>e</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">e_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æ˜ å°„åˆ°å½“å‰æ³¨æ„åŠ›å¤´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span> çš„å­ç©ºé—´</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">âˆ£</mi><mi mathvariant="normal">âˆ£</mi></mrow><annotation encoding="application/x-tex">||</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">âˆ£</span><span class="mord">âˆ£</span></span></span></span>ï¼Œå³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>o</mi><mi>n</mi><mi>c</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>n</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">Concatenation</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span></span></span></span>ï¼šå°†å˜æ¢åŽçš„æºèŠ‚ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">v_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å’Œé‚»å±…èŠ‚ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">v_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> çš„ç‰¹å¾æ‹¼æŽ¥ï¼Œå½¢æˆè¾¹ç¼˜ç‰¹å¾</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>W</mi><mrow><mi>i</mi><mi>j</mi></mrow><mi>T</mi></msubsup></mrow><annotation encoding="application/x-tex">W_{ij}^{T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.236103em;vertical-align:-0.394772em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-2.441336em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.394772em;"><span></span></span></span></span></span></span></span></span></span>ï¼šè¿™æ˜¯ä¸€ä¸ªå¯å­¦ä¹ çš„æƒé‡å‘é‡ï¼Œå°†æ‹¼æŽ¥åŽçš„ç‰¹å¾æ˜ å°„ä¸ºä¸€ä¸ªæ ‡é‡ï¼ˆScalarï¼‰ï¼Œå³æœªå½’ä¸€åŒ–çš„æ³¨æ„åŠ›åˆ†æ•°</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ïƒ</mi><mo stretchy="false">(</mo><mo>â‹…</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma(\cdot)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class="mopen">(</span><span class="mord">â‹…</span><span class="mclose">)</span></span></span></span>ï¼šéžçº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œè®ºæ–‡ä¸­é€‰ç”¨ LeakyReLU</li><li><strong>Softmax å½’ä¸€åŒ–</strong>ï¼šåˆ†æ¯éƒ¨åˆ†å¯¹èŠ‚ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">v_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> çš„æ‰€æœ‰é‚»å±…èŠ‚ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">v_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> è¿›è¡Œæ±‚å’Œï¼Œç¡®ä¿æƒé‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î±</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\alpha_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> ä¹‹å’Œä¸º 1</li><li><strong>ç¨€ç–æ€§</strong>ï¼šä¸ºäº†é™ä½Žè®¡ç®—é‡ï¼Œæ±‚å’Œä»…é’ˆå¯¹é‚»æŽ¥çŸ©é˜µä¸­å®šä¹‰çš„é‚»åŸŸ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{N}(v_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> è¿›è¡Œï¼Œè€Œéžå…¨å›¾</li></ul><p>ç†è§£ä¸Šè¿°çš„å…¬å¼ï¼Œæˆ‘ä»¬éœ€è¦å…ˆç†è§£<strong>æ³¨æ„åŠ›å¤´</strong>æ˜¯ä»€ä¹ˆï¼Œå…¶æ˜¯<strong>å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶</strong>çš„åŸºæœ¬å•å…ƒã€‚å¤šä¸ªæ³¨æ„åŠ›å¤´å°±å¦‚åŒå¤šä¸ªå¯¹ä¸€ä¸ªç›®æ ‡è§‚å¯Ÿçš„è§‚æµ‹è€…ï¼Œæ¯ä¸ªäººå…³æ³¨ç›®æ ‡çš„æŸä¸€æ–¹é¢ï¼Œæœ€åŽå°†è¿™å››ä¸ªè§‚æµ‹è€…çš„è§‚å¯Ÿç»“æžœæ‹¼æŽ¥åœ¨ä¸€èµ·ï¼Œå°±èƒ½å¾—åˆ°ä¸€ä¸ªå¯¹è¿™ä¸ªç›®æ ‡éžå¸¸å…¨é¢ã€ç«‹ä½“çš„æè¿°ã€‚æ¢æˆä¸“ä¸šçš„å™è¿°å°±æ˜¯ï¼š</p><ul><li><span style="color: #BB8ED0; font-weight: bold;">å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶ï¼ˆMulti-Head Attentionï¼‰</span>å…è®¸æ¨¡åž‹åœ¨ä¸åŒçš„ç‰¹å¾å­ç©ºé—´ï¼ˆSubspacesï¼‰é‡Œå¹¶è¡Œåœ°å­¦ä¹ ä¿¡æ¯ï¼Œé˜²æ­¢åªå…³æ³¨æŸä¸€æ–¹é¢è€Œå¿½ç•¥äº†å…¶ä»–é‡è¦ç»†èŠ‚</li></ul><p>åœ¨æ•°å­¦å®žçŽ°ä¸Šï¼Œæ¯ä¸€ä¸ªå¤´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span> éƒ½æ‹¥æœ‰è‡ªå·±ç‹¬æœ‰çš„ä¸€å¥—<strong>æŠ•å½±çŸ©é˜µ</strong>ï¼ˆæƒé‡å‚æ•°ï¼‰<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>W</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">W^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span></span></span></span></span></span></span>ï¼Œç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span> ä¸ªå¤´ä¼šç‹¬ç«‹è®¡ç®—å‡ºä¸€ç»„æ³¨æ„åŠ›ç³»æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Î±</mi><mrow><mi>i</mi><mi>j</mi></mrow><mi>l</mi></msubsup></mrow><annotation encoding="application/x-tex">\alpha_{ij}^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2438799999999999em;vertical-align:-0.394772em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.441336em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.394772em;"><span></span></span></span></span></span></span></span></span></span> å’Œç‰¹å¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>h</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">h^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span></span></span></span></span></span></span>ï¼Œæœ€åŽé€šè¿‡æ‹¼æŽ¥æ“ä½œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>o</mi><mi>n</mi><mi>c</mi><mi>a</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">Concat</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span></span></span></span> æŠŠæ‰€æœ‰å¤´çš„ç»“æžœåˆæˆä¸ºæœ€ç»ˆå‘é‡ã€‚</p><p>é‚£æ¯ä¸ªå¤´è®¡ç®—å‡ºæ¥çš„æ³¨æ„åŠ›ç³»æ•°åˆåº”è¯¥å¦‚ä½•ç†è§£å‘¢ï¼Ÿ</p><ul><li><span style="color: #BB8ED0; font-weight: bold;">æ³¨æ„åŠ›ç³»æ•° (Attention Coefficients)</span> ï¼Œå³<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î±</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\alpha_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œå¯ä»¥è¢«ç†è§£ä¸ºæ¨¡åž‹åœ¨å¤„ç†ä¿¡æ¯æ—¶çš„åˆ¤åˆ«æƒé‡ã€‚</li></ul><p>æƒ³è±¡ä¸€ä¸‹ï¼Œå¯¹äºŽåŠ¨æ€å›¾ä¸­çš„èŠ‚ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">v_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ï¼Œå®ƒå‘¨å›´è¿žæŽ¥ç€å¾ˆå¤šå…¶ä»–èŠ‚ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">v_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î±</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\alpha_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>å°±æ„å‘³ç€ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">v_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å¯¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">v_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> çš„<strong>å…³æ³¨åº¦</strong>ï¼Œä»Žè®ºæ–‡çš„å…¬å¼æ¥çœ‹ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î±</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\alpha_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> æ˜¯é€šè¿‡ Softmax å‡½æ•°è®¡ç®—å‡ºæ¥çš„ï¼Œå› æ­¤å¯¹äºŽèŠ‚ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">v_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> çš„æ‰€æœ‰é‚»å±…ï¼Œæ³¨æ„åŠ›ç³»æ•°ä¹‹å’Œå¿…é¡»ç­‰äºŽ 1ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ‘</mo><mi>Î±</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum \alpha = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.00001em;vertical-align:-0.25001em;"></span><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>ï¼‰ã€‚åœ¨èšåˆç‰¹å¾æ—¶ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î±</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\alpha_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> å®žé™…ä¸Šæ˜¯åœ¨æ‰§è¡ŒåŠ æƒæ±‚å’Œã€‚</p><p>ç†è§£å®Œè¿™äº›ï¼Œæˆ‘ä»¬å›žåˆ°ä¸Šé¢çš„æ³¨æ„åŠ›å¤´ç³»æ•°è®¡ç®—å…¬å¼ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>Î±</mi><mrow><mi>i</mi><mi>j</mi></mrow><mi>l</mi></msubsup><mo>=</mo><mfrac><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mi>Ïƒ</mi><mo stretchy="false">(</mo><msubsup><mi>W</mi><mrow><mi>i</mi><mi>j</mi></mrow><mi>T</mi></msubsup><mo stretchy="false">[</mo><mi>c</mi><mi>o</mi><mi>n</mi><msubsup><mi>v</mi><mrow><mn>1</mn><mo>Ã—</mo><mn>1</mn></mrow><mi>l</mi></msubsup><mo stretchy="false">(</mo><msubsup><mi>e</mi><msub><mi>v</mi><mi>i</mi></msub><mi>t</mi></msubsup><mo stretchy="false">)</mo><mi mathvariant="normal">âˆ£</mi><mi mathvariant="normal">âˆ£</mi><mi>c</mi><mi>o</mi><mi>n</mi><msubsup><mi>v</mi><mrow><mn>1</mn><mo>Ã—</mo><mn>1</mn></mrow><mi>l</mi></msubsup><mo stretchy="false">(</mo><msubsup><mi>e</mi><msub><mi>v</mi><mi>j</mi></msub><mi>t</mi></msubsup><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><mrow><munder><mo>âˆ‘</mo><mrow><msub><mi>v</mi><mi>k</mi></msub><mo>âˆˆ</mo><msup><mi mathvariant="script">V</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup></mrow></munder><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mi>Ïƒ</mi><mo stretchy="false">(</mo><msubsup><mi>W</mi><mrow><mi>k</mi><mi>j</mi></mrow><mi>T</mi></msubsup><mo stretchy="false">[</mo><mi>c</mi><mi>o</mi><mi>n</mi><msubsup><mi>v</mi><mrow><mn>1</mn><mo>Ã—</mo><mn>1</mn></mrow><mi>l</mi></msubsup><mo stretchy="false">(</mo><msubsup><mi>e</mi><msub><mi>v</mi><mi>i</mi></msub><mi>t</mi></msubsup><mo stretchy="false">)</mo><mi mathvariant="normal">âˆ£</mi><mi mathvariant="normal">âˆ£</mi><mi>c</mi><mi>o</mi><mi>n</mi><msubsup><mi>v</mi><mrow><mn>1</mn><mo>Ã—</mo><mn>1</mn></mrow><mi>l</mi></msubsup><mo stretchy="false">(</mo><msubsup><mi>e</mi><msub><mi>v</mi><mi>k</mi></msub><mi>t</mi></msubsup><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\alpha_{ij}^{l}=\frac{exp(\sigma(W_{ij}^{T}[conv_{1\times1}^{l}(e_{v_{i}}^{t})||conv_{1\times1}^{l}(e_{v_{j}}^{t})]))}{\sum_{v_{k}\in\mathcal{V}^{(t)}}exp(\sigma(W_{kj}^{T}[conv_{1\times1}^{l}(e_{v_{i}}^{t})||conv_{1\times1}^{l}(e_{v_{k}}^{t})]))}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.282216em;vertical-align:-0.383108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.899108em;"><span style="top:-2.4530000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.8417519999999996em;vertical-align:-1.158324em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6834279999999997em;"><span style="top:-2.279092em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.27571499999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span><span class="mrel mtight">âˆˆ</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.08222em;">V</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8220357142857143em;"><span style="top:-2.8220357142857138em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.40557em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.823131em;"><span style="top:-2.3986920000000005em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.0448000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.4374159999999999em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.830908em;"><span style="top:-2.433692em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">Ã—</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0448000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3246389999999999em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7195559999999999em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.34709999999999996em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">âˆ£</span><span class="mord">âˆ£</span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.830908em;"><span style="top:-2.433692em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">Ã—</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0448000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3246389999999999em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7195559999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.35285999999999995em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">]</span><span class="mclose">)</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.8343199999999995em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-2.441336em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.394772em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-2.451892em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">Ã—</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.30643899999999996em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.34709999999999996em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">âˆ£</span><span class="mord">âˆ£</span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-2.451892em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">Ã—</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.30643899999999996em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.44432em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">]</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.158324em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>å…¶æ„å›¾å°±æ˜¯ï¼Œè®¡ç®—ï¼š</p><ul><li><span style="color: #89986D; font-weight: bold;">æ¿€æ´»å‡½æ•°å¤„ç†åŽçš„ï¼Œè¯¥æ³¨æ„åŠ›å¤´æƒé‡çŸ©é˜µâœ–ï¸ä¸¤ä¸ªè½¨è¿¹èŠ‚ç‚¹ç‰¹å¾å·ç§¯ç»“æžœçš„æ‹¼æŽ¥ï¼Œçš„softmax å½’ä¸€åŒ–ç»“æžœ</span>ã€‚<br />èŽ·å¾—æ³¨æ„åŠ›ç³»æ•°åŽï¼Œé€šè¿‡åŠ æƒæ±‚å’Œæ›´æ–°èŠ‚ç‚¹ç‰¹å¾ã€‚è¾“å‡º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>h</mi><msub><mi>v</mi><mi>i</mi></msub><mi>t</mi></msubsup></mrow><annotation encoding="application/x-tex">h_{v_i}^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.140656em;vertical-align:-0.34709999999999996em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.34709999999999996em;"><span></span></span></span></span></span></span></span></span></span> çš„è®¡ç®—å…¬å¼ä¸ºï¼š</li></ul><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>h</mi><msub><mi>v</mi><mi>i</mi></msub><mi>t</mi></msubsup><mo>=</mo><mi>C</mi><mi>o</mi><mi>n</mi><mi>c</mi><mi>a</mi><msubsup><mi>t</mi><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>L</mi></msubsup><mo stretchy="false">[</mo><mi>Ïƒ</mi><mo stretchy="false">(</mo><munder><mo>âˆ‘</mo><mrow><msub><mi>v</mi><mi>j</mi></msub><mo>âˆˆ</mo><msup><mi>V</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup></mrow></munder><msubsup><mi>Î±</mi><mrow><mi>i</mi><mi>j</mi></mrow><mi>l</mi></msubsup><mi>c</mi><mi>o</mi><mi>n</mi><msubsup><mi>v</mi><mrow><mn>1</mn><mo>Ã—</mo><mn>1</mn></mrow><mi>l</mi></msubsup><mo stretchy="false">(</mo><msubsup><mi>e</mi><msub><mi>v</mi><mi>j</mi></msub><mi>t</mi></msubsup><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">h_{v_{i}}^{t}=Concat_{l=1}^{L}[\sigma(\sum_{v_{j}\in V^{(t)}}\alpha_{ij}^{l}conv_{1\times1}^{l}(e_{v_{j}}^{t}))]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190656em;vertical-align:-0.34709999999999996em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.843556em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.34709999999999996em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.638755em;vertical-align:-1.58875em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.7585699999999997em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span><span class="mrel mtight">âˆˆ</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8220357142857143em;"><span style="top:-2.8220357142857138em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.58875em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.899108em;"><span style="top:-2.4530000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.899108em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">Ã—</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.305331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.843556em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.44432em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></span></p><ul><li><strong>åŠ æƒæ±‚å’Œ</strong>ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ‘</mo><msubsup><mi>Î±</mi><mrow><mi>i</mi><mi>j</mi></mrow><mi>l</mi></msubsup><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\sum \alpha_{ij}^{l} ...</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2438799999999999em;vertical-align:-0.394772em;"></span><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.441336em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.394772em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span></span> è¡¨ç¤ºèŠ‚ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">v_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> èšåˆäº†å‘¨å›´é‚»å±… <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">v_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> çš„ä¿¡æ¯ï¼Œæƒé‡ç”± <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î±</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\alpha_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> å†³å®šã€‚è¿™æ„å‘³ç€ï¼Œä¸Ž <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">v_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ç›¸ä¼¼åº¦é«˜æˆ–ç©ºé—´å…³ç³»ç´§å¯†çš„èŠ‚ç‚¹ï¼Œå¯¹å…¶æ–°ç‰¹å¾çš„è´¡çŒ®æ›´å¤§ã€‚</li><li><strong>å¤šå¤´æœºåˆ¶</strong> (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>o</mi><mi>n</mi><mi>c</mi><mi>a</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">Concat</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span></span></span></span>)ï¼šè®ºæ–‡ä½¿ç”¨äº† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">L</span></span></span></span> ä¸ªç‹¬ç«‹çš„æ³¨æ„åŠ›å¤´ï¼ˆå®žéªŒä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">L=4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span></span></span></span>ï¼‰ã€‚è¿™å…è®¸æ¨¡åž‹å…³æ³¨ä¸åŒçš„å­ç©ºé—´ä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ªå¤´å…³æ³¨é¢œè‰²çº¹ç†ï¼Œå¦ä¸€ä¸ªå¤´å…³æ³¨æ‘„åƒå¤´ä½ç½®å…³ç³»ï¼‰ã€‚æœ€åŽå°†æ‰€æœ‰å¤´çš„ç»“æžœæ‹¼æŽ¥ä½œä¸º SAL å±‚çš„æœ€ç»ˆè¾“å‡ºã€‚</li></ul><h4 id="å›¾æ—¶åºæ³¨æ„åŠ›å±‚-graph-temporal-attention-layer-tal"><a class="markdownIt-Anchor" href="#å›¾æ—¶åºæ³¨æ„åŠ›å±‚-graph-temporal-attention-layer-tal"></a> å›¾æ—¶åºæ³¨æ„åŠ›å±‚ (Graph Temporal Attention Layer, TAL)</h4><p><span style="color: #89986D; font-weight: bold;">SAL å±‚å¤„ç†äº†å•å¸§å†…çš„ç©ºé—´å…³ç³»ï¼ŒTAL å±‚åˆ™è´Ÿè´£æ•æ‰æ—¶é—´ç»´åº¦ä¸Šçš„æ¼”åŒ–ã€‚</span> å®ƒåŸºäºŽ Transformer çš„ Self-Attention æž¶æž„ï¼Œä½†é’ˆå¯¹åŠ¨æ€å›¾è¿›è¡Œäº†å› æžœæ€§æ”¹è¿›ã€‚</p><p>TAL çš„è¾“å…¥ä¸ä»…ä»…æ˜¯ç‰¹å¾ï¼Œè¿˜éœ€è¦çŸ¥é“æ—¶é—´ç‚¹ã€‚<br />å¯¹äºŽæ¯ä¸ªèŠ‚ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span>ï¼Œå–å…¶åœ¨æ—¶é—´çª—å£ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span> å†…çš„ä¸€ç³»åˆ— SAL è¾“å‡ºç‰¹å¾ï¼Œå¹¶åŠ ä¸Šæ—¶é—´æˆ³ä½ç½®ç¼–ç  (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">p_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>x</mi><mi>v</mi></msub><mo>=</mo><mo stretchy="false">[</mo><msubsup><mi>h</mi><mi>v</mi><mn>1</mn></msubsup><mo>+</mo><msubsup><mi>p</mi><mi>v</mi><mn>1</mn></msubsup><mo separator="true">,</mo><mtext>Â </mtext><msubsup><mi>h</mi><mi>v</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>p</mi><mi>v</mi><mn>2</mn></msubsup><mo separator="true">,</mo><mtext>Â </mtext><mo>â‹…</mo><mo>â‹…</mo><mo>â‹…</mo><mo separator="true">,</mo><mtext>Â </mtext><msubsup><mi>h</mi><mi>v</mi><mi>W</mi></msubsup><mo>+</mo><msubsup><mi>p</mi><mi>v</mi><mi>W</mi></msubsup><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">x_{v}=[h_{v}^{1}+p_{v}^{1}, \ h_{v}^{2}+p_{v}^{2}, \ \cdot\cdot\cdot, \ h_{v}^{W}+p_{v}^{W}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1111079999999998em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace">Â </span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1111079999999998em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace">Â </span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.138331em;vertical-align:-0.247em;"></span><span class="mord">â‹…</span><span class="mpunct">,</span><span class="mspace">Â </span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span></p><p>å°†è¿™äº›å‘é‡å †å æˆä¸€ä¸ªçŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>âˆˆ</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>W</mi><mo>Ã—</mo><msub><mi>D</mi><mi>H</mi></msub></mrow></msup></mrow><annotation encoding="application/x-tex">X \in \mathbb{R}^{W \times D_H}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="mbin mtight">Ã—</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:-0.02778em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>ã€‚</p><p>éµå¾ªæ ‡å‡† Transformer èŒƒå¼ï¼Œé€šè¿‡çº¿æ€§å˜æ¢ç”Ÿæˆ Query, Key, Value çŸ©é˜µ ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>Q</mi><mo>=</mo><mi>X</mi><msub><mi>W</mi><mi>Q</mi></msub><mo separator="true">,</mo><mspace width="1em"/><mi>K</mi><mo>=</mo><mi>X</mi><msub><mi>W</mi><mi>K</mi></msub><mo separator="true">,</mo><mspace width="1em"/><mi>V</mi><mo>=</mo><mi>X</mi><msub><mi>W</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">Q = XW_Q, \quad K = XW_K, \quad V = XW_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">Q</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>å…¶ä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>Q</mi></msub><mo separator="true">,</mo><msub><mi>W</mi><mi>K</mi></msub><mo separator="true">,</mo><msub><mi>W</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">W_Q, W_K, W_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">Q</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æ˜¯å¯å­¦ä¹ çš„æŠ•å½±çŸ©é˜µã€‚</p><p>éšåŽï¼Œé‡‡ç”¨<strong>æŽ©ç ç¼©æ”¾ç‚¹ç§¯æ³¨æ„åŠ› (Masked Scaled Dot-Product Attention)</strong> ï¼Œè®¡ç®—æ—¶é—´æ­¥ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>z</mi><mi>e</mi><mrow><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>=</mo><mi>a</mi><mi>t</mi><mi>t</mi><msup><mi>n</mi><mrow><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">(</mo><mi>Q</mi><mo separator="true">,</mo><mi>K</mi><mo separator="true">,</mo><mi>V</mi><mo stretchy="false">)</mo><mo>=</mo><mi>s</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mfrac><mrow><mi>Q</mi><msup><mi>K</mi><mi>T</mi></msup></mrow><msqrt><msub><mi>D</mi><mi>Z</mi></msub></msqrt></mfrac><mo>+</mo><mi>M</mi><mo stretchy="false">)</mo><mi>V</mi></mrow><annotation encoding="application/x-tex">z_{e}^{(l)}=attn^{(l)}(Q,K,V)=softmax(\frac{QK^{T}}{\sqrt{D_{Z}}}+M)V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.185em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-2.4530000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">t</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">Q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.448331em;vertical-align:-0.93em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">t</span><span class="mord mathnormal">m</span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5183309999999999em;"><span style="top:-2.2583349999999998em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.851665em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">Z</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.811665em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.18833500000000003em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span></span></p><p>å…¶ä¸­ï¼š</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><msup><mi>K</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">QK^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.035771em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">Q</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span>ï¼šè®¡ç®—ä¸åŒæ—¶é—´æ­¥ä¹‹é—´çš„ç›¸ä¼¼åº¦çŸ©é˜µ</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><msub><mi>D</mi><mi>Z</mi></msub></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{D_Z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.18833500000000003em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.851665em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">Z</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.811665em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.18833500000000003em;"><span></span></span></span></span></span></span></span></span>ï¼šç¼©æ”¾å› å­ï¼Œç”¨äºŽé˜²æ­¢ç‚¹ç§¯ç»“æžœè¿‡å¤§å¯¼è‡´æ¢¯åº¦æ¶ˆå¤±</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span> (Mask Matrix)ï¼šè¿™æ˜¯ä¸€ä¸ªæŽ©ç çŸ©é˜µï¼Œç”¨äºŽå¼ºåˆ¶å› æžœæ€§ã€‚è‹¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>&gt;</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i &gt; j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69862em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>ï¼ˆå³æ—¶é—´æ­¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> æ™šäºŽ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>ï¼‰ï¼Œåˆ™ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mo>âˆ’</mo><mi mathvariant="normal">âˆž</mi></mrow><annotation encoding="application/x-tex">M_{ij} = -\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">âˆ’</span><span class="mord">âˆž</span></span></span></span>ï¼›å¦åˆ™ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">M_{ij} = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>ã€‚åœ¨ Softmax åŽï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>e</mi><mrow><mo>âˆ’</mo><mi mathvariant="normal">âˆž</mi></mrow></msup><mo>â‰ˆ</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">e^{-\infty} \approx 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.771331em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">âˆž</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>ã€‚è¿™ä¿è¯äº†å½“å‰æ—¶åˆ» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span></span></span></span> çš„ç‰¹å¾åªèƒ½èšåˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span></span></span></span> æ—¶åˆ»ä¹‹å‰çš„åŽ†å²ä¿¡æ¯ã€‚</li></ul><p>è¿™æ ·çœ‹å¯èƒ½ä¸å¤Ÿç›´è§‚ï¼Œç»“åˆ Transformer çš„ç†å¿µï¼Œä¸Šè¿°å…¬å¼ï¼Œå³ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>z</mi><mi>e</mi><mrow><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>=</mo><mtext>softmax</mtext><mrow><mo fence="true">(</mo><mfrac><mrow><mi>Q</mi><msup><mi>K</mi><mi>T</mi></msup></mrow><msqrt><msub><mi>D</mi><mi>Z</mi></msub></msqrt></mfrac><mo>+</mo><mi>M</mi><mo fence="true">)</mo></mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">z_{e}^{(l)} = \text{softmax}\left(\frac{QK^{T}}{\sqrt{D_{Z}}} + M\right)V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.185em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-2.4530000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.468361em;vertical-align:-0.95003em;"></span><span class="mord text"><span class="mord">softmax</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5183309999999999em;"><span style="top:-2.2583349999999998em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.851665em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">Z</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.811665em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.18833500000000003em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span></span></p><p>ç”±ä»¥ä¸‹å››ä¸ªæ ¸å¿ƒç»„ä»¶æž„æˆï¼š</p><ol><li><strong>Q, K, V (æŸ¥è¯¢ã€é”®ã€å€¼çŸ©é˜µ)</strong>ï¼š è¿™äº›æ˜¯é€šè¿‡å¯¹è¾“å…¥ç‰¹å¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>ï¼ˆèŠ‚ç‚¹åœ¨ä¸åŒæ—¶é—´æ­¥çš„ç‰¹å¾åºåˆ—ï¼‰è¿›è¡Œçº¿æ€§æŠ•å½±å¾—åˆ°çš„ã€‚<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">Q</span></span></span></span> (Query)ï¼š ä»£è¡¨å½“å‰æ—¶åˆ»çš„èŠ‚ç‚¹æ­£åœ¨å¯»æ‰¾ä»€ä¹ˆæ ·çš„åŽ†å²ä¿¡æ¯ã€‚</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> (Key)ï¼š ä»£è¡¨è¿‡åŽ»å„æ—¶åˆ»èŠ‚ç‚¹æ‰€èƒ½â€œæä¾›â€çš„ç‰¹å¾æ ‡ç­¾ã€‚</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span> (Value)ï¼š ä»£è¡¨èŠ‚ç‚¹å®žé™…åŒ…å«çš„ç‰¹å¾ä¿¡æ¯å†…å®¹ã€‚</li></ul></li><li><strong>ç‚¹ç§¯æ“ä½œ</strong> (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><msup><mi>K</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">QK^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.035771em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">Q</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span>)ï¼š é€šè¿‡è®¡ç®—æŸ¥è¯¢å‘é‡ä¸Žé”®å‘é‡çš„ç‚¹ç§¯ï¼Œè¡¡é‡å½“å‰æ—¶åˆ»ä¸Žè¿‡åŽ»æ¯ä¸€ä¸ªæ—¶åˆ»ä¹‹é—´çš„ç›¸å…³æ€§æˆ–ç›¸ä¼¼åº¦ã€‚</li><li><strong>ç¼©æ”¾å› å­</strong> (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi mathvariant="normal">/</mi><msqrt><msub><mi>D</mi><mi>Z</mi></msub></msqrt></mrow><annotation encoding="application/x-tex">1/\sqrt{D_Z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1016650000000001em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.851665em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">Z</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.811665em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.18833500000000003em;"><span></span></span></span></span></span></span></span></span>)ï¼š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>Z</mi></msub></mrow><annotation encoding="application/x-tex">D_Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">Z</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æ˜¯è¾“å‡ºç‰¹å¾çš„ç»´åº¦ã€‚åœ¨è®¡ç®—ç‚¹ç§¯åŽï¼Œå°†å…¶é™¤ä»¥ç»´åº¦çš„å¹³æ–¹æ ¹ã€‚</li><li><strong>æŽ©ç çŸ©é˜µ</strong> (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span>)ï¼š è¿™æ˜¯ä¸€ä¸ªä¸Žæ—¶é—´çª—å£å¤§å°ç›¸åŒçš„çŸ©é˜µï¼Œå…¶å…ƒç´ å–å€¼ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> æˆ– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ’</mo><mi mathvariant="normal">âˆž</mi></mrow><annotation encoding="application/x-tex">-\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">âˆ’</span><span class="mord">âˆž</span></span></span></span>ã€‚</li></ol><p><strong>ç¼©æ”¾çš„ä½œç”¨æ˜¯</strong>éšç€ç‰¹å¾ç»´åº¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>Z</mi></msub></mrow><annotation encoding="application/x-tex">D_Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">Z</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> çš„å¢žå¤§ï¼Œç‚¹ç§¯ç»“æžœ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><msup><mi>K</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">QK^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.035771em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">Q</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span> çš„é‡çº§ä¼šå˜å¾—éžå¸¸å¤§ã€‚è¿™ä¼šå¯¼è‡´åœ¨ç»è¿‡ Softmax å‡½æ•°å¤„ç†æ—¶ï¼Œæ¢¯åº¦å˜å¾—æžå°ï¼Œé€šè¿‡é™¤ä»¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><msub><mi>D</mi><mi>Z</mi></msub></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{D_Z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.18833500000000003em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.851665em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">Z</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.811665em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.18833500000000003em;"><span></span></span></span></span></span></span></span></span>ï¼Œå°†è®¡ç®—ç»“æžœé‡æ–°ç¼©æ”¾åˆ°ä¸€ä¸ªæ›´åˆç†çš„èŒƒå›´ï¼Œèƒ½å¤Ÿç¡®ä¿ Softmax å‡½æ•°èƒ½å¤Ÿäº§ç”Ÿçµæ•çš„æ¢¯åº¦ã€‚</p><p>è€Œ<strong>æŽ©ç çš„ä½œç”¨æ˜¯</strong>ç¡®ä¿äº†æ¯ä¸ªèŠ‚ç‚¹åœ¨æ›´æ–°ç‰¹å¾æ—¶ï¼Œåªèƒ½é€šè¿‡å›žé¡¾åŽ†å²æ¥å­¦ä¹ æ¼”åŒ–è§„å¾‹ï¼Œè€Œä¸ä¼šäº§ç”Ÿç”±äºŽçœ‹åˆ°äº†æœªæ¥çš„è½¨è¿¹ï¼Œè€Œåå‘ä¿®æ­£å½“å‰IDçš„éžå› æžœè¡Œä¸ºã€‚</p><p>å¤šå¤´ TAL çš„è¾“å‡ºè¢«æ‹¼æŽ¥åŽï¼Œé€šè¿‡ä¸€ä¸ª<strong>å‰é¦ˆç¥žç»ç½‘ç»œ</strong>è¿›è¡Œéžçº¿æ€§å˜æ¢ï¼Œå¾—åˆ°æœ€ç»ˆçš„èŠ‚ç‚¹åµŒå…¥åºåˆ—ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">{</mo><msup><msup><mi>e</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo separator="true">,</mo><msup><msup><mi>e</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup><mo separator="true">,</mo><mo>â‹…</mo><mo>â‹…</mo><mo>â‹…</mo><mo separator="true">,</mo><msup><msup><mi>e</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mrow><mo stretchy="false">(</mo><mi>W</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{ {e^{\prime}}^{(1)},{e^{\prime}}^{(2)},\cdot\cdot\cdot,{e^{\prime}}^{(W)}\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.329792em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.079792em;"><span style="top:-3.254792em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.079792em;"><span style="top:-3.254792em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.329792em;vertical-align:-0.25em;"></span><span class="mord">â‹…</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.079792em;"><span style="top:-3.254792em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></span></p><p>è¿™ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>e</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></mrow><annotation encoding="application/x-tex">e&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span> å³ä¸ºæœ€ç»ˆç”¨äºŽé“¾è·¯é¢„æµ‹çš„ç‰¹å¾ã€‚</p><h3 id="èº«ä»½å…³è”ä¸Žæ¨¡åž‹æŸå¤±å‡½æ•°å®šä¹‰"><a class="markdownIt-Anchor" href="#èº«ä»½å…³è”ä¸Žæ¨¡åž‹æŸå¤±å‡½æ•°å®šä¹‰"></a> èº«ä»½å…³è”ä¸Žæ¨¡åž‹æŸå¤±å‡½æ•°å®šä¹‰</h3><p>åœ¨ DyGLIP ä¸­ï¼Œå…³è”è¢«å®šä¹‰ä¸ºåˆ¤æ–­å›¾ä¸­ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´æ˜¯å¦å­˜åœ¨<strong>Link</strong>ã€‚</p><h4 id="å…³è”æ¦‚çŽ‡è®¡ç®—-probability-scoring"><a class="markdownIt-Anchor" href="#å…³è”æ¦‚çŽ‡è®¡ç®—-probability-scoring"></a> å…³è”æ¦‚çŽ‡è®¡ç®— (Probability Scoring)</h4><p>ç»™å®šä¸€å¯¹ç»è¿‡å¢žå¼ºçš„èŠ‚ç‚¹ç‰¹å¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>e</mi><msub><mi>v</mi><mi>i</mi></msub><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup></mrow><annotation encoding="application/x-tex">e&#x27;_{v_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.098992em;vertical-align:-0.34709999999999996em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.34709999999999996em;"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>e</mi><msub><mi>v</mi><mi>j</mi></msub><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup></mrow><annotation encoding="application/x-tex">e&#x27;_{v_j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.196212em;vertical-align:-0.44432em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.44432em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œæ¨¡åž‹éœ€è¦è®¡ç®—å®ƒä»¬å±žäºŽåŒä¸€ç›®æ ‡çš„æ¦‚çŽ‡åˆ†æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>âˆˆ</mo><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">s \in [0, 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>ï¼Œåˆ†æ•°è¶Šé«˜ï¼Œè¡¨ç¤ºè¿™ä¸¤ä¸ªèŠ‚ç‚¹ï¼ˆTrackletsï¼‰å±žäºŽåŒä¸€ä¸ªäººçš„å¯èƒ½æ€§è¶Šå¤§ ã€‚</p><h4 id="åº¦é‡æ ‡å‡†ä¸Žåˆ†ç±»å™¨é€‰æ‹©-metrics-and-classifiers"><a class="markdownIt-Anchor" href="#åº¦é‡æ ‡å‡†ä¸Žåˆ†ç±»å™¨é€‰æ‹©-metrics-and-classifiers"></a> åº¦é‡æ ‡å‡†ä¸Žåˆ†ç±»å™¨é€‰æ‹© (Metrics and Classifiers)</h4><p>è®ºæ–‡åœ¨æŽ¢è®¨äº†ä¸¤ç§ä¸åŒçš„ç›¸ä¼¼åº¦åº¦é‡ä¸Žåˆ†ç±»ç»„åˆï¼ˆä½™å¼¦è·ç¦» + Sigmoi / å“ˆè¾¾çŽ›ç§¯ + Softmaxï¼‰ä¹‹åŽï¼Œé€‰æ‹©äº†åŽè€…ã€‚</p><p>å³è®¡ç®—ä¸¤ä¸ªç‰¹å¾å‘é‡çš„<strong>å“ˆè¾¾çŽ›ç§¯</strong>ï¼ˆHadamard productï¼Œå³å¯¹åº”å…ƒç´ ç›¸ä¹˜ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>e</mi><msub><mi>v</mi><mi>i</mi></msub><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup><mo>âŠ™</mo><msubsup><mi>e</mi><msub><mi>v</mi><mi>j</mi></msub><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup></mrow><annotation encoding="application/x-tex">e_{v_{i}}^{\prime} \odot e_{v_{j}}^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.098992em;vertical-align:-0.34709999999999996em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.34709999999999996em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âŠ™</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.196212em;vertical-align:-0.44432em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.44432em;"><span></span></span></span></span></span></span></span></span></span>ï¼‰ï¼ŒéšåŽè¿žæŽ¥ä¸€ä¸ª<strong>å…¨è¿žæŽ¥å±‚</strong>ï¼Œæœ€åŽé€šè¿‡ Softmax å±‚è¾“å‡ºåˆ†ç±»æ¦‚çŽ‡ã€‚</p><p>æ¶ˆèžå®žéªŒè¯æ˜Žæ–¹æ¡ˆ B æ•ˆæžœæ˜¾è‘—ä¼˜äºŽæ–¹æ¡ˆ A ã€‚è¿™æ˜¯å› ä¸ºå“ˆè¾¾çŽ›ç§¯ä¿ç•™äº†å…ƒç´ çº§åˆ«çš„äº¤äº’ç‰¹å¾ï¼Œè€Œ Softmax é…åˆå…¨è¿žæŽ¥å±‚èƒ½å­¦ä¹ åˆ°æ›´å¤æ‚çš„éžçº¿æ€§åŒ¹é…é€»è¾‘ã€‚</p><h4 id="è”åˆæŸå¤±å‡½æ•°-integrated-loss"><a class="markdownIt-Anchor" href="#è”åˆæŸå¤±å‡½æ•°-integrated-loss"></a> è”åˆæŸå¤±å‡½æ•° (Integrated Loss)</h4><p>ä¸ºäº†è®©æ³¨æ„åŠ›æ¨¡å—å’Œé“¾è·¯åˆ†ç±»å™¨ååŒå·¥ä½œï¼ŒDyGLIP é‡‡ç”¨äº†ä¸€ç§è”åˆå­¦ä¹ çš„æ–¹æ³•ã€‚å…¶ç›®æ ‡æ˜¯åŒæ—¶å­¦ä¹ èƒ½å¤Ÿæ•èŽ·æ—¶ç©ºä¿¡æ¯çš„è¡¨ç¤ºï¼Œå¹¶å®žçŽ°å‡†ç¡®çš„é“¾è·¯é¢„æµ‹ã€‚</p><p>æ¨¡åž‹çš„æ€»ä½“ç›®æ ‡å‡½æ•°æ—¨åœ¨å¹³è¡¡<strong>ç‰¹å¾èšç±»</strong>å’Œ<strong>åˆ†ç±»å‡†ç¡®åº¦</strong>ï¼Œå¯ä»¥æ¦‚æ‹¬ä¸º<strong>ç‰¹å¾è¡¨ç¤ºå­¦ä¹ </strong>å’Œ<strong>é“¾è·¯åˆ†ç±»å­¦ä¹ </strong>çš„è€¦åˆï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mtext>BCEÂ LossÂ (Representation)</mtext><mo>+</mo><msub><mi>w</mi><mi>g</mi></msub><mo>â‹…</mo><mtext>ClassifierÂ Loss</mtext></mrow><annotation encoding="application/x-tex">\mathcal{L}(v_{i}) = \text{BCE Loss (Representation)} + w_g \cdot \text{Classifier Loss}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal">L</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">BCEÂ LossÂ (Representation)</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.730558em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord text"><span class="mord">ClassifierÂ Loss</span></span></span></span></span></span></p><p>å±•å¼€ä¸ºï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>âˆ‘</mo><mi>t</mi><mi>T</mi></munderover><mrow><mo fence="true">(</mo><munder><munder><mrow><munder><mo>âˆ‘</mo><mrow><msub><mi>v</mi><mi>j</mi></msub><mo>âˆˆ</mo><msubsup><mi mathvariant="script">N</mi><mi>b</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msubsup><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></munder><mo>âˆ’</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mi>Ïƒ</mi><mo stretchy="false">(</mo><mo stretchy="false">âŸ¨</mo><msubsup><mi>e</mi><msub><mi>v</mi><mi>i</mi></msub><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup><mo separator="true">,</mo><msubsup><mi>e</mi><msub><mi>v</mi><mi>j</mi></msub><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup><mo stretchy="false">âŸ©</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><mo stretchy="true">âŸ</mo></munder><mtext>æ­£æ ·æœ¬ç‰¹å¾æ‹‰è¿‘</mtext></munder><mo>+</mo><munder><munder><mrow><msub><mi>w</mi><mi>g</mi></msub><munder><mo>âˆ‘</mo><mrow><msub><mi>v</mi><mi>k</mi></msub><mo>âˆˆ</mo><msubsup><mi mathvariant="script">N</mi><mi>g</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msubsup><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></munder><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mn>1</mn><mo>âˆ’</mo><mi>Ïƒ</mi><mo stretchy="false">(</mo><mo stretchy="false">âŸ¨</mo><msubsup><mi>e</mi><msub><mi>v</mi><mi>i</mi></msub><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup><mo separator="true">,</mo><msubsup><mi>e</mi><msub><mi>v</mi><mi>k</mi></msub><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup><mo stretchy="false">âŸ©</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><mo stretchy="true">âŸ</mo></munder><mtext>è´Ÿæ ·æœ¬ç‰¹å¾æŽ¨å¼€</mtext></munder><mo>+</mo><munder><munder><mrow><munder><mo>âˆ‘</mo><mrow><msub><mi>v</mi><mi>j</mi></msub><mo>âˆˆ</mo><msubsup><mi mathvariant="script">N</mi><mi>a</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msubsup><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></munder><msub><mi mathvariant="script">L</mi><mi>c</mi></msub><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>v</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><mo stretchy="true">âŸ</mo></munder><mtext>é“¾è·¯é¢„æµ‹åˆ†ç±»æŸå¤±</mtext></munder><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{L}(v_{i})=\sum_{t}^{T} \left( \underbrace{\sum_{v_{j}\in \mathcal{N}_{b}^{(t)}(v_{i})}-log(\sigma(\langle e_{v_{i}}^{\prime}, e_{v_{j}}^{\prime} \rangle))}_{\text{æ­£æ ·æœ¬ç‰¹å¾æ‹‰è¿‘}} + \underbrace{w_g \sum_{v_{k}\in\mathcal{N}_{g}^{(t)}(v_{i})}log(1-\sigma(\langle e_{v_{i}}^{\prime}, e_{v_{k}}^{\prime} \rangle))}_{\text{è´Ÿæ ·æœ¬ç‰¹å¾æŽ¨å¼€}} + \underbrace{\sum_{v_{j}\in \mathcal{N}_{a}^{(t)}(v_{i})}\mathcal{L}_{c}(v_{i}, v_{j})}_{\text{é“¾è·¯é¢„æµ‹åˆ†ç±»æŸå¤±}} \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal">L</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:6.676801em;vertical-align:-3.1267560000000003em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.250005em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.550045em;"><span style="top:-0.7499750000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽ</span></span></span><span style="top:-1.8999850000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽœ</span></span></span><span style="top:-2.4949950000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽœ</span></span></span><span style="top:-3.090005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽœ</span></span></span><span style="top:-3.6850150000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽœ</span></span></span><span style="top:-4.280025em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽœ</span></span></span><span style="top:-4.3100249999999996em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽœ</span></span></span><span style="top:-5.550045em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽ›</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.050045em;"><span></span></span></span></span></span></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:0.07675100000000024em;"><span class="pstrut" style="height:3.050005em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord cjk_fallback mtight">æ­£æ ·æœ¬ç‰¹å¾æ‹‰è¿‘</span></span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span class="svg-align" style="top:-0.6015799999999998em;"><span class="pstrut" style="height:3.050005em;"></span><span class="stretchy" style="height:0.548em;min-width:1.6em;"><span class="brace-left" style="height:0.548em;"><svg width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'><path d='M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z'/></svg></span><span class="brace-center" style="height:0.548em;"><svg width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'><path d='M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z'/></svg></span><span class="brace-right" style="height:0.548em;"><svg width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'><path d='M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z'/></svg></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.592635em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span><span class="mrel mtight">âˆˆ</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.14736em;">N</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0590857142857142em;"><span style="top:-2.188485714285714em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span style="top:-3.059085714285714em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.34722857142857144em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.800425em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">âˆ’</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class="mopen">(</span><span class="mopen">âŸ¨</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.34709999999999996em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.44432em;"><span></span></span></span></span></span></span><span class="mclose">âŸ©</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4484250000000003em;"><span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.1267560000000003em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:0.04203100000000015em;"><span class="pstrut" style="height:3.050005em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord cjk_fallback mtight">è´Ÿæ ·æœ¬ç‰¹å¾æŽ¨å¼€</span></span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span class="svg-align" style="top:-0.6362999999999999em;"><span class="pstrut" style="height:3.050005em;"></span><span class="stretchy" style="height:0.548em;min-width:1.6em;"><span class="brace-left" style="height:0.548em;"><svg width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'><path d='M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z'/></svg></span><span class="brace-center" style="height:0.548em;"><svg width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'><path d='M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z'/></svg></span><span class="brace-right" style="height:0.548em;"><svg width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'><path d='M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z'/></svg></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.5926349999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span><span class="mrel mtight">âˆˆ</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.14736em;">N</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0590857142857142em;"><span style="top:-2.3769714285714283em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span><span style="top:-3.059085714285714em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.29762857142857146em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.765705em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class="mopen">(</span><span class="mopen">âŸ¨</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.34709999999999996em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.35285999999999995em;"><span></span></span></span></span></span></span><span class="mclose">âŸ©</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.413705em;"><span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.0920360000000002em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:0.0310109999999999em;"><span class="pstrut" style="height:3.050005em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord cjk_fallback mtight">é“¾è·¯é¢„æµ‹åˆ†ç±»æŸå¤±</span></span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span class="svg-align" style="top:-0.6473200000000001em;"><span class="pstrut" style="height:3.050005em;"></span><span class="stretchy" style="height:0.548em;min-width:1.6em;"><span class="brace-left" style="height:0.548em;"><svg width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'><path d='M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z'/></svg></span><span class="brace-center" style="height:0.548em;"><svg width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'><path d='M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z'/></svg></span><span class="brace-right" style="height:0.548em;"><svg width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'><path d='M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z'/></svg></span></span></span><span style="top:-3.0500050000000005em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.5926349999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span><span class="mrel mtight">âˆˆ</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.14736em;">N</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0590857142857142em;"><span style="top:-2.3769714285714283em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span style="top:-3.059085714285714em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15874285714285716em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.754685em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.402685em;"><span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.081016em;"><span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.550045em;"><span style="top:-0.7499750000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽ </span></span></span><span style="top:-1.8999850000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽŸ</span></span></span><span style="top:-2.4949950000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽŸ</span></span></span><span style="top:-3.090005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽŸ</span></span></span><span style="top:-3.6850150000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽŸ</span></span></span><span style="top:-4.280025em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽŸ</span></span></span><span style="top:-4.3100249999999996em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽŸ</span></span></span><span style="top:-5.550045em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽž</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.050045em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªå¤æ‚çš„å…¬å¼æ‹†åˆ†ä¸ºä¸‰ä¸ªæ ¸å¿ƒåŠŸèƒ½æ¨¡å—ï¼š</p><ol><li><span style="color: #BB8ED0; font-weight: bold;">æ­£æ ·æœ¬è¡¨ç¤ºå­¦ä¹  (Positive Samples)</span>ï¼š</li></ol><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><munder><mo>âˆ‘</mo><mrow><msub><mi>v</mi><mi>j</mi></msub><mo>âˆˆ</mo><msubsup><mi mathvariant="script">N</mi><mi>b</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msubsup><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></munder><mo>âˆ’</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mi>Ïƒ</mi><mo stretchy="false">(</mo><mo stretchy="false">âŸ¨</mo><msubsup><mi>e</mi><msub><mi>v</mi><mi>i</mi></msub><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup><mo separator="true">,</mo><msubsup><mi>e</mi><msub><mi>v</mi><mi>j</mi></msub><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup><mo stretchy="false">âŸ©</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sum_{v_{j}\in \mathcal{N}_{b}^{(t)}(v_{i})}-log(\sigma(\langle e_{v_{i}}^{\prime}, e_{v_{j}}^{\prime} \rangle))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.8504300000000002em;vertical-align:-1.800425em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.592635em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span><span class="mrel mtight">âˆˆ</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.14736em;">N</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0590857142857142em;"><span style="top:-2.188485714285714em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span style="top:-3.059085714285714em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.34722857142857144em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.800425em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">âˆ’</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class="mopen">(</span><span class="mopen">âŸ¨</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.34709999999999996em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.44432em;"><span></span></span></span></span></span></span><span class="mclose">âŸ©</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p><p>è¿™é‡Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">N</mi><mi>b</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{N}_{b}^{(t)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3461079999999999em;vertical-align:-0.30130799999999996em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.398692em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span style="top:-3.2197999999999998em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.30130799999999996em;"><span></span></span></span></span></span></span></span></span></span> æ˜¯é€šè¿‡å›ºå®šé•¿åº¦éšæœºæ¸¸èµ°ç¡®å®šçš„é‚»å±…èŠ‚ç‚¹é›†åˆã€‚ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">âŸ¨</mo><mo>â‹…</mo><mo separator="true">,</mo><mo>â‹…</mo><mo stretchy="false">âŸ©</mo></mrow><annotation encoding="application/x-tex">\langle \cdot, \cdot \rangle</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">âŸ¨</span><span class="mord">â‹…</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">â‹…</span><span class="mclose">âŸ©</span></span></span></span> æ˜¯ä¸¤ä¸ªç‰¹å¾å‘é‡çš„å†…ç§¯ã€‚é€šè¿‡æœ€å°åŒ–è¿™ä¸ªè´Ÿå¯¹æ•°ä¼¼ç„¶ï¼Œæ¨¡åž‹åœ¨å¼ºåˆ¶è®©åŒä¸€IDçš„èŠ‚ç‚¹ç‰¹å¾åœ¨åµŒå…¥ç©ºé—´ä¸­é å¾—æ›´è¿‘ã€‚</p><ol start="2"><li><span style="color: #BB8ED0; font-weight: bold;">è´Ÿæ ·æœ¬è¡¨ç¤ºå­¦ä¹  (Negative Samples)</span>ï¼š</li></ol><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>w</mi><mi>g</mi></msub><munder><mo>âˆ‘</mo><mrow><msub><mi>v</mi><mi>k</mi></msub><mo>âˆˆ</mo><msubsup><mi mathvariant="script">N</mi><mi>g</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msubsup><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></munder><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mn>1</mn><mo>âˆ’</mo><mi>Ïƒ</mi><mo stretchy="false">(</mo><mo stretchy="false">âŸ¨</mo><msubsup><mi>e</mi><msub><mi>v</mi><mi>i</mi></msub><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup><mo separator="true">,</mo><msubsup><mi>e</mi><msub><mi>v</mi><mi>k</mi></msub><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup><mo stretchy="false">âŸ©</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">w_g \sum_{v_{k}\in\mathcal{N}_{g}^{(t)}(v_{i})}log(1-\sigma(\langle e_{v_{i}}^{\prime}, e_{v_{k}}^{\prime} \rangle))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.81571em;vertical-align:-1.765705em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.5926349999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span><span class="mrel mtight">âˆˆ</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.14736em;">N</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0590857142857142em;"><span style="top:-2.3769714285714283em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span><span style="top:-3.059085714285714em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.29762857142857146em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.765705em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.154752em;vertical-align:-0.35285999999999995em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class="mopen">(</span><span class="mopen">âŸ¨</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.34709999999999996em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.35285999999999995em;"><span></span></span></span></span></span></span><span class="mclose">âŸ©</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">N</mi><mi>g</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{N}_{g}^{(t)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2974999999999999em;vertical-align:-0.2526999999999999em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.5834080000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2526999999999999em;"><span></span></span></span></span></span></span></span></span></span> æ˜¯éšæœºæŠ½å–çš„è´Ÿæ ·æœ¬èŠ‚ç‚¹ã€‚è¶…å‚æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>g</mi></msub></mrow><annotation encoding="application/x-tex">w_g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>æ˜¯<strong>è´Ÿé‡‡æ ·æ¯”ä¾‹</strong> (Negative Sampling Ratio)ï¼Œç”¨äºŽå¹³è¡¡æ­£è´Ÿæ ·æœ¬çš„æƒé‡ã€‚è¿™ä¸€é¡¹è´Ÿè´£å°†ä¸åŒ ID çš„èŠ‚ç‚¹åœ¨ç‰¹å¾ç©ºé—´ä¸­æŽ¨å¼€ã€‚</p><ol start="3"><li><span style="color: #BB8ED0; font-weight: bold;">åˆ†ç±»å™¨æŸå¤± (Classifier Loss)</span>ï¼š</li></ol><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><munder><mo>âˆ‘</mo><mrow><msub><mi>v</mi><mi>j</mi></msub><mo>âˆˆ</mo><msubsup><mi mathvariant="script">N</mi><mi>a</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msubsup><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></munder><msub><mi mathvariant="script">L</mi><mi>c</mi></msub><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>v</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sum_{v_{j}\in \mathcal{N}_{a}^{(t)}(v_{i})}\mathcal{L}_{c}(v_{i}, v_{j})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.80469em;vertical-align:-1.754685em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.5926349999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span><span class="mrel mtight">âˆˆ</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.14736em;">N</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0590857142857142em;"><span style="top:-2.3769714285714283em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span style="top:-3.059085714285714em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15874285714285716em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.754685em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æ˜¯é“¾è·¯åˆ†ç±»å™¨çš„æŸå¤± 10ã€‚<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">N</mi><mi>a</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{N}_{a}^{(t)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.161392em;vertical-align:-0.11659199999999997em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.5834080000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.11659199999999997em;"><span></span></span></span></span></span></span></span></span></span> æ˜¯æ­£è´Ÿæ ·æœ¬çš„å¹¶é›†ã€‚è¿™ä¸€é¡¹ç›´æŽ¥ç›‘ç£æœ€ç»ˆçš„åˆ†ç±»ç»“æžœï¼Œç¡®ä¿äº†ç»è¿‡æ³¨æ„åŠ›æœºåˆ¶å¢žå¼ºåŽçš„ç‰¹å¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>e</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></mrow><annotation encoding="application/x-tex">e&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span> èƒ½å¤Ÿç›´æŽ¥æœåŠ¡äºŽæœ€åŽçš„ ID åŒ¹é…ä»»åŠ¡ã€‚</p><h3 id="æ¨¡åž‹è®­ç»ƒ"><a class="markdownIt-Anchor" href="#æ¨¡åž‹è®­ç»ƒ"></a> æ¨¡åž‹è®­ç»ƒ</h3><p>æˆ‘ä»¬å…ˆå‡ç»ƒä¸€ä¸‹å‰ä¸¤ç« åšäº†ä»€ä¹ˆã€‚</p><ul><li><p><span style="color: #BB8ED0; font-weight: bold;">æ—¶ç©ºæ³¨æ„åŠ›ç‰¹å¾å¢žå¼º</span>ï¼š<span style="color: #89986D; font-weight: bold;">è¯¥èŠ‚é€šè¿‡ä¸²è”ç»“æž„æ³¨æ„åŠ›ï¼ˆSALï¼‰ä¸Žæ—¶åºæ³¨æ„åŠ›ï¼ˆTALï¼‰ï¼Œå®žçŽ°äº†å¯¹åŽŸå§‹ç‰¹å¾çš„æ·±åº¦æçº¯ã€‚SAL ç»“åˆæ‘„åƒå¤´ä½ç½®ç¼–ç ï¼Œåœ¨ç©ºé—´ç»´åº¦èšåˆé‚»åŸŸä¿¡æ¯ä»¥æ•æ‰ç›¸æœºé—´çš„æ‹“æ‰‘å…³ç³»ï¼›TAL åˆ™åœ¨æ—¶é—´ç»´åº¦åˆ©ç”¨å¸¦æŽ©ç çš„è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼Œå»ºæ¨¡ç›®æ ‡ç‰¹å¾éšæ—¶é—´æ¼”å˜çš„åŠ¨æ€è§„å¾‹å¹¶ç¡®ä¿åœ¨çº¿è·Ÿè¸ªçš„å› æžœæ€§ã€‚ä¸¤è€…ååŒå°†ä¸ç¨³å®šçš„è§†è§‰å¿«ç…§è½¬åŒ–ä¸ºå…·å¤‡æ—¶ç©ºé²æ£’æ€§çš„é«˜ç»´èŠ‚ç‚¹åµŒå…¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>e</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></mrow><annotation encoding="application/x-tex">e&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span>ã€‚</span></p></li><li><p><span style="color: #BB8ED0; font-weight: bold;">èº«ä»½å…³è”ä¸Žæ¨¡åž‹æŸå¤±å‡½æ•°å®šä¹‰</span>ï¼š<span style="color: #89986D; font-weight: bold;">è¯¥èŠ‚å°†æ•°æ®å…³è”ä»»åŠ¡é‡æž„ä¸ºåŠ¨æ€å›¾ä¸Šçš„é“¾è·¯é¢„æµ‹é—®é¢˜ ï¼Œåˆ©ç”¨èŠ‚ç‚¹åµŒå…¥çš„å“ˆè¾¾çŽ›ç§¯é…åˆ Softmax åˆ†ç±»å™¨è®¡ç®—å…³è”æ¦‚çŽ‡ ã€‚ä¸ºé©±åŠ¨æ¨¡åž‹æ¼”è¿›ï¼Œå®šä¹‰äº†è€¦åˆâ€œè¡¨ç¤ºå­¦ä¹ â€ä¸Žâ€œåˆ†ç±»ç²¾åº¦â€çš„è”åˆæŸå¤±å‡½æ•° ï¼Œé€šè¿‡æ­£æ ·æœ¬æ‹‰è¿‘ã€è´Ÿæ ·æœ¬æŽ¨å¼€åŠåˆ†ç±»è¯¯å·®ç›‘ç£ä¸‰é‡çº¦æŸã€‚</span></p></li></ul><p>æœ€åŽæ˜¯è®­ç»ƒéƒ¨åˆ†ï¼Œæ¨¡åž‹çš„æ ¸å¿ƒåœ¨äºŽ<span style="color: #BB8ED0; font-weight: bold;">è”åˆå­¦ä¹ ï¼ˆJoint Learningï¼‰</span>ï¼Œå³åŒæ—¶è®­ç»ƒè‡ªæ³¨æ„åŠ›æ¨¡å—å’Œé“¾è·¯åˆ†ç±»å™¨ã€‚</p><p>æ¨¡åž‹å°†æ•°æ®åˆ‡åˆ†ä¸ºå¤§å°ä¸º 3 çš„<strong>æ—¶ç©ºå—ï¼ˆChunksï¼‰</strong>ï¼Œæ¨¡æ‹Ÿè¿‡åŽ»-çŽ°åœ¨çš„æ—¶é—´è·¨åº¦è¿›è¡Œé¢„æµ‹è®­ç»ƒã€‚æ¯ä¸€ä¸ªæ—¶ç©ºå—å®žé™…ä¸Šæ˜¯ä¸€ä¸ªå¾®ç¼©çš„åŠ¨æ€å›¾æ¼”åŒ–åºåˆ—ï¼šæ¨¡åž‹åˆ©ç”¨å‰ä¸¤ä¸ªæ—¶é—´æ­¥ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>âˆ’</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">t-2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69841em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69841em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>ï¼‰å·²å»ºç«‹çš„å›¾ç»“æž„å’ŒèŠ‚ç‚¹ç‰¹å¾ä½œä¸ºåŽ†å²ä¸Šä¸‹æ–‡ï¼Œæ¥é¢„æµ‹å½“å‰æ­¥ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span></span></span></span>ï¼‰æ–°åŠ å…¥èŠ‚ç‚¹çš„èº«ä»½åˆ†é…ã€‚</p><p>æœ€ç»ˆçš„æ¨¡åž‹ï¼Œæ˜¯ä¸€ä¸ªä»¥ <span style="color: #89986D; font-weight: bold;">2å±‚SAL + 2å±‚TAL + 1å±‚å…¨è¿žæŽ¥åˆ†ç±»å™¨ </span>ä¸ºæ ¸å¿ƒçš„åŠ¨æ€å›¾ç¥žç»ç½‘ç»œã€‚å®ƒæ˜¯ä»¥ DeepSORT äº§ç”Ÿçš„å±€éƒ¨è½¨è¿¹ä¸ºè¾“å…¥ï¼Œåœ¨ Tensorflow çŽ¯å¢ƒä¸‹åˆ©ç”¨ Adam ä¼˜åŒ–å™¨å®Œæˆæœ€ç»ˆè®­ç»ƒçš„ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;è®ºæ–‡ç²¾è¯» DyGLIP: A Dynamic Graph Model with Link Prediction forAccurate Multi-Camera Multiple Object Tracking&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>åŸºäºŽCesiumçš„ä¸‰ç»´è§†é”¥ç»˜åˆ¶ä¸Žç”»é¢æ¨¡æ‹Ÿ</title>
    <link href="https://atffang.github.io/2025/12/22/%E5%9F%BA%E4%BA%8ECesium%E7%9A%84%E4%B8%89%E7%BB%B4%E8%A7%86%E9%94%A5%E7%BB%98%E5%88%B6%E4%B8%8E%E7%94%BB%E9%9D%A2%E6%A8%A1%E6%8B%9F/"/>
    <id>https://atffang.github.io/2025/12/22/%E5%9F%BA%E4%BA%8ECesium%E7%9A%84%E4%B8%89%E7%BB%B4%E8%A7%86%E9%94%A5%E7%BB%98%E5%88%B6%E4%B8%8E%E7%94%BB%E9%9D%A2%E6%A8%A1%E6%8B%9F/</id>
    <published>2025-12-22T06:41:48.000Z</published>
    <updated>2025-12-29T06:54:40.379Z</updated>
    
    <content type="html"><![CDATA[<p>åŸºäºŽCesiumçš„ä¸‰ç»´è§†é”¥ç»˜åˆ¶ä¸Žç”»é¢æ¨¡æ‹Ÿ</p><span id="more"></span><p>æœ‰æœ‹å‹å’¨è¯¢æˆ‘cesiumä¸‹çš„è§†é”¥ç»˜åˆ¶ä¸Žç›‘æŽ§è§†è§’æ¨¡æ‹Ÿæ˜¯å¦‚ä½•å®žçŽ°çš„ï¼Œè¿™é‡Œä»¥JavaScriptä¸ºä¾‹ï¼Œç»™å‡ºä¸€äº›ç¤ºä¾‹ä»£ç ã€‚å‰ç½®æ¡ä»¶æ˜¯ï¼Œåˆ›å»ºäº†Cesiumçš„Viewerï¼Œè€Œä¸ºäº†è§‚å¯Ÿæ›´åŠ çœŸå®žçš„æ¨¡æ‹Ÿè§†è§’ï¼Œå¯ä»¥å‘åœ°å›¾æ·»åŠ 3dtilesã€‚<br /><img src="https://atffang.github.io/2025/12/22/åŸºäºŽCesiumçš„ä¸‰ç»´è§†é”¥ç»˜åˆ¶ä¸Žç”»é¢æ¨¡æ‹Ÿ/è§†é”¥1.jpg"/><br /><img src="https://atffang.github.io/2025/12/22/åŸºäºŽCesiumçš„ä¸‰ç»´è§†é”¥ç»˜åˆ¶ä¸Žç”»é¢æ¨¡æ‹Ÿ/è§†é”¥2.jpg"/></p><p><strong>ç©ºé—´å®šä½å‚æ•°</strong>ï¼šå…±åŒç¡®å®šäº†è§†é”¥ä½“çš„é¡¶ç‚¹ä½ç½®åŠå…¶åœ¨ä¸‰ç»´åœ°çƒåæ ‡ç³»ä¸­çš„æŒ‡å‘ã€‚</p><ul><li><strong>Position (Lon, Lat, Alt)</strong>ï¼šè§†é”¥ä½“çš„<strong>é¡¶ç‚¹åæ ‡</strong>ã€‚å®ƒæ˜¯ç›¸æœºçš„å…‰å¿ƒä½ç½®ï¼Œå³æ‰€æœ‰è§†çº¿çš„æ±‡èšç‚¹ã€‚åœ¨ Cesium ä¸­é€šå¸¸ä½¿ç”¨ç»çº¬åº¦å’Œé«˜åº¦</li><li><strong>Orientation (Heading, Pitch, Roll)</strong>ï¼šè§†é”¥ä½“çš„*<ul><li><strong>Heading</strong>ï¼šå†³å®šæ°´å¹³æ—‹è½¬ï¼ˆå·¦å³çœ‹ï¼‰</li><li><strong>Pitch</strong>ï¼šå†³å®šä¿¯ä»°è§’åº¦ï¼ˆä¸Šä¸‹çœ‹ï¼‰ï¼Œé€šå¸¸ç›‘æŽ§è§†è§’ä¸ºè´Ÿå€¼ã€‚</li><li><strong>Roll</strong>ï¼šå†³å®šç›¸æœºçš„ä¾§å€¾ï¼ˆ</li></ul></li></ul><p><strong>é•œå¤´å‡ ä½•å‚æ•°</strong>ï¼šå®šä¹‰äº†è§†é”¥ä½“æˆªé¢çš„å½¢çŠ¶ï¼Œæ¨¡æ‹Ÿäº†ä¸åŒç„¦è·é•œå¤´äº§ç”Ÿçš„è§†è§‰æ•ˆæžœã€‚</p><ul><li><strong>FOV (Field of View - è§†åœºè§’)</strong>ï¼šé€šå¸¸æŒ‡<strong>åž‚ç›´æ–¹å‘çš„å¼ è§’</strong>ã€‚FOV è¶Šå¤§ï¼Œç”»é¢å®¹çº³çš„å†…å®¹è¶Šå¤šï¼ˆå¹¿è§’é•œå¤´ï¼‰ï¼›FOV è¶Šå°ï¼Œç”»é¢è¶Šçª„ï¼ˆé•¿ç„¦é•œå¤´ï¼‰ã€‚</li><li><strong>Aspect Ratio (å®½é«˜æ¯”)</strong>ï¼šå³è§†é‡Žæˆªé¢çš„<strong>å®½åº¦ä¸Žé«˜åº¦ä¹‹æ¯”</strong>ã€‚å®ƒå¿…é¡»ä¸Žä½ çš„æ˜¾ç¤ºç”»å¸ƒï¼ˆCanvasï¼‰æˆ–è§†é¢‘æµï¼ˆå¦‚ 16:9ï¼‰ä¸€è‡´ï¼Œå¦åˆ™ç”»é¢ä¼šäº§ç”Ÿæ‹‰ä¼¸æˆ–åŽ‹ç¼©ã€‚</li></ul><p><strong>è£å‰ªå¹³é¢å‚æ•°</strong>ï¼šå®šä¹‰äº†è§†é”¥ä½“åœ¨è§†çº¿æ–¹å‘ä¸Šçš„æœ‰æ•ˆæ¸²æŸ“èŒƒå›´ã€‚</p><ul><li><strong>Near (è¿‘è£å‰ªé¢)</strong>ï¼šè·ç¦»ç›¸æœºçš„æœ€è¿‘å¯è§è·ç¦»ã€‚å°äºŽæ­¤è·ç¦»çš„ç‰©ä½“ä¼šè¢«åˆ‡æŽ‰ï¼ˆé˜²æ­¢ç›¸æœºç©¿æ¨¡ï¼‰ã€‚</li><li><strong>Far (è¿œè£å‰ªé¢)</strong>ï¼šè·ç¦»ç›¸æœºçš„æœ€è¿œå¯è§è·ç¦»ã€‚è¶…è¿‡æ­¤è·ç¦»çš„ç‰©ä½“å°†ä¸å†æ¸²æŸ“ï¼Œè¿™ç›´æŽ¥å½±å“æ¸²æŸ“æ€§èƒ½å’Œåœ°å¹³çº¿çš„å¯è§åº¦ã€‚</li></ul><p>ç»˜åˆ¶æµç¨‹é¦–å…ˆé€šè¿‡ <code>Cesium.Cartesian3.fromDegrees</code> å°†ç»çº¬åº¦é«˜åº¦è½¬æ¢ä¸ºç©ºé—´ä½ç½®ï¼ŒéšåŽåˆ©ç”¨ <code>HeadingPitchRoll</code> ç»“åˆ <strong>-90 åº¦çš„åæ ‡ç³»åç§»æ ¡å‡†</strong>ç”Ÿæˆå››å…ƒæ•°ï¼Œä»¥ç¡®å®šè§†é”¥åœ¨åœ°çƒè¡¨é¢çš„ç²¾ç¡®æŒ‡å‘ã€‚<br />æŽ¥ç€å®žä¾‹åŒ– <code>PerspectiveFrustum</code> æ¥å®šä¹‰é€è§†çŸ©é˜µçš„æ ¸å¿ƒå±žæ€§ï¼ˆå¦‚å¼ è§’ã€å®½é«˜æ¯”åŠè¿œè¿‘å¹³é¢ï¼‰ï¼Œå¹¶åŸºäºŽæ­¤æ•°å­¦æ¨¡åž‹åˆ†åˆ«åˆ›å»º <code>FrustumGeometry</code>ï¼ˆå¡«å……ä½“ï¼‰å’Œ <code>FrustumOutlineGeometry</code>ï¼ˆè½®å»“çº¿ï¼‰ä¸¤ä¸ªå‡ ä½•å®žä¾‹ã€‚<br />æœ€åŽï¼Œé€šè¿‡è®¾ç½® <code>ColorGeometryInstanceAttribute</code> å®šä¹‰é¢œè‰²ä¸Žé€æ˜Žåº¦ï¼Œå°†å®žä¾‹å°è£…è¿› <code>Primitive</code> ä¸­å¹¶åŒæ­¥æ·»åŠ åˆ°åœºæ™¯é›†åˆ <code>viewer.scene.primitives</code>ï¼Œä»Žè€Œåœ¨ä¸‰ç»´ç©ºé—´ä¸­æ¸²æŸ“å‡ºä¸€ä¸ªä»£è¡¨ç›¸æœºç›‘æŽ§èŒƒå›´çš„åŠé€æ˜Žå››æ£±å°ã€‚</p><p>ç»™å‡ºå®žçŽ°ç»˜åˆ¶è§†é”¥çš„ä»£ç ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Cesium è§†é”¥ä½“ï¼ˆä¼ æ„Ÿå™¨/ç›¸æœºè§†é‡Žï¼‰å¯è§†åŒ–å·¥å…·</span></span><br><span class="line"><span class="comment"> * é€‚ç”¨åœºæ™¯ï¼šç›¸æœºç›‘æŽ§èŒƒå›´æ¨¡æ‹Ÿã€å¤šç›®æ ‡è·Ÿè¸ª(MTMC)è§†é‡Žå±•ç¤º</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">FrustumVisualizer</span> &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * åˆ›å»ºå¹¶æ·»åŠ ä¸€ä¸ªè§†é”¥ä½“åˆ°åœºæ™¯ä¸­</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">Cesium.Viewer</span>&#125; <span class="variable">viewer</span> - Cesium è§†å›¾å®žä¾‹</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; <span class="variable">params</span> - é…ç½®å‚æ•°</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; params.lon - ç»åº¦ (åº¦)</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; params.lat - çº¬åº¦ (åº¦)</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; params.alt - é«˜åº¦ (ç±³)</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; [params.heading=0] - åèˆªè§’ (0ä¸ºæ­£åŒ—ï¼Œé¡ºæ—¶é’ˆä¸ºæ­£)</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; [params.pitch=-30] - ä¿¯ä»°è§’ (è´Ÿæ•°å‘ä¸‹çœ‹)</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; [params.vfov=60] - åž‚ç›´è§†åœºè§’ (åº¦)</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; [params.aspectRatio=1.77] - å®½é«˜æ¯” (16/9 â‰ˆ 1.77)</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; [params.near=0.1] - è¿‘è£å‰ªé¢è·ç¦» (ç±³)</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; [params.far=50] - è¿œè£å‰ªé¢è·ç¦» (ç±³)</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">Cesium.Color</span>&#125; [params.color] - è§†é”¥é¢œè‰²</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns</span> &#123;<span class="type">Object</span>&#125; åŒ…å« fill å’Œ outline ä¸¤ä¸ª Primitive å¯¹è±¡çš„å®žä¾‹ï¼Œç”¨äºŽåŽç»­é”€æ¯</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">createFrustum</span>(<span class="params">viewer, params</span>) &#123;</span><br><span class="line">    <span class="comment">// 1. æå–å‚æ•°å¹¶è®¾ç½®é»˜è®¤å€¼</span></span><br><span class="line">    <span class="keyword">const</span> &#123;</span><br><span class="line">      lon, lat, alt,</span><br><span class="line">      heading = <span class="number">0</span>,</span><br><span class="line">      pitch = -<span class="number">30</span>,</span><br><span class="line">      vfov = <span class="number">60</span>,</span><br><span class="line">      aspectRatio = <span class="number">16</span> / <span class="number">9</span>,</span><br><span class="line">      near = <span class="number">0.5</span>,</span><br><span class="line">      far = <span class="number">50</span>,</span><br><span class="line">      color = <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">RED</span></span><br><span class="line">    &#125; = params;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. ç©ºé—´ä½ç½®è®¡ç®—ï¼šå°†ç»çº¬åº¦è½¬æ¢ä¸º Cesium ç¬›å¡å°”ç©ºé—´åæ ‡ (XYZ)</span></span><br><span class="line">    <span class="keyword">const</span> position = <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(lon, lat, alt);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. å§¿æ€è®¡ç®— (Orientation)</span></span><br><span class="line">    <span class="comment">// æ³¨æ„ï¼šCesium é»˜è®¤ FrustumGeometry çš„æœå‘æ˜¯æ²¿å±€éƒ¨ Z è½´è´Ÿæ–¹å‘</span></span><br><span class="line">    <span class="comment">// ä¸ºäº†ç¬¦åˆåœ°å›¾å¸¸è§„ï¼ˆHeading 0æŒ‡å‘åŒ—ï¼‰ï¼Œéœ€è¦è¿›è¡Œ -90 åº¦çš„åæ ‡ç³»åç§»æ ¡å‡†</span></span><br><span class="line">    <span class="keyword">const</span> hpr = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">HeadingPitchRoll</span>(</span><br><span class="line">      <span class="title class_">Cesium</span>.<span class="property">Math</span>.<span class="title function_">toRadians</span>(heading - <span class="number">90</span>), <span class="comment">// è°ƒæ•´ Heading ä½¿ 0 åº¦æŒ‡å‘åŒ—æ–¹</span></span><br><span class="line">      <span class="title class_">Cesium</span>.<span class="property">Math</span>.<span class="title function_">toRadians</span>(pitch - <span class="number">90</span>),   <span class="comment">// è°ƒæ•´ Pitch ä½¿ 0 åº¦æ°´å¹³ï¼Œè´Ÿå€¼å‘ä¸‹</span></span><br><span class="line">      <span class="title class_">Cesium</span>.<span class="property">Math</span>.<span class="title function_">toRadians</span>(<span class="number">0</span>)             <span class="comment">// Roll æ»šåŠ¨è§’</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†ä½ç½®å’Œæ—‹è½¬è§’åº¦è½¬æ¢ä¸ºå››å…ƒæ•°ï¼ˆQuaternionï¼‰ï¼Œè¿™æ˜¯ Cesium å®šä½å‡ ä½•ä½“çš„æ ‡å‡†æ–¹å¼</span></span><br><span class="line">    <span class="keyword">const</span> orientationQuat = <span class="title class_">Cesium</span>.<span class="property">Transforms</span>.<span class="title function_">headingPitchRollQuaternion</span>(position, hpr);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4. å®šä¹‰è§†é”¥å‡ ä½•å±žæ€§ (Frustum Definition)</span></span><br><span class="line">    <span class="keyword">const</span> frustum = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">PerspectiveFrustum</span>(&#123;</span><br><span class="line">      <span class="attr">fov</span>: <span class="title class_">Cesium</span>.<span class="property">Math</span>.<span class="title function_">toRadians</span>(vfov), <span class="comment">// å¼§åº¦å•ä½çš„è§†åœºè§’</span></span><br><span class="line">      <span class="attr">aspectRatio</span>: <span class="number">1.0</span> / aspectRatio,   <span class="comment">// æ³¨æ„ï¼šCesium çš„å‡ ä½•å®½é«˜æ¯”é€šå¸¸å–å€’æ•°</span></span><br><span class="line">      <span class="attr">near</span>: near,</span><br><span class="line">      <span class="attr">far</span>: far</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 5. åˆ›å»ºâ€œå¡«å……ä½“â€å‡ ä½•å®žä¾‹</span></span><br><span class="line">    <span class="keyword">const</span> fillInstance = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">GeometryInstance</span>(&#123;</span><br><span class="line">      <span class="attr">geometry</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">FrustumGeometry</span>(&#123;</span><br><span class="line">        <span class="attr">frustum</span>: frustum,</span><br><span class="line">        <span class="attr">origin</span>: position,</span><br><span class="line">        <span class="attr">orientation</span>: orientationQuat,</span><br><span class="line">        <span class="attr">vertexFormat</span>: <span class="title class_">Cesium</span>.<span class="property">VertexFormat</span>.<span class="property">POSITION_ONLY</span> <span class="comment">// ä»…éœ€ä½ç½®ä¿¡æ¯ï¼Œæé«˜æ¸²æŸ“æ•ˆçŽ‡</span></span><br><span class="line">      &#125;),</span><br><span class="line">      <span class="attr">attributes</span>: &#123;</span><br><span class="line">        <span class="comment">// è®¾ç½®å®žä¾‹é¢œè‰²å±žæ€§</span></span><br><span class="line">        <span class="attr">color</span>: <span class="title class_">Cesium</span>.<span class="property">ColorGeometryInstanceAttribute</span>.<span class="title function_">fromColor</span>(color.<span class="title function_">withAlpha</span>(<span class="number">0.25</span>))</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 6. åˆ›å»ºâ€œè½®å»“çº¿â€å‡ ä½•å®žä¾‹</span></span><br><span class="line">    <span class="keyword">const</span> outlineInstance = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">GeometryInstance</span>(&#123;</span><br><span class="line">      <span class="attr">geometry</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">FrustumOutlineGeometry</span>(&#123;</span><br><span class="line">        <span class="attr">frustum</span>: frustum,</span><br><span class="line">        <span class="attr">origin</span>: position,</span><br><span class="line">        <span class="attr">orientation</span>: orientationQuat</span><br><span class="line">      &#125;),</span><br><span class="line">      <span class="attr">attributes</span>: &#123;</span><br><span class="line">        <span class="attr">color</span>: <span class="title class_">Cesium</span>.<span class="property">ColorGeometryInstanceAttribute</span>.<span class="title function_">fromColor</span>(color.<span class="title function_">withAlpha</span>(<span class="number">0.8</span>))</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 7. å°†å‡ ä½•ä½“ä½œä¸º Primitive æ·»åŠ åˆ°åœºæ™¯</span></span><br><span class="line">    <span class="comment">// Primitive æ¯” Entity æ›´åº•å±‚ï¼Œé€‚åˆé«˜é¢‘åˆ›å»ºæˆ–å¤§é‡å±•ç¤º</span></span><br><span class="line">    <span class="keyword">const</span> fillPrimitive = viewer.<span class="property">scene</span>.<span class="property">primitives</span>.<span class="title function_">add</span>(<span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Primitive</span>(&#123;</span><br><span class="line">      <span class="attr">geometryInstances</span>: fillInstance,</span><br><span class="line">      <span class="attr">appearance</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">PerInstanceColorAppearance</span>(&#123;</span><br><span class="line">        <span class="attr">closed</span>: <span class="literal">true</span>,      <span class="comment">// å°é—­å‡ ä½•ä½“</span></span><br><span class="line">        <span class="attr">translucent</span>: <span class="literal">true</span>  <span class="comment">// å¼€å¯é€æ˜Žæ”¯æŒ</span></span><br><span class="line">      &#125;),</span><br><span class="line">      <span class="attr">asynchronous</span>: <span class="literal">false</span>  <span class="comment">// åŒæ­¥åˆ›å»ºï¼Œé˜²æ­¢ç¬¬ä¸€å¸§ä¸æ˜¾ç¤º</span></span><br><span class="line">    &#125;));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> outlinePrimitive = viewer.<span class="property">scene</span>.<span class="property">primitives</span>.<span class="title function_">add</span>(<span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Primitive</span>(&#123;</span><br><span class="line">      <span class="attr">geometryInstances</span>: outlineInstance,</span><br><span class="line">      <span class="attr">appearance</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">PerInstanceColorAppearance</span>(&#123;</span><br><span class="line">        <span class="attr">flat</span>: <span class="literal">true</span>,        <span class="comment">// çº¿æ¡ä½¿ç”¨æ‰å¹³ç€è‰²ï¼Œä¸è®¡ç®—å…‰ç…§</span></span><br><span class="line">        <span class="attr">translucent</span>: <span class="literal">true</span></span><br><span class="line">      &#125;),</span><br><span class="line">      <span class="attr">asynchronous</span>: <span class="literal">false</span></span><br><span class="line">    &#125;));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿”å›žå¯¹è±¡ï¼Œæ–¹ä¾¿å¤–éƒ¨ç®¡ç†ï¼ˆå¦‚ï¼šremovalï¼‰</span></span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">fill</span>: fillPrimitive, <span class="attr">outline</span>: outlinePrimitive &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä½ çš„ä¸»é€»è¾‘æ–‡ä»¶ä¸­ï¼Œç›´æŽ¥ä¼ å…¥åæ ‡å’Œæ—‹è½¬å‚æ•°ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‡è®¾ä½ å·²ç»åˆå§‹åŒ–äº† viewer</span></span><br><span class="line"><span class="keyword">const</span> cameraOptions = &#123;</span><br><span class="line">  <span class="attr">lon</span>: <span class="number">121.45</span>,       <span class="comment">// ç»åº¦</span></span><br><span class="line">  <span class="attr">lat</span>: <span class="number">31.22</span>,        <span class="comment">// çº¬åº¦</span></span><br><span class="line">  <span class="attr">alt</span>: <span class="number">10</span>,          <span class="comment">// ç¦»åœ°é«˜åº¦ 10 ç±³</span></span><br><span class="line">  <span class="attr">heading</span>: <span class="number">45</span>,       <span class="comment">// æœå‘ä¸œåŒ—</span></span><br><span class="line">  <span class="attr">pitch</span>: -<span class="number">45</span>,        <span class="comment">// å‘ä¸‹ä¿¯å†² 45 åº¦çœ‹åœ°é¢</span></span><br><span class="line">  <span class="attr">vfov</span>: <span class="number">50</span>,          <span class="comment">// è§†é‡ŽèŒƒå›´</span></span><br><span class="line">  <span class="attr">color</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">AQUA</span> <span class="comment">// ä¹Ÿå¯ä»¥è‡ªå®šä¹‰é¢œè‰²</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è°ƒç”¨å¹¶å­˜å‚¨è¿”å›žçš„å¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> myFrustum = <span class="title class_">FrustumVisualizer</span>.<span class="title function_">createFrustum</span>(viewer, cameraOptions);</span><br></pre></td></tr></table></figure><p>æ¨¡æ‹Ÿæµç¨‹é¦–å…ˆæ ¹æ®ä¼ æ„Ÿå™¨åæ ‡è®¾å®šç›¸æœºçš„ <code>destination</code> ç›®æ ‡ä½ç½®ï¼ŒéšåŽè°ƒç”¨ <code>viewer.camera.flyTo</code> å¹¶ä¼ å…¥åŽŸå§‹çš„èˆªå‘è§’ï¼ˆHeadingï¼‰ä¸Žä¿¯ä»°è§’ï¼ˆPitchï¼‰ï¼Œå¯åŠ¨å¹³æ»‘é£žè¡Œè¿‡æ¸¡ä»¥å¯¹å‡†è§‚å¯Ÿæ–¹å‘ã€‚<br />åœ¨ç›¸æœºé£žæŠµæŒ‡å®šç‚¹åŽï¼Œæœ€å…³é”®çš„ä¸€æ­¥æ˜¯<strong>æ‰‹åŠ¨è¦†ç›– <code>viewer.camera.frustum</code> å±žæ€§</strong>ï¼Œé€šè¿‡ <code>new Cesium.PerspectiveFrustum</code> å¼ºåˆ¶ä¿®æ”¹ç›¸æœºçš„æŠ•å½±çŸ©é˜µã€‚é€šè¿‡åŒæ­¥åž‚ç›´è§†åœºè§’ï¼ˆfovï¼‰ã€ç”»å¸ƒå®½é«˜æ¯”ï¼ˆaspectRatioï¼‰ä»¥åŠè¿œè¿‘è£å‰ªé¢ï¼Œä½¿å½“å‰å±å¹•æ˜¾ç¤ºçš„æ¸²æŸ“ç”»é¢ä¸Žä¹‹å‰åœ¨åœºæ™¯ä¸­ç»˜åˆ¶çš„çº¢è‰²è§†é”¥å‡ ä½•ä½“åœ¨æ•°å­¦æŠ•å½±ä¸Šå®Œå…¨é‡åˆã€‚<br />ç»™å‡ºæ¨¡æ‹Ÿè§†é”¥è§†è§’çš„ä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å°†åœºæ™¯ç›¸æœºå®šä½è‡³æŒ‡å®šä¼ æ„Ÿå™¨è§†è§’ï¼Œå¹¶åŒæ­¥é•œå¤´å‚æ•°</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Cesium.Viewer</span>&#125; <span class="variable">viewer</span> - Cesium è§†å›¾å®žä¾‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; <span class="variable">props</span> - ä¼ æ„Ÿå™¨å‚æ•°å¯¹è±¡</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; props.lon - ç»åº¦</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; props.lat - çº¬åº¦</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; props.alt - é«˜åº¦ (ç±³)</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; props.heading - åèˆªè§’ (åº¦)</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; props.pitch - ä¿¯ä»°è§’ (åº¦)</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; props.vfov - åž‚ç›´è§†åœºè§’ (åº¦)</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; props.aspectRatio - å®½é«˜æ¯”</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; props.near - è¿‘è£å‰ªé¢è·ç¦»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; props.far - è¿œè£å‰ªé¢è·ç¦»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">goToCameraView</span>(<span class="params">viewer, props</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!viewer || !props) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 1. è®¡ç®—ç›¸æœºç›®æ ‡ä½ç½® (Cartesian3 ç¬›å¡å°”åæ ‡)</span></span><br><span class="line">  <span class="keyword">const</span> destination = <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(</span><br><span class="line">    props.<span class="property">lon</span>, </span><br><span class="line">    props.<span class="property">lat</span>, </span><br><span class="line">    props.<span class="property">alt</span></span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2. æ‰§è¡Œç›¸æœºé£žè¡Œå®šä½</span></span><br><span class="line">  viewer.<span class="property">camera</span>.<span class="title function_">flyTo</span>(&#123;</span><br><span class="line">    <span class="attr">destination</span>: destination,</span><br><span class="line">    <span class="attr">orientation</span>: &#123;</span><br><span class="line">      <span class="comment">// Cesium ç›¸æœºé»˜è®¤ 0 åº¦æŒ‡å‘æ­£åŒ—ï¼Œæ— éœ€åƒå‡ ä½•ä½“é‚£æ ·åš -90 åº¦æ ¡å‡†</span></span><br><span class="line">      <span class="attr">heading</span>: <span class="title class_">Cesium</span>.<span class="property">Math</span>.<span class="title function_">toRadians</span>(props.<span class="property">heading</span>),</span><br><span class="line">      <span class="attr">pitch</span>: <span class="title class_">Cesium</span>.<span class="property">Math</span>.<span class="title function_">toRadians</span>(props.<span class="property">pitch</span>),</span><br><span class="line">      <span class="attr">roll</span>: <span class="number">0.0</span> <span class="comment">// ä¿æŒæ°´å¹³ï¼Œä¸ç¿»è½¬</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">duration</span>: <span class="number">1.5</span> <span class="comment">// é£žè¡ŒæŒç»­æ—¶é—´ï¼ˆç§’ï¼‰</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3. åŒæ­¥ç›¸æœºçš„è§†é”¥ä½“ï¼ˆLens Parametersï¼‰</span></span><br><span class="line">  <span class="comment">// æ ¸å¿ƒé€»è¾‘ï¼šå°†è™šæ‹Ÿç›¸æœºçš„â€œé•œå¤´â€ä¿®æ”¹ä¸ºä¸Žç»˜åˆ¶çš„è§†é”¥å‡ ä½•å®Œå…¨ä¸€è‡´</span></span><br><span class="line">  viewer.<span class="property">camera</span>.<span class="property">frustum</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">PerspectiveFrustum</span>(&#123;</span><br><span class="line">    <span class="comment">// å°†åž‚ç›´è§†åœºè§’ä»Žåº¦è½¬æ¢ä¸ºå¼§åº¦</span></span><br><span class="line">    <span class="attr">fov</span>: <span class="title class_">Cesium</span>.<span class="property">Math</span>.<span class="title function_">toRadians</span>(props.<span class="property">vfov</span>),</span><br><span class="line">    <span class="comment">// ç”»é¢å®½é«˜æ¯”ï¼Œå†³å®šäº†æ¨ªå‘è§†é‡Žçš„å¼€é˜”åº¦</span></span><br><span class="line">    <span class="attr">aspectRatio</span>: props.<span class="property">aspectRatio</span>,</span><br><span class="line">    <span class="comment">// å†³å®šç›¸æœºèƒ½çœ‹åˆ°çš„æœ€è¿‘å’Œæœ€è¿œè·ç¦»</span></span><br><span class="line">    <span class="attr">near</span>: props.<span class="property">near</span>,</span><br><span class="line">    <span class="attr">far</span>: props.<span class="property">far</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;åŸºäºŽCesiumçš„ä¸‰ç»´è§†é”¥ç»˜åˆ¶ä¸Žç”»é¢æ¨¡æ‹Ÿ&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>ä»Ž0å¼€å§‹å­¦JAVA 4 JAVAçº¿ç¨‹æ–¹æ³•æ±‡æ€»</title>
    <link href="https://atffang.github.io/2025/12/22/JAVA%E5%A4%9A%E7%BA%BF%E7%A8%8B%E6%96%B9%E6%B3%95%E6%B1%87%E6%80%BB/"/>
    <id>https://atffang.github.io/2025/12/22/JAVA%E5%A4%9A%E7%BA%BF%E7%A8%8B%E6%96%B9%E6%B3%95%E6%B1%87%E6%80%BB/</id>
    <published>2025-12-22T02:37:17.000Z</published>
    <updated>2025-12-29T06:54:30.563Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸‡å­—é•¿æ–‡æ¢³ç†JAVAçº¿ç¨‹æ–¹æ³•çš„åŸºç¡€åº”ç”¨</p><span id="more"></span><h3 id="ç¬¬ä¸€ç« å¤šçº¿ç¨‹åŸºç¡€"><a class="markdownIt-Anchor" href="#ç¬¬ä¸€ç« å¤šçº¿ç¨‹åŸºç¡€"></a> ç¬¬ä¸€ç« ï¼šå¤šçº¿ç¨‹åŸºç¡€</h3><p>åœ¨ Java ä¸­ï¼Œçº¿ç¨‹ï¼ˆThreadï¼‰æ˜¯æ“ä½œç³»ç»Ÿè°ƒåº¦çš„æœ€å°å•å…ƒã€‚ç†è§£å¤šçº¿ç¨‹ï¼Œé¦–å…ˆè¦ä»Žå¦‚ä½•å¯åŠ¨å®ƒã€å®ƒç»åŽ†è¿‡å“ªäº›çŠ¶æ€ã€ä»¥åŠæˆ‘ä»¬å¦‚ä½•æŽ§åˆ¶å®ƒå¼€å§‹ã€‚</p><h4 id="çº¿ç¨‹çš„åˆ›å»ºæ–¹å¼"><a class="markdownIt-Anchor" href="#çº¿ç¨‹çš„åˆ›å»ºæ–¹å¼"></a> çº¿ç¨‹çš„åˆ›å»ºæ–¹å¼</h4><p>è™½ç„¶æœ€ç»ˆéƒ½æ˜¯é€šè¿‡ <code>Thread.start()</code> å¯åŠ¨ï¼Œä½† Java æä¾›äº†<strong>ä¸‰ç§ä¸»è¦çš„ä»»åŠ¡å®šä¹‰æ–¹å¼</strong>ï¼š</p><ul><li><strong>ç»§æ‰¿ <code>Thread</code> ç±»</strong>ï¼š<ul><li><strong>åšæ³•</strong>ï¼šå®šä¹‰ä¸€ä¸ªç±»ç»§æ‰¿ <code>Thread</code> å¹¶é‡å†™ <code>run()</code> æ–¹æ³•ã€‚</li><li><strong>ç¼ºç‚¹</strong>ï¼šJava æ˜¯å•ç»§æ‰¿çš„ï¼Œç»§æ‰¿äº† Thread å°±ä¸èƒ½å†ç»§æ‰¿å…¶ä»–ç±»ï¼ˆå¦‚ BaseServiceï¼‰ï¼Œçµæ´»æ€§å·®ã€‚</li></ul></li></ul><p>æˆ‘ä»¬ç›´æŽ¥newä¸€ä¸ªTreadç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;  </span><br><span class="line">    <span class="type">Thread</span> <span class="variable">thread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>() &#123;  </span><br><span class="line">        <span class="meta">@Override</span>  </span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;  </span><br><span class="line">            <span class="built_in">super</span>.run();  </span><br><span class="line">            System.out.println(<span class="string">&quot;run: &quot;</span> + <span class="built_in">this</span>.getState());</span><br><span class="line">              </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;;  </span><br><span class="line">  </span><br><span class="line">    System.out.println(<span class="string">&quot;main: &quot;</span> + thread.getState());  </span><br><span class="line">    thread.start();  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong>å®žçŽ° <code>Runnable</code> æŽ¥å£</strong>ï¼ˆæŽ¨èï¼‰ï¼š<ul><li><strong>åšæ³•</strong>ï¼šå®žçŽ° <code>run()</code> æ–¹æ³•ï¼Œå¹¶å°†å…¶ä½œä¸ºå‚æ•°ä¼ é€’ç»™ <code>Thread</code> æž„é€ å‡½æ•°ã€‚</li><li><strong>ä¼˜ç‚¹</strong>ï¼šè§£è€¦äº†â€œä»»åŠ¡é€»è¾‘â€ä¸Žâ€œçº¿ç¨‹èµ„æºâ€ã€‚å¤šä¸ªçº¿ç¨‹å¯ä»¥æ‰§è¡ŒåŒä¸€ä¸ª <code>Runnable</code> å®žä¾‹ï¼Œé€‚åˆèµ„æºå…±äº«ã€‚</li></ul></li></ul><p><strong><code>Runnable</code> æŽ¥å£</strong>ã€‚<code>Runnable</code> æ˜¯ Java ä¸­ä¸€ä¸ªåŠŸèƒ½æ€§çš„æŽ¥å£ï¼Œå®ƒå®šä¹‰äº†ä¸€ä¸ª <code>run()</code> æ–¹æ³•ã€‚å®žçŽ°è¿™ä¸ªæŽ¥å£çš„ç±»ï¼ˆå¦‚ <code>TaskRunnable</code>ï¼‰è¡¨ç¤ºä¸€ä¸ªä»»åŠ¡ï¼Œè¿™ä¸ªä»»åŠ¡å¯ä»¥è¢«ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œã€‚</p><p><strong><code>Thread</code> ä¸Ž <code>Runnable</code></strong>ï¼š<code>Thread</code> ç±»ç”¨äºŽè¡¨ç¤ºä¸€ä¸ªæ‰§è¡Œçš„çº¿ç¨‹ï¼Œä½†å®ƒå¹¶ä¸ç›´æŽ¥å®šä¹‰è¦åšä»€ä¹ˆã€‚<code>Thread</code> éœ€è¦ä¸€ä¸ª <code>Runnable</code> å¯¹è±¡ï¼Œæ¥ç¡®å®šçº¿ç¨‹å¯åŠ¨åŽåº”è¯¥æ‰§è¡Œä»€ä¹ˆæ ·çš„ä»»åŠ¡ã€‚æ‰€ä»¥ï¼Œ<code>Thread</code> ä¼šå°†ä¸€ä¸ª <code>Runnable</code> å¯¹è±¡ä¼ ç»™å…¶æž„é€ æ–¹æ³•ï¼Œè¿™æ ·çº¿ç¨‹å°±çŸ¥é“äº†æ‰§è¡Œä»€ä¹ˆä»»åŠ¡ã€‚</p><p>æˆ‘ä»¬å®žçŽ°ä¸€ä¸ª<code>runnableæŽ¥å£</code>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;  </span><br><span class="line">    <span class="type">TaskRunnable</span> <span class="variable">taskRunnable</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TaskRunnable</span>();  </span><br><span class="line">    <span class="type">Thread</span> <span class="variable">thread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(taskRunnable);  </span><br><span class="line">    thread.start();  </span><br><span class="line">    <span class="keyword">try</span> &#123;  </span><br><span class="line">        Thread.sleep(<span class="number">10000</span>);  </span><br><span class="line">        taskRunnable.cancel();  </span><br><span class="line">          </span><br><span class="line">    &#125;<span class="keyword">catch</span> (InterruptedException e)&#123;  </span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">TaskRunnable</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="type">boolean</span> cancel;  </span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span>  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;  </span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;  </span><br><span class="line">            <span class="keyword">if</span> (cancel)&#123;  </span><br><span class="line">                <span class="keyword">break</span>;  </span><br><span class="line">            &#125;  </span><br><span class="line">  </span><br><span class="line">            <span class="keyword">try</span>&#123;  </span><br><span class="line">                Thread.sleep(<span class="number">1000</span>);  </span><br><span class="line">            &#125;<span class="keyword">catch</span> (InterruptedException e)&#123;  </span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);  </span><br><span class="line">            &#125;  </span><br><span class="line">  </span><br><span class="line">            System.out.println(<span class="string">&quot;running&quot;</span>);  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">cancel</span><span class="params">()</span> &#123;  </span><br><span class="line">        cancel = <span class="literal">true</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong>å®žçŽ° <code>Callable</code> æŽ¥å£</strong>ï¼š<ul><li><strong>åšæ³•</strong>ï¼šå®žçŽ° <code>call()</code> æ–¹æ³•ï¼Œé…åˆ <code>FutureTask</code> æˆ–çº¿ç¨‹æ± ä½¿ç”¨ã€‚</li><li><strong>æ ¸å¿ƒåŒºåˆ«</strong>ï¼š<code>call()</code> æ–¹æ³•<strong>æœ‰è¿”å›žå€¼</strong>ä¸”<strong>å…è®¸æŠ›å‡ºå¼‚å¸¸</strong>ï¼Œè€Œ <code>run()</code> ä¸è¡Œã€‚</li></ul></li></ul><p>æˆ‘ä»¬æ¥å®žçŽ°ä¸€ä¸ª<code>Callable</code> æŽ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CallableBaseDemo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// 1. å®šä¹‰ä»»åŠ¡ï¼šå®žçŽ° Callable æŽ¥å£ï¼Œæ³›åž‹ String æ˜¯è¿”å›žå€¼çš„ç±»åž‹</span></span><br><span class="line">        Callable&lt;String&gt; myTask = <span class="keyword">new</span> <span class="title class_">Callable</span>&lt;String&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> String <span class="title function_">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                Thread.sleep(<span class="number">2000</span>); <span class="comment">// æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ</span></span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼šè¿™æ˜¯ä»Žå­çº¿ç¨‹è¿”å›žçš„ç»“æžœï¼&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. åŒ…è£…ä»»åŠ¡ï¼šç”±äºŽ Thread æž„é€ æ–¹æ³•åªæŽ¥æ”¶ Runnableï¼Œ</span></span><br><span class="line">        <span class="comment">// æˆ‘ä»¬éœ€è¦ç”¨ FutureTask åŒ…è£…ä¸€ä¸‹ã€‚FutureTask å®žçŽ°äº† Runnable æŽ¥å£ã€‚</span></span><br><span class="line">        FutureTask&lt;String&gt; futureTask = <span class="keyword">new</span> <span class="title class_">FutureTask</span>&lt;&gt;(myTask);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3. å¯åŠ¨çº¿ç¨‹</span></span><br><span class="line">        <span class="type">Thread</span> <span class="variable">thread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(futureTask);</span><br><span class="line">        thread.start();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸»çº¿ç¨‹ï¼šå·²ç»å¯åŠ¨å­çº¿ç¨‹ï¼Œæˆ‘çŽ°åœ¨å¯ä»¥åšç‚¹åˆ«çš„äº‹...&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4. èŽ·å–ç»“æžœï¼šget() æ–¹æ³•ä¼šé˜»å¡žå½“å‰çº¿ç¨‹ï¼Œç›´åˆ°å­çº¿ç¨‹æ‰§è¡Œå®Œæ¯•å¹¶è¿”å›žç»“æžœ</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> futureTask.get(); </span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸»çº¿ç¨‹æ”¶åˆ°çš„ç»“æžœ: &quot;</span> + result);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»¼ä¸Šï¼Œä¸‰ç§å®žçŽ°æ–¹å¼çš„åŒºåˆ«åœ¨äºŽï¼š</p><table><thead><tr><th><strong>ç‰¹æ€§</strong></th><th><strong>Thread</strong></th><th><strong>Runnable</strong></th><th><strong>Callable</strong></th></tr></thead><tbody><tr><td><strong>ç»§æ‰¿æ€§</strong></td><td>é™åˆ¶å•ç»§æ‰¿</td><td>æ— é™åˆ¶</td><td>æ— é™åˆ¶</td></tr><tr><td><strong>è¿”å›žå€¼</strong></td><td>æ— </td><td>æ— </td><td>æœ‰ (FutureèŽ·å–)</td></tr><tr><td><strong>å¼‚å¸¸æŠ›å‡º</strong></td><td>åªèƒ½å†…éƒ¨æ•èŽ·</td><td>åªèƒ½å†…éƒ¨æ•èŽ·</td><td>å…è®¸ throws æŠ›å‡º</td></tr></tbody></table><h4 id="çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸä¸ŽçŠ¶æ€è½¬æ¢-state-machine"><a class="markdownIt-Anchor" href="#çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸä¸ŽçŠ¶æ€è½¬æ¢-state-machine"></a> çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸä¸ŽçŠ¶æ€è½¬æ¢ (State Machine)</h4><p>Java çº¿ç¨‹åœ¨ç”Ÿå‘½å‘¨æœŸå†…å¹¶ä¸æ˜¯ä¸€ç›´å ç€ CPU ä¸æ”¾ï¼Œå®ƒä¼šåœ¨å¤šç§çŠ¶æ€é—´åˆ‡æ¢ã€‚é€šè¿‡ <code>thread.getState()</code> å¯ä»¥èŽ·å–ä»¥ä¸‹å…­ç§çŠ¶æ€ï¼š</p><ol><li><p><strong>NEW (æ–°å»º)</strong>ï¼š<code>new Thread()</code> ä¹‹åŽï¼Œè°ƒç”¨ <code>start()</code> ä¹‹å‰ã€‚</p></li><li><p><strong>RUNNABLE (å¯è¿è¡Œ)</strong>ï¼šè°ƒç”¨äº† <code>start()</code>ã€‚åœ¨ Java ä¸­ï¼Œå°±ç»ªï¼ˆReadyï¼‰å’Œè¿è¡Œä¸­ï¼ˆRunningï¼‰ç»Ÿç§°ä¸ºâ€œå¯è¿è¡Œâ€ã€‚</p></li><li><p><strong>BLOCKED (é˜»å¡ž)</strong>ï¼šç­‰å¾…èŽ·å– <code>synchronized</code> é”ã€‚</p></li><li><p><strong>WAITING (ç­‰å¾…)</strong>ï¼šè°ƒç”¨äº† <code>wait()</code>ã€<code>join()</code> æˆ– <code>LockSupport.park()</code>ã€‚éœ€è¦è¢«å…¶ä»–çº¿ç¨‹æ˜¾å¼å”¤é†’ã€‚</p></li><li><p><strong>TIMED_WAITING (è¶…æ—¶ç­‰å¾…)</strong>ï¼šè°ƒç”¨äº† <code>sleep(ms)</code>ã€<code>wait(ms)</code> ç­‰ã€‚æ—¶é—´åˆ°äº†è‡ªåŠ¨è‹é†’ã€‚</p></li><li><p><strong>TERMINATED (ç»ˆæ­¢)</strong>ï¼š<code>run()</code> æ–¹æ³•æ‰§è¡Œå®Œæ¯•æˆ–å› å¼‚å¸¸é€€å‡ºã€‚</p></li></ol><img src="https://atffang.github.io/2025/12/22/JAVAå¤šçº¿ç¨‹æ–¹æ³•æ±‡æ€»/çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ.png"/><h4 id="åŸºç¡€æŽ§åˆ¶æ–¹æ³•"><a class="markdownIt-Anchor" href="#åŸºç¡€æŽ§åˆ¶æ–¹æ³•"></a> åŸºç¡€æŽ§åˆ¶æ–¹æ³•</h4><p>è¿™ä¸€èŠ‚ä»‹ç»çš„æ˜¯ Java <code>Thread</code> ç±»ä¸­æä¾›çš„å‡ ä¸ªæ ¸å¿ƒæŽ§åˆ¶æ–¹æ³•ï¼Œå®ƒä»¬å†³å®šäº†çº¿ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­çš„è¡Œä¸ºã€‚</p><h5 id="1-sleeplong-millis"><a class="markdownIt-Anchor" href="#1-sleeplong-millis"></a> 1. sleep(long millis)</h5><p><code>sleep</code> æ˜¯é™æ€æ–¹æ³•ï¼Œä½¿å½“å‰çº¿ç¨‹è¿›å…¥ <strong>TIMED_WAITING</strong> çŠ¶æ€ï¼Œæš‚åœæ‰§è¡Œä¸€æ®µæ—¶é—´ã€‚</p><ul><li><strong>é”çš„è¡Œä¸º</strong>ï¼šçº¿ç¨‹åœ¨ç¡çœ æ—¶<strong>ä¸ä¼šé‡Šæ”¾</strong>å®ƒæŒæœ‰çš„ä»»ä½•é”ï¼ˆMonitor Lockï¼‰ã€‚</li><li><strong>å¼‚å¸¸å¤„ç†</strong>ï¼šç¡çœ ä¸­çš„çº¿ç¨‹å¦‚æžœè¢«ä¸­æ–­ï¼Œä¼šæŠ›å‡º <code>InterruptedException</code>ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    Thread.sleep(<span class="number">1000</span>); <span class="comment">// æš‚åœ1ç§’</span></span><br><span class="line">&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">    <span class="comment">// çº¿ç¨‹åœ¨ä¼‘çœ ä¸­è¢«ä¸­æ–­æ—¶çš„å¤„ç†é€»è¾‘</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="2-yield"><a class="markdownIt-Anchor" href="#2-yield"></a> 2. yield()</h5><p><code>yield</code> ä¹Ÿæ˜¯é™æ€æ–¹æ³•ï¼Œå®ƒè¡¨ç¤ºå½“å‰çº¿ç¨‹æ„¿æ„è®©å‡º CPU çš„ä½¿ç”¨æƒã€‚</p><ul><li><strong>è°ƒåº¦ç»“æžœ</strong>ï¼šè°ƒç”¨åŽï¼Œçº¿ç¨‹ä»Žâ€œè¿è¡Œä¸­â€å˜ä¸ºâ€œå°±ç»ªâ€çŠ¶æ€ã€‚</li><li><strong>å±€é™æ€§</strong>ï¼šè¿™åªæ˜¯ä¸€ä¸ªâ€œå»ºè®®â€ï¼Œçº¿ç¨‹è°ƒåº¦å™¨å¯èƒ½ä¼šå¿½ç•¥å®ƒã€‚å¦‚æžœå½“å‰æ²¡æœ‰å…¶ä»–åŒä¼˜å…ˆçº§çš„çº¿ç¨‹ï¼Œè¯¥çº¿ç¨‹å¯èƒ½ç«‹å³å†æ¬¡èŽ·å¾— CPUã€‚</li><li><strong>é”çš„è¡Œä¸º</strong>ï¼šåŒæ ·ä¸ä¼šé‡Šæ”¾é”ã€‚</li></ul><h5 id="3-join"><a class="markdownIt-Anchor" href="#3-join"></a> 3. join()</h5><p><code>join</code> æ˜¯æˆå‘˜æ–¹æ³•ï¼Œç”¨äºŽåŒæ­¥å¤šä¸ªçº¿ç¨‹çš„æ‰§è¡Œé¡ºåºã€‚</p><ul><li><strong>ä½œç”¨</strong>ï¼šå¦‚æžœåœ¨çº¿ç¨‹ A ä¸­è°ƒç”¨ <code>B.join()</code>ï¼Œåˆ™ A çº¿ç¨‹ä¼šè¿›å…¥ <strong>WAITING</strong> çŠ¶æ€ï¼Œç›´åˆ° B çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ã€‚</li><li><strong>åŽŸç†</strong>ï¼šåº•å±‚è°ƒç”¨çš„æ˜¯ <code>Object.wait()</code> æ–¹æ³•ï¼Œå› æ­¤è°ƒç”¨è€…ä¼šé‡Šæ”¾æŽ‰ B çº¿ç¨‹å¯¹è±¡çš„é”ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Thread</span> <span class="variable">t1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123; <span class="comment">/* è€—æ—¶ä»»åŠ¡ */</span> &#125;);</span><br><span class="line">t1.start();</span><br><span class="line">t1.join(); <span class="comment">// ä¸»çº¿ç¨‹åœ¨æ­¤é˜»å¡žï¼Œç›´åˆ° t1 å½»åº•è¿è¡Œç»“æŸ</span></span><br></pre></td></tr></table></figure><h5 id="4-interrupt"><a class="markdownIt-Anchor" href="#4-interrupt"></a> 4. interrupt()</h5><p>Java é‡‡ç”¨çš„æ˜¯åä½œå¼çš„ä¸­æ–­æœºåˆ¶ï¼Œè€Œä¸æ˜¯æš´åŠ›åœæ­¢ã€‚</p><ul><li><strong>interrupt()</strong>ï¼šå°†ç›®æ ‡çº¿ç¨‹çš„ä¸­æ–­æ ‡å¿—ä½è®¾ä¸º <code>true</code>ã€‚</li><li><strong>isInterrupted()</strong>ï¼šå®žä¾‹æ–¹æ³•ï¼Œåˆ¤æ–­çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­ã€‚</li><li><strong>é™æ€ interrupted()</strong>ï¼šæ£€æŸ¥å½“å‰çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ï¼Œå¹¶<strong>æ¸…é™¤</strong>æ ‡å¿—ä½ã€‚</li><li><strong>ç‰¹æ®Šæƒ…å†µ</strong>ï¼šå¦‚æžœçº¿ç¨‹æ­£é˜»å¡žåœ¨ <code>sleep</code>ã€<code>wait</code>ã€<code>join</code> ç­‰æ–¹æ³•ä¸Šï¼Œ<code>interrupt()</code> ä¼šä½¿è¿™äº›æ–¹æ³•æŠ›å‡ºå¼‚å¸¸ï¼Œå¹¶è‡ªåŠ¨æ¸…é™¤ä¸­æ–­çŠ¶æ€ï¼ˆå˜å›ž <code>false</code>ï¼‰ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (!Thread.currentThread().isInterrupted()) &#123;</span><br><span class="line">    <span class="comment">// æ‰§è¡Œä¸šåŠ¡é€»è¾‘</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="5-å®ˆæŠ¤çº¿ç¨‹-daemon-thread"><a class="markdownIt-Anchor" href="#5-å®ˆæŠ¤çº¿ç¨‹-daemon-thread"></a> 5. å®ˆæŠ¤çº¿ç¨‹ (Daemon Thread)</h5><p>Java ä¸­çš„çº¿ç¨‹åˆ†ä¸ºâ€œç”¨æˆ·çº¿ç¨‹â€å’Œâ€œå®ˆæŠ¤çº¿ç¨‹â€</p><ul><li><strong>å®šä¹‰</strong>ï¼šå®ˆæŠ¤çº¿ç¨‹æ˜¯ä¸ºç”¨æˆ·çº¿ç¨‹æœåŠ¡çš„ï¼ˆå¦‚ GC åžƒåœ¾å›žæ”¶ï¼‰ã€‚</li><li><strong>é€€å‡ºæœºåˆ¶</strong>ï¼šå½“ JVM ä¸­æ‰€æœ‰çš„ç”¨æˆ·çº¿ç¨‹éƒ½è¿è¡Œç»“æŸæ—¶ï¼Œå®ˆæŠ¤çº¿ç¨‹ä¼šéš JVM ä¸€èµ·ç›´æŽ¥é€€å‡ºï¼Œæ— è®ºå…¶ä»»åŠ¡æ˜¯å¦å®Œæˆã€‚</li><li><strong>é™åˆ¶</strong>ï¼šå¿…é¡»åœ¨ <code>thread.start()</code> ä¹‹å‰è°ƒç”¨ <code>setDaemon(true)</code>ã€‚</li></ul><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;  </span><br><span class="line">    <span class="type">Thread</span> <span class="variable">daemonThread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>() &#123;  </span><br><span class="line">        <span class="meta">@Override</span>  </span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span>&#123;  </span><br><span class="line">            <span class="built_in">super</span>.run();  </span><br><span class="line">                System.out.println(getName() + <span class="string">&quot; &quot;</span> + System.currentTimeMillis());  </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;;  </span><br><span class="line">  </span><br><span class="line">    daemonThread.setName(<span class="string">&quot;B&quot;</span>);  </span><br><span class="line">    daemonThread.setDaemon(<span class="literal">true</span>);  </span><br><span class="line">  </span><br><span class="line">    daemonThread.start();  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç¬¬äºŒç« çº¿ç¨‹å®‰å…¨ä¸Žå†…å­˜æ¨¡åž‹-safety-jmm"><a class="markdownIt-Anchor" href="#ç¬¬äºŒç« çº¿ç¨‹å®‰å…¨ä¸Žå†…å­˜æ¨¡åž‹-safety-jmm"></a> ç¬¬äºŒç« ï¼šçº¿ç¨‹å®‰å…¨ä¸Žå†…å­˜æ¨¡åž‹ (Safety &amp; JMM)</h3><p>çº¿ç¨‹å®‰å…¨çš„æ ¸å¿ƒåœ¨äºŽï¼šå½“å¤šä¸ªçº¿ç¨‹è®¿é—®ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¦‚æžœä¸ç”¨è€ƒè™‘è¿™äº›çº¿ç¨‹åœ¨è¿è¡Œæ—¶çŽ¯å¢ƒä¸‹çš„è°ƒåº¦å’Œäº¤æ›¿æ‰§è¡Œï¼Œä¹Ÿä¸éœ€è¦è¿›è¡Œé¢å¤–çš„åŒæ­¥ï¼Œè°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„è¡Œä¸ºéƒ½å¯ä»¥èŽ·å¾—æ­£ç¡®çš„ç»“æžœï¼Œé‚£è¿™ä¸ªå¯¹è±¡å°±æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p><h4 id="ä»€ä¹ˆæ˜¯çº¿ç¨‹å®‰å…¨"><a class="markdownIt-Anchor" href="#ä»€ä¹ˆæ˜¯çº¿ç¨‹å®‰å…¨"></a> ä»€ä¹ˆæ˜¯çº¿ç¨‹å®‰å…¨ï¼Ÿ</h4><p>è¦å®žçŽ°çº¿ç¨‹å®‰å…¨ï¼Œå¿…é¡»ä¿è¯å¹¶å‘ç¼–ç¨‹çš„ä¸‰å¤§ç‰¹æ€§ï¼š</p><ol><li><p><strong>åŽŸå­æ€§ (Atomicity)</strong>ï¼šä¸€ä¸ªæˆ–å¤šä¸ªæ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œä¸”åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸è¢«ä»»ä½•å› ç´ æ‰“æ–­ï¼Œè¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œã€‚</p><ul><li><em>å…¸åž‹é—®é¢˜</em>ï¼š<code>i++</code> åŒ…å«è¯»ã€åŠ ã€å†™ä¸‰æ­¥ï¼Œåœ¨å¤šçº¿ç¨‹ä¸‹ä¸å…·å¤‡åŽŸå­æ€§ã€‚</li></ul></li><li><p><strong>å¯è§æ€§ (Visibility)</strong>ï¼šå½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†å…±äº«å˜é‡çš„å€¼ï¼Œå…¶ä»–çº¿ç¨‹èƒ½å¤Ÿç«‹å³å¾—çŸ¥è¿™ä¸ªä¿®æ”¹ã€‚</p><ul><li><em>åŽŸå› </em>ï¼šJMM è§„å®šçº¿ç¨‹æœ‰å·¥ä½œå†…å­˜ï¼Œä¿®æ”¹å˜é‡åŽä¸ä¼šç«‹å³åŒæ­¥åˆ°ä¸»å†…å­˜ã€‚</li></ul></li><li><p><strong>æœ‰åºæ€§ (Ordering)</strong>ï¼šç¨‹åºæ‰§è¡Œçš„é¡ºåºæŒ‰ç…§ä»£ç çš„å…ˆåŽé¡ºåºæ‰§è¡Œã€‚</p><ul><li><em>åŽŸå› </em>ï¼šç¼–è¯‘å™¨å’Œå¤„ç†å™¨ä¸ºäº†ä¼˜åŒ–æ€§èƒ½ï¼Œå¾€å¾€ä¼šå¯¹æŒ‡ä»¤è¿›è¡Œ<strong>é‡æŽ’åº</strong>ã€‚</li></ul></li></ol><h4 id="synchronized-å…³é”®å­—"><a class="markdownIt-Anchor" href="#synchronized-å…³é”®å­—"></a> <code>synchronized</code> å…³é”®å­—</h4><p><code>synchronized</code> æ˜¯ä¸€ç§äº’æ–¥é”ï¼Œå®ƒé€šè¿‡æŽ§åˆ¶å¤šä¸ªçº¿ç¨‹å¯¹å…±äº«èµ„æºçš„è®¿é—®ï¼Œä¸€æ¬¡åªå…è®¸ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œï¼Œä»Žè€ŒåŒæ—¶ä¿è¯äº†åŽŸå­æ€§ã€å¯è§æ€§å’Œæœ‰åºæ€§ã€‚</p><p><code>synchronized</code> åº•å±‚ä¾èµ– JVM çš„ <strong>Monitorï¼ˆç›‘è§†å™¨é”ï¼‰</strong>ã€‚ç¼–è¯‘åŽä¼šç”Ÿæˆ <code>monitorenter</code> å’Œ <code>monitorexit</code> æŒ‡ä»¤ã€‚æ¯ä¸ªå¯¹è±¡å¤´ä¸­éƒ½æœ‰ Mark Wordï¼Œè®°å½•äº†é”çš„çŠ¶æ€ï¼ˆåå‘é”ã€è½»é‡çº§é”ã€é‡é‡çº§é”ï¼‰ã€‚</p><p>ä¸‹é¢æ˜¯ä¸¤ä¸ªä¸åŒçš„åº”ç”¨ï¼š</p><p><code>synchronized</code> æ–¹æ³•<br />åœ¨ä¸€ä¸ªæ–¹æ³•ä¸Šä½¿ç”¨ <code>synchronized</code>ï¼Œå¯ä»¥ä¿è¯åŒä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹è®¿é—®è¯¥æ–¹æ³•ã€‚è¿™å¯¹äºŽæ¶‰åŠå…±äº«èµ„æºçš„æ“ä½œå¾ˆæœ‰ç”¨ï¼Œé˜²æ­¢å¤šä¸ªçº¿ç¨‹åŒæ—¶ä¿®æ”¹èµ„æºå¯¼è‡´çŠ¶æ€ä¸ä¸€è‡´ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">someMethod</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// åŒæ­¥çš„ä»£ç å—</span></span><br><span class="line">    <span class="comment">// æ‰§è¡Œä¸€äº›å¯¹å…±äº«èµ„æºçš„æ“ä½œ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>synchronized</code> ä»£ç å—<br />æœ‰æ—¶å€™æˆ‘ä»¬å¹¶ä¸éœ€è¦æ•´ä¸ªæ–¹æ³•éƒ½ä¿æŒåŒæ­¥ï¼Œè€Œæ˜¯åªéœ€è¦æŸéƒ¨åˆ†ä»£ç åœ¨æ‰§è¡Œæ—¶æ˜¯äº’æ–¥çš„ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <strong><code>synchronized</code> ä»£ç å—</strong>ã€‚é€šè¿‡æŒ‡å®šä¸€ä¸ªå¯¹è±¡é”æ¥æŽ§åˆ¶ä»£ç å—çš„åŒæ­¥ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">synchronized</span> (é”å¯¹è±¡) &#123;</span><br><span class="line">    <span class="comment">// éœ€è¦åŒæ­¥çš„ä»£ç </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p><code>é”å¯¹è±¡</code>ï¼šå®ƒå¯ä»¥æ˜¯ä»»æ„å¯¹è±¡ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªå…±äº«å¯¹è±¡ã€‚<code>synchronized</code> å…³é”®å­—ä¼šå°†è¯¥å¯¹è±¡ä½œä¸ºé”ï¼Œåªå…è®¸ä¸€ä¸ªçº¿ç¨‹åœ¨åŒä¸€æ—¶é—´è¿›å…¥è¯¥ä»£ç å—ã€‚</p></li><li><p>å¦‚æžœå¤šä¸ªçº¿ç¨‹è¯•å›¾åŒæ—¶è¿›å…¥è¯¥åŒæ­¥ä»£ç å—ï¼Œå®ƒä»¬å¿…é¡»ç­‰å¾…å…¶ä»–çº¿ç¨‹é‡Šæ”¾è¯¥é”ã€‚</p></li><li><p><strong>æ–¹æ³•çº§é”</strong>ï¼šå½“ä½ ç”¨ <code>synchronized</code> ä¿®é¥°ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œé”çš„ç²’åº¦æ˜¯<strong>æ–¹æ³•çº§åˆ«</strong>çš„ã€‚åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è®¿é—®æ–¹æ³•ä¸­çš„åŒæ­¥éƒ¨åˆ†ã€‚</p></li><li><p><strong>ä»£ç å—çº§é”</strong>ï¼šä½¿ç”¨ <code>synchronized</code> ä»£ç å—æ—¶ï¼Œé”çš„ç²’åº¦æ˜¯<strong>ä»£ç å—çº§åˆ«</strong>çš„ã€‚å®ƒåªé”å®šç‰¹å®šçš„èµ„æºï¼Œè€Œä¸æ˜¯æ•´ä¸ªæ–¹æ³•ï¼Œè¿™æ ·å¯ä»¥æé«˜æ€§èƒ½ï¼Œå› ä¸ºä¸å¿…è¦çš„ä»£ç éƒ¨åˆ†ä¸ä¼šè¢«åŒæ­¥ã€‚</p></li></ul><p><code>wait()</code> æ–¹æ³•ä½¿å½“å‰çº¿ç¨‹è¿›å…¥ <strong>ç­‰å¾…çŠ¶æ€</strong>ï¼Œç›´åˆ°å¦ä¸€ä¸ªçº¿ç¨‹å‘å‡ºé€šçŸ¥ï¼ˆé€šè¿‡ <code>notify()</code> æˆ– <code>notifyAll()</code>ï¼‰ã€‚å½“çº¿ç¨‹è°ƒç”¨ <code>wait()</code> æ—¶ï¼Œå®ƒä¼šé‡Šæ”¾å½“å‰æŒæœ‰çš„å¯¹è±¡é”ï¼Œå¹¶ä¸”è¿›å…¥ <strong>ç­‰å¾…é˜Ÿåˆ—</strong>ï¼Œç›´åˆ°è¢«å…¶ä»–çº¿ç¨‹å”¤é†’ã€‚</p><p><code>wait()</code> å¿…é¡»åœ¨ <strong>åŒæ­¥ä»£ç å—</strong> æˆ– <strong>åŒæ­¥æ–¹æ³•</strong> ä¸­è°ƒç”¨ï¼Œå› ä¸ºå®ƒéœ€è¦èŽ·å¾—å¯¹è±¡çš„ç›‘è§†å™¨é”ï¼ˆå³ <code>synchronized</code> é”ï¼‰ã€‚å½“çº¿ç¨‹åœ¨åŒæ­¥æ–¹æ³•æˆ–åŒæ­¥ä»£ç å—ä¸­è°ƒç”¨ <code>wait()</code> æ—¶ï¼Œå®ƒä¼šé‡Šæ”¾å¯¹è±¡çš„é”ï¼Œå…è®¸å…¶ä»–çº¿ç¨‹èŽ·å¾—é”ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">synchronized</span> (someObject) &#123;</span><br><span class="line">    <span class="keyword">while</span> (conditionNotMet) &#123;</span><br><span class="line">        someObject.wait();  <span class="comment">// çº¿ç¨‹åœ¨æ¡ä»¶ä¸æ»¡è¶³æ—¶ç­‰å¾…</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ‰§è¡ŒåŽç»­æ“ä½œ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>notify()</code> æ–¹æ³•å”¤é†’ <strong>ä¸€ä¸ªç­‰å¾…ä¸­çš„çº¿ç¨‹</strong>ã€‚å½“çº¿ç¨‹è°ƒç”¨ <code>notify()</code> æ—¶ï¼Œå®ƒä¼šä»Žç­‰å¾…é˜Ÿåˆ—ä¸­éšæœºé€‰æ‹©ä¸€ä¸ªçº¿ç¨‹ï¼Œå¹¶å°†å…¶å”¤é†’ï¼Œå”¤é†’åŽçš„çº¿ç¨‹ä¼šå°è¯•é‡æ–°èŽ·å–å¯¹è±¡é”ï¼ŒèŽ·å¾—é”åŽæ‰ä¼šç»§ç»­æ‰§è¡Œã€‚</p><ul><li><code>notify()</code> å¿…é¡»åœ¨ <strong>åŒæ­¥ä»£ç å—</strong> æˆ– <strong>åŒæ­¥æ–¹æ³•</strong> ä¸­è°ƒç”¨ã€‚</li><li>è¢«å”¤é†’çš„çº¿ç¨‹ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œè€Œæ˜¯è¿›å…¥ <strong>å¯è¿è¡ŒçŠ¶æ€</strong>ï¼Œç­‰å¾…èŽ·å–å¯¹è±¡é”ã€‚</li></ul><p><code>notifyAll()</code> æ–¹æ³•å”¤é†’ <strong>æ‰€æœ‰ç­‰å¾…ä¸­çš„çº¿ç¨‹</strong>ã€‚ä¸Ž <code>notify()</code> ä¸åŒçš„æ˜¯ï¼Œ<code>notifyAll()</code> ä¼šå”¤é†’æ‰€æœ‰ç­‰å¾…è¯¥å¯¹è±¡é”çš„çº¿ç¨‹ã€‚æ‰€æœ‰å”¤é†’çš„çº¿ç¨‹ä¼šäº‰å¤ºé”ï¼Œåªæœ‰èŽ·å¾—é”çš„çº¿ç¨‹æ‰ä¼šç»§ç»­æ‰§è¡Œã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SharedBuffer</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">data</span> <span class="operator">=</span> -<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç”Ÿäº§è€…</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">produce</span><span class="params">(<span class="type">int</span> value)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="keyword">while</span> (data != -<span class="number">1</span>) &#123;  <span class="comment">// å¦‚æžœæ•°æ®å·²å­˜åœ¨ï¼Œç”Ÿäº§è€…ç­‰å¾…</span></span><br><span class="line">            wait();</span><br><span class="line">        &#125;</span><br><span class="line">        data = value;  <span class="comment">// ç”Ÿäº§æ•°æ®</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Produced: &quot;</span> + value);</span><br><span class="line">        notify();  <span class="comment">// å”¤é†’æ¶ˆè´¹è€…</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¶ˆè´¹è€…</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">consume</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="keyword">while</span> (data == -<span class="number">1</span>) &#123;  <span class="comment">// å¦‚æžœæ•°æ®ä¸ºç©ºï¼Œæ¶ˆè´¹è€…ç­‰å¾…</span></span><br><span class="line">            wait();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;Consumed: &quot;</span> + data);</span><br><span class="line">        data = -<span class="number">1</span>;  <span class="comment">// æ¶ˆè´¹æ•°æ®</span></span><br><span class="line">        notify();  <span class="comment">// å”¤é†’ç”Ÿäº§è€…</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WaitNotifyExample</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">SharedBuffer</span> <span class="variable">buffer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SharedBuffer</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç”Ÿäº§è€…çº¿ç¨‹</span></span><br><span class="line">        <span class="type">Thread</span> <span class="variable">producer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">                    buffer.produce(i);</span><br><span class="line">                    Thread.sleep(<span class="number">100</span>);  <span class="comment">// æ¨¡æ‹Ÿç”Ÿäº§çš„æ—¶é—´</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                Thread.currentThread().interrupt();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ¶ˆè´¹è€…çº¿ç¨‹</span></span><br><span class="line">        <span class="type">Thread</span> <span class="variable">consumer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">                    buffer.consume();</span><br><span class="line">                    Thread.sleep(<span class="number">150</span>);  <span class="comment">// æ¨¡æ‹Ÿæ¶ˆè´¹çš„æ—¶é—´</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                Thread.currentThread().interrupt();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        producer.start();</span><br><span class="line">        consumer.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="volatile-å…³é”®å­—"><a class="markdownIt-Anchor" href="#volatile-å…³é”®å­—"></a> <code>volatile</code> å…³é”®å­—</h4><p><code>volatile</code> æ˜¯ Java æä¾›çš„æœ€è½»é‡çº§çš„åŒæ­¥æœºåˆ¶ï¼Œå®ƒä¿è¯äº†<strong>å¯è§æ€§</strong>å’Œ<strong>æœ‰åºæ€§</strong>ï¼Œä½†<strong>ä¸ä¿è¯åŽŸå­æ€§</strong>ã€‚</p><ul><li><strong>å¯è§æ€§åŽŸç†</strong>ï¼šå†™ä¸€ä¸ª <code>volatile</code> å˜é‡æ—¶ï¼ŒJMM ä¼šæŠŠè¯¥çº¿ç¨‹å¯¹åº”çš„å·¥ä½œå†…å­˜å€¼ç«‹å³åˆ·æ–°åˆ°ä¸»å†…å­˜ï¼›è¯»æ—¶ï¼Œä¼šä½¿æœ¬åœ°å†…å­˜å¤±æ•ˆï¼Œç›´æŽ¥ä»Žä¸»å†…å­˜è¯»å–ã€‚</li><li><strong>ç¦æ­¢é‡æŽ’åº</strong>ï¼šé€šè¿‡æ’å…¥<strong>å†…å­˜å±éšœ</strong>ï¼Œç¡®ä¿ç¼–è¯‘å™¨ä¸ä¼šä¸ºäº†ä¼˜åŒ–è€Œæ”¹å˜æŒ‡ä»¤é¡ºåºã€‚</li></ul><p>ä¸ºäº†ä¸¾ä¾‹ï¼Œæˆ‘ä»¬ä»‹ç»javaä¸­çš„<strong>åŒé‡æ£€æŸ¥é”å®š</strong>ï¼ˆDouble-Checked Locking,<strong>DCL</strong>ï¼‰,ä¸»è¦æ˜¯ä¸ºäº†è§£å†³å•ä¾‹æ¨¡å¼ï¼ˆSingletonï¼‰åœ¨å¤šçº¿ç¨‹çŽ¯å¢ƒä¸‹çš„æ€§èƒ½å’Œå®‰å…¨å¹³è¡¡é—®é¢˜ã€‚</p><p>å¦‚æžœæ²¡æœ‰ DCLï¼Œæˆ‘ä»¬æœ€ç®€å•çš„åŒæ­¥å†™æ³•æ˜¯ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">static</span> Singleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (instance == <span class="literal">null</span>) instance = <span class="keyword">new</span> <span class="title class_">Singleton</span>();</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¯æ¬¡è°ƒç”¨ <code>getInstance()</code> éƒ½è¦åŠ é”ï¼Œè€Œå®žé™…ä¸Šåªæœ‰ç¬¬ä¸€æ¬¡åˆ›å»ºå®žä¾‹æ—¶æ‰éœ€è¦åŒæ­¥ï¼ŒåŽç»­è¯»å–ç›´æŽ¥è¿”å›žå³å¯ã€‚åŠ é”æ˜¯éžå¸¸é‡çš„æ“ä½œï¼Œè¿™ä¼šä¸¥é‡æ‹–æ…¢æ€§èƒ½ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥å…ˆåˆ¤æ–­æ˜¯å¦ä¸º nullï¼Œå¦‚æžœä¸ä¸º null ç›´æŽ¥è¿”å›žï¼›å¦‚æžœä¸º nullï¼Œå†è¿›å…¥åŒæ­¥å—åˆ›å»ºå¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line">    <span class="comment">// å¿…é¡»åŠ  volatileï¼Œé˜²æ­¢æŒ‡ä»¤é‡æŽ’å¯¼è‡´æ‹¿åˆ°å°šæœªåˆå§‹åŒ–çš„å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> Singleton instance;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (Singleton.class) &#123;</span><br><span class="line">                <span class="keyword">if</span> (instance == <span class="literal">null</span>) &#123;</span><br><span class="line">                    instance = <span class="keyword">new</span> <span class="title class_">Singleton</span>(); </span><br><span class="line">                    <span class="comment">// è¿™é‡ŒåŒ…å«ä¸‰æ­¥ï¼š1.åˆ†é…ç©ºé—´ 2.åˆå§‹åŒ– 3.æŒ‡å‘åœ°å€</span></span><br><span class="line">                    <span class="comment">// é‡æŽ’åºå¯èƒ½å¯¼è‡´ï¼š1 -&gt; 3 -&gt; 2ï¼Œä½¿å¾—å…¶ä»–çº¿ç¨‹æ‹¿åˆ°éž null ä½†æœªåˆå§‹åŒ–çš„å¯¹è±¡</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æ¥çœ‹ åŽŸæ¥çš„<code>instance = new Singleton();</code> è¿™ä¸€è¡Œã€‚åœ¨ JVM å±‚é¢ï¼Œå®ƒå…¶å®žè¢«åˆ†æˆäº† <strong>3 ä¸ªæ­¥éª¤</strong>æ‰§è¡Œï¼š</p><ol><li><strong>åˆ†é…å†…å­˜ç©ºé—´</strong>ï¼ˆç»™è¿™ä¸ªå¯¹è±¡æ‰¾å—åœ°æ–¹ï¼‰ã€‚</li><li><strong>åˆå§‹åŒ–å¯¹è±¡</strong>ï¼ˆæ‰§è¡Œæž„é€ å‡½æ•°é‡Œçš„é€»è¾‘ï¼‰ã€‚</li><li><strong>å°† instance å˜é‡æŒ‡å‘åˆ†é…çš„å†…å­˜åœ°å€</strong>ï¼ˆæ­¤æ—¶ instance ä¸å†æ˜¯ null äº†ï¼‰ã€‚</li></ol><p><strong>é—®é¢˜å‡ºåœ¨ç¼–è¯‘å™¨çš„ä¼˜åŒ–ä¸Š</strong>ï¼š ç”±äºŽæ­¥éª¤ 2 å’Œæ­¥éª¤ 3 ä¹‹é—´æ²¡æœ‰å¿…ç„¶çš„ä¾èµ–å…³ç³»ï¼Œç¼–è¯‘å™¨æˆ– CPU å¯èƒ½ä¼šä¸ºäº†æé«˜æ•ˆçŽ‡è¿›è¡Œ<strong>æŒ‡ä»¤é‡æŽ’åº</strong>ï¼ŒæŠŠé¡ºåºå˜æˆï¼š <strong>1ï¼ˆåˆ†é…å†…å­˜ï¼‰ -&gt; 3ï¼ˆæŒ‡å‘åœ°å€ï¼‰ -&gt; 2ï¼ˆåˆå§‹åŒ–å¯¹è±¡ï¼‰</strong>ã€‚</p><p>è¿™ä¼šå¯¼è‡´ä¸‹é¢å‘ç”Ÿçš„ç¾éš¾åœºæ™¯ï¼š</p><ol><li><strong>çº¿ç¨‹ A</strong> è¿›å…¥åŒæ­¥å—ï¼Œæ‰§è¡Œ <code>instance = new Singleton()</code>ã€‚</li><li>ç”±äºŽé‡æŽ’åºï¼Œçº¿ç¨‹ A å…ˆæ‰§è¡Œäº†æ­¥éª¤ 3ï¼ˆæŒ‡å‘åœ°å€ï¼‰ï¼Œæ­¤æ—¶ <code>instance</code> å·²ç»<strong>ä¸æ˜¯ null</strong> äº†ï¼Œä½†æ­¥éª¤ 2ï¼ˆåˆå§‹åŒ–ï¼‰<strong>è¿˜æ²¡å®Œæˆ</strong>ã€‚</li><li>å°±åœ¨è¿™ä¸€çž¬é—´ï¼Œ<strong>çº¿ç¨‹ B</strong> è°ƒç”¨ <code>getInstance()</code>ï¼Œå®ƒåˆ¤æ–­ <code>instance != null</code>ï¼ŒäºŽæ˜¯å¼€å¿ƒåœ°ç›´æŽ¥æŠŠè¿™ä¸ª instance æ‹¿åŽ»ç”¨äº†ã€‚</li><li>ç»“æžœçº¿ç¨‹ B åœ¨ä½¿ç”¨å¯¹è±¡æ—¶ï¼Œå‘çŽ°ç”±äºŽè¿˜æ²¡åˆå§‹åŒ–ï¼Œå†…éƒ¨å±žæ€§å…¨æ˜¯ç©ºçš„ï¼Œç›´æŽ¥æŠ¥å‡º <strong>ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼ˆNPEï¼‰</strong> æˆ–é€»è¾‘é”™è¯¯ã€‚</li></ol><p>åœ¨ <code>instance</code> å˜é‡ä¸ŠåŠ ä¸Š <code>volatile</code> å…³é”®å­—åŽï¼Œä¼šå‘æŒ¥ä¸¤ä¸ªæ ¸å¿ƒä½œç”¨ï¼š</p><ol><li><strong>ç¦æ­¢æŒ‡ä»¤é‡æŽ’åº</strong>ï¼šå®ƒä¼šæ’å…¥ä¸€ä¸ªâ€œå†…å­˜å±éšœâ€ï¼Œå¼ºåˆ¶ä¿è¯æ‰§è¡Œé¡ºåºå¿…é¡»æ˜¯ <code>1 -&gt; 2 -&gt; 3</code>ã€‚è¿™æ ·å½“çº¿ç¨‹ B æ‹¿åˆ°å¯¹è±¡æ—¶ï¼Œå®ƒä¸€å®šå·²ç»æ˜¯åˆå§‹åŒ–å®Œæˆçš„ã€‚</li><li><strong>ä¿è¯å¯è§æ€§</strong>ï¼šä¸€æ—¦çº¿ç¨‹ A å®Œæˆäº†å¯¹è±¡çš„åˆ›å»ºï¼Œçº¿ç¨‹ B èƒ½å¤Ÿç«‹å³ä»Žä¸»å†…å­˜ä¸­çœ‹åˆ° <code>instance</code> çš„æœ€æ–°å€¼ã€‚</li></ol><h4 id="åŽŸå­ç±»-atomic"><a class="markdownIt-Anchor" href="#åŽŸå­ç±»-atomic"></a> åŽŸå­ç±» <code>Atomic</code></h4><p>å¯¹äºŽç®€å•çš„æ•°å€¼è¿ç®—ï¼Œä½¿ç”¨ <code>synchronized</code> å¤ªé‡ï¼Œé¢‘ç¹çš„çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ä¼šæŸè€—æ€§èƒ½ã€‚<code>Atomic</code> ç³»åˆ—å·¥å…·ç±»ï¼ˆå¦‚ <code>AtomicInteger</code>ï¼‰é‡‡ç”¨ <strong>CAS (Compare And Swap)</strong> æœºåˆ¶å®žçŽ°ã€‚</p><ul><li><strong>CAS åŽŸç†</strong>ï¼šåŒ…å«ä¸‰ä¸ªå‚æ•°ï¼šå˜é‡å†…å­˜åœ°å€ (V)ã€é¢„æœŸåŽŸå€¼ (A) å’Œæ–°å€¼ (B)ã€‚<ul><li>åªæœ‰å½“ V çš„å®žé™…å€¼ç­‰äºŽ A æ—¶ï¼Œæ‰å°† V ä¿®æ”¹ä¸º Bã€‚å¦åˆ™è¯´æ˜Žå˜é‡å·²è¢«ä¿®æ”¹ï¼Œå½“å‰çº¿ç¨‹ä¼šé€šè¿‡è‡ªæ—‹ï¼ˆæ­»å¾ªçŽ¯ï¼‰ä¸æ–­å°è¯•ï¼Œç›´åˆ°æˆåŠŸã€‚</li></ul></li></ul><p>ä»Žæ¦‚å¿µä¸Šæ¥è¯´ï¼Œ<strong>åŽŸå­å˜é‡ = æ“ä½œä¸å¯è¢«æ‰“æ–­çš„å˜é‡</strong><br />å¯¹å®ƒçš„æ“ä½œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œå®Œï¼Œè¦ä¹ˆå®Œå…¨ä¸æ‰§è¡Œï¼Œ<strong>ä¸ä¼šè¢«çº¿ç¨‹åˆ‡æ¢ä¸­æ–­</strong>ï¼Œå› æ­¤å¤©ç„¶çº¿ç¨‹å®‰å…¨ï¼Œä¸éœ€è¦ synchronizedã€‚</p><p>å¯¹äºŽæ™®é€šå˜é‡æ“ä½œï¼Œå¦‚i++ï¼Œçœ‹èµ·æ¥æ˜¯ä¸€å¥ï¼Œä½†å®žé™…ä¸ŠåŒ…å«ä¸‰ä¸ªæ­¥éª¤ï¼š</p><ol><li>è¯»å– i</li><li>i + 1</li><li>å†™å›ž i</li></ol><p>å¦‚æžœä¸¤ä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œï¼Œå°±å¯èƒ½å‡ºçŽ°ï¼š</p><ul><li>ä¸¤ä¸ªçº¿ç¨‹éƒ½è¯»åˆ°æ—§å€¼</li><li>æœ€ç»ˆåªåŠ ä¸€æ¬¡</li></ul><p>è¿™å°±å‡ºçŽ°äº†å…¸åž‹çš„ <strong>ç«žæ€æ¡ä»¶ï¼ˆRace Conditionï¼‰</strong><br />ä¸¾ä¸ªç®€å•çš„ä¾‹å­</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="type">AtomicInteger</span> <span class="variable">count</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicInteger</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">increment</span><span class="params">()</span> &#123;</span><br><span class="line">    count.incrementAndGet(); <span class="comment">// ç­‰åŒäºŽéžåŽŸå­çš„ count++</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="çº¿ç¨‹å°é—­-threadlocal"><a class="markdownIt-Anchor" href="#çº¿ç¨‹å°é—­-threadlocal"></a> çº¿ç¨‹å°é—­ (<code>ThreadLocal</code>)</h4><p>å¦‚æžœè¯´é”æ˜¯è§£å†³â€œå¦‚ä½•åŒæ­¥è®¿é—®å…±äº«æ•°æ®â€ï¼Œé‚£ä¹ˆ <code>ThreadLocal</code> åˆ™æ˜¯â€œå¦‚ä½•ä¸å…±äº«æ•°æ®â€ã€‚å®ƒä¸ºæ¯ä¸ªçº¿ç¨‹æä¾›ä¸€ä»½ç‹¬ç«‹çš„å˜é‡å‰¯æœ¬ï¼Œå®žçŽ°çº¿ç¨‹é—´çš„æ•°æ®éš”ç¦»ã€‚</p><ul><li><strong>æ ¸å¿ƒç”¨é€”</strong>ï¼šè§£å†³æ•°æ®åº“è¿žæŽ¥ã€Session ç®¡ç†ç­‰åœºæ™¯ä¸‹çš„çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚<br />ä¸¾ä¸ªç®€å•çš„ä¾‹å­</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ThreadLocalDemo</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> ThreadLocal&lt;Integer&gt; localValue = ThreadLocal.withInitial(() -&gt; <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            localValue.set(<span class="number">10</span>);</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot; : &quot;</span> + localValue.get());</span><br><span class="line">        &#125;, <span class="string">&quot;Thread-A&quot;</span>).start();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            localValue.set(<span class="number">20</span>);</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot; : &quot;</span> + localValue.get());</span><br><span class="line">        &#125;, <span class="string">&quot;Thread-B&quot;</span>).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç¬¬ä¸‰ç« juc-æ˜¾å¼é”-explicit-locks"><a class="markdownIt-Anchor" href="#ç¬¬ä¸‰ç« juc-æ˜¾å¼é”-explicit-locks"></a> ç¬¬ä¸‰ç« ï¼šJUC æ˜¾å¼é” (Explicit Locks)</h3><p>åœ¨ Java å¹¶å‘å·¥å…·åŒ…ï¼ˆJUCï¼‰ä¸­ï¼Œ<code>java.util.concurrent.locks</code> æä¾›äº†æ¯” <code>synchronized</code> æ›´çµæ´»ã€æ›´å¼ºå¤§çš„é”å®šæœºåˆ¶ã€‚<code>synchronized</code> åˆè¢«ç§°ä¸ºå†…ç½®é”ï¼Œå…¶ä¸éœ€è¦ç¨‹åºå‘˜è¿‡å¤šçš„æ‰‹åŠ¨æ“ä½œï¼Œè€ŒåŸºäºŽ<code>Lock</code>æŽ¥å£å®žçŽ°çš„ä¸ºæ˜¾å¼é”ï¼Œéœ€è¦ç¨‹åºå‘˜ä¸€äº›æ‰‹åŠ¨æ“ä½œæ‰èƒ½æ‰§è¡Œã€‚</p><h4 id="lock-æŽ¥å£ä¸Ž-reentrantlock"><a class="markdownIt-Anchor" href="#lock-æŽ¥å£ä¸Ž-reentrantlock"></a> <code>Lock</code> æŽ¥å£ä¸Ž <code>ReentrantLock</code></h4><p><code>ReentrantLock</code> æ˜¯æœ€å¸¸ç”¨çš„æ˜¾å¼é”ï¼Œå®ƒä¸ä»…å®Œå…¨è¦†ç›–äº† <code>synchronized</code> çš„åŠŸèƒ½ï¼Œè¿˜æä¾›äº†è®¸å¤šé«˜çº§ç‰¹æ€§:</p><ul><li><strong>æ‰‹åŠ¨è§„èŒƒ</strong>ï¼šä½¿ç”¨æ˜¾å¼é”å¿…é¡»éµå¾ªç‰¹å®šçš„æ¨¡æ¿ã€‚ç”±äºŽå®ƒä¸ä¼šè‡ªåŠ¨é‡Šæ”¾é”ï¼Œä¸ºäº†é˜²æ­¢æ­»é”ï¼Œ<strong>å¿…é¡»</strong>åœ¨ <code>finally</code> å—ä¸­è°ƒç”¨ <code>unlock()</code>ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Lock</span> <span class="variable">lock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantLock</span>();</span><br><span class="line"></span><br><span class="line">lock.lock();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// ä¸´ç•ŒåŒº</span></span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    lock.unlock();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p><strong>å¯é‡å…¥æ€§</strong>ï¼šåŒä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¤šæ¬¡èŽ·å¾—åŒä¸€æŠŠé”ï¼Œå†…éƒ¨é€šè¿‡è®¡æ•°å™¨å®žçŽ°ã€‚</p></li><li><p><strong>å¯ä¸­æ–­æ€§</strong>ï¼šä½¿ç”¨ <code>lockInterruptibly()</code> èŽ·å–é”æ—¶ï¼Œå¦‚æžœçº¿ç¨‹æ­£åœ¨ç­‰å¾…é”ï¼Œå®ƒå¯ä»¥å“åº”ä¸­æ–­ä¿¡å·å¹¶åœæ­¢ç­‰å¾…ã€‚</p></li><li><p><strong>å…¬å¹³é”ä¸Žéžå…¬å¹³é”</strong>ï¼šæž„é€ å‡½æ•°æ”¯æŒä¼ å…¥ <code>boolean</code> å€¼ã€‚å…¬å¹³é”ä¼šä¸¥æ ¼æŒ‰ç…§çº¿ç¨‹æŽ’é˜Ÿçš„é¡ºåºç»™é”ï¼Œè€Œéžå…¬å¹³é”ï¼ˆé»˜è®¤ï¼‰å…è®¸æ’é˜Ÿï¼Œé€šå¸¸æ‹¥æœ‰æ›´é«˜çš„åžåé‡ã€‚</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Lock</span> <span class="variable">lock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantLock</span>(<span class="literal">true</span>); <span class="comment">// å…¬å¹³é”</span></span><br></pre></td></tr></table></figure><ul><li><strong>å¯è½®è¯¢èŽ·å–é”ï¼ˆtryLockï¼‰</strong>: çº¿ç¨‹å¯ä»¥â€œè¯•ä¸€è¯•â€æ‹¿é”ï¼Œæ‹¿ä¸åˆ°ç›´æŽ¥èµ°ï¼Œä¸ä¼šé˜»å¡žã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (lock.tryLock(<span class="number">2</span>, TimeUnit.SECONDS)) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// æ‹¿åˆ°é”æ‰æ‰§è¡Œ</span></span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        lock.unlock();</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// æ‹¿ä¸åˆ°é”ï¼Œæ‰§è¡Œåˆ«çš„é€»è¾‘</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Lock</span> <span class="variable">lock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantLock</span>();</span><br><span class="line">lock.lock(); <span class="comment">// é˜»å¡žå¼èŽ·å–</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// ä¸´ç•ŒåŒºä»£ç </span></span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    lock.unlock(); <span class="comment">// å¿…é¡»åœ¨ finally ä¸­é‡Šæ”¾</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°è¯•èŽ·å–é”ï¼šæ‹¿ä¸åˆ°å°±èµ°ï¼Œä¸é˜»å¡ž</span></span><br><span class="line"><span class="keyword">if</span> (lock.tryLock()) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123; <span class="comment">/* ä¸šåŠ¡é€»è¾‘ */</span> &#125; <span class="keyword">finally</span> &#123; lock.unlock(); &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="readwritelock-è¯»å†™é”"><a class="markdownIt-Anchor" href="#readwritelock-è¯»å†™é”"></a> <code>ReadWriteLock</code> è¯»å†™é”</h4><p>åœ¨å¾ˆå¤šåœºæ™¯ä¸‹ï¼Œæ•°æ®æ˜¯â€œè¯»å¤šå†™å°‘â€çš„ã€‚å¦‚æžœç”¨æ™®é€šçš„äº’æ–¥é”ï¼Œå¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»ä¹Ÿä¼šäº’ç›¸æŽ’é˜Ÿï¼Œæ•ˆçŽ‡ä½Žä¸‹ã€‚<code>ReentrantReadWriteLock</code> å®žçŽ°äº†â€œè¯»å†™åˆ†ç¦»â€ã€‚è¯»å†™é”æ˜¯å¯¹æ™®é€šäº’æ–¥é”çš„å‡çº§ï¼Œå…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»ï¼Œä½†å†™æ“ä½œåªèƒ½æœ‰ä¸€ä¸ªï¼Œå¹¶ä¸”å†™æ—¶ä¸èƒ½è¯»ï¼Œå³ï¼š</p><ul><li><strong>è¯»è¯»ä¸äº’æ–¥</strong>ï¼ˆå¹¶å‘åº¦é«˜ï¼‰</li><li><strong>è¯»å†™äº’æ–¥</strong></li><li><strong>å†™å†™äº’æ–¥</strong></li></ul><p><strong>ReentrantReadWriteLock</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ReadWriteLock</span> <span class="variable">rwLock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantReadWriteLock</span>();</span><br><span class="line"><span class="type">Lock</span> <span class="variable">readLock</span> <span class="operator">=</span> rwLock.readLock();</span><br><span class="line"><span class="type">Lock</span> <span class="variable">writeLock</span> <span class="operator">=</span> rwLock.writeLock();</span><br></pre></td></tr></table></figure><p>å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶æ‹¿ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">readLock.lock();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// è¯»å–å…±äº«æ•°æ®</span></span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    readLock.unlock();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æ‹¿ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">writeLock.lock();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// ä¿®æ”¹å…±äº«æ•°æ®</span></span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    writeLock.unlock();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„è¯»å†™é”çš„ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReentrantReadWriteLockDEMO</span> &#123;  </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Map&lt;String, String&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();  </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">ReadWriteLock</span> <span class="variable">readWriteLock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantReadWriteLock</span>();  </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Lock</span> <span class="variable">readLock</span> <span class="operator">=</span> readWriteLock.readLock();  </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Lock</span> <span class="variable">writeLock</span>  <span class="operator">=</span> readWriteLock.writeLock();  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">get</span><span class="params">(String key)</span> &#123;  </span><br><span class="line">        readLock.lock();  </span><br><span class="line">        <span class="keyword">try</span>&#123;  </span><br><span class="line">            <span class="type">String</span> <span class="variable">val</span> <span class="operator">=</span> map.get(key);  </span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot; get &quot;</span> + key + <span class="string">&quot; &quot;</span> + val);  </span><br><span class="line">            <span class="keyword">return</span> val;  </span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;  </span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);  </span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;  </span><br><span class="line">            readLock.unlock();  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">put</span><span class="params">(String key, String val)</span> &#123;  </span><br><span class="line">        writeLock.lock();  </span><br><span class="line">        <span class="keyword">try</span>&#123;  </span><br><span class="line">            map.put(key, val);  </span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot; put &quot;</span> + key + <span class="string">&quot; &quot;</span> + val);  </span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;  </span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);  </span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;  </span><br><span class="line">            writeLock.unlock();  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;  </span><br><span class="line">        <span class="type">ReentrantReadWriteLockDEMO</span> <span class="variable">cache</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantReadWriteLockDEMO</span>();  </span><br><span class="line">  </span><br><span class="line">        <span class="type">Thread</span> <span class="variable">t1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;  </span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;  </span><br><span class="line">                <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> cache.get(<span class="string">&quot;name&quot;</span>);  </span><br><span class="line">                <span class="keyword">try</span> &#123; Thread.sleep(<span class="number">100</span>); &#125; <span class="keyword">catch</span> (Exception ignored) &#123;&#125;  </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;);  </span><br><span class="line">  </span><br><span class="line">        <span class="type">Thread</span> <span class="variable">t2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;  </span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;  </span><br><span class="line">                <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> cache.get(<span class="string">&quot;name&quot;</span>);  </span><br><span class="line">                <span class="keyword">try</span> &#123; Thread.sleep(<span class="number">100</span>); &#125; <span class="keyword">catch</span> (Exception ignored) &#123;&#125;  </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;);  </span><br><span class="line">  </span><br><span class="line">        <span class="type">Thread</span> <span class="variable">t3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;  </span><br><span class="line">            <span class="type">int</span> <span class="variable">cnt</span> <span class="operator">=</span> <span class="number">0</span>;  </span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;  </span><br><span class="line">                cache.put(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;value-&quot;</span> + (cnt++));  </span><br><span class="line">                <span class="keyword">try</span> &#123; Thread.sleep(<span class="number">500</span>); &#125; <span class="keyword">catch</span> (Exception e) &#123;&#125;  </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;);  </span><br><span class="line">  </span><br><span class="line">        t1.start();  </span><br><span class="line">        t2.start();  </span><br><span class="line">        t3.start();  </span><br><span class="line">        t1.join();  </span><br><span class="line">        t2.join();  </span><br><span class="line">        t3.join();   </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="condition-æœºåˆ¶"><a class="markdownIt-Anchor" href="#condition-æœºåˆ¶"></a> <code>Condition</code> æœºåˆ¶</h4><p><code>Condition</code> æ˜¯ä¸ºäº†é…åˆ <code>Lock</code> ä½¿ç”¨çš„ï¼Œå®ƒç”¨æ¥æ›¿ä»£ <code>Object.wait()/notify()</code>ã€‚å®ƒçš„æœ€å¤§ä¼˜åŠ¿åœ¨äºŽï¼š<strong>ä¸€ä¸ªé”å¯ä»¥å…³è”å¤šä¸ª Conditionï¼ˆæ¡ä»¶å˜é‡ï¼‰</strong>ã€‚</p><p>åœ¨ <code>synchronized</code> ä¸­ï¼Œæ‰€æœ‰çš„çº¿ç¨‹éƒ½æŒ¤åœ¨ä¸€ä¸ªç­‰å¾…é˜Ÿåˆ—é‡Œï¼Œè°ƒç”¨ <code>notifyAll()</code> ä¼šå”¤é†’æ‰€æœ‰äººã€‚è€Œ <code>Condition</code> å¯ä»¥å®žçŽ°â€œç²¾å‡†å”¤é†’â€ã€‚</p><p>åœ¨ synchronized é‡Œæˆ‘ä»¬ç”¨ï¼š<br />â€¢wait()<br />â€¢notify()<br />â€¢notifyAll()</p><p>åœ¨ æ˜¾å¼é”ï¼ˆReentrantLockï¼‰ ä¸­ï¼Œæˆ‘ä»¬ä¸èƒ½å†ç”¨å®ƒä»¬ï¼Œè¦ç”¨ï¼š<br />â€¢await() ä»£æ›¿ wait()<br />â€¢signal() ä»£æ›¿ notify()<br />â€¢signalAll() ä»£æ›¿ notifyAll()</p><p>ä¸€ä¸ªå…¸åž‹çš„åº”ç”¨åœºæ™¯æ˜¯<strong>ç”Ÿäº§æ¶ˆè´¹è€…æ¨¡åž‹</strong>ï¼Œ æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸¤ä¸ªæ¡ä»¶ï¼š<code>notFull</code>ï¼ˆä¸æ»¡ï¼‰å’Œ <code>notEmpty</code>ï¼ˆä¸ç©ºï¼‰ã€‚ç”Ÿäº§è€…åªå”¤é†’ç­‰å¾… <code>notEmpty</code> çš„æ¶ˆè´¹è€…ï¼Œäº’ä¸å¹²æ‰°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Depot</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">MAX</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">ReentrantLock</span> <span class="variable">lock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantLock</span>();</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Condition</span> <span class="variable">notEmpty</span> <span class="operator">=</span> lock.newCondition();</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Condition</span> <span class="variable">notFull</span> <span class="operator">=</span> lock.newCondition();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">put</span><span class="params">()</span> &#123;</span><br><span class="line">        lock.lock();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> (count == MAX) &#123;</span><br><span class="line">                notFull.await();   <span class="comment">// ç­‰å¾…ä»“åº“æœ‰ç©ºä½</span></span><br><span class="line">            &#125;</span><br><span class="line">            count++;</span><br><span class="line">            System.out.println(<span class="string">&quot;ç”Ÿäº§ï¼Œæ€»æ•° = &quot;</span> + count);</span><br><span class="line">            notEmpty.signal();     <span class="comment">// å”¤é†’ç­‰å¾…å–è´§çš„çº¿ç¨‹</span></span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            lock.unlock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">take</span><span class="params">()</span> &#123;</span><br><span class="line">        lock.lock();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> (count == <span class="number">0</span>) &#123;</span><br><span class="line">                notEmpty.await();  <span class="comment">// ç­‰å¾…ä»“åº“éžç©º</span></span><br><span class="line">            &#125;</span><br><span class="line">            count--;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ¶ˆè´¹ï¼Œæ€»æ•° = &quot;</span> + count);</span><br><span class="line">            notFull.signal();      <span class="comment">// å”¤é†’ç­‰å¾…ç”Ÿäº§çš„çº¿ç¨‹</span></span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            lock.unlock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="é”çš„é™çº§-å†™é”-è¯»é”"><a class="markdownIt-Anchor" href="#é”çš„é™çº§-å†™é”-è¯»é”"></a> é”çš„é™çº§ (å†™é” -&gt; è¯»é”)</h4><p>é”é™çº§æ˜¯æŒ‡ï¼š<strong>çº¿ç¨‹æŒæœ‰å†™é” -&gt; èŽ·å–è¯»é” -&gt; é‡Šæ”¾å†™é”</strong>ã€‚</p><p>è¿™ä¹ˆåšä¸»è¦æ˜¯ä¸ºäº†ä¿è¯æ•°æ®çš„<strong>å¯è§æ€§</strong>å’Œ<strong>åŽŸå­æ€§</strong>ã€‚å¦‚æžœä½ å…ˆé‡Šæ”¾å†™é”å†èŽ·å–è¯»é”ï¼Œåœ¨ä¸­é—´çš„ç©ºéš™ï¼Œæ•°æ®å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹ä¿®æ”¹äº†ã€‚é€šè¿‡é”é™çº§ï¼Œçº¿ç¨‹å¯ä»¥æ— ç¼åœ°ä»Žâ€œä¿®æ”¹è€…â€åˆ‡æ¢ä¸ºâ€œè§‚å¯Ÿè€…â€ï¼Œä¸”åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ•°æ®ä¸ä¼šè¢«ä»–äººç¯¡æ”¹ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">writeLock.lock();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 1. ä¿®æ”¹æ•°æ®</span></span><br><span class="line">    <span class="comment">// 2. é™çº§ï¼šåœ¨é‡Šæ”¾å†™é”å‰å…ˆèŽ·å–è¯»é”</span></span><br><span class="line">    readLock.lock();</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    writeLock.unlock(); <span class="comment">// 3. é‡Šæ”¾å†™é”ï¼Œæ­¤æ—¶ä¾ç„¶æŒæœ‰è¯»é”</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 4. ä½¿ç”¨æ•°æ®</span></span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    readLock.unlock(); <span class="comment">// 5. æœ€åŽé‡Šæ”¾è¯»é”</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç¬¬å››ç« å¹¶å‘åä½œå·¥å…·ç±»-synchronization-tools"><a class="markdownIt-Anchor" href="#ç¬¬å››ç« å¹¶å‘åä½œå·¥å…·ç±»-synchronization-tools"></a> ç¬¬å››ç« ï¼šå¹¶å‘åä½œå·¥å…·ç±» (Synchronization Tools)</h3><p>JUCï¼ˆJava å¹¶å‘å·¥å…·åŒ…ï¼‰é™¤äº†æä¾›é”ä¹‹å¤–ï¼Œè¿˜æä¾›äº†ä¸€ç³»åˆ—éžå¸¸æœ‰ç”¨çš„åä½œå·¥å…·ã€‚å¦‚æžœè¯´é”æ˜¯è§£å†³èµ„æºç«žäº‰çš„ï¼Œé‚£ä¹ˆè¿™äº›å·¥å…·å°±æ˜¯è§£å†³çº¿ç¨‹é…åˆçš„ã€‚</p><h4 id="å€’è®¡æ—¶å™¨-countdownlatch"><a class="markdownIt-Anchor" href="#å€’è®¡æ—¶å™¨-countdownlatch"></a> å€’è®¡æ—¶å™¨ <code>CountDownLatch</code></h4><p>CountDownLatch æ˜¯ä¸€ä¸ªåŒæ­¥å·¥å…·ç±»ï¼Œç”¨æ¥è®©ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ç­‰å¾…å…¶ä»–çº¿ç¨‹å®Œæˆä»»åŠ¡ã€‚<br />å°±åƒä¸€ä¸ªå€’è®¡æ—¶å™¨ï¼š<br />â€¢åˆå§‹æœ‰ä¸€ä¸ªè®¡æ•° count<br />â€¢æ¯æ¬¡è°ƒç”¨ countDown()ï¼Œè®¡æ•°å‡ 1<br />â€¢å½“è®¡æ•°å˜æˆ 0 æ—¶ï¼Œæ‰€æœ‰åœ¨ await() ç­‰å¾…çš„çº¿ç¨‹éƒ½ä¼šç»§ç»­æ‰§è¡Œ</p><p>å…¸åž‹åœºæ™¯ï¼šç­‰å¾…å¤šä¸ªä»»åŠ¡éƒ½å®ŒæˆåŽç»§ç»­æ‰§è¡Œ<br />ä¾‹å¦‚ï¼š<br />â€¢ä¸»çº¿ç¨‹å¯åŠ¨ 3 ä¸ªå­çº¿ç¨‹<br />â€¢æ¯ä¸ªå­çº¿ç¨‹å®ŒæˆåŽæ‰§è¡Œ countDown()<br />â€¢ä¸»çº¿ç¨‹è°ƒç”¨ await()ï¼Œä¸€ç›´ç­‰å¾…æ‰€æœ‰å­çº¿ç¨‹å®Œæˆ<br />â€¢æ‰€æœ‰å­çº¿ç¨‹å®ŒæˆåŽï¼Œä¸»çº¿ç¨‹ç»§ç»­æ‰§è¡Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.CountDownLatch;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">taskCount</span> <span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line">        <span class="type">CountDownLatch</span> <span class="variable">latch</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CountDownLatch</span>(taskCount);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; taskCount; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">id</span> <span class="operator">=</span> i;</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;å­çº¿ç¨‹ &quot;</span> + id + <span class="string">&quot; å¼€å§‹ä»»åŠ¡&quot;</span>);</span><br><span class="line">                    Thread.sleep(<span class="number">1000</span> + id * <span class="number">500</span>);</span><br><span class="line">                    System.out.println(<span class="string">&quot;å­çº¿ç¨‹ &quot;</span> + id + <span class="string">&quot; å®Œæˆä»»åŠ¡&quot;</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123; &#125;</span><br><span class="line">                <span class="keyword">finally</span> &#123;</span><br><span class="line">                    latch.countDown(); <span class="comment">// è®¡æ•° -1</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;).start();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸»çº¿ç¨‹ç­‰å¾…æ‰€æœ‰å­ä»»åŠ¡å®Œæˆ...&quot;</span>);</span><br><span class="line">        latch.await(); <span class="comment">// ç­‰å¾… count å˜ä¸º 0</span></span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;æ‰€æœ‰å­ä»»åŠ¡å®Œæˆï¼Œä¸»çº¿ç¨‹ç»§ç»­æ‰§è¡Œ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å¾ªçŽ¯æ …æ -cyclicbarrier"><a class="markdownIt-Anchor" href="#å¾ªçŽ¯æ …æ -cyclicbarrier"></a> å¾ªçŽ¯æ …æ  <code>CyclicBarrier</code></h4><p><strong>CyclicBarrier æ˜¯ä¸€ç§åŒæ­¥å±éšœï¼Œè®©ä¸€ç»„çº¿ç¨‹å¿…é¡»ç­‰åˆ°â€œå…¨éƒ¨éƒ½åˆ°è¾¾å±éšœç‚¹â€ï¼Œç„¶åŽåŒæ—¶ç»§ç»­æ‰§è¡Œã€‚</strong><br />ç‰¹ç‚¹ï¼š<br />â€¢å±éšœç‚¹ï¼ˆbarrierï¼‰å¯ä»¥é‡å¤ä½¿ç”¨ï¼ˆå¾ªçŽ¯ cyclicï¼‰<br />â€¢çº¿ç¨‹åˆ°è¾¾ barrier åŽä¼šé˜»å¡ž<br />â€¢å½“æ‰€æœ‰çº¿ç¨‹éƒ½åˆ°è¾¾åŽï¼Œè‡ªåŠ¨é‡Šæ”¾æ‰€æœ‰çº¿ç¨‹</p><p>å‡è®¾è¦ 3 ä¸ªçº¿ç¨‹åŒæ—¶å¼€å§‹ä¸‹ä¸€æ­¥ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.CyclicBarrier;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">CyclicBarrier</span> <span class="variable">barrier</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CyclicBarrier</span>(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">id</span> <span class="operator">=</span> i;</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;çº¿ç¨‹ &quot;</span> + id + <span class="string">&quot; åˆ°è¾¾å±éšœç‚¹&quot;</span>);</span><br><span class="line">                    barrier.await(); <span class="comment">// é˜»å¡žï¼Œç›´åˆ° 3 ä¸ªçº¿ç¨‹éƒ½è°ƒç”¨</span></span><br><span class="line">                    System.out.println(<span class="string">&quot;çº¿ç¨‹ &quot;</span> + id + <span class="string">&quot; é€šè¿‡å±éšœï¼Œç»§ç»­æ‰§è¡Œ&quot;</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;&#125;</span><br><span class="line">            &#125;).start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">çº¿ç¨‹ 0 åˆ°è¾¾å±éšœç‚¹</span><br><span class="line">çº¿ç¨‹ 2 åˆ°è¾¾å±éšœç‚¹</span><br><span class="line">çº¿ç¨‹ 1 åˆ°è¾¾å±éšœç‚¹</span><br><span class="line">ï¼ˆæ»¡è¶³3ä¸ªçº¿ç¨‹åˆ°è¾¾ï¼‰</span><br><span class="line">çº¿ç¨‹ 2 é€šè¿‡å±éšœï¼Œç»§ç»­æ‰§è¡Œ</span><br><span class="line">çº¿ç¨‹ 1 é€šè¿‡å±éšœï¼Œç»§ç»­æ‰§è¡Œ</span><br><span class="line">çº¿ç¨‹ 0 é€šè¿‡å±éšœï¼Œç»§ç»­æ‰§è¡Œ</span><br></pre></td></tr></table></figure><p>CyclicBarrier ä¸Ž CountDownLatch çš„åŒºåˆ«</p><table><thead><tr><th><strong>ç‰¹æ€§</strong></th><th><strong>CyclicBarrier</strong></th><th><strong>CountDownLatch</strong></th></tr></thead><tbody><tr><td>ä½œç”¨</td><td>è®©å¤šä¸ªçº¿ç¨‹â€œé›†åˆï¼Œç„¶åŽä¸€èµ·ç»§ç»­â€</td><td>è®©çº¿ç¨‹ç­‰å¾…å…¶ä»–çº¿ç¨‹åšå®ŒæŸä»¶äº‹</td></tr><tr><td>æ˜¯å¦å¯é‡ç”¨</td><td>âœ” å¯é‡å¤ä½¿ç”¨ï¼ˆcyclicï¼‰</td><td>âŒ ä¸èƒ½é‡ç½®ï¼ˆä¸€æ¬¡æ€§ï¼‰</td></tr><tr><td>æ˜¯å¦æ‰€æœ‰çº¿ç¨‹éƒ½ä¼šç­‰å¾…</td><td>âœ” æ˜¯</td><td>âŒ é€šå¸¸åªæœ‰ä¸€ä¸ªæˆ–å°‘é‡çº¿ç¨‹ç­‰å¾…</td></tr><tr><td>è°ƒç”¨æ–¹æ³•</td><td>await()</td><td>await() + countDown()</td></tr><tr><td>è°å‡è®¡æ•°</td><td>æ¯ä¸ªçº¿ç¨‹è°ƒç”¨ await() éƒ½ç®—ä¸€ä¸ªåˆ°è¾¾</td><td>è°ƒç”¨ countDown() çš„çº¿ç¨‹</td></tr><tr><td>ä¿¡å·æ–¹å‘</td><td>å¤§å®¶äº’ç›¸ç­‰å¾…</td><td>ä¸€äº›çº¿ç¨‹ç­‰å¾…ï¼Œå¦ä¸€äº›è´Ÿè´£ countDown</td></tr></tbody></table><h4 id="ä¿¡å·é‡-semaphore"><a class="markdownIt-Anchor" href="#ä¿¡å·é‡-semaphore"></a> ä¿¡å·é‡ <code>Semaphore</code></h4><p>**Semaphoreï¼ˆä¿¡å·é‡ï¼‰**æ˜¯Java å¹¶å‘ç¼–ç¨‹é‡Œä¸€ä¸ªéžå¸¸æ ¸å¿ƒçš„åŒæ­¥å·¥å…·ï¼Œä¸»è¦ç”¨äºŽæŽ§åˆ¶åŒæ—¶è®¿é—®æŸä¸ªèµ„æºçš„çº¿ç¨‹æ•°é‡ã€‚</p><p>Semaphore = ä¸€ä¸ªâ€œè®¸å¯è¯â€è®¡æ•°å™¨ï¼Œç”¨æ¥é™åˆ¶å¹¶å‘è®¿é—®æ•°é‡ã€‚<br />æ¯”å¦‚ä½ æœ‰ 3 å°æ‰“å°æœºï¼Œä½†æœ‰ 10 ä¸ªçº¿ç¨‹è¦æ‰“å°æ–‡ä»¶ã€‚<br />Semaphore(3) å°±ç›¸å½“äºŽå‘ 3 å¼ â€œè®¸å¯è¯â€ï¼ŒåŒæ—¶åªå…è®¸ 3 ä¸ªçº¿ç¨‹ä½¿ç”¨æ‰“å°æœºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Semaphore</span> <span class="variable">semaphore</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Semaphore</span>(<span class="number">3</span>); <span class="comment">// æœ‰ 3 ä¸ªè®¸å¯è¯</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">print</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        semaphore.acquire(); <span class="comment">// è¯·æ±‚ä¸€ä¸ªè®¸å¯è¯ï¼Œå¦‚æžœæ²¡æœ‰å°±é˜»å¡ž</span></span><br><span class="line">        System.out.println(Thread.currentThread().getName() + <span class="string">&quot; å¼€å§‹æ‰“å°...&quot;</span>);</span><br><span class="line">        Thread.sleep(<span class="number">1000</span>); <span class="comment">// æ¨¡æ‹Ÿä»»åŠ¡</span></span><br><span class="line">        System.out.println(Thread.currentThread().getName() + <span class="string">&quot; æ‰“å°ç»“æŸ&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        semaphore.release(); <span class="comment">// é‡Šæ”¾ä¸€ä¸ªè®¸å¯è¯</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Semaphore å¸¸ç”¨æ–¹æ³•</p><table><thead><tr><th><strong>æ–¹æ³•</strong></th><th><strong>å«ä¹‰</strong></th></tr></thead><tbody><tr><td>acquire()</td><td>èŽ·å–ä¸€ä¸ªè®¸å¯è¯ï¼Œæ²¡æœ‰åˆ™é˜»å¡ž</td></tr><tr><td>acquire(int n)</td><td>ä¸€æ¬¡èŽ·å– n ä¸ªè®¸å¯è¯</td></tr><tr><td>tryAcquire()</td><td>å°è¯•èŽ·å–ï¼Œä¸é˜»å¡žï¼ŒèŽ·å–ä¸åˆ°è¿”å›ž false</td></tr><tr><td>release()</td><td>é‡Šæ”¾è®¸å¯è¯</td></tr><tr><td>availablePermits()</td><td>æŸ¥çœ‹å‰©ä½™è®¸å¯è¯æ•°é‡</td></tr></tbody></table><p>Semaphore vs Lock / synchronized</p><table><thead><tr><th><strong>å¯¹æ¯”å¯¹è±¡</strong></th><th><strong>Semaphore</strong></th><th><strong>Lock / synchronized</strong></th></tr></thead><tbody><tr><td>æ ¸å¿ƒç”¨é€”</td><td>é™åˆ¶å¹¶å‘æ•°é‡</td><td>åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹è¿›å…¥ä¸´ç•ŒåŒºï¼ˆäº’æ–¥ï¼‰</td></tr><tr><td>æ”¯æŒå¤šå°‘çº¿ç¨‹åŒæ—¶è¿›å…¥</td><td><strong>å¤šä¸ª</strong>ï¼ˆå–å†³äºŽ permitsï¼‰</td><td><strong>åªèƒ½ 1 ä¸ª</strong></td></tr><tr><td>æ˜¯å¦å¯ä½œä¸ºé”ä½¿ç”¨</td><td>å¯ä»¥ï¼ˆpermits=1 æ—¶ç±»ä¼¼ mutexï¼‰</td><td>æ˜¯é”</td></tr></tbody></table><p>å…¬å¹³/éžå…¬å¹³</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Semaphore</span>(<span class="number">3</span>, <span class="literal">true</span>); <span class="comment">// å…¬å¹³ï¼ŒæŒ‰æŽ’é˜Ÿé¡ºåº</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Semaphore</span>(<span class="number">3</span>, <span class="literal">false</span>); <span class="comment">// éžå…¬å¹³ï¼ˆé»˜è®¤ï¼‰ï¼Œé€Ÿåº¦æ›´å¿«</span></span><br></pre></td></tr></table></figure><h4 id="é˜¶æ®µåŒæ­¥-phaser"><a class="markdownIt-Anchor" href="#é˜¶æ®µåŒæ­¥-phaser"></a> é˜¶æ®µåŒæ­¥ <code>Phaser</code></h4><p>Phaser æ˜¯ Java å¹¶å‘é‡Œ <strong>æœ€çµæ´»ã€å¯é‡ç”¨ã€å¯åŠ¨æ€æ³¨å†Œçº¿ç¨‹çš„â€œé˜¶æ®µåŒæ­¥å™¨â€</strong><br />å¯ä»¥ç†è§£ä¸ºï¼šä¸€ä¸ªå¯ä»¥åˆ†æˆå¾ˆå¤šé˜¶æ®µï¼ˆphaseï¼‰çš„åŒæ­¥å™¨ï¼Œæ¯ä¸ªé˜¶æ®µéƒ½è¦æ‰€æœ‰â€œå‚ä¸Žè€…â€åˆ°é½åŽæ‰èƒ½è¿›å…¥ä¸‹ä¸€é˜¶æ®µï¼Œå¹¶ä¸”å‚ä¸Žè€…æ•°é‡è¿˜å¯ä»¥åŠ¨æ€å¢žå‡ã€‚</p><table><thead><tr><th><strong>å·¥å…·</strong></th><th><strong>é—®é¢˜</strong></th></tr></thead><tbody><tr><td><strong>CountDownLatch</strong></td><td>ä¸€æ¬¡æ€§ç­‰å¾…ï¼Œä¸èƒ½å¤ç”¨ï¼Œä¸èƒ½åŠ¨æ€å¢žåŠ çº¿ç¨‹</td></tr><tr><td><strong>CyclicBarrier</strong></td><td>å¯å¤ç”¨ï¼Œä½†æ˜¯å‚ä¸Žçº¿ç¨‹æ•°å›ºå®šï¼Œä¸èƒ½åŠ¨æ€å˜åŒ–</td></tr><tr><td><strong>Phaser</strong></td><td>âœ” å¯å¤ç”¨ âœ” å¯å¤šé˜¶æ®µ âœ” å¯åŠ¨æ€å¢žåŠ /å‡å°‘çº¿ç¨‹ âœ” æ›´çµæ´»</td></tr></tbody></table><p>åŸºç¡€ä½¿ç”¨ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Phaser</span> <span class="variable">phaser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Phaser</span>(<span class="number">3</span>); <span class="comment">// 3 ä¸ªå‚ä¸Žè€…</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">        System.out.println(Thread.currentThread().getName() + <span class="string">&quot; æ‰§è¡Œé˜¶æ®µ1&quot;</span>);</span><br><span class="line">        phaser.arriveAndAwaitAdvance();  <span class="comment">// ç­‰åˆ«äºº</span></span><br><span class="line">        System.out.println(Thread.currentThread().getName() + <span class="string">&quot; æ‰§è¡Œé˜¶æ®µ2&quot;</span>);</span><br><span class="line">        phaser.arriveAndAwaitAdvance();</span><br><span class="line">        System.out.println(Thread.currentThread().getName() + <span class="string">&quot; æ‰§è¡Œé˜¶æ®µ3&quot;</span>);</span><br><span class="line">        phaser.arriveAndAwaitAdvance();</span><br><span class="line">    &#125;).start();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">T1 æ‰§è¡Œé˜¶æ®µ1</span><br><span class="line">T2 æ‰§è¡Œé˜¶æ®µ1</span><br><span class="line">T3 æ‰§è¡Œé˜¶æ®µ1</span><br><span class="line">--- é˜¶æ®µ1ç»“æŸ ---</span><br><span class="line">T1 æ‰§è¡Œé˜¶æ®µ2</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>æ ¸å¿ƒæ–¹æ³•ï¼š</p><table><thead><tr><th><strong>æ–¹æ³•</strong></th><th><strong>æ„ä¹‰</strong></th></tr></thead><tbody><tr><td>arrive()</td><td>åˆ°è¾¾å½“å‰é˜¶æ®µï¼Œä¸ç­‰å¾…</td></tr><tr><td>arriveAndAwaitAdvance()</td><td>åˆ°è¾¾å¹¶ç­‰å¾…å…¶ä»–çº¿ç¨‹ï¼ˆæœ€å¸¸ç”¨ï¼‰</td></tr><tr><td>arriveAndDeregister()</td><td>åˆ°è¾¾åŽé€€å‡ºï¼Œä¸å†å‚åŠ åŽç»­é˜¶æ®µ</td></tr></tbody></table><p>phaserå¯ä»¥åŠ¨æ€æ³¨å†Œçº¿ç¨‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">phaser.register(); <span class="comment">// æ–°çº¿ç¨‹åŠ å…¥åŒæ­¥æŽ§åˆ¶</span></span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªä¾‹å­</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Phaser</span> <span class="variable">phaser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Phaser</span>(<span class="number">1</span>); <span class="comment">// main æ˜¯ 1 ä¸ªå‚ä¸Žè€…</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Player</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line">    Phaser ph;</span><br><span class="line">    Player(Phaser ph) &#123; <span class="built_in">this</span>.ph = ph; ph.register(); &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(Thread.currentThread().getName() + <span class="string">&quot; å‡†å¤‡è¿›å…¥æ¸¸æˆ&quot;</span>);</span><br><span class="line">        ph.arriveAndAwaitAdvance();</span><br><span class="line"></span><br><span class="line">        System.out.println(Thread.currentThread().getName() + <span class="string">&quot; åŠ è½½åœ°å›¾&quot;</span>);</span><br><span class="line">        ph.arriveAndAwaitAdvance();</span><br><span class="line"></span><br><span class="line">        System.out.println(Thread.currentThread().getName() + <span class="string">&quot; åŠ è½½è§’è‰²&quot;</span>);</span><br><span class="line">        ph.arriveAndAwaitAdvance();</span><br><span class="line">        </span><br><span class="line">        System.out.println(Thread.currentThread().getName() + <span class="string">&quot; å®Œæˆæ‰€æœ‰åŠ è½½&quot;</span>);</span><br><span class="line">        ph.arriveAndDeregister();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">Phaser</span> <span class="variable">ph</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Phaser</span>(<span class="number">1</span>); <span class="comment">// main</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Player</span>(ph), <span class="string">&quot;çŽ©å®¶1&quot;</span>).start();</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Player</span>(ph), <span class="string">&quot;çŽ©å®¶2&quot;</span>).start();</span><br><span class="line"></span><br><span class="line">    ph.arriveAndAwaitAdvance(); <span class="comment">// ä¸»çº¿ç¨‹åŒæ­¥å„é˜¶æ®µ</span></span><br><span class="line">    ph.arriveAndAwaitAdvance();</span><br><span class="line">    ph.arriveAndAwaitAdvance();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ•°æ®äº¤æ¢-exchanger"><a class="markdownIt-Anchor" href="#æ•°æ®äº¤æ¢-exchanger"></a> æ•°æ®äº¤æ¢ <code>Exchanger</code></h4><p><code>Exchanger</code> ç”¨äºŽä¸¤ä¸ªçº¿ç¨‹ä¹‹é—´çš„æ•°æ®äº¤æ¢ã€‚å®ƒæä¾›ä¸€ä¸ªåŒæ­¥ç‚¹ï¼Œåœ¨è¿™ä¸ªç‚¹ï¼Œä¸¤ä¸ªçº¿ç¨‹å¯ä»¥äº¤æ¢å½¼æ­¤çš„æ•°æ®ã€‚</p><ul><li><strong>æ ¸å¿ƒé€»è¾‘</strong>ï¼šå½“ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ <code>exchange()</code> æ—¶ï¼Œå®ƒä¼šé˜»å¡žç›´åˆ°ç¬¬äºŒä¸ªçº¿ç¨‹ä¹Ÿè°ƒç”¨è¯¥æ–¹æ³•ã€‚ç„¶åŽä¸¤ä¸ªçº¿ç¨‹äº¤æ¢æ•°æ®å¹¶è¿”å›žã€‚</li><li><strong>ç‰¹æ€§</strong>ï¼šåªèƒ½æˆå¯¹ä½¿ç”¨ï¼ˆ2ä¸ªçº¿ç¨‹ï¼‰ã€‚</li><li><strong>åœºæ™¯</strong>ï¼šä¸¤ä¸ªæµæ°´çº¿çŽ¯èŠ‚çš„æ•°æ®ä¼ é€’ï¼Œæˆ–è€…é—ä¼ ç®—æ³•ä¸­çš„äº¤å‰æ“ä½œã€‚</li></ul><p>ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Exchanger&lt;String&gt; exchanger = <span class="keyword">new</span> <span class="title class_">Exchanger</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">data</span> <span class="operator">=</span> <span class="string">&quot;Açº¿ç¨‹æ•°æ®&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> exchanger.exchange(data);</span><br><span class="line">        System.out.println(<span class="string">&quot;A å¾—åˆ°ï¼š&quot;</span> + result);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception ignored) &#123;&#125;</span><br><span class="line">&#125;).start();</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">data</span> <span class="operator">=</span> <span class="string">&quot;Bçº¿ç¨‹æ•°æ®&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> exchanger.exchange(data);</span><br><span class="line">        System.out.println(<span class="string">&quot;B å¾—åˆ°ï¼š&quot;</span> + result);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception ignored) &#123;&#125;</span><br><span class="line">&#125;).start();</span><br></pre></td></tr></table></figure><h3 id="ç¬¬äº”ç« çº¿ç¨‹æ± æž¶æž„-executor-framework"><a class="markdownIt-Anchor" href="#ç¬¬äº”ç« çº¿ç¨‹æ± æž¶æž„-executor-framework"></a> ç¬¬äº”ç« ï¼šçº¿ç¨‹æ± æž¶æž„ (Executor Framework)</h3><p>åœ¨å®žé™…ç”Ÿäº§å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å‡ ä¹Žä»Žä¸æ‰‹åŠ¨ <code>new Thread()</code>ã€‚ä¸ºäº†èŠ‚çœç³»ç»Ÿèµ„æºå¹¶æé«˜å“åº”é€Ÿåº¦ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨çº¿ç¨‹æ± æ¥ç®¡ç†çº¿ç¨‹ã€‚</p><h4 id="ä¸ºä»€ä¹ˆè¦ç”¨çº¿ç¨‹æ± "><a class="markdownIt-Anchor" href="#ä¸ºä»€ä¹ˆè¦ç”¨çº¿ç¨‹æ± "></a> ä¸ºä»€ä¹ˆè¦ç”¨çº¿ç¨‹æ± ï¼Ÿ</h4><p>åˆ›å»ºä¸€ä¸ª Java çº¿ç¨‹éœ€è¦è°ƒç”¨æ“ä½œç³»ç»Ÿçš„å†…æ ¸ APIï¼Œè¿™æ˜¯ä¸€ä¸ªæ˜‚è´µçš„æ“ä½œã€‚</p><ul><li><strong>é™ä½Žèµ„æºæ¶ˆè€—</strong>ï¼šé€šè¿‡æ± åŒ–æŠ€æœ¯é‡å¤åˆ©ç”¨å·²åˆ›å»ºçš„çº¿ç¨‹ï¼Œå‡å°‘çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯çš„æ€§èƒ½å¼€é”€ã€‚</li><li><strong>æé«˜å“åº”é€Ÿåº¦</strong>ï¼šä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œæ— éœ€ç­‰å¾…çº¿ç¨‹åˆ›å»ºå³å¯ç«‹å³æ‰§è¡Œã€‚</li><li><strong>æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§</strong>ï¼šçº¿ç¨‹æ˜¯ç¨€ç¼ºèµ„æºï¼Œä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥ç»Ÿä¸€åˆ†é…ã€è°ƒä¼˜å’Œç›‘æŽ§ï¼Œé˜²æ­¢æ— é™åˆ¶åˆ›å»ºçº¿ç¨‹å¯¼è‡´ç³»ç»Ÿå´©æºƒï¼ˆOOMï¼‰ã€‚</li></ul><h4 id="threadpoolexecutor-æ ¸å¿ƒå‚æ•°"><a class="markdownIt-Anchor" href="#threadpoolexecutor-æ ¸å¿ƒå‚æ•°"></a> <code>ThreadPoolExecutor</code> æ ¸å¿ƒå‚æ•°</h4><p>æ‰€æœ‰çš„çº¿ç¨‹æ± åº•å±‚éƒ½æ˜¯ <code>ThreadPoolExecutor</code>ï¼ŒåŒ…å«ä¸ƒä¸ªæ ¸å¿ƒçš„å‚æ•°ï¼š</p><table><thead><tr><th><strong>å‚æ•°</strong></th><th><strong>åç§°</strong></th><th><strong>ä½œç”¨</strong></th></tr></thead><tbody><tr><td><code>corePoolSize</code></td><td><strong>æ ¸å¿ƒçº¿ç¨‹æ•°</strong></td><td>çº¿ç¨‹æ± ä¸­å¸¸é©»çš„â€œä¿åº•â€çº¿ç¨‹æ•°é‡ï¼Œå³ä½¿å®ƒä»¬é—²ç€ä¹Ÿä¸ä¼šè¢«é”€æ¯ã€‚</td></tr><tr><td><code>maximumPoolSize</code></td><td><strong>æœ€å¤§çº¿ç¨‹æ•°</strong></td><td>çº¿ç¨‹æ± å…è®¸åˆ›å»ºçš„æœ€å¤§çº¿ç¨‹æ€»é‡ã€‚</td></tr><tr><td><code>keepAliveTime</code></td><td><strong>å­˜æ´»æ—¶é—´</strong></td><td>å½“çº¿ç¨‹æ•°å¤§äºŽæ ¸å¿ƒçº¿ç¨‹æ•°æ—¶ï¼Œå¤šä½™çš„ç©ºé—²çº¿ç¨‹èƒ½æ´»å¤šä¹…ã€‚</td></tr><tr><td><code>unit</code></td><td><strong>æ—¶é—´å•ä½</strong></td><td><code>keepAliveTime</code> çš„æ—¶é—´å•ä½ï¼ˆç§’ã€æ¯«ç§’ç­‰ï¼‰ã€‚</td></tr><tr><td><code>workQueue</code></td><td><strong>ä»»åŠ¡é˜Ÿåˆ—</strong></td><td>å­˜æ”¾å¾…æ‰§è¡Œä»»åŠ¡çš„é˜»å¡žé˜Ÿåˆ—ï¼ˆBlockingQueueï¼‰ã€‚</td></tr><tr><td><code>threadFactory</code></td><td><strong>çº¿ç¨‹å·¥åŽ‚</strong></td><td>ç”¨äºŽåˆ›å»ºæ–°çº¿ç¨‹ï¼Œé€šå¸¸åœ¨è¿™é‡Œç»™çº¿ç¨‹èµ·ä¸ªæœ‰æ„ä¹‰çš„åå­—ã€‚</td></tr><tr><td><code>handler</code></td><td><strong>æ‹’ç»ç­–ç•¥</strong></td><td>å½“é˜Ÿåˆ—æ»¡äº†ä¸”çº¿ç¨‹æ•°è¾¾åˆ°æœ€å¤§å€¼æ—¶ï¼Œå¦‚ä½•å¤„ç†æ–°æ¥çš„ä»»åŠ¡ã€‚</td></tr></tbody></table><h4 id="çº¿ç¨‹æ± å·¥ä½œæµç¨‹ä¸Žæ‹’ç»ç­–ç•¥"><a class="markdownIt-Anchor" href="#çº¿ç¨‹æ± å·¥ä½œæµç¨‹ä¸Žæ‹’ç»ç­–ç•¥"></a> çº¿ç¨‹æ± å·¥ä½œæµç¨‹ä¸Žæ‹’ç»ç­–ç•¥</h4><p>çº¿ç¨‹æ± çš„å¤„ç†é€»è¾‘éµå¾ªâ€œ<strong>å…ˆæ ¸å¿ƒï¼Œå†é˜Ÿåˆ—ï¼ŒåŽæœ€å¤§</strong>â€çš„åŽŸåˆ™ï¼š</p><ol><li><strong>æäº¤ä»»åŠ¡</strong>ï¼šå¦‚æžœå½“å‰çº¿ç¨‹æ•° &lt; <code>corePoolSize</code>ï¼Œç›´æŽ¥åˆ›å»ºæ–°çº¿ç¨‹æ‰§è¡Œã€‚</li><li><strong>è¿›å…¥é˜Ÿåˆ—</strong>ï¼šå¦‚æžœçº¿ç¨‹æ•° â‰¥ <code>corePoolSize</code>ï¼Œä»»åŠ¡è¿›å…¥ <code>workQueue</code> æŽ’é˜Ÿã€‚</li><li><strong>å°è¯•æ‰©å®¹</strong>ï¼šå¦‚æžœé˜Ÿåˆ—æ»¡äº†ä¸”çº¿ç¨‹æ•° &lt; <code>maximumPoolSize</code>ï¼Œåˆ›å»ºéžæ ¸å¿ƒçº¿ç¨‹æ‰§è¡Œã€‚</li><li><strong>è§¦å‘æ‹’ç»</strong>ï¼šå¦‚æžœé˜Ÿåˆ—æ»¡äº†ä¸”çº¿ç¨‹æ•° = <code>maximumPoolSize</code>ï¼Œæ‰§è¡Œæ‹’ç»ç­–ç•¥ã€‚</li></ol><p><strong>JDK è‡ªå¸¦çš„å››ç§æ‹’ç»ç­–ç•¥ï¼š</strong></p><ul><li><strong>AbortPolicy</strong>ï¼ˆé»˜è®¤ï¼‰ï¼šç›´æŽ¥æŠ›å‡º <code>RejectedExecutionException</code> å¼‚å¸¸ï¼Œé˜»æ­¢ç³»ç»Ÿæ­£å¸¸å·¥ä½œã€‚</li><li><strong>CallerRunsPolicy</strong>ï¼šâ€œè°æäº¤è°æ‰§è¡Œâ€ã€‚è®©æäº¤ä»»åŠ¡çš„çº¿ç¨‹ï¼ˆæ¯”å¦‚ä¸»çº¿ç¨‹ï¼‰è‡ªå·±åŽ»è·‘è¿™ä¸ªä»»åŠ¡ï¼Œä»Žè€Œé™ä½Žä»»åŠ¡æäº¤é€Ÿåº¦ã€‚</li><li><strong>DiscardPolicy</strong>ï¼šç›´æŽ¥ä¸¢å¼ƒä»»åŠ¡ï¼Œä¸äºˆä»»ä½•å¤„ç†ä¹Ÿä¸æŠ¥é”™ã€‚</li><li><strong>DiscardOldestPolicy</strong>ï¼šä¸¢å¼ƒé˜Ÿåˆ—é‡Œæœ€è€çš„ä¸€ä¸ªä»»åŠ¡ï¼Œå°è¯•å†æ¬¡æäº¤å½“å‰ä»»åŠ¡ã€‚</li></ul><h4 id="å·¥åŽ‚ç±»-executors"><a class="markdownIt-Anchor" href="#å·¥åŽ‚ç±»-executors"></a> å·¥åŽ‚ç±» <code>Executors</code></h4><p>å¸¸ç”¨æ–¹æ³•ï¼š<br />â€¢Executors.newFixedThreadPool(n)ï¼šå›ºå®šå¤§å°çº¿ç¨‹æ± <br />â€¢Executors.newCachedThreadPool()ï¼šå¼¹æ€§çº¿ç¨‹æ± <br />â€¢Executors.newSingleThreadExecutor()ï¼šå•çº¿ç¨‹<br />â€¢Executors.newScheduledThreadPool(n)ï¼šå®šæ—¶ä»»åŠ¡çº¿ç¨‹æ± </p><h5 id="executorserviceçº¿ç¨‹æ± æŽ¥å£"><a class="markdownIt-Anchor" href="#executorserviceçº¿ç¨‹æ± æŽ¥å£"></a> ExecutorServiceï¼ˆçº¿ç¨‹æ± æŽ¥å£ï¼‰</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Executor</span><br><span class="line">  â”‚</span><br><span class="line">  â”œâ”€â”€ ExecutorService</span><br><span class="line">  â”‚        â”‚</span><br><span class="line">  â”‚        â””â”€â”€ AbstractExecutorService</span><br><span class="line">  â”‚                â”‚</span><br><span class="line">  â”‚                â””â”€â”€ ThreadPoolExecutor  â† æ™®é€šçº¿ç¨‹æ± æ ¸å¿ƒ</span><br><span class="line">  â”‚</span><br><span class="line">  â””â”€â”€ ScheduledExecutorService</span><br><span class="line">           â”‚</span><br><span class="line">           â””â”€â”€ ScheduledThreadPoolExecutor â† å®šæ—¶ä»»åŠ¡çº¿ç¨‹æ± æ ¸å¿ƒ</span><br></pre></td></tr></table></figure><p>å¸¸ç”¨æ–¹æ³•ï¼š<br />â€¢submit()ï¼šæäº¤ä»»åŠ¡<br />â€¢shutdown()ï¼šä¼˜é›…å…³é—­<br />â€¢shutdownNow()ï¼šå¼ºåˆ¶ç»ˆæ­¢</p><h5 id="scheduledexecutorservice"><a class="markdownIt-Anchor" href="#scheduledexecutorservice"></a> <strong>ScheduledExecutorService</strong></h5><p>ç”¨äºŽæ‰§è¡Œå®šæ—¶ä»»åŠ¡ã€å‘¨æœŸä»»åŠ¡ã€‚<br />åŒ…å«ï¼š<br /><code>schedule()</code><br /><code>scheduleAtFixedRate()</code><br /><code>scheduleWithFixedDelay()</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ScheduledExample</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸€ä¸ªå…·æœ‰2ä¸ªçº¿ç¨‹çš„å®šæ—¶ä»»åŠ¡çº¿ç¨‹æ± </span></span><br><span class="line">        <span class="type">ScheduledExecutorService</span> <span class="variable">scheduler</span> <span class="operator">=</span> Executors.newScheduledThreadPool(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1. å»¶è¿Ÿ 3 ç§’æ‰§è¡Œä¸€æ¬¡ä»»åŠ¡</span></span><br><span class="line">        scheduler.schedule(() -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ä»»åŠ¡ Aï¼šå»¶è¿Ÿ 3 ç§’æ‰§è¡Œ -&gt; &quot;</span> + System.currentTimeMillis());</span><br><span class="line">        &#125;, <span class="number">3</span>, TimeUnit.SECONDS);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. æ¯éš” 2 ç§’æ‰§è¡Œä¸€æ¬¡ä»»åŠ¡ï¼ˆå›ºå®šé¢‘çŽ‡ï¼‰</span></span><br><span class="line">        scheduler.scheduleAtFixedRate(() -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ä»»åŠ¡ Bï¼šæ¯éš” 2 ç§’æ‰§è¡Œ -&gt; &quot;</span> + System.currentTimeMillis());</span><br><span class="line">        &#125;, <span class="number">1</span>, <span class="number">2</span>, TimeUnit.SECONDS);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç¨‹åºä¸é€€å‡ºï¼Œä¿æŒæ‰§è¡Œ</span></span><br><span class="line">        <span class="comment">// è‹¥æƒ³åœæ­¢ï¼Œç¨åŽè°ƒç”¨ scheduler.shutdown();</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="forkjoinpool-åˆ†æ²»æ€æƒ³"><a class="markdownIt-Anchor" href="#forkjoinpool-åˆ†æ²»æ€æƒ³"></a> <code>ForkJoinPool</code> (åˆ†æ²»æ€æƒ³)</h4><p>ForkJoinPool æ˜¯ä¸€ç§ä¸“é—¨ç”¨äºŽâ€œåˆ†è€Œæ²»ä¹‹ï¼ˆForkï¼‰+ åˆå¹¶ç»“æžœï¼ˆJoinï¼‰â€çš„é«˜æ•ˆå¹¶è¡Œè®¡ç®—çº¿ç¨‹æ± ï¼Œå®ƒç”¨æ¥å¤„ç†å¤§é‡å¯ä»¥æ‹†åˆ†çš„ä»»åŠ¡ï¼Œè‡ªåŠ¨è¿›è¡Œä»»åŠ¡çªƒå–ï¼ˆwork-stealingï¼‰ä»¥æå‡ CPU åˆ©ç”¨çŽ‡ã€‚</p><p>ä½ ä¸€èˆ¬åªéœ€è¦ç»§æ‰¿ï¼š<br />â€¢RecursiveActionï¼ˆvoid ä»»åŠ¡ï¼‰<br />â€¢RecursiveTaskï¼ˆæœ‰è¿”å›žå€¼ä»»åŠ¡ï¼‰</p><p>å¤§æ•°ç»„æ±‚å’Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SumTask</span> <span class="keyword">extends</span> <span class="title class_">RecursiveTask</span>&lt;Long&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">THRESHOLD</span> <span class="operator">=</span> <span class="number">10000</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span>[] arr;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> start, end;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">SumTask</span><span class="params">(<span class="type">long</span>[] arr, <span class="type">int</span> start, <span class="type">int</span> end)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.arr = arr;</span><br><span class="line">        <span class="built_in">this</span>.start = start;</span><br><span class="line">        <span class="built_in">this</span>.end = end;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Long <span class="title function_">compute</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> end - start;</span><br><span class="line">        <span class="keyword">if</span> (length &lt;= THRESHOLD) &#123; <span class="comment">// å°ä»»åŠ¡ç›´æŽ¥ç®—</span></span><br><span class="line">            <span class="type">long</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> start; i &lt; end; i++) sum += arr[i];</span><br><span class="line">            <span class="keyword">return</span> sum;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> start + length / <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">        <span class="type">SumTask</span> <span class="variable">left</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SumTask</span>(arr, start, mid);</span><br><span class="line">        <span class="type">SumTask</span> <span class="variable">right</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SumTask</span>(arr, mid, end);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ†è£‚</span></span><br><span class="line">        left.fork();</span><br><span class="line">        right.fork();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆå¹¶</span></span><br><span class="line">        <span class="keyword">return</span> left.join() + right.join();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ForkJoinPool</span> <span class="variable">pool</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ForkJoinPool</span>();</span><br><span class="line"></span><br><span class="line">        <span class="type">long</span>[] arr = <span class="keyword">new</span> <span class="title class_">long</span>[<span class="number">1000000</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; arr.length; i++) arr[i] = i;</span><br><span class="line"></span><br><span class="line">        <span class="type">long</span> <span class="variable">result</span> <span class="operator">=</span> pool.invoke(<span class="keyword">new</span> <span class="title class_">SumTask</span>(arr, <span class="number">0</span>, arr.length));</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;æ€»å’Œï¼š&quot;</span> + result);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="future"><a class="markdownIt-Anchor" href="#future"></a> Future</h4><p>Future è¡¨ç¤ºä¸€ä¸ªå¼‚æ­¥è®¡ç®—çš„ç»“æžœï¼Œä½ å¯ä»¥åœ¨æäº¤ä»»åŠ¡åŽç«‹å³å¾—åˆ° Future å¯¹è±¡ï¼Œä»¥åŽå†ä»Žè¿™ä¸ªå¯¹è±¡ä¸­å–ç»“æžœã€‚<br />å…¶æŽ¥å£ä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Future</span>&lt;V&gt; &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">cancel</span><span class="params">(<span class="type">boolean</span> mayInterruptIfRunning)</span>;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">isCancelled</span><span class="params">()</span>;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">isDone</span><span class="params">()</span>;</span><br><span class="line">    V <span class="title function_">get</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException, ExecutionException;</span><br><span class="line">    V <span class="title function_">get</span><span class="params">(<span class="type">long</span> timeout, TimeUnit unit)</span></span><br><span class="line">         <span class="keyword">throws</span> InterruptedException, ExecutionException, TimeoutException;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>futureçš„æœ€å¸¸è§æ¥æºï¼šçº¿ç¨‹æ± çš„ <strong>submit()</strong> æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ExecutorService</span> <span class="variable">pool</span> <span class="operator">=</span> Executors.newFixedThreadPool(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">Future&lt;Integer&gt; future = pool.submit(() -&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">10</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>å¾—åˆ°çš„ future å°±æ˜¯å¼‚æ­¥ç»“æžœå¥æŸ„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ExecutorService</span> <span class="variable">pool</span> <span class="operator">=</span> Executors.newFixedThreadPool(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">Future&lt;String&gt; future = pool.submit(() -&gt; &#123;</span><br><span class="line">    <span class="comment">// æ¨¡æ‹Ÿè€—æ—¶ä»»åŠ¡</span></span><br><span class="line">    Thread.sleep(<span class="number">2000</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;ä»»åŠ¡å®Œæˆ&quot;</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;æˆ‘å…ˆåšç‚¹åˆ«çš„äº‹...&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¾—åˆ°ç»“æžœï¼ˆé˜»å¡žï¼‰</span></span><br><span class="line"><span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> future.get();</span><br><span class="line"></span><br><span class="line">System.out.println(result);</span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘å…ˆåšç‚¹åˆ«çš„äº‹...</span><br><span class="line">ä»»åŠ¡å®Œæˆ</span><br></pre></td></tr></table></figure><p>å› æ­¤ï¼Œfutureå¯ä»¥ é€šè¿‡ get() æ–¹æ³•èŽ·å–å¼‚æ­¥æ‰§è¡Œçš„ç»“æžœï¼ˆé˜»å¡žç­‰å¾…ï¼‰ã€‚<br />åŒæ—¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡cancelå–æ¶ˆä»»åŠ¡ï¼Œé€šè¿‡isDoneåˆ¤æ–­ä»»åŠ¡æ˜¯å¦å®Œæˆï¼Œé€šè¿‡get(timeout)ç­‰å¾…å›ºå®šæ—¶é—´ï¼Œå¦‚æžœä»»åŠ¡è¿˜æ²¡å®Œæˆï¼Œåˆ™æŠ› TimeoutExceptionã€‚</p><h3 id="ç¬¬å…­ç« å¼‚æ­¥ç¼–ç¨‹-asynchronous-programming"><a class="markdownIt-Anchor" href="#ç¬¬å…­ç« å¼‚æ­¥ç¼–ç¨‹-asynchronous-programming"></a> ç¬¬å…­ç« ï¼šå¼‚æ­¥ç¼–ç¨‹ (Asynchronous Programming)</h3><h4 id="future-çš„å±€é™æ€§"><a class="markdownIt-Anchor" href="#future-çš„å±€é™æ€§"></a> <code>Future</code> çš„å±€é™æ€§</h4><p>è™½ç„¶ <code>Future</code> å¼€å¯äº†å¼‚æ­¥æ‰§è¡Œçš„å…ˆæ²³ï¼Œä½†å®ƒåœ¨å¤„ç†å¤æ‚ä¸šåŠ¡é€»è¾‘æ—¶éžå¸¸ç¬¨æ‹™ï¼š</p><ul><li><strong>é˜»å¡žç­‰å¾…</strong>ï¼šè¦èŽ·å–ç»“æžœåªèƒ½è°ƒç”¨ <code>get()</code>ï¼Œå¦‚æžœå­çº¿ç¨‹æ²¡è·‘å®Œï¼Œä¸»çº¿ç¨‹å¿…é¡»åœ¨æ­¤é˜»å¡žï¼Œè¿™å®žé™…ä¸ŠæŠŠå¼‚æ­¥å˜æˆäº†åŒæ­¥ç­‰å¾…ã€‚</li><li><strong>è½®è¯¢è€—èƒ½</strong>ï¼šå¦‚æžœä¸é˜»å¡žï¼Œå°±å¾—ç”¨ <code>isDone()</code> å¼€å¯æ­»å¾ªçŽ¯è½®è¯¢ï¼Œæžåº¦æ¶ˆè€— CPUã€‚</li><li><strong>æ— æ³•å›žè°ƒ</strong>ï¼šæ— æ³•è¡¨è¾¾â€œä»»åŠ¡å®ŒæˆåŽè‡ªåŠ¨æ‰§è¡Œä¸‹ä¸€æ­¥â€çš„é€»è¾‘ã€‚</li><li><strong>ç¼–æŽ’å›°éš¾</strong>ï¼šå¾ˆéš¾å°†å¤šä¸ª <code>Future</code> çš„ç»“æžœç»„åˆåœ¨ä¸€èµ·ï¼Œä»£ç ä¼šåµŒå¥—å¾—éžå¸¸éš¾çœ‹ï¼ˆå›žè°ƒåœ°ç‹±ï¼‰ã€‚</li></ul><h4 id="completablefuture"><a class="markdownIt-Anchor" href="#completablefuture"></a> <code>CompletableFuture</code></h4><p>JDK 8 å¼•å…¥çš„ <code>CompletableFuture</code> æ˜¯å¼‚æ­¥ç¼–ç¨‹çš„é‡Œç¨‹ç¢‘ã€‚å®ƒå®žçŽ°äº† <code>Future</code> å’Œ <code>CompletionStage</code> ä¸¤ä¸ªæŽ¥å£ï¼Œæ”¯æŒä»»åŠ¡çš„å›žè°ƒã€ç»„åˆå’Œé“¾å¼ç¼–æŽ’ã€‚</p><h5 id="å¼‚æ­¥ä»»åŠ¡çš„å¯åŠ¨ä¸Žæ‰§è¡Œç­–ç•¥"><a class="markdownIt-Anchor" href="#å¼‚æ­¥ä»»åŠ¡çš„å¯åŠ¨ä¸Žæ‰§è¡Œç­–ç•¥"></a> å¼‚æ­¥ä»»åŠ¡çš„å¯åŠ¨ä¸Žæ‰§è¡Œç­–ç•¥</h5><p>ä»»åŠ¡çš„å¯åŠ¨é€šå¸¸ä¾èµ–äºŽé™æ€å·¥åŽ‚æ–¹æ³•ã€‚<code>supplyAsync</code> ç”¨äºŽå¯åŠ¨å…·æœ‰è¿”å›žå€¼çš„å¼‚æ­¥è®¡ç®—ï¼Œè€Œ <code>runAsync</code> åˆ™é€‚ç”¨äºŽä»…éœ€æ‰§è¡Œç‰¹å®šåŠ¨ä½œä¸”æ— éœ€è¿”å›žç»“æžœçš„åœºæ™¯ã€‚åœ¨èµ„æºè°ƒåº¦å±‚é¢ï¼Œè‹¥ä¸æŒ‡å®š <code>Executor</code>ï¼Œè¿™äº›ä»»åŠ¡é»˜è®¤ç”± <code>ForkJoinPool.commonPool()</code> æ‰¿è½½ï¼Œä½†åœ¨ç”Ÿäº§çŽ¯å¢ƒä¸‹ï¼Œé€šå¸¸å»ºè®®ä¼ å…¥è‡ªå®šä¹‰çº¿ç¨‹æ± ä»¥å®žçŽ°ä¸šåŠ¡é—´çš„èµ„æºéš”ç¦»ä¸Žç›‘æŽ§ã€‚</p><h5 id="å¼‚æ­¥é“¾è·¯çš„å›žè°ƒå¤„ç†æœºåˆ¶"><a class="markdownIt-Anchor" href="#å¼‚æ­¥é“¾è·¯çš„å›žè°ƒå¤„ç†æœºåˆ¶"></a> å¼‚æ­¥é“¾è·¯çš„å›žè°ƒå¤„ç†æœºåˆ¶</h5><p>åœ¨ä»»åŠ¡å®ŒæˆåŽï¼Œ<code>CompletableFuture</code> æ”¯æŒé€šè¿‡é“¾å¼è°ƒç”¨å®šä¹‰å›žè°ƒé€»è¾‘ã€‚<code>thenApply</code> æ–¹æ³•èƒ½å¤ŸèŽ·å–å‰ä¸€é˜¶æ®µçš„æ‰§è¡Œç»“æžœå¹¶å¯¹å…¶è¿›è¡Œè½¬æ¢ï¼Œäº§ç”Ÿä¸€ä¸ªæ–°çš„è¿”å›žå€¼ï¼Œä»Žè€Œæž„å»ºå‡ºæµæ°´çº¿å¼çš„å¤„ç†é“¾è·¯ã€‚ä¸Žä¹‹ç›¸å¯¹ï¼Œ<code>thenAccept</code> ä»…ç”¨äºŽæ¶ˆè´¹å‰åºä»»åŠ¡çš„ç»“æžœè€Œä¸äº§ç”Ÿæ–°çš„è¾“å‡ºï¼Œè€Œ <code>thenRun</code> åˆ™å®Œå…¨å¿½ç•¥ç»“æžœï¼Œä»…åœ¨ä»»åŠ¡å®Œæˆè¿™ä¸€ç‰¹å®šæ—¶æœºè§¦å‘åŽç»­åŠ¨ä½œã€‚</p><h5 id="å¤šä»»åŠ¡çš„é€»è¾‘ç¼–æŽ’ä¸ŽååŒ"><a class="markdownIt-Anchor" href="#å¤šä»»åŠ¡çš„é€»è¾‘ç¼–æŽ’ä¸ŽååŒ"></a> å¤šä»»åŠ¡çš„é€»è¾‘ç¼–æŽ’ä¸ŽååŒ</h5><p>é’ˆå¯¹å¤æ‚çš„å¹¶å‘åœºæ™¯ï¼Œ<code>CompletableFuture</code> æä¾›äº†å¼ºå¤§çš„ç¼–æŽ’èƒ½åŠ›ã€‚å¯¹äºŽå­˜åœ¨å…ˆåŽä¾èµ–å…³ç³»çš„ä¸²è¡Œä»»åŠ¡ï¼Œ<code>thenCompose</code> å¯ä»¥å°†å‰ä¸€ä¸ªä»»åŠ¡çš„è¾“å‡ºå¹³æ»‘ä¼ é€’ç»™ä¸‹ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ï¼›è€Œå¯¹äºŽäº’ä¸ä¾èµ–ã€éœ€å¹¶è¡Œæ‰§è¡Œçš„ä»»åŠ¡ï¼Œ<code>thenCombine</code> æ”¯æŒåœ¨ä¸¤ä¸ªä»»åŠ¡å…¨éƒ¨å®ŒæˆåŽå¯¹å…¶ç»“æžœè¿›è¡Œèšåˆã€‚åœ¨æ›´å®è§‚çš„å±‚é¢ï¼Œ<code>allOf</code> æä¾›äº†é˜»å¡žå¼åŒæ­¥æœºåˆ¶ï¼Œç¡®ä¿æ‰€æœ‰å¹¶è¡Œçš„å¼‚æ­¥ä»»åŠ¡å…¨éƒ¨å®ŒæˆåŽå†å‘ä¸‹æ‰§è¡Œï¼Œè€Œ <code>anyOf</code> åˆ™å®žçŽ°äº†ç«žäº‰é€»è¾‘ï¼Œåªè¦å…¶ä¸­ä»»æ„ä¸€ä¸ªä»»åŠ¡çŽ‡å…ˆå®Œæˆå³è¿”å›žå…¶ç»“æžœã€‚</p><h5 id="å¼‚æ­¥é“¾è·¯çš„å¼‚å¸¸æ•èŽ·ä¸Žå®¹é”™"><a class="markdownIt-Anchor" href="#å¼‚æ­¥é“¾è·¯çš„å¼‚å¸¸æ•èŽ·ä¸Žå®¹é”™"></a> å¼‚æ­¥é“¾è·¯çš„å¼‚å¸¸æ•èŽ·ä¸Žå®¹é”™</h5><p>å¼‚æ­¥ç¼–ç¨‹ä¸­çš„å¼‚å¸¸ä¼ æ’­ä¸Žä¼ ç»ŸåŒæ­¥ä»£ç æœ‰æ‰€ä¸åŒï¼Œéœ€è¦ä¸“é—¨çš„å…œåº•æœºåˆ¶ã€‚<code>exceptionally</code> æ–¹æ³•ç±»ä¼¼äºŽåŒæ­¥ä»£ç ä¸­çš„ catch å—ï¼Œèƒ½å¤Ÿåœ¨é“¾è·¯å‡ºçŽ°å¼‚å¸¸æ—¶æ‹¦æˆªé”™è¯¯å¹¶è¿”å›žä¸€ä¸ªé¢„è®¾çš„é»˜è®¤å€¼ï¼Œç¡®ä¿åŽç»­é“¾è·¯ä¸ä¼šå› æœªæ•èŽ·çš„å¼‚å¸¸è€Œä¸­æ–­ã€‚æ­¤å¤–ï¼Œ<code>handle</code> æ–¹æ³•æä¾›äº†æ›´å…¨é¢çš„æŽ§åˆ¶ï¼Œæ— è®ºå‰åºä»»åŠ¡æ˜¯æ­£å¸¸ç»“æŸè¿˜æ˜¯æŠ›å‡ºå¼‚å¸¸ï¼Œå®ƒå‡èƒ½æŽ¥æ”¶åˆ°æ‰§è¡Œç»“æžœæˆ–å¼‚å¸¸å¯¹è±¡ï¼Œå¹¶è¿›è¡Œç»Ÿä¸€çš„å¤„ç†ä¸Žè½¬æ¢ã€‚</p><p>ä¸¾ä¸€ä¸ªé“¾å¼æµæ°´çº¿çš„ä¾‹å­</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CompletableFuture.supplyAsync(() -&gt; <span class="string">&quot;æŸ¥è¯¢å•†å“ID:123&quot;</span>)</span><br><span class="line">    .thenApply(id -&gt; <span class="string">&quot;èŽ·å–å•†å“ä»·æ ¼: $99&quot;</span>) <span class="comment">// é“¾å¼å¤„ç†</span></span><br><span class="line">    .thenCombine(CompletableFuture.supplyAsync(() -&gt; <span class="string">&quot;èŽ·å–ä¼˜æƒ åˆ¸: -$10&quot;</span>), </span><br><span class="line">        (price, coupon) -&gt; price + <span class="string">&quot; &quot;</span> + coupon) <span class="comment">// ç»„åˆä¸¤ä¸ªå¼‚æ­¥ä»»åŠ¡</span></span><br><span class="line">    .thenAccept(finalResult -&gt; System.out.println(<span class="string">&quot;æœ€ç»ˆæŠ¥ä»·: &quot;</span> + finalResult))</span><br><span class="line">    .exceptionally(e -&gt; &#123; </span><br><span class="line">        System.err.println(<span class="string">&quot;å‡ºé”™: &quot;</span> + e.getMessage()); </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>; </span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure><h4 id="completionservice"><a class="markdownIt-Anchor" href="#completionservice"></a> <code>CompletionService</code></h4><p><code>CompletionService&lt;V&gt;</code> æ˜¯ä¸€ä¸ªæŽ¥å£ï¼Œç”¨äºŽ æäº¤å¼‚æ­¥ä»»åŠ¡å¹¶æŒ‰å®Œæˆé¡ºåºèŽ·å–ç»“æžœã€‚å®ƒç»“åˆäº† Executorï¼ˆçº¿ç¨‹æ± ï¼‰å’Œ BlockingQueue çš„åŠŸèƒ½ã€‚ä»»åŠ¡å®Œæˆé¡ºåºä¸Žæäº¤é¡ºåºå¯èƒ½ä¸åŒï¼Œä½¿ç”¨ CompletionService å¯ä»¥ æŒ‰ç…§å®Œæˆé¡ºåº èŽ·å–ä»»åŠ¡ç»“æžœã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CompletionServiceExample</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">ExecutorService</span> <span class="variable">pool</span> <span class="operator">=</span> Executors.newFixedThreadPool(<span class="number">3</span>);</span><br><span class="line">        CompletionService&lt;String&gt; service = <span class="keyword">new</span> <span class="title class_">ExecutorCompletionService</span>&lt;&gt;(pool);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æäº¤ä»»åŠ¡</span></span><br><span class="line">        service.submit(() -&gt; &#123; Thread.sleep(<span class="number">300</span>); <span class="keyword">return</span> <span class="string">&quot;Task 1&quot;</span>; &#125;);</span><br><span class="line">        service.submit(() -&gt; &#123; Thread.sleep(<span class="number">100</span>); <span class="keyword">return</span> <span class="string">&quot;Task 2&quot;</span>; &#125;);</span><br><span class="line">        service.submit(() -&gt; &#123; Thread.sleep(<span class="number">200</span>); <span class="keyword">return</span> <span class="string">&quot;Task 3&quot;</span>; &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æŒ‰å®Œæˆé¡ºåºèŽ·å–ç»“æžœ</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">            Future&lt;String&gt; future = service.take();  <span class="comment">// é˜»å¡žç›´åˆ°æœ‰ä»»åŠ¡å®Œæˆ</span></span><br><span class="line">            System.out.println(future.get());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        pool.shutdown();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç¬¬ä¸ƒç« å¹¶å‘å®¹å™¨-concurrent-collections"><a class="markdownIt-Anchor" href="#ç¬¬ä¸ƒç« å¹¶å‘å®¹å™¨-concurrent-collections"></a> ç¬¬ä¸ƒç« ï¼šå¹¶å‘å®¹å™¨ (Concurrent Collections)</h3><h4 id="concurrenthashmap-åŽŸç†"><a class="markdownIt-Anchor" href="#concurrenthashmap-åŽŸç†"></a> <code>ConcurrentHashMap</code> åŽŸç†</h4><p><code>ConcurrentHashMap</code> æ˜¯ä¸ºäº†è§£å†³ <code>Hashtable</code> å…¨å±€é”å®šå¯¼è‡´å¹¶å‘æ•ˆçŽ‡ä½Žä¸‹çš„é—®é¢˜è€Œè®¾è®¡çš„ã€‚åœ¨ Java 8 åŠå…¶åŽç»­ç‰ˆæœ¬ä¸­ï¼Œå®ƒèˆå¼ƒäº†æ—©æœŸç‰ˆæœ¬ä¸­çš„åˆ†æ®µé”ï¼ˆSegmentï¼‰è®¾è®¡ï¼Œè½¬è€Œé‡‡ç”¨ <strong>Node æ•°ç»„ + é“¾è¡¨ + çº¢é»‘æ ‘</strong> çš„ç»“æž„ï¼Œå¹¶ç»“åˆ <strong>CASï¼ˆCompare-And-Swapï¼‰</strong> å’Œ <strong>synchronized</strong> å®žçŽ°æ›´ç»†ç²’åº¦çš„é”æŽ§åˆ¶ã€‚</p><p>åœ¨æ‰§è¡Œè¯»æ“ä½œæ—¶ï¼Œ<code>ConcurrentHashMap</code> å®Œå…¨ä¸åŠ é”ï¼Œé€šè¿‡ <code>volatile</code> å…³é”®å­—ä¿è¯äº†æ•°æ®çš„å¯è§æ€§ï¼Œè¿™ä½¿å¾—å®ƒåœ¨è¯»å–å¯†é›†çš„åœºæ™¯ä¸‹è¡¨çŽ°æžä½³ã€‚åœ¨æ‰§è¡Œå†™æ“ä½œæ—¶ï¼Œå®ƒä»…é”å®šå½“å‰æ­£åœ¨æ“ä½œçš„å“ˆå¸Œæ¡¶ï¼ˆå³ Node æ•°ç»„çš„å¤´èŠ‚ç‚¹ï¼‰ï¼Œè€Œä¸æ˜¯æ•´ä¸ª Mapã€‚è¿™ç§â€œå±€éƒ¨é”å®šâ€çš„ç­–ç•¥å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶å¯¹ä¸åŒçš„å“ˆå¸Œæ¡¶è¿›è¡Œå†™å…¥ã€‚æ­¤å¤–ï¼Œå½“é“¾è¡¨é•¿åº¦è¶…è¿‡é˜ˆå€¼ï¼ˆé»˜è®¤ä¸º 8ï¼‰ä¸”æ•°ç»„å®¹é‡å¤§äºŽ 64 æ—¶ï¼Œé“¾è¡¨ä¼šè½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œä»¥ä¿è¯åœ¨é«˜ç¢°æ’žæƒ…å†µä¸‹çš„æŸ¥è¯¢æ•ˆçŽ‡ä»èƒ½ç»´æŒåœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>ã€‚</p><h4 id="copyonwritearraylist"><a class="markdownIt-Anchor" href="#copyonwritearraylist"></a> <code>CopyOnWriteArrayList</code></h4><p><code>CopyOnWriteArrayList</code> é‡‡ç”¨äº†ä¸€ç§æžå…¶ç‹¬ç‰¹çš„â€œå†™æ—¶å¤åˆ¶â€ï¼ˆCopy-On-Writeï¼‰ç­–ç•¥ã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šå½“ä½ å¯¹å®¹å™¨è¿›è¡Œä¿®æ”¹ï¼ˆæ·»åŠ ã€åˆ é™¤ã€è®¾ç½®å…ƒç´ ï¼‰æ—¶ï¼Œå®ƒå¹¶ä¸ç›´æŽ¥ä¿®æ”¹å½“å‰æ•°ç»„ï¼Œè€Œæ˜¯å…ˆå°†åŽŸæ•°ç»„æ‹·è´ä¸€ä»½å‰¯æœ¬ï¼Œåœ¨å‰¯æœ¬ä¸Šå®Œæˆä¿®æ”¹æ“ä½œï¼Œæœ€åŽå†å°†åŽŸæ•°ç»„çš„å¼•ç”¨æŒ‡å‘è¿™ä¸ªæ–°å‰¯æœ¬ã€‚</p><p>è¿™ç§æœºåˆ¶å¸¦æ¥äº†æ˜¾è‘—çš„ç‰¹æ€§ï¼š<strong>è¯»æ“ä½œå®Œå…¨æ— é”ä¸”ä¸é˜»å¡ž</strong>ã€‚å½“ä¸€ä¸ªçº¿ç¨‹åœ¨éåŽ†åˆ—è¡¨æ—¶ï¼Œå³ä½¿æœ‰å¦ä¸€ä¸ªçº¿ç¨‹æ­£åœ¨è¿›è¡Œä¿®æ”¹ï¼ŒéåŽ†çº¿ç¨‹çœ‹åˆ°çš„ä¾ç„¶æ˜¯ä¿®æ”¹å‰çš„æ—§æ•°ç»„é•œåƒï¼Œå› æ­¤å®ƒå¤©ç„¶åœ°è§£å†³äº†å¹¶å‘ä¿®æ”¹å¼‚å¸¸ï¼ˆ<code>ConcurrentModificationException</code>ï¼‰ã€‚ç„¶è€Œï¼Œè¿™ç§è®¾è®¡ä¹Ÿå­˜åœ¨æ˜Žæ˜¾çš„æƒè¡¡ï¼Œå³æ¯æ¬¡ä¿®æ”¹éƒ½ä¼šå¯¼è‡´æ•°ç»„æ‹·è´ï¼Œå†…å­˜å¼€é”€è¾ƒå¤§ã€‚å› æ­¤ï¼Œå®ƒä»…é€‚ç”¨äºŽ<strong>è¯»å¤šå†™æžå°‘</strong>ä¸”å¯¹å®žæ—¶æ€§è¦æ±‚ä¸æ˜¯æžé«˜çš„åœºæ™¯ï¼ˆä¾‹å¦‚é…ç½®ç™½åå•æˆ–ç›‘å¬å™¨åˆ—è¡¨ï¼‰ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å†™æ“ä½œç¤ºä¾‹ï¼šå†…éƒ¨ä¼šåŠ é”å¹¶å¤åˆ¶æ•°ç»„</span></span><br><span class="line">List&lt;String&gt; list = <span class="keyword">new</span> <span class="title class_">CopyOnWriteArrayList</span>&lt;&gt;();</span><br><span class="line">list.add(<span class="string">&quot;data&quot;</span>); </span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯»æ“ä½œç¤ºä¾‹ï¼šç›´æŽ¥è¯»å–å¼•ç”¨ï¼Œæ€§èƒ½æžé«˜</span></span><br><span class="line"><span class="type">String</span> <span class="variable">val</span> <span class="operator">=</span> list.get(<span class="number">0</span>);</span><br></pre></td></tr></table></figure><h4 id="é˜»å¡žé˜Ÿåˆ—-blockingqueue-å…¨å®¶æ¡¶"><a class="markdownIt-Anchor" href="#é˜»å¡žé˜Ÿåˆ—-blockingqueue-å…¨å®¶æ¡¶"></a> é˜»å¡žé˜Ÿåˆ— <code>BlockingQueue</code> å…¨å®¶æ¡¶</h4><p><code>BlockingQueue</code> æ˜¯å®žçŽ°â€œç”Ÿäº§è€…-æ¶ˆè´¹è€…â€æ¨¡åž‹çš„çµé­‚ç»„ä»¶ã€‚å®ƒä¸Žæ™®é€šé˜Ÿåˆ—çš„åŒºåˆ«åœ¨äºŽæ”¯æŒ<strong>é˜»å¡žæœºåˆ¶</strong>ï¼šå½“é˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼Œå°è¯•å–å‡ºçš„çº¿ç¨‹ä¼šè¢«é˜»å¡žç›´åˆ°æœ‰æ•°æ®å¯ç”¨ï¼›å½“é˜Ÿåˆ—æ»¡æ—¶ï¼Œå°è¯•å­˜å…¥çš„çº¿ç¨‹ä¼šè¢«é˜»å¡žç›´åˆ°é˜Ÿåˆ—å‡ºçŽ°ç©ºä½ã€‚</p><p>JUC æä¾›äº†å¤šç§ä¸åŒç‰¹æ€§çš„å®žçŽ°ç±»ã€‚<code>ArrayBlockingQueue</code> åŸºäºŽå®šé•¿æ•°ç»„ï¼Œå¼ºåˆ¶è¦æ±‚è®¾ç½®åˆå§‹å®¹é‡ï¼Œé€‚åˆä»»åŠ¡é‡ç¨³å®šçš„ç³»ç»Ÿã€‚<code>LinkedBlockingQueue</code> åŸºäºŽé“¾è¡¨ï¼Œé»˜è®¤å®¹é‡ä¸º <code>Integer.MAX_VALUE</code>ï¼Œå¦‚æžœä¸è®¾é™å¯èƒ½ä¼šå¯¼è‡´å†…å­˜æº¢å‡ºã€‚<code>SynchronousQueue</code> åˆ™æ›´ä¸ºç‰¹æ®Šï¼Œå®ƒä¸å­˜å‚¨ä»»ä½•å…ƒç´ ï¼Œæ¯ä¸€ä¸ªæ’å…¥æ“ä½œå¿…é¡»ç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹çš„ç§»é™¤æ“ä½œï¼Œæ˜¯çº¿ç¨‹é—´â€œæ‰‹é€’æ‰‹â€ä¼ é€’æ•°æ®çš„æ¡¥æ¢ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰æ”¯æŒä¼˜å…ˆçº§çš„ <code>PriorityBlockingQueue</code> å’Œå¤„ç†å»¶è¿Ÿä»»åŠ¡çš„ <code>DelayQueue</code>ã€‚è¿™äº›é˜Ÿåˆ—é€šè¿‡å†…éƒ¨çš„ <code>ReentrantLock</code> å’Œ <code>Condition</code> æœºåˆ¶ï¼Œä¼˜é›…åœ°è§£å†³äº†çº¿ç¨‹é—´çš„åŒæ­¥è°ƒåº¦é—®é¢˜ã€‚</p><h3 id="ç¬¬å…«ç« -æ­»é”"><a class="markdownIt-Anchor" href="#ç¬¬å…«ç« -æ­»é”"></a> ç¬¬å…«ç«  æ­»é”</h3><p>åœ¨å¤šçº¿ç¨‹çŽ¯å¢ƒä¸‹ï¼Œ<strong>æ­»é”ï¼ˆDeadlockï¼‰</strong> æ˜¯æœ€ä»¤äººå¤´ç–¼çš„å¹¶å‘é—®é¢˜ä¹‹ä¸€ã€‚å®ƒå‘ç”Ÿåœ¨ä¸¤ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹äº’ç›¸æŒæœ‰å¯¹æ–¹æ‰€éœ€çš„èµ„æºï¼Œå¯¼è‡´æ‰€æœ‰ç›¸å…³çº¿ç¨‹éƒ½è¿›å…¥æ— é™æœŸçš„ç­‰å¾…çŠ¶æ€ã€‚</p><h4 id="æ­»é”çš„å››å¤§å¿…è¦æ¡ä»¶"><a class="markdownIt-Anchor" href="#æ­»é”çš„å››å¤§å¿…è¦æ¡ä»¶"></a> æ­»é”çš„å››å¤§å¿…è¦æ¡ä»¶</h4><p>æ ¹æ®ç»å…¸æ“ä½œç³»ç»Ÿç†è®ºï¼Œæ­»é”çš„å‘ç”Ÿå¿…é¡»åŒæ—¶æ»¡è¶³ä»¥ä¸‹å››ä¸ªæ¡ä»¶ã€‚å¦‚æžœèƒ½ç ´åå…¶ä¸­ä»»ä½•ä¸€ä¸ªï¼Œæ­»é”å°±ä¸ä¼šå‘ç”Ÿï¼š</p><ol><li><strong>äº’æ–¥æ¡ä»¶ï¼ˆMutual Exclusionï¼‰</strong>ï¼š<br />èµ„æºæ˜¯ç‹¬å çš„ã€‚åœ¨æŸä¸€æ—¶åˆ»ï¼Œä¸€ä¸ªèµ„æºï¼ˆå¦‚ä¸€ä¸ªå¯¹è±¡é”ï¼‰åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹æŒæœ‰ã€‚å¦‚æžœå…¶ä»–çº¿ç¨‹è¯·æ±‚è¯¥èµ„æºï¼Œå¿…é¡»ç­‰å¾…ç›´åˆ°æŒæœ‰è€…é‡Šæ”¾ã€‚</li><li><strong>å æœ‰ä¸”ç­‰å¾…ï¼ˆHold and Waitï¼‰</strong>ï¼š<br />ä¸€ä¸ªçº¿ç¨‹å·²ç»æŒæœ‰äº†è‡³å°‘ä¸€ä¸ªèµ„æºï¼Œä½†åˆæå‡ºäº†æ–°çš„èµ„æºè¯·æ±‚ï¼Œè€Œè¯¥èµ„æºæ­£è¢«å…¶ä»–çº¿ç¨‹å æœ‰ã€‚æ­¤æ—¶è¯·æ±‚çº¿ç¨‹é˜»å¡žï¼Œä½†å¯¹è‡ªå·±å·²èŽ·å¾—çš„èµ„æºä¿æŒä¸æ”¾ã€‚</li><li><strong>ä¸å¯å‰¥å¤ºï¼ˆNo Preemptionï¼‰</strong>ï¼š<br />çº¿ç¨‹å·²èŽ·å¾—çš„èµ„æºåœ¨æœªä½¿ç”¨å®Œä¹‹å‰ï¼Œä¸èƒ½è¢«å…¶ä»–çº¿ç¨‹å¼ºè¡Œå¤ºèµ°ï¼Œåªèƒ½ç”±è¯¥çº¿ç¨‹åœ¨å®Œæˆä»»åŠ¡åŽä¸»åŠ¨é‡Šæ”¾ã€‚</li><li><strong>å¾ªçŽ¯ç­‰å¾…ï¼ˆCircular Waitï¼‰</strong>ï¼š<br />å­˜åœ¨ä¸€ä¸ªçº¿ç¨‹çš„èµ„æºå¾ªçŽ¯é“¾ã€‚ä¾‹å¦‚ï¼Œçº¿ç¨‹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">T1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord">1</span></span></span></span> ç­‰å¾… <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">T2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord">2</span></span></span></span> å æœ‰çš„èµ„æºï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">T2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord">2</span></span></span></span> ç­‰å¾… <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">T3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord">3</span></span></span></span> çš„èµ„æºâ€¦â€¦æœ€åŽ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">Tn</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal">n</span></span></span></span> åˆåœ¨ç­‰å¾… <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">T1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord">1</span></span></span></span> å æœ‰çš„èµ„æºã€‚</li></ol><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Object</span> <span class="variable">lockA</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line"><span class="type">Object</span> <span class="variable">lockB</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// çº¿ç¨‹ t1ï¼šå…ˆæ‹¿ Aï¼Œå†æ‹¿ B</span></span><br><span class="line"><span class="type">Thread</span> <span class="variable">t1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">    <span class="keyword">synchronized</span> (lockA) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123; Thread.sleep(<span class="number">100</span>); &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;&#125; <span class="comment">// ç¡®ä¿ t2 æ‹¿åˆ°äº† B</span></span><br><span class="line">        <span class="keyword">synchronized</span> (lockB) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Thread 1 acquired both locks&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// çº¿ç¨‹ t2ï¼šå…ˆæ‹¿ Bï¼Œå†æ‹¿ A</span></span><br><span class="line"><span class="type">Thread</span> <span class="variable">t2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">    <span class="keyword">synchronized</span> (lockB) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123; Thread.sleep(<span class="number">100</span>); &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;&#125; <span class="comment">// ç¡®ä¿ t1 æ‹¿åˆ°äº† A</span></span><br><span class="line">        <span class="keyword">synchronized</span> (lockA) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Thread 2 acquired both locks&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">t1.start();</span><br><span class="line">t2.start();</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒThread.sleep(100) æ˜¯äº§ç”Ÿæ­»é”çš„å…³é”®å‚¬åŒ–å‰‚ã€‚å®ƒä¿è¯äº† t1 é”ä½ lockA çš„åŒæ—¶ï¼Œt2 æœ‰è¶³å¤Ÿçš„æ—¶é—´é”ä½ lockBã€‚æ­¤æ—¶ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">t1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathnormal">t</span><span class="mord">1</span></span></span></span> è¯•å›¾èŽ·å– lockB æ—¶ä¼šå› ä¸ºâ€œäº’æ–¥â€è¢«é˜»å¡žï¼ŒåŒæ—¶å®ƒâ€œå æœ‰ä¸”ç­‰å¾…â€ç€ lockAï¼›<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">t2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathnormal">t</span><span class="mord">2</span></span></span></span> åŒç†ã€‚ç”±äºŽé”æ˜¯â€œä¸å¯å‰¥å¤ºâ€çš„ï¼Œæœ€ç»ˆå½¢æˆäº† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mn>1</mn><mo>â†’</mo><mi>l</mi><mi>o</mi><mi>c</mi><mi>k</mi><mi>B</mi><mo>â†’</mo><mi>t</mi><mn>2</mn><mo>â†’</mo><mi>l</mi><mi>o</mi><mi>c</mi><mi>k</mi><mi>A</mi><mo>â†’</mo><mi>t</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">t1 \rightarrow lockB \rightarrow t2 \rightarrow lockA \rightarrow t1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathnormal">t</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathnormal">t</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathnormal">t</span><span class="mord">1</span></span></span></span> çš„å¾ªçŽ¯ç­‰å¾…ã€‚</p><p><strong>å¦‚ä½•æŽ’æŸ¥æ­»é”ï¼Ÿ</strong><br />å½“ç¨‹åºçªç„¶â€œå¡æ­»â€ä¸” CPU å ç”¨çŽ‡æžä½Žæ—¶ï¼Œæžæœ‰å¯èƒ½æ˜¯å‘ç”Ÿäº†æ­»é”ã€‚ä½ å¯ä»¥ä½¿ç”¨ JDK è‡ªå¸¦çš„å·¥å…·è¿›è¡Œæ£€æµ‹ï¼š</p><ol><li><strong><code>jcmd / jps</code></strong>ï¼šèŽ·å–è¿è¡Œä¸­çš„ Java è¿›ç¨‹ IDã€‚</li><li><strong><code>jstack &lt;pid&gt;</code></strong>ï¼šæ‰“å°çº¿ç¨‹å †æ ˆã€‚å¦‚æžœå­˜åœ¨æ­»é”ï¼Œ<code>jstack</code> ä¼šåœ¨æœ«å°¾æ˜Žç¡®æç¤º <code>Found one Java-level deadlock</code>ï¼Œå¹¶è¯¦ç»†åˆ—å‡ºæ˜¯å“ªäº›çº¿ç¨‹åœ¨å“ªä¸ªå¯¹è±¡ä¸Šäº’ç›¸æŠ˜ç£¨ã€‚</li></ol><p><strong>å¦‚ä½•é¢„é˜²æ­»é”ï¼Ÿ</strong></p><ol><li><strong>å›ºå®šåŠ é”é¡ºåº</strong>ï¼ˆç ´åå¾ªçŽ¯ç­‰å¾…ï¼‰ï¼šè¿™æ˜¯æœ€å¸¸ç”¨çš„æ–¹æ¡ˆã€‚è®© <code>t1</code> å’Œ <code>t2</code> éƒ½æŒ‰ç…§â€œå…ˆæ‹¿ A å†æ‹¿ Bâ€çš„é¡ºåºåŽ»ç«žäº‰ï¼Œè¿™æ ·å°±ä¸ä¼šå½¢æˆçŽ¯è·¯ã€‚</li><li><strong>å°è¯•æ€§èŽ·å–é”</strong>ï¼ˆç ´åä¸å¯å‰¥å¤ºï¼‰ï¼šä½¿ç”¨ <code>ReentrantLock</code> çš„ <code>tryLock(long time, TimeUnit unit)</code> æ–¹æ³•ã€‚å¦‚æžœçº¿ç¨‹åœ¨è§„å®šæ—¶é—´å†…æ‹¿ä¸åˆ°ä¸‹ä¸€æŠŠé”ï¼Œå°±ä¸»åŠ¨é‡Šæ”¾å·²ç»æ‹¿åˆ°çš„é”ï¼Œé€€å›žå¹¶é‡è¯•ã€‚</li><li><strong>å‡å°é”ç²’åº¦</strong>ï¼šå°½é‡ä¸è¦åœ¨ä¸€ä¸ªåŒæ­¥å—ä¸­åµŒå¥—å¦ä¸€ä¸ªåŒæ­¥å—ã€‚</li></ol><h3 id="ç¬¬ä¹ç« -threadå†…å­˜æ³„æ¼"><a class="markdownIt-Anchor" href="#ç¬¬ä¹ç« -threadå†…å­˜æ³„æ¼"></a> ç¬¬ä¹ç«  Threadå†…å­˜æ³„æ¼</h3><p>åœ¨å¤šçº¿ç¨‹å¼€å‘ä¸­ï¼Œé™¤äº†æ­»é”ï¼Œå¦ä¸€ä¸ªéšè”½ä¸”é«˜å‘çš„é™·é˜±æ˜¯ <strong>ThreadLocal å¯¼è‡´çš„å†…å­˜æ³„æ¼</strong>ã€‚è¿™é€šå¸¸å‘ç”Ÿåœ¨é•¿ç”Ÿå‘½å‘¨æœŸçš„çº¿ç¨‹ï¼ˆå¦‚çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹ï¼‰ä¸­ã€‚</p><h4 id="threadlocal-å†…å­˜æ³„æ¼çš„æ ¹æº"><a class="markdownIt-Anchor" href="#threadlocal-å†…å­˜æ³„æ¼çš„æ ¹æº"></a> ThreadLocal å†…å­˜æ³„æ¼çš„æ ¹æº</h4><p><code>ThreadLocal</code> çš„åŽŸç†æ˜¯ä¸ºæ¯ä¸ªçº¿ç¨‹ç»´æŠ¤ä¸€ä¸ªç§æœ‰çš„ <code>ThreadLocalMap</code>ã€‚è¿™ä¸ª Map çš„ç‰¹æ®Šä¹‹å¤„åœ¨äºŽå®ƒçš„å†…éƒ¨ç»“æž„ï¼šå…¶ <strong>Keyï¼ˆThreadLocal å®žä¾‹ï¼‰æ˜¯å¼±å¼•ç”¨ï¼ˆWeakReferenceï¼‰</strong>ï¼Œè€Œ <strong>Valueï¼ˆå­˜å‚¨çš„æ•°æ®ï¼‰æ˜¯å¼ºå¼•ç”¨</strong>ã€‚</p><p>è¿™ç§è®¾è®¡çš„åˆè¡·æ˜¯ä¸ºäº†ä¿æŠ¤å†…å­˜ï¼šå½“å¤–éƒ¨ä¸å†æŒæœ‰ <code>ThreadLocal</code> å®žä¾‹çš„å¼ºå¼•ç”¨æ—¶ï¼ŒKey ä¼šåœ¨ä¸‹ä¸€æ¬¡ GC æ—¶è¢«å›žæ”¶ï¼Œå˜æˆ <code>null</code>ã€‚ç„¶è€Œï¼Œé—®é¢˜ä¹Ÿå°±æ­¤äº§ç”Ÿã€‚è™½ç„¶ Key æ¶ˆå¤±äº†ï¼Œä½† <strong>Value ä¾ç„¶è¢«çº¿ç¨‹çš„ <code>ThreadLocalMap</code> ä»¥å¼ºå¼•ç”¨çš„æ–¹å¼æŒæœ‰</strong>ã€‚</p><p>å¦‚æžœè¿™ä¸ªçº¿ç¨‹æ˜¯æ™®é€šçº¿ç¨‹ï¼Œæ‰§è¡Œå®Œä»»åŠ¡å°±é”€æ¯äº†ï¼Œé‚£ä¹ˆæ•´ä¸ª Map éƒ½ä¼šè¢«å›žæ”¶ã€‚ä½†çŽ°ä»£åº”ç”¨å‡ ä¹Žéƒ½åœ¨ä½¿ç”¨<strong>çº¿ç¨‹æ± </strong>ã€‚çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ˜¯é«˜åº¦å¤ç”¨çš„ï¼Œè¿™æ„å‘³ç€ï¼š</p><ol><li>çº¿ç¨‹æ°¸è¿œä¸ä¼šç»“æŸã€‚</li><li><code>ThreadLocalMap</code> é‡Œçš„é‚£å— Value å†…å­˜ä¼šä¸€ç›´è¢«å ç”¨ã€‚</li><li>ç”±äºŽ Key å˜æˆäº† <code>null</code>ï¼Œä½ å†ä¹Ÿæ²¡æœ‰åŠžæ³•é€šè¿‡æ­£å¸¸é€”å¾„è®¿é—®åˆ°è¿™å— Valueï¼Œå®ƒæˆäº†ä¸€å—â€œå¹½çµå†…å­˜â€ã€‚</li></ol><p>æ¯”å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ThreadLocalLeakDemo</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> ThreadLocal&lt;<span class="type">byte</span>[]&gt; localData = <span class="keyword">new</span> <span class="title class_">ThreadLocal</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// æ¨¡æ‹Ÿä¸€ä¸ªå›ºå®šå¤§å°ä¸º 5 çš„çº¿ç¨‹æ± </span></span><br><span class="line">        <span class="type">ExecutorService</span> <span class="variable">pool</span> <span class="operator">=</span> Executors.newFixedThreadPool(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">50</span>; i++) &#123;</span><br><span class="line">            pool.execute(() -&gt; &#123;</span><br><span class="line">                <span class="comment">// æ¯ä¸ªä»»åŠ¡å ç”¨ 5MB å†…å­˜</span></span><br><span class="line">                localData.set(<span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span> * <span class="number">1024</span> * <span class="number">5</span>]);</span><br><span class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">&quot; è®¾ç½®äº†æ•°æ®&quot;</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// æ³¨æ„ï¼šè¿™é‡Œæ²¡æœ‰è°ƒç”¨ localData.remove()</span></span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œè™½ç„¶ä»»åŠ¡æ‰§è¡Œå®Œäº†ï¼Œä½†ç”±äºŽçº¿ç¨‹æ± é‡Œçš„çº¿ç¨‹æ²¡æ­»ï¼Œæ¯ä¸ªçº¿ç¨‹æŒæœ‰çš„ 5MB å­—èŠ‚æ•°ç»„ä¼šä¸€ç›´é©»ç•™åœ¨å†…å­˜ä¸­ã€‚å¦‚æžœä»»åŠ¡ä¸æ–­æäº¤ï¼Œå†…å­˜å ç”¨ä¼šæŒç»­æ”€å‡ï¼Œæœ€ç»ˆå¯¼è‡´ <code>OutOfMemoryError</code>ã€‚</p><p>ä½¿ç”¨ <code>jvisualvm</code> æˆ– <code>MAT</code> (Memory Analyzer Tool) æŸ¥çœ‹å †è½¬å‚¨ï¼ˆHeap Dumpï¼‰ã€‚å¦‚æžœä½ å‘çŽ° <code>ThreadLocalMap</code> é‡Œçš„ <code>Entry</code> æ•°é‡å¼‚å¸¸å¤šï¼Œä¸”å…¶ <code>value</code> å­—æ®µå ç”¨äº†å¤§é‡å†…å­˜ï¼ŒåŸºæœ¬å¯ä»¥ç¡®å®šæ˜¯æ³„æ¼ã€‚</p><p>åœ¨ä»£ç ä¸­ä½¿ç”¨ <code>ThreadLocal</code> æ—¶ï¼ŒåŠ¡å¿…éµå¾ª <code>try-finally</code> æ¨¡å¼ï¼Œåœ¨ <code>finally</code> å—ä¸­è°ƒç”¨ <code>remove()</code> æ–¹æ³•ã€‚è¿™ä¼šæ¸…é™¤å½“å‰çº¿ç¨‹ Map ä¸­å¯¹åº”çš„ Entryã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    localData.set(value);</span><br><span class="line">    <span class="comment">// æ‰§è¡Œä¸šåŠ¡é€»è¾‘</span></span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    <span class="comment">// å…³é”®ï¼šä»»åŠ¡ç»“æŸå‰ä¸€å®šè¦æ¸…ç†ï¼Œå°¤å…¶æ˜¯åœ¨çº¿ç¨‹æ± çŽ¯å¢ƒä¸‹</span></span><br><span class="line">    localData.remove();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;ä¸‡å­—é•¿æ–‡æ¢³ç†JAVAçº¿ç¨‹æ–¹æ³•çš„åŸºç¡€åº”ç”¨&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>MTMCTæ–¹å‘çš„åº¦é‡å­¦ä¹ æ¢³ç†</title>
    <link href="https://atffang.github.io/2025/12/21/MTMCT%E6%96%B9%E5%90%91%E7%9A%84%E5%BA%A6%E9%87%8F%E5%AD%A6%E4%B9%A0%E6%A2%B3%E7%90%86/"/>
    <id>https://atffang.github.io/2025/12/21/MTMCT%E6%96%B9%E5%90%91%E7%9A%84%E5%BA%A6%E9%87%8F%E5%AD%A6%E4%B9%A0%E6%A2%B3%E7%90%86/</id>
    <published>2025-12-21T07:11:01.000Z</published>
    <updated>2025-12-21T11:47:16.354Z</updated>
    
    <content type="html"><![CDATA[<p>MTMCTæ–¹å‘çš„åº¦é‡å­¦ä¹ æ¢³ç†ã€‚</p><span id="more"></span><h3 id="èƒŒæ™¯"><a class="markdownIt-Anchor" href="#èƒŒæ™¯"></a> èƒŒæ™¯</h3><p>åœ¨ä»¥è¡Œäººé‡è¯†åˆ«ï¼ˆPerson Re-Identification, ReIDï¼‰ä¸ºä»£è¡¨çš„ä¸€äº›è§†è§‰ä»»åŠ¡ä¸­ï¼Œæµ‹è¯•é˜¶æ®µå‡ºçŽ°çš„ç±»åˆ«ï¼ˆå³å…·ä½“çš„è¡Œäººèº«ä»½æˆ–ç›®æ ‡IDï¼‰åœ¨è®­ç»ƒé˜¶æ®µæ˜¯æœªçŸ¥çš„ã€‚è¿™ä»Žæ ¹æœ¬ä¸Šè¦æ±‚æ¨¡åž‹å…·å¤‡æå–å…·å¤‡å¼ºåˆ¤åˆ«åŠ›ï¼ˆDiscriminativeï¼‰ä¸”é«˜æ³›åŒ–æ€§ç‰¹å¾çš„èƒ½åŠ›ï¼Œè€Œéžå•çº¯åœ°è®°å¿†è®­ç»ƒé›†ä¸­çš„ç±»åˆ«æ ‡ç­¾ã€‚</p><p><strong>åº¦é‡å­¦ä¹ ï¼ŒMetric Learning</strong> æ­£æ˜¯è§£å†³è¿™ä¸€æ ¸å¿ƒçŸ›ç›¾çš„å…³é”®æŠ€æœ¯é€”å¾„ã€‚å…¶æœ¬è´¨æ—¨åœ¨é€šè¿‡æ·±åº¦ç¥žç»ç½‘ç»œæž„å»ºä¸€ä¸ªéžçº¿æ€§çš„<strong>ç‰¹å¾æ˜ å°„å‡½æ•°</strong>ï¼Œå°†å­˜åœ¨äºŽé«˜ç»´åƒç´ ç©ºé—´çš„åŽŸå§‹æ•°æ®æŠ•å½±è‡³ä½Žç»´çš„<strong>åµŒå…¥ç©ºé—´</strong>ï¼ˆEmbedding Spaceï¼‰æˆ–æµå½¢ï¼ˆManifoldï¼‰ä¸Šã€‚åœ¨æ­¤åº¦é‡ç©ºé—´ä¸­ï¼Œ<strong>è·ç¦»åº¦é‡</strong>ï¼ˆå¦‚æ¬§æ°è·ç¦»æˆ–ä½™å¼¦ç›¸ä¼¼åº¦ï¼‰ç›´æŽ¥å¯¹åº”äºŽæ ·æœ¬é—´çš„è¯­ä¹‰ç›¸ä¼¼åº¦ã€‚</p><p>ç†æƒ³çš„åº¦é‡å­¦ä¹ æ¨¡åž‹åº”å½“æ»¡è¶³ä¸¤ä¸ªåŸºæœ¬å‡ ä½•çº¦æŸï¼š</p><ul><li><strong>åŒç±»æ ·æœ¬åœ¨ç‰¹å¾ç©ºé—´ä¸­é«˜åº¦ç´§å‡‘</strong>ï¼ˆIntra-class Compactnessï¼‰</li><li><strong>å¼‚ç±»æ ·æœ¬åœ¨ç‰¹å¾ç©ºé—´ä¸­å°½å¯èƒ½åˆ†ç¦»</strong>ï¼ˆInter-class Separabilityï¼‰</li></ul><h4 id="é—®é¢˜å®šä¹‰"><a class="markdownIt-Anchor" href="#é—®é¢˜å®šä¹‰"></a> é—®é¢˜å®šä¹‰</h4><p>ä»Žæ•°å­¦è§’åº¦å½¢å¼åŒ–åœ°çœ‹ï¼Œåº¦é‡å­¦ä¹ çš„ç›®æ ‡æ˜¯å­¦ä¹ ä¸€ä¸ªå‚æ•°åŒ–çš„æ˜ å°„å‡½æ•°ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>f</mi><mi>Î¸</mi></msub><mo>:</mo><mi mathvariant="script">X</mi><mo>â†’</mo><msup><mi mathvariant="double-struck">R</mi><mi>d</mi></msup></mrow><annotation encoding="application/x-tex">f_\theta: \mathcal{X} \rightarrow \mathbb{R}^d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.14643em;">X</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8991079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span></span></p><p>å…¶ä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">X</mi></mrow><annotation encoding="application/x-tex">\mathcal{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.14643em;">X</span></span></span></span></span> ä¸ºè¾“å…¥å›¾åƒç©ºé—´ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="double-struck">R</mi><mi>d</mi></msup></mrow><annotation encoding="application/x-tex">\mathbb{R}^d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span> ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">d</span></span></span></span> ç»´ç‰¹å¾å‘é‡ç©ºé—´ã€‚</p><p>å¯¹äºŽä»»æ„ç»™å®šçš„ä¸‰å…ƒç»„æ ·æœ¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mi>a</mi></msub><mo separator="true">,</mo><msub><mi>x</mi><mi>p</mi></msub><mo separator="true">,</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_a, x_p, x_n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼Œå…¶ä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">x_a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸ºé”šç‚¹æ ·æœ¬ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">x_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> ä¸ºä¸Ž <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">x_a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> åŒä¸€èº«ä»½çš„æ­£æ ·æœ¬ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">x_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸ºä¸åŒèº«ä»½çš„è´Ÿæ ·æœ¬ï¼Œåº¦é‡å­¦ä¹ æ—¨åœ¨ä¼˜åŒ–å‚æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span></span></span></span>ï¼Œä½¿å¾—åœ¨æ˜ å°„åŽçš„ç‰¹å¾ç©ºé—´ä¸­æ»¡è¶³ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>D</mi><mo stretchy="false">(</mo><msub><mi>f</mi><mi>Î¸</mi></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>a</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>f</mi><mi>Î¸</mi></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>p</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>â‰ª</mo><mi>D</mi><mo stretchy="false">(</mo><msub><mi>f</mi><mi>Î¸</mi></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>a</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>f</mi><mi>Î¸</mi></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">D(f_\theta(x_a), f_\theta(x_p)) \ll D(f_\theta(x_a), f_\theta(x_n))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰ª</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p><p>å…¶ä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo stretchy="false">(</mo><mo>â‹…</mo><mo separator="true">,</mo><mo>â‹…</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">D(\cdot, \cdot)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord">â‹…</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">â‹…</span><span class="mclose">)</span></span></span></span> ä¸ºé¢„å®šä¹‰çš„è·ç¦»åº¦é‡å‡½æ•°ã€‚</p><h4 id="å½“å‰ä¼˜åŒ–çš„æ–¹å‘"><a class="markdownIt-Anchor" href="#å½“å‰ä¼˜åŒ–çš„æ–¹å‘"></a> å½“å‰ä¼˜åŒ–çš„æ–¹å‘</h4><p>é¦–å…ˆæ˜¯ä¼ ç»ŸæŸå¤±å‡½æ•°çš„ä¼˜åŒ–ç“¶é¢ˆï¼Œä»¥æœ€ç»å…¸çš„ Softmax ä¸ºä¾‹ï¼ŒSoftmax äº¤å‰ç†µæŸå¤±å‡½æ•°è™½ç„¶åœ¨æ¦‚çŽ‡ç©ºé—´èƒ½å¤Ÿæœ‰æ•ˆåŒºåˆ†è®­ç»ƒç±»åˆ«ï¼Œä½†åœ¨ç‰¹å¾ç©ºé—´å¹¶æœªæ–½åŠ æ˜¾å¼çš„è·ç¦»çº¦æŸï¼Œå¯¼è‡´å­¦ä¹ åˆ°çš„ç‰¹å¾åœ¨ç±»å†…åˆ†å¸ƒè¾ƒä¸ºæ¾æ•£ã€‚</p><p>å…·ä½“æ¥è¯´ï¼ŒSoftmax çš„ç›®æ ‡æ˜¯æœ€å¤§åŒ–æ­£ç¡®ç±»åˆ«çš„åŽéªŒæ¦‚çŽ‡ã€‚åœ¨æ•°å­¦ä¸Šï¼Œåªè¦ç‰¹å¾å‘é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">f</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{f}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> åœ¨æ­£ç¡®ç±»åˆ«æƒé‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">w</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mrow><annotation encoding="application/x-tex">\mathbf{w}_{y_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.730548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">w</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> æ–¹å‘ä¸Šçš„æŠ•å½±æ¯”åœ¨å…¶ä»–ç±»åˆ«æ–¹å‘ä¸Šçš„æŠ•å½±ç¨å¾®å¤§ä¸€ç‚¹ï¼ŒLoss å°±ä¼šå‡å°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span></span></span></span> è¢«åˆ†åˆ°äº†ç±» Aï¼Œå“ªæ€•å®ƒä»…ä»…è·¨è¿‡äº†å†³ç­–è¾¹ç•Œä¸€ç‚¹ç‚¹ï¼Œæ¨¡åž‹ä¹Ÿè®¤ä¸ºä»»åŠ¡å®Œæˆäº†ã€‚ä½†åœ¨åº¦é‡å­¦ä¹ ä»»åŠ¡ä¸­ï¼Œä¸ä»… <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span></span></span></span> è¦è¢«åˆ†åˆ°ç±» Aï¼Œè€Œä¸” <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span></span></span></span> å¿…é¡»å°½å¯èƒ½é è¿‘ç±» A çš„ä¸­å¿ƒï¼Œå¹¶ä¸”è¿œç¦»ç±» Bã€‚</p><p>å…¶æ¬¡æ˜¯<strong>å›°éš¾æ ·æœ¬æŒ–æŽ˜</strong>çš„ç­–ç•¥è®¾è®¡ã€‚åœ¨æµ·é‡è®­ç»ƒæ•°æ®ä¸­ï¼Œç»å¤§å¤šæ•°æ ·æœ¬å¯¹åŒ…å«çš„æ¢¯åº¦ä¿¡æ¯æžå…¶å¾®å¼±ï¼Œå³æ¨¡åž‹å·²èƒ½è½»æ˜“åŒºåˆ†å¤§éƒ¨åˆ†ä¸åŒç±»åˆ«ï¼Œåªæœ‰å°‘æ•°ä½äºŽå†³ç­–è¾¹ç•Œé™„è¿‘çš„<strong>å›°éš¾æ ·æœ¬</strong>å¯¹æ¨¡åž‹çš„ä¼˜åŒ–å…·æœ‰å®žè´¨æ€§è´¡çŒ®ã€‚å¦‚ä½•é«˜æ•ˆåœ°ç­›é€‰å‡ºè¿™äº›é«˜ä»·å€¼æ ·æœ¬ï¼ŒåŒæ—¶é¿å…å› æ ‡æ³¨å™ªå£°å¯¼è‡´çš„æ¨¡åž‹åå¡Œï¼Œæ˜¯è®¾è®¡é«˜æ•ˆåº¦é‡å­¦ä¹ ç³»ç»Ÿçš„å…³é”®ã€‚</p><p>æ­¤å¤–ï¼Œç‰¹å¾ç©ºé—´çš„å‡ ä½•ç»“æž„é€‰æ‹©äº¦è‡³å…³é‡è¦ã€‚æ—©æœŸçš„ç ”ç©¶å¤šåŸºäºŽæ¬§æ°ç©ºé—´è¿›è¡Œåº¦é‡ï¼Œä½†è¿‘å¹´æ¥çš„ç ”ç©¶è¡¨æ˜Žï¼Œå°†ç‰¹å¾å½’ä¸€åŒ–å¹¶çº¦æŸåœ¨è¶…çƒé¢ä¸Šï¼Œåˆ©ç”¨è§’åº¦è·ç¦»ä»£æ›¿æ¬§æ°è·ç¦»å¾€å¾€æ›´åŠ æœ‰æ•ˆã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œåœ¨ä¼ ç»Ÿçš„æ¬§æ°ç©ºé—´ï¼ˆæ¬§æ°è·ç¦»ï¼‰ä¸­ï¼Œç‰¹å¾å‘é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">f</mi></mrow><annotation encoding="application/x-tex">\mathbf{f}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span></span></span> çš„é•¿åº¦ï¼ˆèŒƒæ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">âˆ¥</mi><mi mathvariant="bold">f</mi><mi mathvariant="normal">âˆ¥</mi></mrow><annotation encoding="application/x-tex">\|\mathbf{f}\|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">âˆ¥</span><span class="mord"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span><span class="mord">âˆ¥</span></span></span></span>ï¼‰ä»£è¡¨äº†æ¨¡åž‹å¯¹è¯¥æ ·æœ¬çš„ç½®ä¿¡åº¦æˆ–æ˜¾è‘—æ€§ï¼Œåœ¨æŸä¸ªæ–¹é¢å¯ä»¥ç†è§£ä¸ºå›¾åƒçš„æ¸…æ™°åº¦ã€‚åœ¨è®¡ç®—æ¬§æ°è·ç¦» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">âˆ¥</mi><msub><mi mathvariant="bold">f</mi><mn>1</mn></msub><mo>âˆ’</mo><msub><mi mathvariant="bold">f</mi><mn>2</mn></msub><mi mathvariant="normal">âˆ¥</mi></mrow><annotation encoding="application/x-tex">\| \mathbf{f}_1 - \mathbf{f}_2 \|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">âˆ¥</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">âˆ¥</span></span></span></span> æ—¶ï¼Œæ¨¡é•¿çš„å·®å¼‚ä¼šæŽ©ç›–æ–¹å‘çš„ç›¸ä¼¼æ€§ã€‚æ¨¡åž‹å¯èƒ½ä¼šå› ä¸ºä¸¤å¼ å›¾ç‰‡çš„â€œæ¸…æ™°åº¦â€ç›¸è¿‘è€Œè®¤ä¸ºå®ƒä»¬æ˜¯åŒä¸€ä¸ªäººã€‚</p><p>è€Œè¶…çƒé¢ï¼ˆHypersphereï¼‰çš„è§£æ³•ï¼šé€šè¿‡å½’ä¸€åŒ–ï¼Œå°†æ‰€æœ‰ç‰¹å¾æ˜ å°„åˆ°æ¨¡é•¿ä¸º 1 çš„è¶…çƒé¢ä¸Šã€‚æ¨¡åž‹è¢«è¿«åªé€šè¿‡â€œæ–¹å‘â€æ¥åˆ¤åˆ«èº«ä»½ï¼Œæ¶ˆé™¤äº†å›¾åƒè´¨é‡ã€å…‰ç…§ç­‰å› ç´ å¸¦æ¥çš„å¹…å€¼å¹²æ‰°ã€‚</p><h3 id="ç›¸å…³å·¥ä½œreidä¸Žmtmctæ–¹å‘"><a class="markdownIt-Anchor" href="#ç›¸å…³å·¥ä½œreidä¸Žmtmctæ–¹å‘"></a> ç›¸å…³å·¥ä½œï¼ˆREIDä¸ŽMTMCTæ–¹å‘ï¼‰</h3><h4 id="æ·±åº¦åº¦é‡å­¦ä¹ èŒƒå¼"><a class="markdownIt-Anchor" href="#æ·±åº¦åº¦é‡å­¦ä¹ èŒƒå¼"></a> æ·±åº¦åº¦é‡å­¦ä¹ èŒƒå¼</h4><p><strong>æ·±åº¦åº¦é‡å­¦ä¹ </strong>ï¼ˆDeep Metric Learning, <strong>DML</strong>ï¼‰æ—¨åœ¨é€šè¿‡æ·±åº¦ç¥žç»ç½‘ç»œå°†è¯­ä¹‰ç›¸ä¼¼çš„å›¾åƒæ˜ å°„åˆ°é‚»è¿‘çš„ç‰¹å¾ç©ºé—´ã€‚æ ¹æ®ä¼˜åŒ–ç›®æ ‡çš„æž„å»ºæ–¹å¼ï¼ŒçŽ°æœ‰çš„ä¸»æµæ–¹æ³•å¯å¤§è‡´åˆ’åˆ†ä¸ºåŸºäºŽæ ·æœ¬å¯¹ï¼ˆPair-basedï¼‰çš„æ–¹æ³•å’ŒåŸºäºŽä»£ç†ï¼ˆProxy-basedï¼‰çš„æ–¹æ³•ä¸¤å¤§ç±»ã€‚</p><p><strong>åŸºäºŽæ ·æœ¬å¯¹</strong>çš„æ–¹æ³•ç›´æŽ¥åœ¨æ ·æœ¬ä¹‹é—´æž„å»ºçº¦æŸã€‚æ—©æœŸçš„å¼€åˆ›æ€§å·¥ä½œå¦‚ <strong>Siamese Network</strong>ï¼ˆå­ªç”Ÿç½‘ç»œï¼‰å¼•å…¥äº†<strong>å¯¹æ¯”æŸå¤±</strong>ï¼ˆContrastive Lossï¼‰ï¼Œè¯¥æ–¹æ³•æŽ¥å—ä¸€å¯¹æ ·æœ¬ä½œä¸ºè¾“å…¥ï¼Œé€šè¿‡æ‹‰è¿‘æ­£æ ·æœ¬å¯¹è·ç¦»å¹¶æŽ¨è¿œè´Ÿæ ·æœ¬å¯¹è·ç¦»æ¥å­¦ä¹ ç‰¹å¾è¡¨ç¤ºã€‚</p><h5 id="contrastive-loss"><a class="markdownIt-Anchor" href="#contrastive-loss"></a> Contrastive Loss</h5><p>å‡è®¾æœ‰ä¸€å¯¹è¾“å…¥æ ·æœ¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_i, x_j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼Œå…¶å¯¹åº”çš„ç‰¹å¾åµŒå…¥ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x_j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ã€‚æˆ‘ä»¬å®šä¹‰è¿™ä¸¤è€…åœ¨ç‰¹å¾ç©ºé—´ä¸­çš„æ¬§æ°è·ç¦»ä¸ºï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>d</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi mathvariant="normal">âˆ¥</mi><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>âˆ’</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo><msub><mi mathvariant="normal">âˆ¥</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">d_{ij} = \| f(x_i) - f(x_j) \|_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">âˆ¥</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord">âˆ¥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>ä¸ºäº†åŒºåˆ†æ ·æœ¬å¯¹çš„å…³ç³»ï¼Œå®šä¹‰æ ‡ç­¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>âˆˆ</mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">y \in \{0, 1\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335400000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">}</span></span></span></span>ï¼š</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">y=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> è¡¨ç¤ºåŒç±»æ ·æœ¬ï¼ˆPositive Pairï¼‰</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">y=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> è¡¨ç¤ºå¼‚ç±»æ ·æœ¬ï¼ˆNegative Pairï¼‰</li></ul><p>å¯¹æ¯”æŸå¤±å‡½æ•°çš„æ ‡å‡†å½¢å¼å¦‚ä¸‹ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><msub><mi>d</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo fence="true">[</mo><mi>y</mi><mo>â‹…</mo><msubsup><mi>d</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>2</mn></msubsup><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>âˆ’</mo><mi>y</mi><mo stretchy="false">)</mo><mo>â‹…</mo><mi>max</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>m</mi><mo>âˆ’</mo><msub><mi>d</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo separator="true">,</mo><mn>0</mn><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{L}(d_{ij}) = \frac{1}{2} \left[ y \cdot d_{ij}^2 + (1 - y) \cdot \max(m - d_{ij}, 0)^2 \right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span></span></span></p><p>å…¶ä¸­ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">m &gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> æ˜¯ä¸€ä¸ªé¢„è®¾çš„é˜ˆå€¼ï¼ˆMarginï¼‰ã€‚</p><p>è¿™ä¸ªå…¬å¼ä¸æ˜¯å¾ˆå¥½ç†è§£ï¼Œæˆ‘ä»¬æ‹†è§£<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>çš„ä¸¤ç§æƒ…å†µï¼š</p><ul><li>å½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">y=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> æ—¶ï¼ŒåŒç±»æ‹‰è¿‘ï¼Œå…¬å¼ç®€åŒ–ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">L</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msubsup><mi>d</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L} = \frac{1}{2} d_{ij}^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal">L</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2398799999999999em;vertical-align:-0.394772em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.394772em;"><span></span></span></span></span></span></span></span></span></span>ã€‚è¿™æ˜¯ä¸€ä¸ªäºŒæ¬¡å‡½æ•°ï¼Œå…¶æœ€å°å€¼åœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">d_{ij}=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> å¤„å–å¾—ã€‚æ— è®ºæ­£æ ·æœ¬å¯¹é å¾—æœ‰å¤šè¿‘ï¼ŒæŸå¤±å‡½æ•°å§‹ç»ˆæ–½åŠ ä¸€ä¸ªå‘å¿ƒçš„æ‹‰åŠ›ï¼Œè®©ä»–ä»¬å¯ä»¥æ›´åŠ é è¿‘ã€‚</li><li>å½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">y=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> æ—¶ï¼ˆå¼‚ç±»æŽ¨è¿œï¼‰å…¬å¼ç®€åŒ–ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">L</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>max</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>m</mi><mo>âˆ’</mo><msub><mi>d</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo separator="true">,</mo><mn>0</mn><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\mathcal{L} = \frac{1}{2} \max(m - d_{ij}, 0)^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal">L</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1002159999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>ã€‚è¿™æ˜¯ä¸€ä¸ªåˆ†æ®µå‡½æ•°ã€‚åªæœ‰å½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>&lt;</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">d_{ij} &lt; m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span> æ—¶ï¼ŒæŸå¤±æ‰å¤§äºŽ 0ã€‚å¦‚æžœä¸¤ä¸ªä¸åŒç±»åˆ«çš„æ ·æœ¬ç¦»å¾—è¶³å¤Ÿè¿œï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>â‰¥</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">d_{ij} \ge m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span>ï¼‰ï¼Œæ¨¡åž‹è®¤ä¸ºå®ƒä»¬å·²ç»å®‰å…¨ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">Loss</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mord mathnormal">s</span></span></span></span> å˜ä¸º 0ï¼Œä¸äº§ç”Ÿä»»ä½•æ–¥åŠ›ã€‚å¦‚æžœå®ƒä»¬é å¾—å¤ªè¿‘ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>&lt;</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">d_{ij} &lt; m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span>ï¼‰ï¼ŒæŸå¤±å‡½æ•°ä¼šäº§ç”Ÿä¸€ä¸ªæ–¥åŠ›ï¼Œå°†å®ƒä»¬æŽ¨å¼€ï¼Œç›´åˆ°è·ç¦»è‡³å°‘ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span>ã€‚</li></ul><h5 id="triplet-loss"><a class="markdownIt-Anchor" href="#triplet-loss"></a> Triplet Loss</h5><p>å¯¹æ¯”æŸå¤±æ˜¯äºŒå…ƒçš„ï¼Œå®ƒå­¤ç«‹åœ°çœ‹æ­£å¯¹ï¼ˆPositive Pairï¼‰æˆ–è´Ÿå¯¹ï¼ˆNegative Pairï¼‰ã€‚å…¶æ•°å­¦å±€é™åœ¨äºŽï¼š</p><ul><li>å®ƒè¿«ä½¿æ‰€æœ‰æ­£å¯¹çš„è·ç¦» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d(a, p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span> è¶‹è¿‘äºŽ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></li><li>å®ƒè¿«ä½¿æ‰€æœ‰è´Ÿå¯¹çš„è·ç¦» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d(a, n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> å¿…é¡»å¤§äºŽå›ºå®šå€¼ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span></li></ul><p>FaceNet æå‡ºçš„<strong>ä¸‰å…ƒç»„æŸå¤±</strong>ï¼ˆTriplet Lossï¼‰å°†çº¦æŸå…³ç³»æ‰©å±•è‡³ä¸‰å…ƒç»„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>A</mi><mi>n</mi><mi>c</mi><mi>h</mi><mi>o</mi><mi>r</mi><mo separator="true">,</mo><mi>P</mi><mi>o</mi><mi>s</mi><mi>i</mi><mi>t</mi><mi>i</mi><mi>v</mi><mi>e</mi><mo separator="true">,</mo><mi>N</mi><mi>e</mi><mi>g</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>v</mi><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(Anchor, Positive, Negative)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord mathnormal">n</span><span class="mord mathnormal">c</span><span class="mord mathnormal">h</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">e</span><span class="mclose">)</span></span></span></span>ï¼Œä¸å†å¼ºåˆ¶è¦æ±‚æ­£è´Ÿæ ·æœ¬å¯¹çš„ç»å¯¹è·ç¦»ï¼Œè€Œæ˜¯å…³æ³¨å®ƒä»¬ä¹‹é—´çš„ç›¸å¯¹è·ç¦»å·®ã€‚è¿™ç§ç›¸å¯¹çº¦æŸæžå¤§åœ°æå‡äº†æ¨¡åž‹åœ¨äººè„¸è¯†åˆ«å’Œè¡Œäººé‡è¯†åˆ«ç­‰å¼€é›†ä»»åŠ¡ä¸­çš„åˆ¤åˆ«èƒ½åŠ›ï¼Œæˆä¸ºè¯¥é¢†åŸŸçš„ç»å…¸åŸºå‡†ã€‚</p><p>ä¸‰å…ƒç»„æŸå¤±çš„å‡½æ•°å®šä¹‰ä¸ºï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="script">L</mi><mo>=</mo><mi>max</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>p</mi><mo stretchy="false">)</mo><mo>âˆ’</mo><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo><mo>+</mo><mi>Î±</mi><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{L} = \max(d(a, p) - d(a, n) + \alpha, 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal">L</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span></p><p>åœ¨ä¸‰å…ƒç»„çº¦æŸä¸‹ï¼Œæ¨¡åž‹ä¸å†å±€é™äºŽ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>p</mi><mo stretchy="false">)</mo><mo>â‰ˆ</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">d(a, p) \approx 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>ã€‚åªè¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d(a, p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span> æ¯” <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d(a, n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> å°ä¸€ä¸ªé—´éš” <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î±</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span></span></span></span> å³å¯ã€‚æ¯”å¦‚ï¼Œå¦‚æžœæŸäººçš„ç‰¹å¾æœ¬èº«è¾ƒåˆ†æ•£ï¼ˆä¾‹å¦‚å§¿æ€å¤šå˜ï¼‰ï¼Œæ¨¡åž‹å…è®¸å…¶ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d(a, p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span> ç¨å¤§ï¼ˆå¦‚ 0.5ï¼‰ï¼Œåªè¦è´Ÿæ ·æœ¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d(a, n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> è¢«æŽ¨åˆ°æ›´è¿œï¼ˆå¦‚ 1.0ï¼‰å³å¯ã€‚</p><h4 id="å›°éš¾æ ·æœ¬æŒ–æŽ˜ç­–ç•¥"><a class="markdownIt-Anchor" href="#å›°éš¾æ ·æœ¬æŒ–æŽ˜ç­–ç•¥"></a> å›°éš¾æ ·æœ¬æŒ–æŽ˜ç­–ç•¥</h4><p>åœ¨åº¦é‡å­¦ä¹ çš„è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ ·æœ¬çš„é€‰æ‹©ç­–ç•¥å¯¹æ¨¡åž‹æ€§èƒ½çš„å½±å“å¾€å¾€å¤§äºŽæŸå¤±å‡½æ•°æœ¬èº«ã€‚ç”±äºŽæ·±åº¦ç½‘ç»œå…·æœ‰å¼ºå¤§çš„æ‹Ÿåˆèƒ½åŠ›ï¼Œéšç€è®­ç»ƒçš„è¿›è¡Œï¼Œç»å¤§å¤šæ•°éšæœºé‡‡æ ·çš„ä¸‰å…ƒç»„å‡æ»¡è¶³è·ç¦»çº¦æŸï¼Œè¿™äº›æ— æ•ˆæ ·æœ¬ä¸ä»…æµªè´¹è®¡ç®—èµ„æºï¼Œè¿˜ä¼šå¯¼è‡´æ¢¯åº¦æ¶ˆå¤±ï¼Œä½¿å¾—æ¨¡åž‹æ— æ³•è¿›ä¸€æ­¥ä¼˜åŒ–å†³ç­–è¾¹ç•Œã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸€æ¢¯åº¦ç¨€ç–é—®é¢˜ï¼Œ<strong>å›°éš¾æ ·æœ¬æŒ–æŽ˜</strong>ï¼ˆHard Negative Miningï¼‰æˆä¸ºå¿…ç„¶é€‰æ‹©ã€‚ç»å…¸çš„æŒ–æŽ˜ç­–ç•¥å€¾å‘äºŽå¯»æ‰¾é‚£äº›ä½¿å¾—æŸå¤±å‡½æ•°å€¼æœ€å¤§çš„â€œæœ€éš¾â€æ ·æœ¬ã€‚Hermans ç­‰äººåœ¨è¡Œäººé‡è¯†åˆ«ä»»åŠ¡ä¸­ç³»ç»Ÿæ€§åœ°éªŒè¯äº†å¤šç§é‡‡æ ·ç­–ç•¥ï¼Œå¹¶æå‡ºäº† Batch Hardï¼ˆTriHardï¼‰é‡‡æ ·æ–¹æ³•ã€‚</p><p>è¯¥æ–¹æ³•ä¸å†ä¾èµ–å…¨æ•°æ®é›†çš„ç¦»çº¿æŒ–æŽ˜ï¼Œè€Œæ˜¯åŠ¨æ€åœ°åœ¨æ¯ä¸ªè®­ç»ƒæ‰¹æ¬¡ï¼ˆBatchï¼‰å†…ï¼Œé’ˆå¯¹æ¯ä¸€ä¸ª Anchor æ ·æœ¬ï¼Œé€‰å–è·ç¦»æœ€è¿œçš„æ­£æ ·æœ¬å’Œè·ç¦»æœ€è¿‘çš„è´Ÿæ ·æœ¬æž„å»ºä¸‰å…ƒç»„ã€‚è¿™ç§åœ¨çº¿ï¼ˆOnlineï¼‰æŒ–æŽ˜ç­–ç•¥åœ¨ä¿è¯è®­ç»ƒç¨³å®šæ€§çš„åŒæ—¶ï¼Œæ˜¾è‘—æå‡äº†æ¨¡åž‹å¯¹å¤–è§‚ç›¸ä¼¼ä¸ªä½“çš„åŒºåˆ†èƒ½åŠ›ï¼Œç›®å‰å·²æˆä¸º ReID é¢†åŸŸçš„æ ‡å‡†é…ç½®ã€‚</p><h5 id="batch-hard-trihard"><a class="markdownIt-Anchor" href="#batch-hard-trihard"></a> Batch Hard (TriHard)</h5><p>å®šä¹‰ä¸€ä¸ª Batch çš„æž„æˆï¼šéšæœºæŠ½å– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> ä¸ªèº«ä»½ï¼ˆIDï¼‰ï¼Œæ¯ä¸ªèº«ä»½æŠ½å– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> å¼ å›¾ç‰‡ã€‚Batch æ€»é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mi>P</mi><mo>Ã—</mo><mi>K</mi></mrow><annotation encoding="application/x-tex">N = P \times K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span>ã€‚<br />å¯¹äºŽ Batch ä¸­çš„ä»»æ„ä¸€ä¸ªé”šç‚¹æ ·æœ¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mi>a</mi><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">x_a^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.071664em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span>ï¼ˆå±žäºŽèº«ä»½ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span>ï¼‰ï¼ŒTriHard æŸå¤±å‡½æ•°çš„æ•°å­¦è¡¨è¾¾å¼ä¸ºï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mi>B</mi><mi>H</mi></mrow></msub><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>P</mi></munderover><munderover><mo>âˆ‘</mo><mrow><mi>a</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mrow><mo fence="true">[</mo><mover><mover><mrow><munder><mo><mi>max</mi><mo>â¡</mo></mo><mrow><mi>p</mi><mo>=</mo><mn>1</mn><mo>â€¦</mo><mi>K</mi></mrow></munder><mi>d</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><msubsup><mi>x</mi><mi>a</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>f</mi><mo stretchy="false">(</mo><msubsup><mi>x</mi><mi>p</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><mo stretchy="true">âž</mo></mover><mtext>æœ€éš¾æ­£æ ·æœ¬è·ç¦»</mtext></mover><mo>âˆ’</mo><munder><munder><mrow><munder><mo><mi>min</mi><mo>â¡</mo></mo><mstyle scriptlevel="1"><mtable rowspacing="0.1em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="1" displaystyle="false"><mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo>â€¦</mo><mi>P</mi><mo separator="true">,</mo><mi>n</mi><mo>=</mo><mn>1</mn><mo>â€¦</mo><mi>K</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="1" displaystyle="false"><mrow><mi>j</mi><mo mathvariant="normal">â‰ </mo><mi>i</mi></mrow></mstyle></mtd></mtr></mtable></mstyle></munder><mi>d</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><msubsup><mi>x</mi><mi>a</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>f</mi><mo stretchy="false">(</mo><msubsup><mi>x</mi><mi>n</mi><mi>j</mi></msubsup><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><mo stretchy="true">âŸ</mo></munder><mtext>æœ€éš¾è´Ÿæ ·æœ¬è·ç¦»</mtext></munder><mo>+</mo><mi>Î±</mi><mo fence="true">]</mo></mrow><mo>+</mo></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{BH} = \sum_{i=1}^{P} \sum_{a=1}^{K} \left[ \overbrace{\max_{p=1 \dots K} d(f(x_a^i), f(x_p^i))}^{\text{æœ€éš¾æ­£æ ·æœ¬è·ç¦»}} - \underbrace{\min_{\substack{j=1 \dots P, n=1 \dots K \\ j \neq i}} d(f(x_a^i), f(x_n^j))}_{\text{æœ€éš¾è´Ÿæ ·æœ¬è·ç¦»}} + \alpha \right]_+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:6.192007em;vertical-align:-2.937017em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2549900000000003em;"><span style="top:-1.0499800000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽ£</span></span></span><span style="top:-2.1999800000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:-2.79598em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:-3.39198em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:-3.9879800000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:-4.0139700000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:-5.25499em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽ¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.75004em;"><span></span></span></span></span></span></span><span class="mord mover"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.2009950000000003em;"><span style="top:-3.5226640000000002em;"><span class="pstrut" style="height:3.5226640000000002em;"></span><span class="mord mover"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5226640000000002em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43055999999999994em;"><span style="top:-2.3556690000000002em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mrel mtight">=</span><span class="mord mtight">1</span><span class="minner mtight">â€¦</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">max</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.880439em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8746639999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.874664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span><span class="svg-align" style="top:-3.974664em;"><span class="pstrut" style="height:3em;"></span><span class="stretchy" style="height:0.548em;min-width:1.6em;"><span class="brace-left" style="height:0.548em;"><svg width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'><path d='M6 548l-6-6v-35l6-11c56-104 135.3-181.3 238-232 57.3-28.7 117-45 179-50h399577v120H403c-43.3 7-81 15-113 26-100.7 33-179.7 91-237 174-2.7 5-6 9-10 13-.7 1-7.3 1-20 1H6z'/></svg></span><span class="brace-center" style="height:0.548em;"><svg width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'><path d='M200428 334c-100.7-8.3-195.3-44-280-108-55.3-42-101.7-93-139-153l-9-14c-2.7 4-5.7 8.7-9 14-53.3 86.7-123.7 153-211 199-66.7 36-137.3 56.3-212 62H0V214h199568c178.3-11.7 311.7-78.3 403-201 6-8 9.7-12 11-12 .7-.7 6.7-1 18-1s17.3.3 18 1c1.3 0 5 4 11 12 44.7 59.3 101.3 106.3 170 141s145.3 54.3 229 60h199572v120z'/></svg></span><span class="brace-right" style="height:0.548em;"><svg width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'><path d='M400000 542l-6 6h-17c-12.7 0-19.3-.3-20-1-4-4-7.3-8.3-10-13-35.3-51.3-80.8-93.8-136.5-127.5s-117.2-55.8-184.5-66.5c-.7 0-2-.3-4-1-18.7-2.7-76-4.3-172-5H0V214h399571l6 1c124.7 8 235 61.7 331 161 31.3 33.3 59.7 72.7 85 118l7 13v35z'/></svg></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.880439em;"><span></span></span></span></span></span></span><span style="top:-5.245328000000001em;"><span class="pstrut" style="height:3.5226640000000002em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord cjk_fallback mtight">æœ€éš¾æ­£æ ·æœ¬è·ç¦»</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.880439em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8746640000000001em;"><span style="top:-0.171014em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord cjk_fallback mtight">æœ€éš¾è´Ÿæ ·æœ¬è·ç¦»</span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8746640000000001em;"><span class="svg-align" style="top:-0.849345em;"><span class="pstrut" style="height:3em;"></span><span class="stretchy" style="height:0.548em;min-width:1.6em;"><span class="brace-left" style="height:0.548em;"><svg width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'><path d='M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z'/></svg></span><span class="brace-center" style="height:0.548em;"><svg width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'><path d='M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z'/></svg></span><span class="brace-right" style="height:0.548em;"><svg width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'><path d='M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z'/></svg></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6678600000000001em;"><span style="top:-2.0406725000000003em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.133325em;"><span style="top:-3.149995em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span><span class="minner mtight">â€¦</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span><span class="minner mtight">â€¦</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span><span style="top:-2.261115em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight"><span class="mrel mtight"><span class="mord vbox mtight"><span class="thinbox mtight"><span class="rlap mtight"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel mtight">î€ </span></span><span class="fix"></span></span></span></span></span><span class="mrel mtight">=</span></span><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.6333249999999999em;"><span></span></span></span></span></span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5026549999999999em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8746639999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8746639999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.150655em;"><span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.828986em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2549900000000003em;"><span style="top:-1.0499800000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽ¦</span></span></span><span style="top:-2.1999800000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:-2.79598em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:-3.39198em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:-3.9879800000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:-4.0139700000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:-5.25499em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽ¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.75004em;"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-2.470355em;"><span style="top:0.17868599999999982em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.937017em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>æˆ‘ä»¬åœ¨ä¹‹å‰ä¸€ç¯‡æ–‡ç« ä¸­è¯¦ç»†è§£é‡Šäº†è¿™ä¸€æ–¹æ³•ï¼Œå…¶æ ¸å¿ƒæ¦‚å¿µä¸ºç±»å†…å·®å¼‚çš„æœ€å¤§åŒ–ï¼Œå’Œç±»é—´è·ç¦»çš„æœ€å°åŒ–ã€‚</p><ul><li><strong>æœ€å¤§åŒ–ç±»å†…å·®å¼‚</strong>ï¼ˆMax-Pooling in Positivesï¼‰ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>max</mi><mo>â¡</mo><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\max d(a, p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span> æ‰¾åˆ°äº†å½“å‰ ID ä¸‹åˆ†å¸ƒæœ€æ•£çš„æ ·æœ¬ã€‚è¿™æ˜¯åœ¨ä¼˜åŒ–è¯¥ç±»åˆ«çš„åŠå¾„ï¼Œå¼ºåˆ¶å°†ç¦»ç¾¤ç‚¹ï¼ˆOutliersï¼‰æ‹‰å›žä¸­å¿ƒã€‚</li><li><strong>æœ€å°åŒ–ç±»é—´è·ç¦»</strong>ï¼ˆMin-Pooling in Negativesï¼‰ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>min</mi><mo>â¡</mo><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\min d(a, n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> æ‰¾åˆ°äº†è·ç¦»å½“å‰ç±»åˆ«æœ€è¿‘çš„å¼‚ç±»ã€‚è¿™æ˜¯åœ¨æŽ¢æµ‹å†³ç­–è¾¹ç•Œã€‚åªæœ‰é€šè¿‡æŽ¨å¼€è¿™äº›â€œæœ€è¿‘é‚»â€çš„å¼‚ç±»ï¼Œæ‰èƒ½åœ¨ç‰¹å¾ç©ºé—´ä¸­è…¾å‡ºè¶³å¤Ÿçš„ç¼“å†²åŒºã€‚</li></ul><h3 id="åºåˆ—æ·±åº¦åº¦é‡å­¦ä¹ æ–¹æ³•"><a class="markdownIt-Anchor" href="#åºåˆ—æ·±åº¦åº¦é‡å­¦ä¹ æ–¹æ³•"></a> åºåˆ—æ·±åº¦åº¦é‡å­¦ä¹ æ–¹æ³•</h3><h4 id="é›†åˆç©ºé—´çš„æ˜ å°„å½¢å¼åŒ–"><a class="markdownIt-Anchor" href="#é›†åˆç©ºé—´çš„æ˜ å°„å½¢å¼åŒ–"></a> é›†åˆç©ºé—´çš„æ˜ å°„å½¢å¼åŒ–</h4><p>åœ¨åŸºäºŽåºåˆ—çš„åº¦é‡å­¦ä¹ ä¸­ï¼Œè¾“å…¥å¯¹è±¡ä¸å†æ˜¯å•ä¸€çš„æ ·æœ¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>âˆˆ</mo><mi mathvariant="script">X</mi></mrow><annotation encoding="application/x-tex">x \in \mathcal{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.14643em;">X</span></span></span></span></span>ï¼Œè€Œæ˜¯ä¸€ä¸ªåŒ…å« <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span> å¸§å›¾åƒçš„åºåˆ—é›†åˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">S</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><msub><mi>x</mi><mi>T</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\mathcal{S} = \{x_1, x_2, \dots, x_T\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.075em;">S</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span>ï¼Œå…¶ä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span> ä¸ºå˜é‡ã€‚</p><p>æ•°å­¦ä¸Šï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯å­¦ä¹ ä¸€ä¸ªéžçº¿æ€§æ˜ å°„å‡½æ•°</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">Î¦</mi><mo>:</mo><msup><mi mathvariant="script">X</mi><mi>T</mi></msup><mo>â†’</mo><msup><mi mathvariant="double-struck">R</mi><mi>d</mi></msup></mrow><annotation encoding="application/x-tex">\Phi: \mathcal{X}^T \rightarrow \mathbb{R}^d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">Î¦</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8913309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.14643em;">X</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8991079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span></span></p><p>å°†é«˜ç»´çš„å›¾åƒåºåˆ—å¼ é‡æŠ•å½±ä¸ºä½Žç»´çš„å›ºå®šé•¿åº¦åµŒå…¥å‘é‡ã€‚<br />è¿™ä¸€æ˜ å°„è¿‡ç¨‹å¿…é¡»æ»¡è¶³ä¸¤ä¸ªå…³é”®çš„æ•°å­¦æ€§è´¨ï¼š</p><ul><li><strong>ç½®æ¢ä¸å˜æ€§</strong>ï¼ˆPermutation Invarianceï¼‰ï¼š å¯¹äºŽé›†åˆæ¨¡åž‹è€Œè¨€ï¼Œç‰¹å¾è¡¨ç¤ºä¸åº”å—è¾“å…¥å¸§é¡ºåºçš„å½±å“ï¼ˆé™¤éžæ˜¾å¼å»ºæ¨¡åŠ¨ä½œä¿¡æ¯ï¼‰ï¼Œå³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Î¦</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">Î¦</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Phi(x_1, x_2) = \Phi(x_2, x_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Î¦</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Î¦</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li><li><strong>å°ºå¯¸ä¸å˜æ€§</strong>ï¼ˆSize Invarianceï¼‰ï¼š æ— è®ºè¾“å…¥åºåˆ—é•¿åº¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span> æ˜¯ 5 å¸§è¿˜æ˜¯ 50 å¸§ï¼Œè¾“å‡ºç‰¹å¾å‘é‡çš„ç»´åº¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">d</span></span></span></span> å¿…é¡»æ’å®šã€‚ä¸ºæ­¤ï¼Œåºåˆ—åº¦é‡å­¦ä¹ é€šå¸¸é‡‡ç”¨â€œ<strong>ç¼–ç -èšåˆ</strong>â€ï¼ˆEncode-Aggregateï¼‰çš„äºŒé˜¶æ®µæ•°å­¦èŒƒå¼ï¼šé¦–å…ˆé€šè¿‡ CNN éª¨å¹²ç½‘ç»œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>Î¸</mi></msub></mrow><annotation encoding="application/x-tex">f_\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å°†æ¯ä¸€å¸§æ˜ å°„ä¸ºå¸§çº§ç‰¹å¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>t</mi></msub><mo>=</mo><msub><mi>f</mi><mi>Î¸</mi></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">v_t = f_\theta(x_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼ŒéšåŽé€šè¿‡æ—¶åºèšåˆå‡½æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mo>â‹…</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G(\cdot)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord">â‹…</span><span class="mclose">)</span></span></span></span> ç”Ÿæˆæœ€ç»ˆçš„åºåˆ—è¡¨å¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">e</mi><mo>=</mo><mi>G</mi><mo stretchy="false">(</mo><mo stretchy="false">{</mo><msub><mi>v</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><msub><mi>v</mi><mi>T</mi></msub><mo stretchy="false">}</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{e} = G(\{v_1, \dots, v_T\})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.44444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">e</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span><span class="mclose">)</span></span></span></span>ã€‚</li></ul><h4 id="åŸºäºŽæ³¨æ„åŠ›çš„æ—¶åºèšåˆæœºåˆ¶"><a class="markdownIt-Anchor" href="#åŸºäºŽæ³¨æ„åŠ›çš„æ—¶åºèšåˆæœºåˆ¶"></a> åŸºäºŽæ³¨æ„åŠ›çš„æ—¶åºèšåˆæœºåˆ¶</h4><p>æœ€æœ´ç´ çš„èšåˆå‡½æ•°æ˜¯<strong>æ—¶é—´å¹³å‡æ± åŒ–</strong>ï¼ˆTemporal Average Pooling, TAPï¼‰ï¼Œå³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>G</mi><mrow><mi>a</mi><mi>v</mi><mi>g</mi></mrow></msub><mo>=</mo><mfrac><mn>1</mn><mi>T</mi></mfrac><mo>âˆ‘</mo><msub><mi>v</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">G_{avg} = \frac{1}{T}\sum v_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€‚ç„¶è€Œï¼Œä»Žä¿¡æ¯è®ºè§’åº¦çœ‹ï¼Œåºåˆ—ä¸­çš„æ¯ä¸€å¸§æ‰€å«æœ‰çš„â€œèº«ä»½ä¿¡æ¯é‡â€æ˜¯ä¸å‡åŒ€çš„ï¼ˆä¾‹å¦‚ï¼Œé®æŒ¡å¸§çš„ä¿¡æ¯ç†µæžé«˜ï¼ŒåŒ…å«å¤§é‡å™ªå£°ï¼‰ã€‚</p><p>ä¸ºäº†æœ€å¤§åŒ–ç‰¹å¾ä¿¡å™ªæ¯”ï¼ŒçŽ°ä»£æ–¹æ³•ï¼ˆQuality Aware Network for Set to Set Recognitionï¼‰å¼•å…¥äº†**æ³¨æ„åŠ›æœºåˆ¶ï¼ˆAttention Mechanismï¼‰**ä½œä¸ºä¸€ç§å¯å­¦ä¹ çš„åŠ æƒç®—å­ã€‚</p><p>æ•°å­¦ä¸Šï¼Œè¿™ç­‰ä»·äºŽå­¦ä¹ ä¸€ä¸ªè¯„åˆ†å‡½æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo stretchy="false">(</mo><msub><mi>v</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h(v_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼Œç”¨äºŽä¼°è®¡ç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span></span></span></span> å¸§çš„ç‰¹å¾è´¨é‡ã€‚åŠ æƒèšåˆè¿‡ç¨‹å®šä¹‰ä¸ºï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="bold">e</mi><mrow><mi>a</mi><mi>t</mi><mi>t</mi></mrow></msub><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><msub><mi>Î±</mi><mi>t</mi></msub><mo>â‹…</mo><msub><mi>v</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{e}_{att} = \sum_{t=1}^{T} \alpha_t \cdot v_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">e</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0954490000000003em;vertical-align:-1.267113em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>å…¶ä¸­æƒé‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î±</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\alpha_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> éœ€æ»¡è¶³æ¦‚çŽ‡å•çº¯å½¢çº¦æŸï¼ˆSum-to-oneï¼‰ï¼Œé€šå¸¸é€šè¿‡ Softmax å‡½æ•°èŽ·å¾—ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>Î±</mi><mi>t</mi></msub><mo>=</mo><mfrac><mrow><mi>exp</mi><mo>â¡</mo><mo stretchy="false">(</mo><msup><mi mathvariant="bold">w</mi><mi>T</mi></msup><mi>tanh</mi><mo>â¡</mo><mo stretchy="false">(</mo><msub><mi mathvariant="bold">W</mi><mi>a</mi></msub><msub><mi>v</mi><mi>t</mi></msub><mo>+</mo><msub><mi mathvariant="bold">b</mi><mi>a</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><mrow><munderover><mo>âˆ‘</mo><mrow><mi>Ï„</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><mi>exp</mi><mo>â¡</mo><mo stretchy="false">(</mo><msup><mi mathvariant="bold">w</mi><mi>T</mi></msup><mi>tanh</mi><mo>â¡</mo><mo stretchy="false">(</mo><msub><mi mathvariant="bold">W</mi><mi>a</mi></msub><msub><mi>v</mi><mi>Ï„</mi></msub><mo>+</mo><msub><mi mathvariant="bold">b</mi><mi>a</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\alpha_t = \frac{\exp(\mathbf{w}^T \tanh(\mathbf{W}_a v_t + \mathbf{b}_a))}{\sum_{\tau=1}^{T} \exp(\mathbf{w}^T \tanh(\mathbf{W}_a v_\tau + \mathbf{b}_a))}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.689272em;vertical-align:-1.170941em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5183309999999999em;"><span style="top:-2.128769em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">Ï„</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">w</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.767331em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">tanh</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">Ï„</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">b</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">w</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">tanh</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">b</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.170941em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>æ­¤å¤„ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">W</mi><mi>a</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">b</mi><mi>a</mi></msub><mo separator="true">,</mo><mi mathvariant="bold">w</mi></mrow><annotation encoding="application/x-tex">\mathbf{W}_a, \mathbf{b}_a, \mathbf{w}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">b</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">w</span></span></span></span></span> å‡ä¸ºå‚ä¸Žåå‘ä¼ æ’­ä¼˜åŒ–çš„å‚æ•°ã€‚è¯¥æ•°å­¦ç»“æž„è¿«ä½¿æ¨¡åž‹åœ¨ç‰¹å¾ç©ºé—´ä¸­è‡ªåŠ¨è¿›è¡Œâ€œåŽ»å™ªâ€ï¼Œæ¢¯åº¦ä¸‹é™è¿‡ç¨‹ä¼šæŠ‘åˆ¶é‚£äº›ä¸Žèº«ä»½ä¸»å‘é‡æ­£äº¤çš„å™ªå£°åˆ†é‡çš„æƒé‡ã€‚</p><h4 id="é›†åˆé—´è·ç¦»åº¦é‡ä¸Žä¼˜åŒ–ç›®æ ‡"><a class="markdownIt-Anchor" href="#é›†åˆé—´è·ç¦»åº¦é‡ä¸Žä¼˜åŒ–ç›®æ ‡"></a> é›†åˆé—´è·ç¦»åº¦é‡ä¸Žä¼˜åŒ–ç›®æ ‡</h4><p>å®šä¹‰äº†åºåˆ—ç‰¹å¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Î¦</mi><mo stretchy="false">(</mo><mi mathvariant="script">S</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Phi(\mathcal{S})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Î¦</span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right:0.075em;">S</span></span><span class="mclose">)</span></span></span></span> åŽï¼Œæ ¸å¿ƒé—®é¢˜åœ¨äºŽå¦‚ä½•å®šä¹‰ä¸¤ä¸ªé›†åˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">S</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\mathcal{S}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.075em;">S</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">S</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\mathcal{S}_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.075em;">S</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> ä¹‹é—´çš„åº¦é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo stretchy="false">(</mo><msub><mi mathvariant="script">S</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="script">S</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">D(\mathcal{S}_i, \mathcal{S}_j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.075em;">S</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.075em;">S</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ã€‚</p><ul><li><strong>èšåˆåµŒå…¥è·ç¦»</strong>ï¼ˆAggregated Embedding Distanceï¼‰ï¼šæœ€ç›´æŽ¥çš„æ–¹æ³•æ˜¯åœ¨èšåˆåŽçš„ç‰¹å¾å‘é‡ä¸Šè®¡ç®—æ¬§æ°è·ç¦»ï¼š</li></ul><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>D</mi><mo stretchy="false">(</mo><msub><mi mathvariant="script">S</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="script">S</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">âˆ¥</mi><mi mathvariant="normal">Î¦</mi><mo stretchy="false">(</mo><msub><mi mathvariant="script">S</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>âˆ’</mo><mi mathvariant="normal">Î¦</mi><mo stretchy="false">(</mo><msub><mi mathvariant="script">S</mi><mi>j</mi></msub><mo stretchy="false">)</mo><msub><mi mathvariant="normal">âˆ¥</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">D(\mathcal{S}_i, \mathcal{S}_j) = \| \Phi(\mathcal{S}_i) - \Phi(\mathcal{S}_j) \|_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.075em;">S</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.075em;">S</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">âˆ¥</span><span class="mord">Î¦</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.075em;">S</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord">Î¦</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.075em;">S</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord">âˆ¥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>è¿™ç§æ–¹æ³•è®¡ç®—æ•ˆçŽ‡æœ€é«˜ï¼Œä¸”å®Œå…¨å…¼å®¹æ ‡å‡†çš„ Triplet Lossã€‚<br /></br></p><ul><li><strong>æœ€å°ç‚¹é›†è·ç¦»</strong>ï¼ˆMinimum Set Distanceï¼‰ï¼šä¸ºäº†è§£å†³èšåˆå¸¦æ¥çš„ä¿¡æ¯å¹³æ»‘é—®é¢˜ï¼Œå¯ä»¥ä¿ç•™å¸§çº§ç‰¹å¾ï¼Œå®šä¹‰ä¸¤ä¸ªé›†åˆçš„è·ç¦»ä¸ºâ€œæœ€ä½³åŒ¹é…å¸§â€ä¹‹é—´çš„è·ç¦»ï¼š</li></ul><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>D</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi mathvariant="script">S</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="script">S</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>=</mo><munder><mo><mi>min</mi><mo>â¡</mo></mo><mrow><msub><mi>v</mi><mi>n</mi></msub><mo>âˆˆ</mo><msub><mi mathvariant="script">S</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>v</mi><mi>m</mi></msub><mo>âˆˆ</mo><msub><mi mathvariant="script">S</mi><mi>j</mi></msub></mrow></munder><mi mathvariant="normal">âˆ¥</mi><msub><mi>v</mi><mi>n</mi></msub><mo>âˆ’</mo><msub><mi>v</mi><mi>m</mi></msub><msub><mi mathvariant="normal">âˆ¥</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">D_{min}(\mathcal{S}_i, \mathcal{S}_j) = \min_{v_n \in \mathcal{S}_i, v_m \in \mathcal{S}_j} \| v_n - v_m \|_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.075em;">S</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.075em;">S</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.691651em;vertical-align:-0.941651em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.66786em;"><span style="top:-2.355669em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mrel mtight">âˆˆ</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.075em;">S</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mrel mtight">âˆˆ</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.075em;">S</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.941651em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">âˆ¥</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">âˆ¥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>è¿™ç§éžå‚æ•°åŒ–çš„åº¦é‡æ–¹å¼åœ¨æ•°å­¦ä¸Šå…è®¸åºåˆ—åœ¨å±€éƒ¨è¿›è¡Œå¯¹é½ï¼Œå¯¹äºŽå¤„ç†è§†è§’å‰§çƒˆå˜åŒ–ï¼ˆå¦‚ä»Žæ­£é¢é€æ¸è½¬åˆ°èƒŒé¢ï¼‰çš„åºåˆ—å…·æœ‰æ›´å¼ºçš„å‡ ä½•è§£é‡Šæ€§ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;MTMCTæ–¹å‘çš„åº¦é‡å­¦ä¹ æ¢³ç†ã€‚&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>å®žéªŒå®¤å®‰å…¨æ£€æµ‹ç³»ç»Ÿ2</title>
    <link href="https://atffang.github.io/2025/11/13/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%AE%89%E5%85%A8%E6%A3%80%E6%B5%8B%E7%B3%BB%E7%BB%9F2/"/>
    <id>https://atffang.github.io/2025/11/13/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%AE%89%E5%85%A8%E6%A3%80%E6%B5%8B%E7%B3%BB%E7%BB%9F2/</id>
    <published>2025-11-13T12:41:07.000Z</published>
    <updated>2025-11-13T12:50:07.437Z</updated>
    
    <content type="html"><![CDATA[<p>èŠ±äº†ä¸€ä¸ªä¸‹åˆçš„æ—¶é—´ä¿®æ”¹äº†ä¸€ä¸‹é¡¹ç›®ç»“æž„ï¼Œç®€å•è®°å½•ä¸€ä¸‹</p><span id="more"></span><p>ä¸Šæ¬¡ä»‹ç»äº†ä¸€ä¸‹å‚ä¸Žçš„ä¸€ä¸ªæ¨ªå‘ä¸­çš„ä¸€ä¸ªæ¨¡å—ï¼Œæœ€è¿‘èŠ±äº†ä¸€ç‚¹æ—¶é—´æ¢³ç†äº†ä¸€ä¸‹ç»“æž„ï¼Œç®€å•è®°å½•ä¸€ä¸‹ã€‚åŠŸèƒ½å¹¶æ²¡æœ‰å¢žåŠ ï¼Œè¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ã€‚</p><h3 id="ç®€ä»‹"><a class="markdownIt-Anchor" href="#ç®€ä»‹"></a> ç®€ä»‹</h3><img src="https://atffang.github.io/2025/11/13/å®žéªŒå®¤å®‰å…¨æ£€æµ‹ç³»ç»Ÿ2/ç»“æž„.png"/><p>ç³»ç»Ÿç”±ä¸‰ä¸ªåŠŸèƒ½å±‚ç»„æˆï¼š</p><ul><li><strong>infra</strong>ï¼šåŸºç¡€åŠŸèƒ½å±‚ï¼ŒåŒ…æ‹¬configï¼ˆé…ç½®åŠ è½½ï¼‰ã€loggingï¼ˆæ—¥å¿—æ‰“å°ï¼‰ã€messagequeuesï¼ˆæ¶ˆæ¯é˜Ÿåˆ—ï¼‰</li><li><strong>data</strong>ï¼šè´Ÿè´£æ•°æ®éƒ¨åˆ†åŠŸèƒ½ï¼Œä¸»è¦åŒ…æ‹¬frameprocessorï¼ˆè§†é¢‘æµç›¸å…³ï¼‰ã€databaseï¼ˆminioä¸Žpostgresqlæ•°æ®åº“çš„å¢žåˆ æ”¹æŸ¥æŽ¥å£ï¼‰ã€‚è¿žæŽ¥çš„psqlæ•°æ®åº“å’Œminioç”±dockerå®žçŽ°ã€‚</li><li><strong>core</strong>ï¼šæ ¸å¿ƒä¸šåŠ¡å±‚ï¼ŒåŒ…æ‹¬prepocessï¼ˆè´Ÿè´£åŠ è½½è¯†åˆ«æ¨¡åž‹åŠ è½½å‰éœ€è¦é¢„åŠ è½½çš„æ•°æ®ï¼‰ã€modelloaderï¼ˆåŠ è½½è¯†åˆ«æ¨¡åž‹ï¼Œå®šä¹‰è¯†åˆ«æ–¹æ³•ï¼ˆpridictï¼‰ã€è¾“å‡ºè¯†åˆ«ç»“æžœã€postprocessï¼ˆåŽå¤„ç†ï¼Œä¸»è¦ä¸ºæ¯æ—¥æ•°æ®è¿ç§»ä»»åŠ¡ï¼‰ï¼‰</li></ul><h4 id="1-infra"><a class="markdownIt-Anchor" href="#1-infra"></a> 1. infra</h4><h5 id="11-config"><a class="markdownIt-Anchor" href="#11-config"></a> 1.1 config</h5><p>è¯»å–æ ¹ç›®å½•ä¸‹çš„<code>config.yaml</code>æ–‡ä»¶ï¼Œæä¾›åŠ è½½å„ç±»é…ç½®çš„æŽ¥å£ï¼Œ<code>config</code>æ–‡ä»¶å¦‚ä¸‹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -------- æ•°æ®åº“é…ç½® --------</span></span><br><span class="line"><span class="attr">db:</span></span><br><span class="line">  <span class="attr">host:</span> <span class="string">&quot;localhost&quot;</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">5434</span></span><br><span class="line">  <span class="attr">user:</span> <span class="string">&quot;postgres&quot;</span></span><br><span class="line">  <span class="attr">password:</span> <span class="string">&quot;postgres&quot;</span></span><br><span class="line">  <span class="attr">database:</span> <span class="string">&quot;labcamera&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -------- MinIOé…ç½® --------</span></span><br><span class="line"><span class="attr">minio:</span></span><br><span class="line">  <span class="attr">endpoint:</span> <span class="string">&quot;localhost:9000&quot;</span></span><br><span class="line">  <span class="attr">access_key:</span> <span class="string">&quot;minioadmin&quot;</span></span><br><span class="line">  <span class="attr">secret_key:</span> <span class="string">&quot;minioadmin&quot;</span></span><br><span class="line">  <span class="attr">bucket:</span> <span class="string">&quot;detection-results&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -------- äº‹ä»¶æ˜ å°„è¡¨ --------</span></span><br><span class="line"><span class="attr">event:</span></span><br><span class="line">  <span class="attr">event_dict:</span></span><br><span class="line">    <span class="attr">coat:</span> <span class="number">1</span></span><br><span class="line">    <span class="attr">nightsingle:</span> <span class="number">2</span></span><br><span class="line">    <span class="attr">channeloccupancy:</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -------- æ¨¡åž‹å‚æ•°é…ç½® --------</span></span><br><span class="line"><span class="attr">model:</span></span><br><span class="line">  <span class="attr">coatdetecter:</span> <span class="string">&quot;coatdetecter.json&quot;</span></span><br><span class="line">  <span class="attr">nightsingledetecter:</span> <span class="string">&quot;nightsingledetecter.json&quot;</span></span><br><span class="line">  <span class="attr">channeloccupancydetecter:</span> <span class="string">&quot;channeloccupancydetecter.json&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -------- ç›‘æŽ§æµé…ç½® --------</span></span><br><span class="line"><span class="attr">rtsp:</span></span><br><span class="line">  <span class="attr">server_ip:</span> <span class="string">&quot;***.***.***.***&quot;</span></span><br><span class="line">  <span class="attr">username:</span> <span class="string">&quot;***&quot;</span></span><br><span class="line">  <span class="attr">password:</span> <span class="string">&quot;***&quot;</span></span><br><span class="line">  <span class="attr">channel_num:</span> <span class="number">256</span></span><br><span class="line">  <span class="attr">stream_type:</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -------- å¯åŠ¨æ—¶é—´é…ç½® --------</span></span><br><span class="line"><span class="attr">scheduler:</span></span><br><span class="line">  <span class="attr">&quot;main_program&quot;:</span></span><br><span class="line">    <span class="attr">&quot;start&quot;:</span> <span class="string">&quot;05:00&quot;</span></span><br><span class="line">    <span class="attr">&quot;end&quot;:</span> <span class="string">&quot;03:00&quot;</span></span><br><span class="line">  <span class="attr">&quot;summary_program&quot;:</span></span><br><span class="line">    <span class="attr">&quot;start&quot;:</span> <span class="string">&quot;03:00&quot;</span></span><br><span class="line">    <span class="attr">&quot;end&quot;:</span> <span class="string">&quot;05:00&quot;</span></span><br></pre></td></tr></table></figure><h5 id="12-logging"><a class="markdownIt-Anchor" href="#12-logging"></a> 1.2 logging</h5><p>æ—¥å¿—æ¨¡å—</p><h5 id="13-messagequeues"><a class="markdownIt-Anchor" href="#13-messagequeues"></a> 1.3 messagequeues</h5><p>æ¶ˆæ¯é˜Ÿåˆ—æ¨¡å—ï¼Œé¦–å…ˆåœ¨<code>PhotoMessage.py</code>ä¸­å®šä¹‰äº†ä¸¤ä¸ªç±»ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">PhotoMessage</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    è¡¨ç¤ºè§†é¢‘æµå¤„ç†ç®¡çº¿ä¸­çš„å•å¸§æ¶ˆæ¯å¯¹è±¡ã€‚  </span></span><br><span class="line"><span class="string">    ç”¨äºŽå°è£…å•å¸§å›¾åƒåŠå…¶å…³è”çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    å±žæ€§è¯´æ˜Žï¼š</span></span><br><span class="line"><span class="string">        photo_id (str): å¸§çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆé»˜è®¤ä½¿ç”¨ UUID è‡ªåŠ¨ç”Ÿæˆï¼‰ã€‚</span></span><br><span class="line"><span class="string">        camera_id (str): æ‘„åƒå¤´è®¾å¤‡ç¼–å·æˆ–æ ‡è¯†ã€‚</span></span><br><span class="line"><span class="string">        room_id (str): æ‹æ‘„å¸§æ‰€åœ¨çš„ç‰©ç†ä½ç½®æˆ–æˆ¿é—´æ ‡è¯†ã€‚</span></span><br><span class="line"><span class="string">        photo_path (Path): å¸§å›¾åƒæ–‡ä»¶çš„è·¯å¾„æˆ–å†…å­˜å¼•ç”¨ã€‚</span></span><br><span class="line"><span class="string">        timestamp (datetime): å¸§æ•èŽ·çš„æ—¶é—´æˆ³ï¼ˆè‹¥æœªæä¾›åˆ™è‡ªåŠ¨ç”Ÿæˆï¼‰ã€‚</span></span><br><span class="line"><span class="string">        metadata (Dict[str, Any]): é™„åŠ çš„å¤„ç†ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    camera_id: <span class="built_in">str</span></span><br><span class="line">    room_id: <span class="built_in">str</span></span><br><span class="line">    photo_path: Path</span><br><span class="line">    task_id: <span class="built_in">int</span> = <span class="number">0</span></span><br><span class="line">    photo_id: <span class="built_in">str</span> = field(default_factory=<span class="keyword">lambda</span>: <span class="built_in">str</span>(uuid.uuid4()))</span><br><span class="line">    timestamp: datetime = field(default_factory=datetime.now)</span><br><span class="line">    metadata: <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="type">Any</span>] = field(default_factory=<span class="built_in">dict</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">DetectionResult</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    è¡¨ç¤ºå•å¸§å›¾åƒæ£€æµ‹ï¼ˆè¯†åˆ«ï¼‰ç»“æžœçš„æ•°æ®ç»“æž„ã€‚  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    å±žæ€§è¯´æ˜Žï¼š</span></span><br><span class="line"><span class="string">        ifwarning (bool): æ˜¯å¦è§¦å‘å‘Šè­¦ï¼ˆTrue è¡¨ç¤ºå¼‚å¸¸æˆ–è­¦å‘Šï¼‰ã€‚</span></span><br><span class="line"><span class="string">        image (Optional[Image.Image]): æ£€æµ‹åŽçš„å¤„ç†å›¾åƒæˆ–æ ‡æ³¨ç»“æžœã€‚</span></span><br><span class="line"><span class="string">        description (str): æ£€æµ‹ç»“æžœçš„æ–‡æœ¬æè¿°ä¿¡æ¯ã€‚</span></span><br><span class="line"><span class="string">        timestamp (Optional[datetime]): æ£€æµ‹ç»“æžœç”Ÿæˆçš„æ—¶é—´æˆ³ã€‚</span></span><br><span class="line"><span class="string">        task_id (int): å…³è”çš„ä»»åŠ¡æ ‡è¯†ç¬¦ã€‚</span></span><br><span class="line"><span class="string">        room_id (str): æ£€æµ‹å¸§æ‰€åœ¨çš„ç‰©ç†æˆ¿é—´æ ‡è¯†ã€‚</span></span><br><span class="line"><span class="string">        camera_id (str): å¯¹åº”çš„æ‘„åƒå¤´ç¼–å·ã€‚</span></span><br><span class="line"><span class="string">        alarm_category (str): å‘Šè­¦ç±»åž‹æˆ–ç±»åˆ«ï¼ˆé»˜è®¤å€¼ä¸º &#x27;unknow&#x27;ï¼‰ã€‚</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, ifwarning: <span class="built_in">bool</span> = <span class="literal">False</span>, image: <span class="type">Optional</span>[Image.Image] = <span class="literal">None</span>, </span></span><br><span class="line"><span class="params">                 description: <span class="built_in">str</span> = <span class="string">&quot;&quot;</span>, timestamp: <span class="type">Optional</span>[datetime] = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">                 task_id: <span class="built_in">int</span> = <span class="number">0</span>,</span></span><br><span class="line"><span class="params">                 room_id: <span class="built_in">str</span> = <span class="string">&quot;&quot;</span>, camera_id: <span class="built_in">str</span> = <span class="string">&quot;&quot;</span>, alarm_category: <span class="built_in">str</span> = <span class="string">&quot;unknow&quot;</span></span>):</span><br><span class="line">        ifwarning = ifwarning</span><br><span class="line">        self.image = image</span><br><span class="line">        self.description = description</span><br><span class="line">        self.timestamp = timestamp</span><br><span class="line">        self.room_id = room_id</span><br><span class="line">        self.camera_id = camera_id</span><br><span class="line">        self.alarm_category = alarm_category</span><br><span class="line">        self.task_id = task_id</span><br></pre></td></tr></table></figure><p>å¹¶åœ¨<code>MessageQueue.py</code>ä¸­å®šä¹‰äº†ä¸€ä¸ªå…¨å±€æ¶ˆæ¯é˜Ÿåˆ—<code>GlobalMessageQueue()</code>ï¼Œç”¨äºŽå­˜æ”¾<code>PhotoMessage</code>ï¼Œå¹¶ç¡®ä¿å…¶çº¿ç¨‹å®‰å…¨ã€‚å¹¶å®žçŽ°ï¼š</p><ul><li><code>put_message(self, msg: PhotoMessage) -&gt; bool</code></li><li><code>get_message(self) -&gt; Optional[PhotoMessage]</code></li><li><code>persist_messages(self, file_path: Path) -&gt; int</code></li><li><code>load_messages(self, file_path: Path) -&gt; int</code></li><li>â€¦â€¦</li></ul><p>ç­‰æ–¹æ³•ã€‚</p><h4 id="2data"><a class="markdownIt-Anchor" href="#2data"></a> 2.Data</h4><h5 id="21-frameprocessor"><a class="markdownIt-Anchor" href="#21-frameprocessor"></a> 2.1 frameprocessor</h5><p>è´Ÿè´£è§†é¢‘æµå¤„ç†ã€‚é¦–å…ˆåœ¨<code>rtsp_client.py</code>ä¸­å®šä¹‰äº†å®žçŽ°ï¼š</p><ul><li>ç™»å½•è§†é¢‘æœåŠ¡å™¨èŽ·å– Token</li><li>å®šæ—¶ä¿æ´»</li><li>æ³¨å†Œæ’­æ”¾é€šé“</li><li>èŽ·å–æŒ‡å®šæ‘„åƒå¤´çš„ RTSP URL</li><li>ç™»å‡ºé‡Šæ”¾ Token</li></ul><p>åŠŸèƒ½çš„RTSPClient ç±»ï¼Œå¹¶å®šä¹‰äº†å…¶çº¿ç¨‹å®žçŽ°<code>RTSPServiceThread(threading.Thread)</code>ï¼Œè¯¥çº¿ç¨‹å¯åŠ¨åŽè¿è¡Œé€»è¾‘ä¸ºï¼š</p><ul><li>ç™»å½•å¹¶æ³¨å†Œæ’­æ”¾é€šé“</li><li>å¾ªçŽ¯æ‰§è¡Œ keep_alive ä¿æ´»</li><li>å¼‚å¸¸å¤„ç†åŽè‡ªåŠ¨ç™»å‡º</li></ul><p>éšåŽåœ¨<code>get_rtsp.py</code>å®šä¹‰äº†<code>CaptureThread(threading.Thread)</code>çš„æ‘„åƒå¤´æŠ“å¸§çº¿ç¨‹ï¼Œç®¡ç† RTSP æµä¿æ´»å’Œå¸§æ•èŽ·ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">CaptureThread</span>(threading.Thread):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    æ‘„åƒå¤´æŠ“å¸§çº¿ç¨‹ï¼Œç®¡ç† RTSP æµä¿æ´»å’Œå¸§æ•èŽ·ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Attributes:</span></span><br><span class="line"><span class="string">        rtsp_config (dict): RTSP é…ç½®</span></span><br><span class="line"><span class="string">        rtsp_thread (RTSPServiceThread): RTSP æœåŠ¡çº¿ç¨‹</span></span><br><span class="line"><span class="string">        db_conn: æ•°æ®åº“è¿žæŽ¥å¯¹è±¡</span></span><br><span class="line"><span class="string">        running (bool): çº¿ç¨‹è¿è¡ŒçŠ¶æ€</span></span><br><span class="line"><span class="string">        camera_list (List[Dict[str, Any]]): å½“å‰ä»»åŠ¡æ‘„åƒå¤´åˆ—è¡¨</span></span><br><span class="line"><span class="string">        wait_rtsp (int): ä¸¤æ¬¡æ‘„åƒå¤´æŠ“å¸§é—´éš”ï¼ˆç§’ï¼‰</span></span><br><span class="line"><span class="string">        round_rtsp (int): æ¯è½®æŠ“å¸§æœ€å°æ€»é—´éš”ï¼ˆç§’ï¼‰</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__(daemon=<span class="literal">True</span>)</span><br><span class="line">        self.rtsp_config = RTSP_CONFIG</span><br><span class="line">        self.rtsp_thread = RTSPServiceThread(RTSP_CONFIG)</span><br><span class="line">        self.db_conn = <span class="literal">None</span></span><br><span class="line">        self.running = <span class="literal">True</span></span><br><span class="line">        self.camera_list: <span class="type">List</span>[<span class="type">Dict</span>[<span class="built_in">str</span>, <span class="type">Any</span>]] = []</span><br><span class="line">        self.wait_rtsp = <span class="number">1</span></span><br><span class="line">        self.round_rtsp = <span class="number">600</span></span><br></pre></td></tr></table></figure><p>çº¿ç¨‹ä¸»é€»è¾‘ï¼š</p><ul><li>å¯åŠ¨ RTSP æœåŠ¡çº¿ç¨‹ï¼ˆè‡ªåŠ¨ä¿æ´»ï¼‰</li><li>è¿žæŽ¥æ•°æ®åº“èŽ·å–æ‘„åƒå¤´åˆ—è¡¨</li><li>å¾ªçŽ¯æŠ“å–æ‘„åƒå¤´å•å¸§å›¾åƒå¹¶å‘é€åˆ°æ¶ˆæ¯é˜Ÿåˆ—</li></ul><h5 id="22-database"><a class="markdownIt-Anchor" href="#22-database"></a> 2.2 database</h5><p>databaseæ¨¡å—åŸºäºŽåˆ†å±‚å¼æž¶æž„æ¨¡å¼ï¼ˆentityã€repositoryã€serviceä¸‰å±‚ï¼‰</p><ul><li>entityï¼šå®žä½“å±‚ï¼Œå®šä¹‰äº†æ•°æ®åº“ä¸­å„ä¸ªè¡¨å¯¹åº”çš„å®žä½“ç±»ï¼Œå¦‚<code>Camera</code>ã€<code>Results</code>ã€<code>ResultsTemp</code>ã€‚</li><li>repositoryï¼šæ•°æ®è®¿é—®å±‚ï¼Œè´Ÿè´£ä¸Žæ•°æ®åº“è¿›è¡Œäº¤äº’ï¼Œæä¾›æ•°æ®æŒä¹…åŒ–å’Œæ£€ç´¢åŠŸèƒ½ï¼Œå¦‚<code>CameraRepository</code>ã€<code>ResultsRepository</code>ã€<code>ResultsTempRepository</code>ã€‚</li><li>serviceï¼šä¸šåŠ¡é€»è¾‘å±‚ï¼Œè´Ÿè´£å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œå¦‚<code>CameraService</code>ã€<code>ResultsMigrationService</code>ã€<code>ResultsNightService</code>ã€<code>ResultsTempSaverService</code>ï¼Œè¿™éƒ¨åˆ†è´Ÿè´£æä¾›æ•°æ®åº“éƒ¨åˆ†çš„å„ä¸ªæŽ¥å£ï¼Œç»™å…¶ä»–ç»„ä»¶è°ƒç”¨ï¼Œå®žçŽ°è§£è€¦ã€‚</li></ul><p>æˆ‘ä»¬ä»¥æ•°æ®æš‚å­˜ä¸ºä¾‹ï¼Œå…¶éœ€æ±‚æ˜¯æ¯æ¬¡æ£€æµ‹å®ŒæˆåŽï¼Œæš‚å­˜æ•°æ®åˆ°t_results_tempè¡¨ä¸­ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå®šä¹‰ä¸€ä¸ª<strong>ResultsTemp</strong>çš„Entityï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ResultsEntity</span>(<span class="title class_ inherited__">Base</span>):</span><br><span class="line">    __tablename__ = <span class="string">&quot;t_results&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">id</span> = Column(Integer, primary_key=<span class="literal">True</span>, autoincrement=<span class="literal">True</span>)</span><br><span class="line">    task_id = Column(String(<span class="number">100</span>))</span><br><span class="line">    event_id = Column(Integer)</span><br><span class="line">    description = Column(Text)</span><br><span class="line">    time1 = Column(TIMESTAMP)</span><br><span class="line">    time2 = Column(TIMESTAMP)</span><br><span class="line">    picture1 = Column(String(<span class="number">255</span>))</span><br><span class="line">    picture2 = Column(String(<span class="number">255</span>))</span><br><span class="line">    picture3 = Column(String(<span class="number">255</span>))</span><br></pre></td></tr></table></figure><p>éšåŽï¼Œå®šä¹‰ä¸€å±‚æ•°æ®è®¿é—®å±‚<strong>ResultsTempRepository</strong>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> entity.ResultsTemp <span class="keyword">import</span> ResultsTempEntity</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ResultsTempRepository</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, session: Session</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">insert</span>(<span class="params">self, entity: ResultsTempEntity</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">find_all</span>(<span class="params">self</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">find_by_task</span>(<span class="params">self, task_id: <span class="built_in">str</span></span>):</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">query_by_event_and_date</span>(<span class="params">self, event_ids, date_str</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">delete_batch</span>(<span class="params">self, records</span>):</span><br></pre></td></tr></table></figure><p>æœ€åŽï¼Œå®šä¹‰ä¸€ä¸ªServiceï¼š<strong>ResultsTempSaverService</strong> æ¥æä¾›æœåŠ¡æŽ¥å£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">DataSaverService</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Service å±‚ï¼šå¤„ç†æ£€æµ‹ç»“æžœä¿å­˜ï¼ˆæ•°æ®åº“ + MinIO ä¸Šä¼ ï¼‰&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">save_detection_result</span>(<span class="params">self, result: DetectionResult</span>):</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆï¼Œåœ¨å…¶ä»–ç»„ä»¶ä¸­è°ƒç”¨<code>save_detection_result</code>å³å¯ã€‚</p><h4 id="3-core"><a class="markdownIt-Anchor" href="#3-core"></a> 3. Core</h4><h5 id="31-preprocess"><a class="markdownIt-Anchor" href="#31-preprocess"></a> 3.1 preprocess</h5><p>é‡Œé¢æ”¾ä¸€äº›é¢„å¤„ç†å‡½æ•°ï¼Œæ¯”å¦‚ä»Žæ•°æ®åº“ä¸‹è½½é€šé“èŒƒå›´ã€‚ç„¶åŽæˆ‘ä»¬åœ¨<code>detect.py</code>ä¸­åœ¨å¯åŠ¨è¯†åˆ«çº¿ç¨‹å‰è°ƒç”¨å³å¯ã€‚æ¯”å¦‚è¯´æˆ‘åœ¨<code>detect.py</code>é‡Œé¢è°ƒç”¨çš„ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> core.preprocess <span class="keyword">import</span> LoadChannelRange</span><br><span class="line"><span class="comment"># é¦–å…ˆä¸‹è½½æ‘„åƒå¤´èŒƒå›´æ•°æ®</span></span><br><span class="line">LoadChannelRange.save()</span><br></pre></td></tr></table></figure><h5 id="32-modelloader"><a class="markdownIt-Anchor" href="#32-modelloader"></a> 3.2 modelloader</h5><p><strong>é‡ç‚¹</strong></p><p>modelleréƒ¨åˆ†è´Ÿè´£åŠ è½½æ¨¡åž‹ï¼Œå¹¶å®žçŽ°è¯†åˆ«åŠŸèƒ½ã€‚<br />å¯¹äºŽä¸€ä¸ªè¯†åˆ«åŠŸèƒ½æ¨¡å—ï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨modelloader/configä¸­æ·»åŠ ä¸€ä¸ªé…ç½®jsonæ–‡ä»¶ï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;coatdetecter&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;pipeline&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;yolo11s&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pt&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;weight_path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;core/modelloader/model/yolo11s.pt&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mobilenet_v2&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pth&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;weight_path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;core/modelloader/model/coat_classifier_final.pth&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>å¹¶å°†å…¶æ·»åŠ åˆ°æ ¹ç›®å½•ä¸‹çš„<code>config.yaml</code>æ–‡ä»¶ä¸­çš„ æ¨¡åž‹å‚æ•°é…ç½® éƒ¨åˆ†ã€‚<br />å¹¶ä¸”æŒ‰ç…§&quot;weight_path&quot;çš„è·¯å¾„æ­£ç¡®å°†æƒé‡æ¨¡åž‹å­˜æ”¾åœ¨ç›¸åº”çš„è·¯å¾„ã€‚</p><p>éšåŽï¼Œæˆ‘ä»¬åœ¨åœ¨modelloader/functionmodelå®šä¹‰ä¸€ä¸ªæ¨¡åž‹è¯†åˆ«ç±»ï¼Œæˆ‘åœ¨è¿™ä¸ªè·¯å¾„ä¸‹çš„<code>base_detector.py</code>æä¾›äº†ä¸€ä¸ªæŠ½è±¡ç±»:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">BaseDetector</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Detector ç¤ºä¾‹æ¨¡æ¿</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    å­ç±»å¿…é¡»å®žçŽ° load æ–¹æ³•ï¼Œè¿”å›ž predict å‡½æ•°ï¼š</span></span><br><span class="line"><span class="string">        predict(message: PhotoMessage, image_input: np.ndarray) -&gt; Optional[DetectionResult]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    predict å‡½æ•°å¿…é¡»ï¼š</span></span><br><span class="line"><span class="string">    1. æŽ¥å— PhotoMessage å’Œ np.ndarrayï¼ˆBGR å›¾åƒï¼‰</span></span><br><span class="line"><span class="string">    2. è¿”å›ž DetectionResult æˆ– None</span></span><br><span class="line"><span class="string">    3. å¯¹å›¾åƒæ“ä½œåº”ä½¿ç”¨ copy()ï¼Œé¿å…å¹¶è¡Œå†²çª</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">load</span>(<span class="params">model_pipeline: <span class="built_in">list</span>, device</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        åˆå§‹åŒ–æ¨¡åž‹ï¼Œè¿”å›ž predict å‡½æ•°ã€‚</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># <span class="doctag">TODO:</span> åœ¨è¿™é‡Œå®žçŽ°ä½ çš„æ¨¡åž‹åˆå§‹åŒ–é€»è¾‘</span></span><br><span class="line">        <span class="comment"># åˆå§‹åŒ–é€»è¾‘ç¤ºä¾‹ï¼š</span></span><br><span class="line">        <span class="comment"># parent_dir = Path(__file__).resolve().parents[3]</span></span><br><span class="line">        <span class="comment"># yolo_path = parent_dir / model_pipeline[0][&quot;weight_path&quot;]</span></span><br><span class="line">        <span class="comment"># yolo_model = YOLO(yolo_path).to(device)</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">predict</span>(<span class="params">message: PhotoMessage, image_input: np.ndarray</span>) -&gt; <span class="type">Optional</span>[DetectionResult]:</span><br><span class="line">            <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            å¯¹è¾“å…¥å›¾åƒæ‰§è¡Œæ£€æµ‹ï¼Œè¿”å›ž DetectionResult æˆ– Noneã€‚</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span></span><br><span class="line">            <span class="comment"># <span class="doctag">TODO:</span> åœ¨è¿™é‡Œå®žçŽ°ä½ çš„æ£€æµ‹é€»è¾‘</span></span><br><span class="line">            image = image_input.copy()</span><br><span class="line">            <span class="comment"># æ£€æµ‹é€»è¾‘ç¤ºä¾‹ï¼š</span></span><br><span class="line">            <span class="comment"># for box in detected_boxes:</span></span><br><span class="line">            <span class="comment">#     crop = image[...]</span></span><br><span class="line">            <span class="comment">#     pred = classify(crop)</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># å¦‚æžœæœ‰å¼‚å¸¸æƒ…å†µ,åˆ™æž„é€ å¹¶è¿”å›žDetectionResultï¼š</span></span><br><span class="line">            <span class="comment"># return DetectionResult(...)</span></span><br><span class="line">            <span class="comment"># å¦‚æžœæ²¡æœ‰å¼‚å¸¸æƒ…å†µï¼Œè¿”å›žNone</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> predict</span><br></pre></td></tr></table></figure><p>åŸºäºŽè¿™ä¸ªæŠ½è±¡ç±»çš„è¦æ±‚ï¼Œå®žçŽ°ä¸€ä¸ªå…·ä½“çš„è¯†åˆ«ç±»ï¼Œæ¯”å¦‚æˆ‘åœ¨<code>coat_detector.py</code>ä¸­å®žçŽ°äº†ä¸€ä¸ª<code>CoatDetector(BaseDetector)</code>ç±»ã€‚</p><p>åŒæ—¶ï¼Œåœ¨<code>modelloader.py</code>ä¸­ï¼Œæä¾›äº†ä¸€ä¸ªå·¥åŽ‚ç±»<code>ModelLoader</code>ï¼Œç”¨äºŽåŠ è½½æ¨¡åž‹ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ModelLoader</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    æ¨¡åž‹åŠ è½½å·¥åŽ‚ç±»ï¼Œç»Ÿä¸€æ ¹æ®æ¨¡åž‹åç§°è¿”å›žé¢„æµ‹å‡½æ•°ã€‚</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    MODEL_MAP: <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="type">Callable</span>[[<span class="type">Any</span>, torch.device], <span class="type">Any</span>]] = &#123;</span><br><span class="line">        <span class="string">&quot;coatdetecter&quot;</span>: CoatDetector.load,</span><br><span class="line">        <span class="string">&quot;nightsingledetecter&quot;</span>: NightSingleDetector.load,</span><br><span class="line">        <span class="string">&quot;channeloccupancydetecter&quot;</span>: ChannelOccupancyDetector.load</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">loader</span>(<span class="params">model_name: <span class="built_in">str</span>, model_pipeline: <span class="type">Any</span>, device: torch.device</span>) -&gt; <span class="type">Callable</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        æ ¹æ®æ¨¡åž‹åç§°åŠ è½½å¯¹åº”çš„æ£€æµ‹æ¨¡åž‹ï¼Œå¹¶è¿”å›žé¢„æµ‹å‡½æ•°ã€‚</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            model_name (str): æ¨¡åž‹åç§°ï¼Œå¦‚ &quot;coatdetecter&quot;ã€‚</span></span><br><span class="line"><span class="string">            model_pipeline (Any): æ¨¡åž‹æƒé‡è·¯å¾„æˆ–é…ç½®åˆ—è¡¨ã€‚</span></span><br><span class="line"><span class="string">            device (torch.device): æ¨¡åž‹è¿è¡Œè®¾å¤‡ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            Callable: ç”¨äºŽæ‰§è¡Œé¢„æµ‹çš„å‡½æ•°ï¼Œè¾“å…¥ä¸º image/messageï¼Œè¾“å‡º DetectionResultã€‚</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Raises:</span></span><br><span class="line"><span class="string">            ValueError: å¦‚æžœæ¨¡åž‹åç§°ä¸åœ¨æ”¯æŒåˆ—è¡¨ä¸­ã€‚</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            load_func = ModelLoader.MODEL_MAP[model_name]</span><br><span class="line">        <span class="keyword">except</span> KeyError:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;Model &#x27;<span class="subst">&#123;model_name&#125;</span>&#x27; is not supported.&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> load_func(model_pipeline, device)</span><br></pre></td></tr></table></figure><p>ä¸ºäº†åŠ è½½åˆšåˆšçš„æ¨¡åž‹ï¼Œæˆ‘ä»¬æŠŠæ¨¡åž‹åå­—å’Œæ¨¡åž‹ç±».loadå‡½æ•°åŠ è½½åœ¨<code>MODEL_MAP</code>ä¸­</p><p>å†åŒæ—¶ï¼Œåœ¨<code>modelloader.py</code>ä¸­ï¼Œè¿˜æä¾›äº†ä¸€ä¸ª<code>IdentificationModel</code>ç±»ï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">IdentificationModel</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, config: <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="type">Any</span>]</span>):</span><br><span class="line">        self.device = torch.device(<span class="string">&quot;cuda&quot;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&quot;cpu&quot;</span>)</span><br><span class="line">        self.name = config[<span class="string">&quot;name&quot;</span>]</span><br><span class="line">        self.pipeline = config[<span class="string">&quot;pipeline&quot;</span>]</span><br><span class="line">        self.predict = self._loadmodel()</span><br></pre></td></tr></table></figure><p>è¿™ä¸ª<code>IdentificationModel</code>ç±»ï¼Œè°ƒç”¨äº†å·¥åŽ‚ç±»<code>ModelLoader</code>çš„<code>loader</code>æ–¹æ³•ï¼Œå°†æ¨¡åž‹åŠ è½½åˆ°<code>predict</code>ä¸­ï¼Œç„¶åŽæˆ‘ä»¬å°±å¯ä»¥ç›´æŽ¥è°ƒç”¨å®žä¾‹åŒ–åŽçš„<code>IdentificationModel</code>ç±»çš„<code>predict</code>æ–¹æ³•è¿›è¡Œè¯†åˆ«äº†ã€‚è¿™é‡Œå…¶å®žé€»è¾‘æ¯”è¾ƒæ··ä¹±ï¼Œè¯»è€…å®Œå…¨å¯ä»¥å°†è¿™ä¸¤ä¸ªç±»åˆå¹¶ã€‚</p><p>äº†è§£å®Œè¿™äº›åŽï¼Œæˆ‘ä»¬æœ€ç»ˆå®šä¹‰ä¸€ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹ç±»ï¼Œè¯¥ç±»é¦–å…ˆåŸºäºŽconfigæ–‡ä»¶ï¼Œåˆå§‹åŒ–ä¸€ä¸ª<code>IdentificationModel</code>å®žä¾‹åˆ—è¡¨ï¼Œç„¶åŽå¯¹äºŽ<code>messagequeue</code>ä¸­çš„æ¯ä¸ª<code>PhotoMessage</code>ï¼ŒéåŽ†è°ƒç”¨æ¯ä¸ª<code>IdentificationModel</code>å®žä¾‹çš„<code>pridict()</code>æ–¹æ³•è¿›è¡Œè¯†åˆ«ï¼Œå¹¶è°ƒç”¨<code>data.service</code>æš´éœ²çš„å­˜å‚¨æŽ¥å£è¿›è¡Œå­˜å‚¨ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">PhotoConsumer</span>(threading.Thread):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, config_list: <span class="type">List</span>[<span class="built_in">dict</span>], poll_interval: <span class="built_in">float</span> = <span class="number">1</span>, max_workers: <span class="built_in">int</span> = <span class="number">4</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        å¤šçº¿ç¨‹æ¶ˆè´¹è€…ï¼šä»Ž global_mq èŽ·å–æ¶ˆæ¯ï¼Œè¯»å–å›¾ç‰‡ï¼Œæ‰§è¡Œæ¨¡åž‹æŽ¨ç†ï¼Œå¹¶åˆ é™¤å›¾ç‰‡ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        :param config_list: ä¸€ç»„ config å­—å…¸ï¼ˆæ¯ä¸ªé…ç½®ä¸€ä¸ªæ¨¡åž‹ï¼‰</span></span><br><span class="line"><span class="string">        :param poll_interval: è½®è¯¢é—´éš”ç§’æ•°</span></span><br><span class="line"><span class="string">        :param max_workers: å¹¶å‘å¤„ç†çš„æœ€å¤§çº¿ç¨‹æ•°</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(daemon=<span class="literal">True</span>)</span><br><span class="line">        self.poll_interval = poll_interval</span><br><span class="line">        self.running = <span class="literal">True</span></span><br><span class="line">        self.db = DataSaver()</span><br><span class="line">        self.executor = ThreadPoolExecutor(max_workers=max_workers)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># åˆå§‹åŒ–æ¨¡åž‹åˆ—è¡¨</span></span><br><span class="line">        self.modellist = [IdentificationModel(config) <span class="keyword">for</span> config <span class="keyword">in</span> config_list]</span><br><span class="line">        <span class="keyword">for</span> model <span class="keyword">in</span> self.modellist:</span><br><span class="line">            logger.info(model)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">stop</span>(<span class="params">self</span>):</span><br><span class="line">      <span class="string">&quot;&quot;&quot;åœæ­¢çº¿ç¨‹å¹¶å…³é—­çº¿ç¨‹æ± &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;ä¸»çº¿ç¨‹å¾ªçŽ¯èŽ·å–æ¶ˆæ¯å¹¶äº¤ç”±çº¿ç¨‹æ± å¤„ç†&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">process_message</span>(<span class="params">self, message: PhotoMessage</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;å¤„ç†å•æ¡æ¶ˆæ¯çš„è¯†åˆ«ä¸Žå­˜å‚¨&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p>æœ€åŽå®šä¹‰ä¸€ä¸ª<code>start_photo_consumer_concurrent()</code>å‡½æ•°ç”¨äºŽå¯åŠ¨æ¨¡åž‹æ¶ˆè´¹è€…ï¼Œæœ‰detect.pyè°ƒç”¨ï¼Œå…¶ä¸­ï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">consumer = PhotoConsumer(config_list, max_workers=<span class="number">3</span>)</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œ<code>max_workers</code>ä¸ºå¯ç”¨çš„æ¶ˆè´¹è€…çº¿ç¨‹æ•°</p><h5 id="33-postprocess"><a class="markdownIt-Anchor" href="#33-postprocess"></a> 3.3 postprocess</h5><p>é‡Œé¢æ”¾ä¸€å¤©çš„è¯†åˆ«ç»“æŸåŽçš„æ“ä½œï¼Œæ¯”å¦‚è¯´å°†è¯†åˆ«ç»“æžœæ•°æ®æ¢³ç†åŽä»Žt_results_tempè¡¨è¿ç§»åˆ°t_resultsè¡¨ï¼Œå¹¶åˆ é™¤t_results_tempè¡¨ä¸­çš„æ•°æ®ã€‚preprocesså’Œpostprocessé‡Œé¢çš„æ“ä½œå¤§å¤šæ•°è¢«å°è£…ä¸ºäº†data.database.serviceé‡Œé¢çš„æœåŠ¡æŽ¥å£ï¼Œåªè¦è°ƒç”¨å°±è¡Œäº†ã€‚å€¼å¾—å…³æ³¨çš„æ˜¯ï¼Œpreprocessåœ¨<code>detect.py</code>ä¸­è¢«è°ƒç”¨ï¼Œè€Œpostprocessåœ¨<code>main.py</code>ä¸­è¢«è°ƒç”¨ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> core.postprocess.migration_runner <span class="keyword">import</span> DailyMigrationTask</span><br><span class="line"></span><br><span class="line"><span class="comment"># å½’çº³ç¨‹åºæŽ§åˆ¶</span></span><br><span class="line">summary_start = str_to_time(config[<span class="string">&quot;summary_program&quot;</span>][<span class="string">&quot;start&quot;</span>])</span><br><span class="line">summary_end = str_to_time(config[<span class="string">&quot;summary_program&quot;</span>][<span class="string">&quot;end&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> in_time_range(summary_start, summary_end, now):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> started_summary:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[INFO] å¯åŠ¨å½’çº³ç¨‹åº&quot;</span>)</span><br><span class="line">        task = DailyMigrationTask()</span><br><span class="line">        task.run()</span><br><span class="line">        started_summary = <span class="literal">True</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">if</span> started_summary <span class="keyword">and</span> summary_proc:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[INFO] å…³é—­å½’çº³ç¨‹åº&quot;</span>)</span><br><span class="line">        started_summary = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">time.sleep(<span class="number">60</span>)</span><br></pre></td></tr></table></figure><h3 id="æž¶æž„"><a class="markdownIt-Anchor" href="#æž¶æž„"></a> æž¶æž„</h3><img src="https://atffang.github.io/2025/11/13/å®žéªŒå®¤å®‰å…¨æ£€æµ‹ç³»ç»Ÿ2/æž¶æž„.png"/>çŽ°åœ¨æ²¡æœ‰è®¾è®¡å¤šGPUï¼Œä¹Ÿæš‚æ—¶æ²¡æœ‰å¿…è¦ã€‚]]></content>
    
    
    <summary type="html">&lt;p&gt;èŠ±äº†ä¸€ä¸ªä¸‹åˆçš„æ—¶é—´ä¿®æ”¹äº†ä¸€ä¸‹é¡¹ç›®ç»“æž„ï¼Œç®€å•è®°å½•ä¸€ä¸‹&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>DeepSort (SIMPLE ONLINE AND REALTIME TRACKING WITH A DEEP ASSOCIATION METRIC)</title>
    <link href="https://atffang.github.io/2025/11/12/deepsort/"/>
    <id>https://atffang.github.io/2025/11/12/deepsort/</id>
    <published>2025-11-12T05:23:19.000Z</published>
    <updated>2025-12-29T08:58:03.490Z</updated>
    
    <content type="html"><![CDATA[<p>æ¢³ç†æ‘„åƒå¤´è¡Œäººè¿½è¸ªç»å…¸è®ºæ–‡SIMPLE ONLINE AND REALTIME TRACKING WITH A DEEP ASSOCIATION METRICä¸­çš„æ–¹æ³•ã€‚</p><span id="more"></span><h1 id="simple-online-and-realtime-tracking-with-a-deep-association-metric"><a class="markdownIt-Anchor" href="#simple-online-and-realtime-tracking-with-a-deep-association-metric"></a> Simple online and realtime tracking with a deep association metric</h1><p><strong>ä½œè€…</strong>ï¼šNicolai Wojke, Alex Bewley, Dietrich Paulus</p><hr /><h3 id="abstract"><a class="markdownIt-Anchor" href="#abstract"></a> Abstract</h3><p>Simple Online and Realtime Tracking (SORT) is a pragmatic approach to multiple object tracking with a focus on simple, effective algorithms. In this paper, we integrate appearance information to improve the performance of SORT. Due to this extension we are able to track objects through longer periods of occlusions, effectively reducing the number of identity switches. In spirit of the original framework we place much of the computational complexity into an offline pre-training stage where we learn a deep association metric on a largescale person re-identification dataset. During online application, we establish measurement-to-track associations using nearest neighbor queries in visual appearance space. Experimental evaluation shows that our extensions reduce the number of identity switches by 45%, achieving overall competitive performance at high frame rates.</p><h3 id="1-è®­ç»ƒé˜¶æ®µ"><a class="markdownIt-Anchor" href="#1-è®­ç»ƒé˜¶æ®µ"></a> 1. è®­ç»ƒé˜¶æ®µ</h3><h4 id="11-æ•°æ®æ¥æº"><a class="markdownIt-Anchor" href="#11-æ•°æ®æ¥æº"></a> 1.1 æ•°æ®æ¥æº</h4><ul><li>ä½¿ç”¨ MARS æ•°æ®é›†ï¼š1.1 M å›¾åƒï¼Œ1261 åè¡Œäººï¼Œè·¨ç›¸æœºè·¨æ—¶æ®µã€‚</li><li>è®­ç»ƒé›†/éªŒè¯é›†æ‹†åˆ†ï¼šæŒ‰èº«ä»½åˆ’æˆ 631/630 ä¸¤ç»„ç”¨äºŽè®­ç»ƒå’ŒéªŒè¯ï¼Œä¿è¯ ID ä¸é‡å ã€‚</li><li>å¢žå¹¿ï¼šæ°´å¹³ç¿»è½¬ã€éšæœºæ“¦é™¤ã€é¢œè‰²æ‰°åŠ¨ã€256Ã—128 LetterBoxã€‚</li></ul><h4 id="12-ç½‘ç»œç»“æž„"><a class="markdownIt-Anchor" href="#12-ç½‘ç»œç»“æž„"></a> 1.2 ç½‘ç»œç»“æž„</h4><img src="/2025/11/12/deepsort/deepsort1.jpg" class="" title="sucessful"><p>è¾“å…¥ (3,256,128) çš„å›¾åƒ</p><ul><li><strong>Conv1 3Ã—3/1 32 é€šé“</strong></li><li><strong>Conv2 3Ã—3/1 32 é€šé“</strong></li><li><strong>MaxPool 3Ã—3/2</strong></li><li><strong>6 ä¸ªæ®‹å·®å—ï¼ˆé€šé“ 32â†’64â†’128ï¼Œä¸‹é‡‡æ · 2 æ¬¡ï¼‰</strong></li><li><strong>GAPï¼ˆå…¨å±€å¹³å‡æ± åŒ–ï¼‰ (128,8,4) â†’ 128 ç»´å‘é‡</strong></li><li><strong>Dense10 128-D</strong></li><li><strong>BatchNorm1d + L2 å½’ä¸€åŒ– â†’ å•ä½çƒé¢è¾“å‡º</strong></li></ul><h4 id="13-æŸå¤±ä¸Žè®­ç»ƒåè®®"><a class="markdownIt-Anchor" href="#13-æŸå¤±ä¸Žè®­ç»ƒåè®®"></a> 1.3 æŸå¤±ä¸Žè®­ç»ƒåè®®</h4><p><strong>batch-hard ä¸‰å…ƒç»„æŸå¤±</strong>çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼Œåœ¨ä¸€ä¸ª mini-batch é‡Œï¼Œåªç•™æœ€éš¾çš„æ ·æœ¬åŽ»æŽ¨/æ‹‰ç½‘ç»œï¼Œå¿½ç•¥å…¶ä½™è½»æ¾æ ·æœ¬ï¼Œé¿å…æ¢¯åº¦è¢«å¤§é‡ç®€å•å¯¹æ·¹æ²¡ã€‚batch-hardçš„ batch æž„é€ è¿‡ç¨‹å¦‚ä¸‹</p><ul><li>å…ˆéšæœºæŠ½ P=18 ä¸ªè¡Œäººèº«ä»½ï¼ˆå¯ä»¥ç†è§£ä¸º 18 ä¸ªäººï¼‰</li><li>å¯¹æ¯ä¸ªäººï¼Œå†ä»Žä¸åŒç›¸æœºã€ä¸åŒå¸§é‡Œå„æŠ“ 4 å¼ å›¾ï¼Œå…± 18Ã—4=72 å¼ å›¾</li></ul><p>å¯¹ä»»æ„ä¸€å¼ <strong>é”šå›¾</strong>ï¼š</p><ul><li>æ‰¾å‡ºåŒèº«ä»½é‡Œå¤–è§‚æœ€ä¸åƒé”šçš„é‚£å¼ å›¾ï¼ˆåŒèº«ä»½ä¸­ä½™å¼¦è·ç¦»æœ€å¤§ï¼‰ï¼Œä½œä¸º<strong>æœ€éš¾æ­£æ ·æœ¬</strong></li><li>æ‰¾å‡ºå¼‚èº«ä»½é‡Œå¤–è§‚æœ€åƒé”šçš„é‚£å¼ å›¾ï¼ˆåŒèº«ä»½ä¸­ä½™å¼¦è·ç¦»æœ€å°ï¼‰ï¼Œä½œä¸º<strong>æœ€éš¾è´Ÿæ ·æœ¬</strong></li></ul><p>åªä¿ç•™è¿™ä¸€å¯¹éš¾æ ·æœ¬è®¡ç®—æŸå¤±ï¼Œå…¶ä½™å…¨éƒ¨å¿½ç•¥ã€‚æŸå¤±å‡½æ•°å¼•ç”¨äº†æ–‡ç«  <em>Simple online and realtime tracking with a deep association metric</em> ä¸­çš„è®¡ç®—æ–¹æ³•ã€‚</p><p><strong>æŸå¤±å‡½æ•°</strong>ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mi mathvariant="normal">B</mi><mi mathvariant="normal">H</mi></mrow></msub><mo stretchy="false">(</mo><mi>Î¸</mi><mo separator="true">;</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>P</mi></munderover><munderover><mo>âˆ‘</mo><mrow><mi>a</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mrow><mo fence="true">[</mo><mi>m</mi><mo>+</mo><munder><mo><mi>max</mi><mo>â¡</mo></mo><mstyle scriptlevel="1"><mtable rowspacing="0.1em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="1" displaystyle="false"><mrow><mi>p</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><mi>K</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="1" displaystyle="false"><mrow><mi>p</mi><mo mathvariant="normal">â‰ </mo><mi>a</mi></mrow></mstyle></mtd></mtr></mtable></mstyle></munder><mi>D</mi><mo stretchy="false">(</mo><msub><mi>f</mi><mi>Î¸</mi></msub><mo stretchy="false">(</mo><msubsup><mi>x</mi><mi>a</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>f</mi><mi>Î¸</mi></msub><mo stretchy="false">(</mo><msubsup><mi>x</mi><mi>p</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>âˆ’</mo><munder><mo><mi>min</mi><mo>â¡</mo></mo><mstyle scriptlevel="1"><mtable rowspacing="0.1em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="1" displaystyle="false"><mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><mi>P</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="1" displaystyle="false"><mrow><mi>j</mi><mo mathvariant="normal">â‰ </mo><mi>i</mi></mrow></mstyle></mtd></mtr></mtable></mstyle></munder><mi>D</mi><mo stretchy="false">(</mo><msub><mi>f</mi><mi>Î¸</mi></msub><mo stretchy="false">(</mo><msubsup><mi>x</mi><mi>a</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>f</mi><mi>Î¸</mi></msub><mo stretchy="false">(</mo><msubsup><mi>x</mi><mi>n</mi><mi>j</mi></msubsup><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo fence="true">]</mo></mrow><mo>+</mo></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\mathrm{BH}}(\theta; X) = \sum_{i=1}^{P} \sum_{a=1}^{K} \left[ m + \max_{\substack{p=1,\dots,K \\ p \neq a}} D(f_\theta(x_a^i), f_\theta(x_p^i)) - \min_{\substack{j=1,\dots,P \\ j \neq i}} D(f_\theta(x_a^i), f_\theta(x_n^j)) \right]_+ </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">B</span><span class="mord mathrm mtight">H</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.7090609999999997em;vertical-align:-1.658051em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽ£</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽ¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43056000000000005em;"><span style="top:-2.0406725000000003em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.133325em;"><span style="top:-3.149995em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mrel mtight">=</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="minner mtight">â€¦</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span><span style="top:-2.261115em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mrel mtight"><span class="mrel mtight"><span class="mord vbox mtight"><span class="thinbox mtight"><span class="rlap mtight"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel mtight">î€ </span></span><span class="fix"></span></span></span></span></span><span class="mrel mtight">=</span></span><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.6333249999999999em;"><span></span></span></span></span></span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">max</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5026549999999999em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8746639999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.874664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6678600000000001em;"><span style="top:-2.0406725000000003em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.133325em;"><span style="top:-3.149995em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="minner mtight">â€¦</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span><span style="top:-2.261115em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight"><span class="mrel mtight"><span class="mord vbox mtight"><span class="thinbox mtight"><span class="rlap mtight"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel mtight">î€ </span></span><span class="fix"></span></span></span></span></span><span class="mrel mtight">=</span></span><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.6333249999999999em;"><span></span></span></span></span></span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5026549999999999em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8746639999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8746639999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽ¦</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽ¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-1.191389em;"><span style="top:-1.1002800000000001em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.658051em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>å…¶ä¸­ï¼š<br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span>ï¼šbatch ä¸­èº«ä»½ï¼ˆpersonï¼‰æ•°é‡<br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span>ï¼šæ¯ä¸ªèº«ä»½çš„å›¾åƒæ•°<br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mi>a</mi><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">x_a^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.071664em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span>ï¼šç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> ä¸ªèº«ä»½çš„ç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">a</span></span></span></span> å¼ å›¾åƒï¼ˆanchorï¼‰<br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mi>p</mi><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">x_p^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2077719999999998em;vertical-align:-0.383108em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span></span></span></span>ï¼šä¸Ž anchor åŒèº«ä»½çš„æœ€è¿œæ­£æ ·æœ¬ï¼ˆhardest positiveï¼‰<br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mi>n</mi><mi>j</mi></msubsup></mrow><annotation encoding="application/x-tex">x_n^j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.071664em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span>ï¼šä¸Ž anchor å¼‚èº«ä»½çš„æœ€è¿‘è´Ÿæ ·æœ¬ï¼ˆhardest negativeï¼‰<br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo stretchy="false">(</mo><mo separator="true">â‹…</mo><mo separator="true">,</mo><mo separator="true">â‹…</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">D(Â·,Â·)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mclose">)</span></span></span></span>ï¼šæ¬§æ°è·ç¦»ï¼ˆä½œè€…æ˜Žç¡®ä½¿ç”¨ éžå¹³æ–¹ æ¬§æ°è·ç¦»ï¼‰<br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span>ï¼šmarginï¼Œå– 0.2<br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mo separator="true">â‹…</mo><msub><mo stretchy="false">]</mo><mo>+</mo></msub></mrow><annotation encoding="application/x-tex">[Â·]_+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.25833100000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>ï¼šReLUï¼Œå³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mo separator="true">â‹…</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">max(0, Â·)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mclose">)</span></span></span></span></p><p>æˆ‘ä»¬æ¥æ‹†è§£ä¸€ä¸‹è¿™ä¸ªå…¬å¼ã€‚</p><ol><li><strong>å¤–å±‚åŒé‡æ±‚å’Œ</strong><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>P</mi></msubsup><msubsup><mo>âˆ‘</mo><mrow><mi>a</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup></mrow><annotation encoding="application/x-tex">\sum_{i=1}^{P} \sum_{a=1}^{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2809409999999999em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span></span></span></span><br />ä¸€æ¬¡ mini-batch é‡Œæœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> ä¸ªèº«ä»½ï¼Œæ¯äºº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> å¼ å›¾ï¼›å¯¹æ¯å¼ å›¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i,a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span> éƒ½å½“ä¸€æ¬¡é”šç‚¹ï¼Œå…± <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>Ã—</mo><mi>K</mi></mrow><annotation encoding="application/x-tex">PÃ—K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> ä¸ªé”šç‚¹ã€‚</li><li><strong>æœ€éš¾æ­£æ ·æœ¬é¡¹</strong><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo><mi>max</mi><mo>â¡</mo></mo><mstyle scriptlevel="1"><mtable rowspacing="0.1em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="1" displaystyle="false"><mrow><mi>p</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><mi>K</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="1" displaystyle="false"><mrow><mi>p</mi><mo mathvariant="normal">â‰ </mo><mi>a</mi></mrow></mstyle></mtd></mtr></mtable></mstyle></msub><mi>D</mi><mo stretchy="false">(</mo><msub><mi>f</mi><mi>Î¸</mi></msub><mo stretchy="false">(</mo><msubsup><mi>x</mi><mi>a</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>f</mi><mi>Î¸</mi></msub><mo stretchy="false">(</mo><msubsup><mi>x</mi><mi>p</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\max_{\substack{p=1,\dots,K \\ p \neq a}} D(f_\theta(x_a^i), f_\theta(x_p^i))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.716519em;vertical-align:-0.8918549999999998em;"></span><span class="mop"><span class="mop">max</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3447999999999998em;margin-right:0.05em;"><span class="pstrut" style="height:2.7933274999999997em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.133325em;"><span style="top:-3.149995em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mrel mtight">=</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="minner mtight">â€¦</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span><span style="top:-2.261115em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mrel mtight"><span class="mrel mtight"><span class="mord vbox mtight"><span class="thinbox mtight"><span class="rlap mtight"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel mtight">î€ </span></span><span class="fix"></span></span></span></span></span><span class="mrel mtight">=</span></span><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.6333249999999999em;"><span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8918549999999998em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span><br />åœ¨åŒèº«ä»½ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> çš„å…¶ä½™ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">K-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> å¼ å›¾é‡Œï¼Œæ‰¾è·ç¦»æœ€å¤§çš„é‚£å¼ ä½œä¸ºç¡¬æ­£æ ·æœ¬ï¼ˆ<strong>hardest positive</strong>ï¼‰ã€‚ä½œç”¨æ˜¯æŠŠåŒèº«ä»½æœ€è¿œçš„ç‚¹æ‹‰è¿›æ¥ï¼Œé˜²æ­¢ç°‡å†…æ¾æ•£ã€‚</li><li><strong>æœ€éš¾è´Ÿæ ·æœ¬é¡¹</strong><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo><mi>min</mi><mo>â¡</mo></mo><mstyle scriptlevel="1"><mtable rowspacing="0.1em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="1" displaystyle="false"><mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><mi>P</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="1" displaystyle="false"><mrow><mi>j</mi><mo mathvariant="normal">â‰ </mo><mi>i</mi></mrow></mstyle></mtd></mtr></mtable></mstyle></msub><mi>D</mi><mo stretchy="false">(</mo><msub><mi>f</mi><mi>Î¸</mi></msub><mo stretchy="false">(</mo><msubsup><mi>x</mi><mi>a</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>f</mi><mi>Î¸</mi></msub><mo stretchy="false">(</mo><msubsup><mi>x</mi><mi>n</mi><mi>j</mi></msubsup><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\min_{\substack{j=1,\dots,P \\ j \neq i}} D(f_\theta(x_a^i), f_\theta(x_n^j))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.716519em;vertical-align:-0.8918549999999998em;"></span><span class="mop"><span class="mop">min</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3447999999999998em;margin-right:0.05em;"><span class="pstrut" style="height:2.7933274999999997em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.133325em;"><span style="top:-3.149995em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="minner mtight">â€¦</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span><span style="top:-2.261115em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight"><span class="mrel mtight"><span class="mord vbox mtight"><span class="thinbox mtight"><span class="rlap mtight"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel mtight">î€ </span></span><span class="fix"></span></span></span></span></span><span class="mrel mtight">=</span></span><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.6333249999999999em;"><span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8918549999999998em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span><br />åœ¨ æ‰€æœ‰å¼‚èº«ä»½ å›¾é‡Œï¼Œæ‰¾è·ç¦»æœ€å°çš„é‚£å¼ ä½œä¸ºç¡¬è´Ÿæ ·æœ¬ï¼ˆ<strong>hardest negative</strong>ï¼‰ã€‚ä½œç”¨æ˜¯æŠŠæœ€è¿·æƒ‘äººçš„å¼‚ç±»æŽ¨è¿œï¼Œå¢žå¤§ç±»é—´ marginã€‚</li><li><strong>Hingeé¡¹</strong><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>m</mi><mo>+</mo><mo stretchy="false">(</mo><mi>h</mi><mi>a</mi><mi>r</mi><mi>d</mi><mi>e</mi><mi>s</mi><mi>t</mi><mi>p</mi><mi>o</mi><mi>s</mi><mi>i</mi><mi>t</mi><mi>i</mi><mi>v</mi><mi>e</mi><mo stretchy="false">)</mo><mtext>âˆ’</mtext><mo stretchy="false">(</mo><mi>h</mi><mi>a</mi><mi>r</mi><mi>d</mi><mi>e</mi><mi>s</mi><mi>t</mi><mi>n</mi><mi>e</mi><mi>g</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>v</mi><mi>e</mi><mo stretchy="false">)</mo><msub><mo stretchy="false">]</mo><mo>+</mo></msub></mrow><annotation encoding="application/x-tex">[m + (hardest positive) âˆ’ (hardest negative)]_+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal">p</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">e</span><span class="mclose">)</span><span class="mord">âˆ’</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal">n</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">e</span><span class="mclose">)</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.25833100000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span><br />å½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mi>a</mi><mi>r</mi><mi>d</mi><mi>e</mi><mi>s</mi><mi>t</mi><mi>p</mi><mi>o</mi><mi>s</mi><mi>i</mi><mi>t</mi><mi>i</mi><mi>v</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">hardest positive</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">h</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal">p</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">e</span></span></span></span> æ¯” <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mi>a</mi><mi>r</mi><mi>d</mi><mi>e</mi><mi>s</mi><mi>t</mi><mi>n</mi><mi>e</mi><mi>g</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>v</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">hardest negative</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">h</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal">n</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">e</span></span></span></span> è¿œï¼ˆæˆ–è¿‘å¾—ä¸å¤Ÿï¼‰æ—¶ï¼Œ <strong>hinge</strong> é¡¹ä¸ºæ­£ï¼ŒæŸå¤±äº§ç”Ÿæ¢¯åº¦ï¼Œå¦åˆ™ä¸º 0ï¼ŒæŸå¤±ä¸º 0ã€‚</li></ol><p><strong>è®­ç»ƒåè®®</strong>ï¼š</p><ul><li>ä¼˜åŒ–å™¨ï¼šAdam</li><li>å­¦ä¹ çŽ‡ï¼š0.0001</li><li>mini-batchï¼š72</li><li>epochï¼š1000</li><li>ä¿å­˜é¢‘çŽ‡ï¼šæ¯ 100 ä¸ª epoch ä¿å­˜ä¸€æ¬¡</li></ul><hr /><h3 id="2-è¯†åˆ«æµç¨‹"><a class="markdownIt-Anchor" href="#2-è¯†åˆ«æµç¨‹"></a> 2. è¯†åˆ«æµç¨‹</h3><h4 id="21-è¾“å…¥æ£€æµ‹"><a class="markdownIt-Anchor" href="#21-è¾“å…¥æ£€æµ‹"></a> 2.1 è¾“å…¥æ£€æµ‹</h4><p>æ£€æµ‹å™¨ç»™å‡º (u,v,w,h) + ç½®ä¿¡ï¼›ç½®ä¿¡ &lt;0.3 çš„ç›´æŽ¥ä¸¢å¼ƒã€‚è¯¥æ–‡ç« çš„æ£€æµ‹å™¨æ¥è‡ªäºŽ<em>Poi: Multiple object tracking with high performance detection and appearance feature</em>ï¼Œæ˜¯ä¸€ä¸ªFaster R-CNN åœ¨ç§æœ‰+å…¬å¼€è¡Œäººæ•°æ®é›†ä¸Šé‡æ–°è®­ç»ƒçš„ä¸€ä¸ªå¼ºæ£€æµ‹å™¨ã€‚</p><h4 id="22-ç‰¹å¾æå–"><a class="markdownIt-Anchor" href="#22-ç‰¹å¾æå–"></a> 2.2 ç‰¹å¾æå–</h4><ol><li>æ¡†å›¾ç­‰æ¯”ç¼©æ”¾åˆ° 256Ã—128ï¼Œä¾§è¡¥ç°æ¡ï¼›</li><li>æ¯ä¸ªé€šé“å‡åŽ» ImageNet å‡å€¼ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¼</mi></mrow><annotation encoding="application/x-tex">Î¼</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">Î¼</span></span></span></span> ï¼Œå†é™¤ä»¥æ ‡å‡†å·® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ïƒ</mi></mrow><annotation encoding="application/x-tex">Ïƒ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span></span></span></span> ï¼Œå³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>r</mi></msub><mi>a</mi><mi>w</mi><mi mathvariant="normal">/</mi><mn>255.0</mn><mo>âˆ’</mo><mi>Î¼</mi><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>Ïƒ</mi></mrow><annotation encoding="application/x-tex">x = (x_raw / 255.0 - Î¼) / Ïƒ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord">/</span><span class="mord">2</span><span class="mord">5</span><span class="mord">5</span><span class="mord">.</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Î¼</span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span></span></span></span>ï¼›</li><li>å‰å‘å†»ç»“ CNN â†’ 128-D â†’ L2 å½’ä¸€åŒ– â†’ å•ä½å‘é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">r_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>ã€‚æŠŠ RGB å›¾åƒåŽ‹æˆ 128 ç»´å•ä½è¶…çƒé¢å‘é‡</li></ol><h4 id="23-è¿åŠ¨é¢„æµ‹ä¸Žé—¨æŽ§"><a class="markdownIt-Anchor" href="#23-è¿åŠ¨é¢„æµ‹ä¸Žé—¨æŽ§"></a> 2.3 è¿åŠ¨é¢„æµ‹ä¸Žé—¨æŽ§</h4><p>ç›®æ ‡ï¼šåœ¨ä¸‹ä¸€å¸§åˆ°æ¥ä¹‹å‰ï¼Œç”¨â€œå¸¸é€Ÿæ¨¡åž‹â€ä¼°è®¡æ¯ä¸ªè½¨è¿¹çš„æ–°ä½ç½®ï¼Œå¹¶ç»™å‡ºä¸€ä¸ªç½®ä¿¡æ¤­åœ†â€”â€”åªæœ‰æ£€æµ‹æ¡†è½åœ¨è¿™ä¸ªæ¤­åœ†å†…ï¼Œæ‰å…è®¸å‚ä¸ŽåŽç»­åŒ¹é…ã€‚æ•´ä¸ªæµç¨‹åˆ†ä¸ºä¸‰æ­¥ï¼šçŠ¶æ€å®šä¹‰ â†’ é¢„æµ‹ â†’ Mahalanobis é—¨æŽ§ã€‚</p><ol><li><strong>çŠ¶æ€å‘é‡ä¸Žè§‚æµ‹</strong><br />é‡‡ç”¨å›¾åƒå¹³é¢ä¸Šçš„ 8 ç»´å¸¸é€Ÿæ¨¡åž‹ã€‚<br /><strong>çŠ¶æ€</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mo stretchy="false">[</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo separator="true">,</mo><mi>Î³</mi><mo separator="true">,</mo><mi>h</mi><mo separator="true">,</mo><mover accent="true"><mi>u</mi><mo>Ë™</mo></mover><mo separator="true">,</mo><mover accent="true"><mi>v</mi><mo>Ë™</mo></mover><mo separator="true">,</mo><mover accent="true"><mi>Î³</mi><mo>Ë™</mo></mover><mo separator="true">,</mo><mover accent="true"><mi>h</mi><mo>Ë™</mo></mover><mo stretchy="false">]</mo><mtext>áµ€</mtext></mrow><annotation encoding="application/x-tex">x = [u, v, Î³, h, uÌ‡, vÌ‡, Î³Ì‡, hÌ‡]áµ€</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1813em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">Î³</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">h</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.66786em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">u</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.11111000000000001em;"><span class="mord">Ë™</span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.66786em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.11111000000000001em;"><span class="mord">Ë™</span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.66786em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">Î³</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.13889em;"><span class="mord">Ë™</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9313em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">h</span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.13889em;"><span class="mord">Ë™</span></span></span></span></span></span></span><span class="mclose">]</span><span class="mord">áµ€</span></span></span></span><br />â€“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(u,v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span>ï¼šæ¡†ä¸­å¿ƒåƒç´ åæ ‡<br />â€“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î³</mi><mo>=</mo><mi>w</mi><mi mathvariant="normal">/</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">Î³ = w/h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">Î³</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord">/</span><span class="mord mathnormal">h</span></span></span></span>ï¼šå®½é«˜æ¯”<br />â€“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">h</span></span></span></span>ï¼šé«˜åº¦åƒç´ <br />â€“ å¸¦ç‚¹é¡¹ä¸ºå¯¹åº”ä¸€é˜¶å¯¼æ•°ï¼ˆé€Ÿåº¦ï¼‰</li></ol><p>1.2 <strong>è§‚æµ‹</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mo stretchy="false">[</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo separator="true">,</mo><mi>Î³</mi><mo separator="true">,</mo><mi>h</mi><mo stretchy="false">]</mo><mtext>áµ€</mtext></mrow><annotation encoding="application/x-tex">z = [u, v, Î³, h]áµ€</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">Î³</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">h</span><span class="mclose">]</span><span class="mord">áµ€</span></span></span></span></p><ol start="2"><li><strong>é¢„æµ‹é˜¶æ®µ</strong><br />å¯¹å·²å­˜åœ¨è½¨è¿¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>ï¼š<br />ç”¨<strong>ä¸Šå¸§ä¼°è®¡</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mrow><mi>k</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>P</mi><mrow><mi>k</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(xÌ‚_{k-1}, P_{k-1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.22222em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> åšå…ˆéªŒé¢„æµ‹</li></ol><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mi>k</mi></msub><mi mathvariant="normal">âˆ£</mi><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo>=</mo><mi>F</mi><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mrow><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mi mathvariant="normal">âˆ£</mi><mi>k</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">xÌ‚_k|k-1 = F xÌ‚_{k-1|k-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.22222em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">âˆ£</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.04964em;vertical-align:-0.3551999999999999em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.22222em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span><span class="mord mtight">âˆ£</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>P</mi><mi>k</mi></msub><mi mathvariant="normal">âˆ£</mi><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo>=</mo><mi>F</mi><msub><mi>P</mi><mrow><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mi mathvariant="normal">âˆ£</mi><mi>k</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mi>F</mi><mtext>áµ€</mtext><mo>+</mo><mi>Q</mi></mrow><annotation encoding="application/x-tex">P_k|k-1 = F P_{k-1|k-1} Fáµ€ + Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">âˆ£</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.03853em;vertical-align:-0.3551999999999999em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span><span class="mord mtight">âˆ£</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord">áµ€</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">Q</span></span></span></span></span></p><p>å…¶ä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> ä¸ºçŠ¶æ€è½¬ç§»çŸ©é˜µï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">Q</span></span></span></span> ä¸ºè¿‡ç¨‹å™ªå£°åæ–¹å·®çŸ©é˜µã€‚<br /><strong>é¢„æµ‹è¾“å‡º</strong><br />å‡å€¼ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mi>H</mi><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mi>k</mi></msub><mi mathvariant="normal">âˆ£</mi><mi>k</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">y_i = H xÌ‚_k|k-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.22222em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">âˆ£</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> â†’ 4-D æ¡† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo separator="true">,</mo><mi>Î³</mi><mo separator="true">,</mo><mi>h</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(u,v,Î³,h)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">Î³</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">h</span><span class="mclose">)</span></span></span></span><br />åæ–¹å·® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub><mo>=</mo><mi>H</mi><msub><mi>P</mi><mi>k</mi></msub><mi mathvariant="normal">âˆ£</mi><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mi>H</mi><mtext>áµ€</mtext><mo>+</mo><mi>R</mi></mrow><annotation encoding="application/x-tex">S_i = H P_k|k-1 Háµ€ + R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">âˆ£</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord">áµ€</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></p><ol start="3"><li><strong>é—¨æŽ§é˜¶æ®µ</strong><br />å¯¹æ–°æ£€æµ‹æ¡† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>j</mi></msub><mo>=</mo><mo stretchy="false">(</mo><msub><mi>u</mi><mi>j</mi></msub><mo separator="true">,</mo><msub><mi>v</mi><mi>j</mi></msub><mo separator="true">,</mo><msub><mi>Î³</mi><mi>j</mi></msub><mo separator="true">,</mo><msub><mi>h</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d_j = (u_j, v_j, Î³_j, h_j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05556em;">Î³</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼Œè®¡ç®—åˆ°é¢„æµ‹åˆ†å¸ƒçš„ å¹³æ–¹ <strong>Mahalanobis</strong> è·ç¦»ï¼š</li></ol><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>d</mi><mo stretchy="false">(</mo></msup><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><msub><mi>d</mi><mi>j</mi></msub><mo>âˆ’</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mtext>áµ€</mtext><msubsup><mi>S</mi><mi>i</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msubsup><mo stretchy="false">(</mo><msub><mi>d</mi><mi>j</mi></msub><mo>âˆ’</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d^(1)(i,j) = (d_j - y_i)áµ€ S_i^{-1} (d_j - y_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mopen mtight">(</span></span></span></span></span></span></span></span><span class="mord">1</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.150216em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">áµ€</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.433005em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.266995em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>4-D è§‚æµ‹ç©ºé—´ä¸‹ï¼Œå¹³æ–¹ Mahalanobis è·ç¦»æœä»Ž <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï‡</mi><mtext>Â²</mtext></mrow><annotation encoding="application/x-tex">Ï‡Â²</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">Ï‡</span><span class="mord">Â²</span></span></span></span> åˆ†å¸ƒï¼ŒèŽ·å–95 % ç½®ä¿¡åŒºåŸŸå¯¹åº”çš„é˜ˆå€¼ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mn>95</mn></msub></mrow><annotation encoding="application/x-tex">t_{95}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">9</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œè‹¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>d</mi><mo stretchy="false">(</mo></msup><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>&lt;</mo><msub><mi>t</mi><mn>95</mn></msub></mrow><annotation encoding="application/x-tex">d^(1)(i,j) &lt; t_{95}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mopen mtight">(</span></span></span></span></span></span></span></span><span class="mord">1</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">9</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> åˆ™è®¤ä¸ºé€šè¿‡é—¨æŽ§ï¼Œå…è®¸è¿›å…¥åŒˆç‰™åˆ©æˆæœ¬çŸ©é˜µã€‚</p><h4 id="24-å¤–è§‚åŒ¹é…ä¸Žé—¨æŽ§"><a class="markdownIt-Anchor" href="#24-å¤–è§‚åŒ¹é…ä¸Žé—¨æŽ§"></a> 2.4 å¤–è§‚åŒ¹é…ä¸Žé—¨æŽ§</h4><p>ç›®çš„ï¼šæŠŠç¨‹åº¦ä½Žçš„é…å¯¹ç›´æŽ¥è¸¢æŽ‰ï¼Œå‡å°‘åŒˆç‰™åˆ©çŸ©é˜µçš„æ­§ä¹‰ï¼ŒåŒæ—¶è®©è½¨è¿¹åœ¨é®æŒ¡åŽé å¤–è²Œé‡æ–°æ‰¾å›žèº«ä»½ã€‚<br /><strong>å¾ªçŽ¯ç”»å»Š</strong>ï¼ˆCircular Galleryï¼‰<br />æ¯æ¡è½¨è¿¹ k ç»´æŠ¤ä¸€ä¸ª å›ºå®šé•¿åº¦ 100 çš„åˆ—è¡¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>k</mi></msub><mo>=</mo><mo stretchy="false">[</mo><msup><mi>r</mi><mo stretchy="false">(</mo></msup><mn>1</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><msup><mi>r</mi><mo stretchy="false">(</mo></msup><mn>100</mn><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">R_k = [r^(1), â€¦, r^(100)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mopen mtight">(</span></span></span></span></span></span></span></span><span class="mord">1</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mopen mtight">(</span></span></span></span></span></span></span></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mclose">)</span><span class="mclose">]</span></span></span></span>ï¼Œå…ƒç´ æ˜¯ 128-D å•ä½å‘é‡ï¼ˆL2 å½’ä¸€åŒ–åŽï¼‰ï¼Œæ¥è‡ªè¿‡åŽ» 100 æ¬¡æˆåŠŸåŒ¹é…çš„æ£€æµ‹ç‰¹å¾ã€‚æ¯æˆåŠŸåŒ¹é…ä¸€æ¬¡ï¼ŒæŠŠæ–°ç‰¹å¾ push è¿›é˜Ÿå°¾ï¼Œè¶…å‡º 100 åˆ™ pop é˜Ÿå¤´<br /><strong>æœ€å°ä½™å¼¦è·ç¦»è®¡ç®—</strong><br />å¯¹æ–°æ£€æµ‹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>ï¼Œå…ˆæå– 128-D å•ä½å‘é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">r_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œç„¶åŽä¸Žç”»å»Šé€å‘é‡æ±‚ä½™å¼¦ç›¸ä¼¼åº¦</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>s</mi><mi>i</mi><mi>m</mi><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mi>r</mi><mi>j</mi><mi>T</mi></msubsup><msubsup><mi>r</mi><mi>k</mi><mo stretchy="false">(</mo></msubsup><mi>l</mi><mo stretchy="false">)</mo><mo>âˆˆ</mo><mo stretchy="false">[</mo><mo>âˆ’</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">sim(l) = r_j^T r_k^(l)          âˆˆ [-1, 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">m</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.427908em;vertical-align:-0.383108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.891331em;"><span style="top:-2.4530000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.3986920000000005em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mopen mtight">(</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013079999999999em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">âˆ’</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>d</mi><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>=</mo><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>l</mi></msub><mrow><mn>1</mn><mo>âˆ’</mo><mi>s</mi><mi>i</mi><mi>m</mi><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow><mo>âˆˆ</mo><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">d^{(2)}(i,j) = min_l { 1 - sim(l) } âˆˆ [0, 2]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">i</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">m</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mclose">)</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mclose">]</span></span></span></span></span></p><p>å–æœ€å°è·ç¦», å³æœ€åƒçš„é‚£ä¸ªåŽ†å²å‘é‡ã€‚<br />3. <strong>ç¡¬é—¨æŽ§</strong>ï¼ˆHard Gatingï¼‰</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>b</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msubsup><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1</mn><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msup><mi>d</mi><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>â‰¤</mo><mn>0.2</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>0</mn><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>otherwise</mtext></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">b^{(2)}_{i,j}=\begin{cases}1,&amp;d^{(2)}(i,j)\leq0.2\\0,&amp;\text{otherwise}\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4577719999999998em;vertical-align:-0.412972em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.412972em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">1</span><span class="mpunct">,</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">0</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">otherwise</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><h4 id="25-æˆæœ¬çŸ©é˜µä¸Žçº§è”"><a class="markdownIt-Anchor" href="#25-æˆæœ¬çŸ©é˜µä¸Žçº§è”"></a> 2.5 æˆæœ¬çŸ©é˜µä¸Žçº§è”</h4><p>ä¸¤è½®é—¨æŽ§ï¼ˆè¿åŠ¨ + å¤–è§‚ï¼‰éƒ½é€šè¿‡åŽï¼Œè¯¥ (è½¨è¿¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span>, æ£€æµ‹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>) å¯¹æ‰è¢«å…è®¸è¿›å…¥åŒˆç‰™åˆ©ç®—æ³•çš„æˆæœ¬çŸ©é˜µã€‚æŽ¥ä¸‹æ¥é¡ºåºå¦‚ä¸‹ï¼š</p><ol><li><strong>æž„é€ æˆæœ¬çŸ©é˜µ C</strong><br />ä»…ä¿ç•™ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>b</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">b^{(1)}=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> ä¸” <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>b</mi><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">b^{(2)}=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> çš„é…å¯¹<br />å…ƒç´  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">C_{i,j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> = å¤–è§‚ä½™å¼¦è·ç¦»<br />æœªé€šè¿‡é—¨æŽ§çš„ä½ç½®å¡« <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">âˆž</mi></mrow><annotation encoding="application/x-tex">âˆž</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord">âˆž</span></span></span></span>ï¼Œç¡®ä¿åŒˆç‰™åˆ©ä¸ä¼šé€‰ä¸­</li><li><strong>åŒˆç‰™åˆ©æœ€ä¼˜åˆ†é…</strong><br />åœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> ä¸Šæ±‚è§£æœ€å°æˆæœ¬åŒ¹é…<br />è¾“å‡ºï¼šæœ€ä¼˜ (è½¨è¿¹â†’æ£€æµ‹) åˆ—è¡¨ + æœªåŒ¹é…è½¨è¿¹ + æœªåŒ¹é…æ£€æµ‹</li><li><strong>Kalman æ›´æ–° / æ–°å»ºè½¨è¿¹ / åˆ é™¤è½¨è¿¹</strong><br />åŒ¹é…æˆåŠŸçš„ï¼šç”¨å¯¹åº”æ£€æµ‹æ¡†åš Kalman æ›´æ–°ï¼Œå¹¶æŠŠå…¶ 128-D ç‰¹å¾åŽ‹å…¥è½¨è¿¹ gallery<br />æœªåŒ¹é…æ£€æµ‹ï¼šåˆå§‹åŒ–æš‚å®šè½¨è¿¹ï¼Œéœ€è¿žç»­ 3 å¸§æˆåŠŸå…³è”æ‰è½¬æ­£<br />æœªåŒ¹é…è½¨è¿¹ï¼šage +1ï¼Œè¶…è¿‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mrow><mi>l</mi><mi>o</mi><mi>s</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">T_{lost}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼ˆé»˜è®¤ 30ï¼‰å¸§å³åˆ é™¤<br />å¾ªçŽ¯ç»“æŸï¼šä¸‹ä¸€å¸§åˆ°æ¥æ—¶ï¼Œç”¨æ›´æ–°åŽçš„è½¨è¿¹çŠ¶æ€å›žåˆ°ç¬¬ 1 æ­¥é¢„æµ‹é˜¶æ®µã€‚</li></ol><hr />]]></content>
    
    
    <summary type="html">&lt;p&gt;æ¢³ç†æ‘„åƒå¤´è¡Œäººè¿½è¸ªç»å…¸è®ºæ–‡SIMPLE ONLINE AND REALTIME TRACKING WITH A DEEP ASSOCIATION METRICä¸­çš„æ–¹æ³•ã€‚&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>Features for Multi-Target Multi-Camera Tracking and Re-Identification</title>
    <link href="https://atffang.github.io/2025/11/11/%E8%AE%BA%E6%96%87%E7%B2%BE%E8%AF%BBFMTMCRI/"/>
    <id>https://atffang.github.io/2025/11/11/%E8%AE%BA%E6%96%87%E7%B2%BE%E8%AF%BBFMTMCRI/</id>
    <published>2025-11-11T03:33:07.000Z</published>
    <updated>2025-12-29T08:53:02.307Z</updated>
    
    <content type="html"><![CDATA[<p>æ¢³ç†MTMCé—®é¢˜ç»å…¸è®ºæ–‡Features for Multi-Target Multi-Camera Tracking and Re-Identificationä¸­çš„æ–¹æ³•ã€‚</p><span id="more"></span><h1 id="features-for-multi-target-multi-camera-tracking-and-re-identification"><a class="markdownIt-Anchor" href="#features-for-multi-target-multi-camera-tracking-and-re-identification"></a> Features for Multi-Target Multi-Camera Tracking and Re-Identification</h1><p><strong>ä½œè€…</strong>ï¼šErgys Ristani, Carlo Tomasi (Duke University)</p><h3 id="abstract"><a class="markdownIt-Anchor" href="#abstract"></a> Abstract</h3><p>Multi-Target Multi-Camera Tracking (MTMCT) tracks many people through video taken from several cameras. Person Re-Identification (Re-ID) retrieves from a gallery images of people similar to a person query image. We learn good features for both MTMCT and Re-ID with a convolutional neural network. Our contributions include an adaptive weighted triplet loss for training and a new technique for hard-identity mining. Our method outperforms the state of the art both on the DukeMTMC benchmarks for tracking, and on the Market-1501 and DukeMTMC-ReID benchmarks for Re-ID. We examine the correlation between good Re-ID and good MTMCT scores, and perform ablation studies to elucidate the contributions of the main components of our system.</p><h2 id="1-ä»»åŠ¡å®šä¹‰ä¸Žæ•´ä½“æ€è·¯"><a class="markdownIt-Anchor" href="#1-ä»»åŠ¡å®šä¹‰ä¸Žæ•´ä½“æ€è·¯"></a> 1. ä»»åŠ¡å®šä¹‰ä¸Žæ•´ä½“æ€è·¯</h2><p>MTMCT çš„ç›®æ ‡æ˜¯ï¼Œç»™å®š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span> è·¯æ— é‡å è§†åŸŸçš„è§†é¢‘æµ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo>=</mo><mrow><mi>V</mi><mn>1</mn><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><mi>V</mi><mi>n</mi></mrow></mrow><annotation encoding="application/x-tex">V={V1,â€¦,Vn}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord mathnormal">n</span></span></span></span></span>ï¼Œè¾“å‡ºæ¯ä¸ªäººåœ¨å…¨å±€æ—¶ç©ºä¸­çš„å®Œæ•´è½¨è¿¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>=</mo><mrow><mi>T</mi><mn>1</mn><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><mi>T</mi><mi>l</mi></mrow></mrow><annotation encoding="application/x-tex">T={T1,â€¦,Tl}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span></span>ã€‚<br />Re-ID çš„ç›®æ ‡æ˜¯ï¼šç»™å®šæŸ¥è¯¢å›¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span>ï¼Œåœ¨è·¨ç›¸æœºå›¾åº“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">G</span></span></span></span> ä¸­æŒ‰ç›¸ä¼¼åº¦é™åºè¿”å›žåŒèº«ä»½å›¾åƒã€‚</p><p>ä½œè€…æå‡ºåªå­¦ä¹ ç‰¹å¾ï¼Œä¸å­¦ä¹ å…³è”ï¼š</p><ul><li>è®­ç»ƒé˜¶æ®µï¼šç”¨æ”¹è¿›çš„åŠ æƒä¸‰å…ƒç»„æŸå¤±ï¼ˆAWTLï¼‰+ å›°éš¾èº«ä»½æŒ–æŽ˜ï¼ˆHNMï¼‰åœ¨çº¯ Re-ID åè®®ä¸‹è®­ç»ƒ 128-D å¤–è§‚ç‰¹å¾ï¼›</li><li>æµ‹è¯•é˜¶æ®µï¼šç”¨ç›¸å…³èšç±»ï¼ˆCorrelation Clusteringï¼‰ä¸€æ¬¡æ€§æŠŠå…¨éƒ¨æ£€æµ‹å…³è”æˆè·¨ç›¸æœºè½¨è¿¹ï¼›</li><li>æ£€æµ‹å™¨ä¸Žç‰¹å¾è§£è€¦ï¼Œæ•´ä½“ pipeline é€šè¿‡ä¸‰é˜¶æ®µé€’è¿›ï¼Œå³æ£€æµ‹ â†’ å•ç›¸æœºè½¨è¿¹ â†’ è·¨ç›¸æœºè½¨è¿¹ã€‚</li></ul><hr /><h2 id="2-è®­ç»ƒå¤–è§‚ç‰¹å¾å­¦ä¹ "><a class="markdownIt-Anchor" href="#2-è®­ç»ƒå¤–è§‚ç‰¹å¾å­¦ä¹ "></a> 2. è®­ç»ƒï¼šå¤–è§‚ç‰¹å¾å­¦ä¹ </h2><h3 id="21-ä¸‰å…ƒç»„æŸå¤±çš„é€šç”¨å½¢å¼"><a class="markdownIt-Anchor" href="#21-ä¸‰å…ƒç»„æŸå¤±çš„é€šç”¨å½¢å¼"></a> 2.1 ä¸‰å…ƒç»„æŸå¤±çš„é€šç”¨å½¢å¼</h3><p>åœ¨è¡Œäºº Re-ID ä»»åŠ¡é‡Œï¼Œæˆ‘ä»¬æŠŠä¸€å¼ å«æœ‰æŸä¸ªäººå…¨èº«ï¼ˆæˆ–å¯è§å¤§éƒ¨åˆ†èº«ä½“ï¼‰çš„ bounding-box å›¾åƒå«åšä¸€ä¸ª æ ·æœ¬ï¼ˆæˆ– patchã€embeddingï¼‰ã€‚</p><p>è®­ç»ƒæ—¶ï¼Œè¾“å…¥ç½‘ç»œçš„å›¾åƒä¸‰å…ƒç»„å¦‚ä¸‹ï¼š<br />Â· å…ˆéšæœºé€‰ ä¸€ä¸ªèº«ä»½ ID-aï¼ˆæ¯”å¦‚å¼ ä¸‰ï¼‰ã€‚<br />Â· ä»Ž ID-a å½“å¤©è¢«ä¸åŒç›¸æœºæ‹åˆ°çš„æ‰€æœ‰æ¡†å›¾é‡Œï¼ŒéšæœºæŠ½ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> å¼ ï¼ˆè®ºæ–‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">K=4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span></span></span></span>ï¼‰ã€‚è¿™ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> å¼ é‡Œçš„ä»»æ„ä¸€å¼ å°±å« é”šç‚¹å›¾åƒ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">xa</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal">a</span></span></span></span>ï¼ˆanchorï¼‰ã€‚<br />Â· åŒå±ž ID-a çš„å…¶ä½™æ¡†å›¾éƒ½å« æ­£æ ·æœ¬å›¾åƒ xpï¼ˆpositiveï¼‰â€”â€”å®ƒä»¬å’Œ xa åŒèº«ä»½ï¼Œåªæ˜¯è§†è§’ã€å…‰ç…§ã€å§¿æ€æˆ–é®æŒ¡ä¸åŒã€‚<br />å†ä»Ž å…¶å®ƒä»»ä½•èº«ä»½ï¼ˆæŽé›·ã€éŸ©æ¢…â€¦ï¼‰çš„æ¡†å›¾é‡ŒéšæœºæŠ½è‹¥å¹²å¼ ï¼Œå« è´Ÿæ ·æœ¬å›¾åƒ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>n</mi><mtext>ï¼ˆ</mtext><mi>n</mi><mi>e</mi><mi>g</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>v</mi><mi>e</mi><mtext>ï¼‰</mtext></mrow><annotation encoding="application/x-tex">xnï¼ˆnegativeï¼‰</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal">n</span><span class="mord cjk_fallback">ï¼ˆ</span><span class="mord mathnormal">n</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">e</span><span class="mord cjk_fallback">ï¼‰</span></span></span></span>ï¼Œå®ƒä»¬å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">xa</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal">a</span></span></span></span> èº«ä»½ä¸åŒã€‚</p><p>å¯¹é”šç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">xa</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal">a</span></span></span></span>ï¼Œè®¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span> ä¸ºæ­£æ ·æœ¬é›†ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N(a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span> ä¸ºè´Ÿæ ·æœ¬é›†ï¼Œå®šä¹‰</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>L</mi><mn>3</mn></msub><mo>=</mo><msub><mrow><mo fence="true">[</mo><mi>m</mi><mo>+</mo><munder><mo>âˆ‘</mo><mrow><msub><mi>x</mi><mi>p</mi></msub><mo>âˆˆ</mo><mi>P</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo></mrow></munder><msub><mi>w</mi><mi>p</mi></msub><mi>d</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>a</mi></msub><mo separator="true">,</mo><msub><mi>x</mi><mi>p</mi></msub><mo stretchy="false">)</mo><mo>âˆ’</mo><munder><mo>âˆ‘</mo><mrow><msub><mi>x</mi><mi>n</mi></msub><mo>âˆˆ</mo><mi>N</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo></mrow></munder><msub><mi>w</mi><mi>n</mi></msub><mi>d</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>a</mi></msub><mo separator="true">,</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo fence="true">]</mo></mrow><mo>+</mo></msub></mrow><annotation encoding="application/x-tex">L_3=\left[m+\sum_{x_p\in P(a)}w_pd(x_a,x_p)-\sum_{x_n\in N(a)}w_nd(x_a,x_n)\right]_+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.7090609999999997em;vertical-align:-1.658051em;"></span><span class="minner"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽ£</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽ¢</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽ¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.808995em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285716em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span><span class="mrel mtight">âˆˆ</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">a</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.538325em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.808995em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mrel mtight">âˆˆ</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">a</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.516005em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽ¦</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽ¥</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŽ¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-1.191389em;"><span style="top:-1.1002800000000001em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.658051em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>å…¶ä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">(</mo><mo separator="true">â‹…</mo><mo separator="true">,</mo><mo separator="true">â‹…</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d(Â·,Â·)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mclose">)</span></span></span></span> ä¸ºæ¬§æ°è·ç¦»ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>ã€‚å…³é”®åœ¨æƒé‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mtext>â‚š</mtext><mo separator="true">,</mo><mi>w</mi><mtext>â‚™</mtext></mrow><annotation encoding="application/x-tex">{wâ‚š, wâ‚™}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord">â‚š</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord">â‚™</span></span></span></span></span> çš„è®¾è®¡ã€‚</p><h3 id="22-è‡ªé€‚åº”æƒé‡awtl"><a class="markdownIt-Anchor" href="#22-è‡ªé€‚åº”æƒé‡awtl"></a> 2.2 è‡ªé€‚åº”æƒé‡ï¼ˆAWTLï¼‰</h3><p>ä¸Ž Batch-Hard ä»…ç»™æœ€éš¾æ ·æœ¬èµ‹ 1ã€å…¶ä½™ 0 ä¸åŒï¼Œä½œè€…æå‡º softmax å¼è¿žç»­æƒé‡ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>w</mi><mi>p</mi></msub><mo>=</mo><mfrac><msup><mi>e</mi><mrow><mi>d</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>a</mi></msub><mo separator="true">,</mo><msub><mi>x</mi><mi>p</mi></msub><mo stretchy="false">)</mo></mrow></msup><mrow><munder><mo>âˆ‘</mo><mrow><mi>x</mi><mo>âˆˆ</mo><mi>P</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo></mrow></munder><msup><mi>e</mi><mrow><mi>d</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>a</mi></msub><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></msup></mrow></mfrac><mo separator="true">,</mo><mspace width="1em"/><msub><mi>w</mi><mi>n</mi></msub><mo>=</mo><mfrac><msup><mi>e</mi><mrow><mo>âˆ’</mo><mi>d</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>a</mi></msub><mo separator="true">,</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></msup><mrow><munder><mo>âˆ‘</mo><mrow><mi>x</mi><mo>âˆˆ</mo><mi>N</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo></mrow></munder><msup><mi>e</mi><mrow><mo>âˆ’</mo><mi>d</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>a</mi></msub><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">w_p=\frac{e^{d(x_a,x_p)}}{\sum_{x\in P(a)}e^{d(x_a,x)}},\quad w_n=\frac{e^{-d(x_a,x_n)}}{\sum_{x\in N(a)}e^{-d(x_a,x)}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.74371em;vertical-align:-1.17871em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.565em;"><span style="top:-2.2960000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.22528999999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">âˆˆ</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">a</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.47471em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.814em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285716em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.17871em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.74371em;vertical-align:-1.17871em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.565em;"><span style="top:-2.2960000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.22528999999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">âˆˆ</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">a</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.47471em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.814em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mathnormal mtight">d</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mathnormal mtight">d</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.17871em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>Batch-Hardçš„ç¼ºç‚¹ï¼š</p><ul><li>æ¢¯åº¦åªæ¥è‡ªä¸¤å¼ å›¾ï¼Œå…¶ä½™æ ·æœ¬è¢«æµªè´¹ï¼›</li><li>å¦‚æžœâ€œæœ€éš¾â€æ ·æœ¬æ˜¯ç¦»ç¾¤å¸§ï¼ˆé®æŒ¡ã€è¯¯æ£€ï¼‰ï¼Œç½‘ç»œä¼šè¢«å¼ºè¡Œæ‹‰å‘é”™è¯¯æ–¹å‘ï¼›</li><li>æƒé‡æ˜¯ 0/1 ç¡¬åˆ†é…ï¼Œæ— æ³•å…¼é¡¾å¤šä¸ªéš¾æ ·æœ¬ã€‚</li></ul><p>è‡ªé€‚åº”æƒé‡çš„ä¼˜åŠ¿ï¼š</p><ul><li>hardest æ ·æœ¬è‹¥æ˜¯ç¦»ç¾¤ï¼Œæƒé‡ä¸ä¼šç‹¬å¤§ï¼›</li><li>å¤šä¸ªéš¾åˆ†æ ·æœ¬åŒæ—¶èŽ·å¾—æ¢¯åº¦ï¼Œè®­ç»ƒæ›´ç¨³å®šã€‚</li></ul><h3 id="23-å›°éš¾èº«ä»½æŒ–æŽ˜hnm"><a class="markdownIt-Anchor" href="#23-å›°éš¾èº«ä»½æŒ–æŽ˜hnm"></a> 2.3 å›°éš¾èº«ä»½æŒ–æŽ˜ï¼ˆHNMï¼‰</h3><p>è®­ç»ƒé›†èº«ä»½æ•°å¤§æ—¶ï¼Œéšæœº PK é‡‡æ ·å¾ˆéš¾ç¢°åˆ°çœŸæ­£å›°éš¾çš„èº«ä»½ã€‚ä½œè€…ç»´æŠ¤ä¸¤ä¸ªæ± ï¼š</p><ul><li>Hard-Identity-Pool Hï¼šå¯¹å½“å‰é”šç‚¹ï¼Œå…¨å±€ç‰¹å¾è·ç¦»æœ€å¤§çš„ H=50 ä¸ªèº«ä»½ï¼›</li><li>Random-Poolï¼šå…¶ä½™èº«ä»½ã€‚</li></ul><p>æ¯ä¸ª mini-batch ä¸­ï¼Œé™¤é”šèº«ä»½å¤–çš„ Pâ€“1 ä¸ªèº«ä»½ä»¥ 0.5/0.5 æ¦‚çŽ‡ä»Žä¸Šè¿°ä¸¤æ± æŠ½å–ï¼Œå†å„éšæœºé€‰ K=4 å¼ å›¾ã€‚<br />å®žè·µï¼šç½‘ç»œå…ˆ warm-up 5 k æ¬¡è¿­ä»£ï¼Œç”¨æ­¤åˆ»ç‰¹å¾ç¦»çº¿è®¡ç®—ä¸€æ¬¡ Hï¼Œä¹‹åŽå›ºå®šåˆ°è®­ç»ƒç»“æŸã€‚</p><h3 id="24-ç½‘ç»œç»“æž„ä¸Žå¢žå¼º"><a class="markdownIt-Anchor" href="#24-ç½‘ç»œç»“æž„ä¸Žå¢žå¼º"></a> 2.4 ç½‘ç»œç»“æž„ä¸Žå¢žå¼º</h3><p>è®­ç»ƒæ ·æœ¬ï¼šå«è¡Œäººçš„è¾¹æ¡†å›¾ + èº«ä»½ç¼–å·</p><ol><li><strong>éª¨æž¶ï¼šImageNet é¢„è®­ç»ƒ ResNet-50</strong>ï¼š</li></ol><ul><li>è¾“å…¥å½¢çŠ¶ï¼š(B, 3, 256, 128)</li><li>è¾“å‡ºï¼š<strong>pool5</strong> ç‰¹å¾å›¾ (B, 2048, 8, 4)ï¼ˆåŽŸå§‹ ImageNet æ˜¯ 7Ã—7ï¼Œè¿™é‡Œæ˜¯ 8Ã—4ï¼Œå› ä¸ºè¡Œäººå›¾é«˜å®½æ¯” 2:1ï¼‰</li><li>åªä¿ç•™â€œå·ç§¯+BN+ReLUâ€éƒ¨åˆ†ï¼ŒæŠŠå…¨å±€å¹³å‡æ± åŒ–ï¼ˆGAPï¼‰å’Œ 1000-D fc å…¨éƒ¨ä¸¢æŽ‰ï¼›ç¡®ä¿å¾—åˆ°ç©ºé—´ç»´åº¦ 8Ã—4 çš„ 2048 é€šé“å·ç§¯ç‰¹å¾ã€‚</li></ul><ol start="2"><li><strong>å…¨å±€æœ€å¤§æ± åŒ–ï¼ˆGMPï¼‰æˆ–å¹³å‡æ± åŒ–ï¼ˆGAPï¼‰</strong></li></ol><ul><li>ä½¿ç”¨Global Average Poolingï¼ˆGAPï¼‰æˆ–è€… Global Max Poolingï¼ˆGMPï¼‰æŠŠ (B, 2048, 8, 4) çš„ç‰¹å¾å›¾åŽ‹æˆ (B, 2048, 1, 1)ï¼Œå† flatten æˆ (B, 2048) å‘é‡ã€‚æŠŠç©ºé—´ä¿¡æ¯åŽ‹æˆå›ºå®šé•¿åº¦å‘é‡</li></ul><ol start="3"><li><strong>ç¬¬ä¸€å…¨è¿žæŽ¥</strong></li></ol><ul><li>å…¨è¿žæŽ¥å±‚ï¼šæŠŠ 2048 ç»´å‘é‡æ˜ å°„åˆ° 1024 ç»´ã€‚</li><li>åŠ  BatchNorm1d(ç¼“è§£å†…éƒ¨åå˜é‡åç§»)</li><li>åŠ  ReLU(å¼•å…¥éžçº¿æ€§)</li></ul><ol start="4"><li><strong>ç¬¬äºŒå…¨è¿žæŽ¥</strong></li></ol><ul><li>1024 â†’ 128ï¼ˆåµŒå…¥å±‚ï¼‰</li><li>ç›´æŽ¥è¾“å‡º 128-D å‘é‡ï¼Œä¿è¯åµŒå…¥ç©ºé—´æ˜¯çº¿æ€§çš„ï¼Œæ–¹ä¾¿åŽé¢ç®—æ¬§æ°è·ç¦»</li></ul><ol start="5"><li><strong>Lâ‚‚ å½’ä¸€åŒ–</strong></li></ol><ul><li>æŠŠæ¯ä¸ª 128-D å‘é‡æ‹‰æˆå•ä½çƒé¢ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>â€–</mtext><mi>x</mi><mtext>â€–â‚‚</mtext><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">â€–xâ€–â‚‚ = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord">â€–</span><span class="mord mathnormal">x</span><span class="mord">â€–</span><span class="mord">â‚‚</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></li></ul><ol start="6"><li><strong>æœ€ç»ˆè¾“å‡º</strong></li></ol><ul><li>æŠŠç½‘ç»œè¾“å‡ºçš„ 128-D å•ä½å‘é‡ç»„ç»‡æˆä¸‰å…ƒç»„$ (xa, xp, xn)<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>ï¼Œç®—æ¬§æ°è·ç¦»</mtext></mrow><annotation encoding="application/x-tex">ï¼Œç®—æ¬§æ°è·ç¦»</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">ç®—</span><span class="mord cjk_fallback">æ¬§</span><span class="mord cjk_fallback">æ°</span><span class="mord cjk_fallback">è·</span><span class="mord cjk_fallback">ç¦»</span></span></span></span> d(Â·,Â·)$ï¼Œå†ä»£å…¥è‡ªé€‚åº”åŠ æƒä¸‰å…ƒç»„æŸå¤±ï¼Œå¾—åˆ°æ¢¯åº¦å¹¶å›žä¼ ã€‚</li></ul><p>ä¸Šè¿°æ–¹æ³•çš„ä¼ªä»£ç ä¸ºï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">model.train()</span><br><span class="line">optim.zero_grad()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ===== 1. å‰å‘æ‹¿åˆ° 128-D å•ä½å‘é‡ =====</span></span><br><span class="line">embs = model(imgs)          <span class="comment"># (B, 128)  å·²åœ¨æ¨¡åž‹é‡Œ L2-normalize</span></span><br><span class="line">embs = embs.view(P, K, <span class="number">128</span>) <span class="comment"># (P, K, 128) æ–¹ä¾¿æŒ‰èº«ä»½åˆ‡ç‰‡</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ===== 2. é€èº«ä»½æž„é€ ä¸‰å…ƒç»„ =====</span></span><br><span class="line">loss_batch = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(P):               <span class="comment"># æ¯ä¸ªèº«ä»½å½“ä¸€æ¬¡é”š</span></span><br><span class="line">    xa = embs[i, <span class="number">0</span>]              <span class="comment"># é€‰è¯¥èº«ä»½ç¬¬ 1 å¼ å½“é”šï¼ˆå¯éšæœºï¼‰</span></span><br><span class="line">    xp = embs[i, <span class="number">1</span>:]             <span class="comment"># åŒèº«ä»½å…¶ä½™ K-1 å¼  = æ­£</span></span><br><span class="line">    xn = embs[torch.arange(P)!=i] <span class="comment"># å…¶ä½™ (P-1) ä¸ªèº«ä»½ = è´Ÿ</span></span><br><span class="line">    xn = xn.view(-<span class="number">1</span>, <span class="number">128</span>)        <span class="comment"># æ‹‰å¹³æˆ ((P-1)*K, 128)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># ===== 3. ç®—æ¬§æ°è·ç¦» =====</span></span><br><span class="line">    d_ap = torch.cdist(xa.unsqueeze(<span class="number">0</span>), xp)  <span class="comment"># (1, K-1)</span></span><br><span class="line">    d_an = torch.cdist(xa.unsqueeze(<span class="number">0</span>), xn)  <span class="comment"># (1, (P-1)*K)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># ===== 4. è‡ªé€‚åº”æƒé‡ =====</span></span><br><span class="line">    w_p = F.softmax(d_ap, dim=<span class="number">1</span>)             <span class="comment"># æ­£æ ·æœ¬æƒé‡ (1, K-1)</span></span><br><span class="line">    w_n = F.softmax(-d_an, dim=<span class="number">1</span>)            <span class="comment"># è´Ÿæ ·æœ¬æƒé‡ (1, (P-1)*K)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># ===== 5. åŠ æƒä¸‰å…ƒç»„æŸå¤± =====</span></span><br><span class="line">    pos_term = (w_p * d_ap).<span class="built_in">sum</span>()</span><br><span class="line">    neg_term = (w_n * d_an).<span class="built_in">sum</span>()</span><br><span class="line">    loss_i = F.relu(m + pos_term - neg_term) <span class="comment"># m=1 è®ºæ–‡è®¾ç½®</span></span><br><span class="line">    loss_batch += loss_i</span><br><span class="line"></span><br><span class="line">loss = loss_batch / P          <span class="comment"># å¹³å‡åˆ°æ¯ä¸ªé”š</span></span><br><span class="line">loss.backward()</span><br><span class="line">optim.step()</span><br></pre></td></tr></table></figure><hr /><h2 id="3-æµ‹è¯•mtmc-è·Ÿè¸ª-pipeline"><a class="markdownIt-Anchor" href="#3-æµ‹è¯•mtmc-è·Ÿè¸ª-pipeline"></a> 3. æµ‹è¯•ï¼šMTMC è·Ÿè¸ª pipeline</h2><p>æ•´ä½“æµç¨‹è§ä¸‹å›¾</p><img src="/2025/11/11/%E8%AE%BA%E6%96%87%E7%B2%BE%E8%AF%BBFMTMCRI/image.png" class="" title="sucessful"><h3 id="31-è¾“å…¥æ£€æµ‹"><a class="markdownIt-Anchor" href="#31-è¾“å…¥æ£€æµ‹"></a> 3.1 è¾“å…¥æ£€æµ‹</h3><p>é‡‡ç”¨å…¬å¼€ OpenPose äººä½“æ£€æµ‹å™¨ï¼ˆåŸºäºŽ PAFï¼Œåœ¨ Part Affinity ä¸Šç›´æŽ¥ç›‘ç£ï¼‰ï¼Œè¾“å‡ºæ¯å¸§è¾¹ç•Œæ¡†ã€‚</p><h3 id="32-ç‰¹å¾æå–"><a class="markdownIt-Anchor" href="#32-ç‰¹å¾æå–"></a> 3.2 ç‰¹å¾æå–</h3><p>æ£€æµ‹ç»™å‡ºçš„ä»»æ„é«˜å®½æ¯”æ¡†å…ˆè¢«ç­‰æ¯”ç¼©æ”¾åˆ°é«˜ 256 åƒç´ ã€å®½ 128 åƒç´ ï¼ˆä¸è¶³ä¸¤ä¾§è¡¥ç°æ¡ï¼‰ï¼Œå†åš ImageNet å‡å€¼-æ–¹å·®å½’ä¸€åŒ–ï¼›å›ºå®šæƒé‡çš„ ResNet-50 å·ç§¯åŸºæå– 2048-D å…¨å±€ç‰¹å¾ï¼Œç» 2048â†’1024â†’128 ä¸¤å±‚å…¨è¿žæŽ¥ï¼ˆå¸¦ BN ä¸Ž ReLUï¼‰å¹¶ Lâ‚‚ å½’ä¸€åŒ–åŽï¼Œè¾“å‡º 128 ç»´å•ä½å‘é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mtext>áµ¢</mtext></mrow><annotation encoding="application/x-tex">xáµ¢</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mord">áµ¢</span></span></span></span>ï¼Œä¾›åŽç»­å…³è”ä½¿ç”¨ã€‚</p><h3 id="33-ç›¸ä¼¼åº¦è®¡ç®—"><a class="markdownIt-Anchor" href="#33-ç›¸ä¼¼åº¦è®¡ç®—"></a> 3.3 ç›¸ä¼¼åº¦è®¡ç®—</h3><ol><li><strong>å¤–è§‚ç›¸å…³åº¦</strong>ï¼š</li></ol><ul><li>å…ˆç¦»çº¿åœ¨è®­ç»ƒé›†ä¸Šç»Ÿè®¡æ‰€æœ‰æ­£/è´Ÿå¯¹çš„å¹³å‡è·ç¦» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¼</mi><mtext>â‚š</mtext><mo separator="true">,</mo><mi>Î¼</mi><mtext>â‚™</mtext></mrow><annotation encoding="application/x-tex">Î¼â‚š, Î¼â‚™</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">Î¼</span><span class="mord">â‚š</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">Î¼</span><span class="mord">â‚™</span></span></span></span>ï¼Œä»¤é˜ˆå€¼<br />â€ƒâ€ƒ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mtext>â‚</mtext><mo>=</mo><mo stretchy="false">(</mo><mi>Î¼</mi><mtext>â‚š</mtext><mo>+</mo><mi>Î¼</mi><mtext>â‚™</mtext><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">tâ‚ = (Î¼â‚š + Î¼â‚™)/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span><span class="mord">â‚</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">Î¼</span><span class="mord">â‚š</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Î¼</span><span class="mord">â‚™</span><span class="mclose">)</span><span class="mord">/</span><span class="mord">2</span></span></span></span>â€ƒâ€ƒ(â‰¤1)</li><li>åˆ™å¯¹ä»»æ„ä¸€å¯¹æ£€æµ‹,å¤–è§‚ç›¸å…³åº¦ä¸ºï¼š<br />â€ƒâ€ƒ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow><mi>A</mi></msubsup><mo>=</mo><mo stretchy="false">(</mo><mi>t</mi><mtext>â‚â€“</mtext><mi>d</mi><mo stretchy="false">(</mo><mi>x</mi><mtext>áµ¢</mtext><mo separator="true">,</mo><mi>x</mi><mtext>â±¼</mtext><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>t</mi><mtext>â‚</mtext></mrow><annotation encoding="application/x-tex">w_{ij}^{A} = (tâ‚ â€“ d(xáµ¢,xâ±¼))/tâ‚</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.236103em;vertical-align:-0.394772em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-2.441336em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.394772em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mord">â‚</span><span class="mord">â€“</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mord">áµ¢</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">x</span><span class="mord">â±¼</span><span class="mclose">)</span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathnormal">t</span><span class="mord">â‚</span></span></span></span>â€ƒ<br />å€¼åŸŸ (âˆ’âˆž,1]ï¼ŒåŒèº«ä»½æœŸæœ›ä¸ºæ­£ï¼Œå¼‚èº«ä»½æœŸæœ›ä¸ºè´Ÿã€‚</li></ul><ol start="2"><li><strong>è¿åŠ¨ç›¸å…³åº¦</strong>ï¼š</li></ol><ul><li>ç¦»çº¿ï¼šç”¨è®­ç»ƒé›†é‡Œå·²çŸ¥çš„çŸ­è½¨è¿¹ï¼ŒæŒ‰â€œå¸¸é€Ÿæ¨¡åž‹â€å‘å‰ã€å‘åŽå„é¢„æµ‹ 10 å¸§ï¼Œå¾—åˆ°é¢„æµ‹æ¡†ä¸ŽçœŸå®žæ¡†çš„ IoU è¯¯å·®ï¼Œç»Ÿè®¡å‡ºèƒ½æŠŠâ€œåŒä¸€è½¨è¿¹å¯¹â€ä¸Žâ€œä¸åŒè½¨è¿¹å¯¹â€åˆ†å¼€çš„è¯¯å·®é˜ˆå€¼$ t_m$ å’Œç¼©æ”¾å› å­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î±</mi></mrow><annotation encoding="application/x-tex">Î±</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span></span></span></span></li><li>åœ¨çº¿ï¼šå¯¹ä¸¤æ¡å¾…å…³è”è½¨è¿¹ï¼Œç”¨å„è‡ªæœ€è¿‘ 5 å¸§ä¼°é€Ÿåº¦ï¼Œé‡‡ç”¨çº¿æ€§åŒ€é€Ÿæ¨¡åž‹,å‰å‘-åŽå‘åŒå‘é¢„æµ‹ï¼Œå¾—è¯¯å·® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>e</mi><mi>m</mi></msub><mo>=</mo><msub><mi>e</mi><mi>f</mi></msub><mo>+</mo><msub><mi>e</mi><mi>b</mi></msub></mrow><annotation encoding="application/x-tex">e_m = e_f + e_b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8694379999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€‚<br />åœ¨è®­ç»ƒé›†ä¸Šæ‹Ÿåˆé˜ˆå€¼ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">t_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> åŠç¼©æ”¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î±</mi></mrow><annotation encoding="application/x-tex">Î±</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span></span></span></span>ï¼Œä»¤<br />â€ƒâ€ƒ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow><mi>M</mi></msubsup><mo>=</mo><mi>Î±</mi><mo stretchy="false">(</mo><msub><mi>t</mi><mi>m</mi></msub><mtext>â€“</mtext><msub><mi>e</mi><mi>m</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">w_{ij}^{M} = Î±(t_m â€“ e_m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.236103em;vertical-align:-0.394772em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-2.441336em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.394772em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">â€“</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>â€ƒâ€ƒè‹¥ e_m å¯è®¡ç®—ï¼›å¦åˆ™$ â€“âˆž$<br />ä¸ºæ­£ï¼Œé¼“åŠ±å…³è”ï¼Œä¸ºè´Ÿï¼Œæ‹’ç»ä¸å¯èƒ½è·³è·ƒ</li></ul><ol start="3"><li><p>æ—¶é—´æŠ˜æ‰£ï¼š<br />å¯¹æ—¶é—´å·® Î”t çš„ä¸¤æ£€æµ‹ï¼Œå¼•å…¥æŒ‡æ•°è¡°å‡ï¼Œ æƒ©ç½šâ€œæ—¶é—´éš”å¾—å¤ªè¿œâ€çš„è¾¹<br />â€ƒâ€ƒ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mtext>â€“</mtext><mi>Î²</mi><mi mathvariant="normal">Î”</mi><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">D_{ij} = exp(â€“Î²Î”t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord">â€“</span><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span><span class="mord">Î”</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></p></li><li><p>æœ€ç»ˆè¾¹æƒ<br />â€ƒâ€ƒ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mo>=</mo><mo stretchy="false">(</mo><msup><mi>W</mi><mi>A</mi></msup><mo>+</mo><msup><mi>W</mi><mi>M</mi></msup><mo stretchy="false">)</mo><mo>âŠ™</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">W = (W^{A} + W^{M}) âŠ™ D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âŠ™</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>â€ƒ<br />å…¶ä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âŠ™</mo></mrow><annotation encoding="application/x-tex">âŠ™</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">âŠ™</span></span></span></span> ä¸ºé€å…ƒç´ ä¹˜ã€‚</p></li></ol><h3 id="34-ç›¸å…³èšç±»ä¼˜åŒ–"><a class="markdownIt-Anchor" href="#34-ç›¸å…³èšç±»ä¼˜åŒ–"></a> 3.4 ç›¸å…³èšç±»ä¼˜åŒ–</h3><ol><li><p><strong>æž„é€ æ— å‘å›¾</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>=</mo><mo stretchy="false">(</mo><mi>V</mi><mo separator="true">,</mo><mi>E</mi><mo separator="true">,</mo><mi>W</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G=(V,E,W)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose">)</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span> ä¸ºæ‰€æœ‰æ£€æµ‹èŠ‚ç‚¹(æ¯ä¸€å¸§çš„æ¯ä¸ªæ£€æµ‹æ¡†å°±æ˜¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¸¦å±žæ€§ âŸ¨t, x, y, w, h, 128-D å‘é‡âŸ©ã€‚)ï¼Œè¾¹æƒ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span> å¦‚ä¸Š(æ­£å€¼ â†’ é¼“åŠ±åŒç°‡ï¼›è´Ÿå€¼ â†’ é¼“åŠ±å¼‚ç°‡)ã€‚</p></li><li><p><strong>ç›®æ ‡å‡½æ•°</strong>ï¼šæœ€å¤§åŒ–ä¸€è‡´è¾¹çš„æ€»æƒé‡ï¼Œç»™æ¯æ¡è¾¹ä¸€ä¸ªäºŒè¿›åˆ¶å˜é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mi>j</mi><mo>âˆˆ</mo><mrow><mn>0</mn><mo separator="true">,</mo><mn>1</mn></mrow></mrow><annotation encoding="application/x-tex">x_ij âˆˆ {0,1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span></span></span></span></span></p></li></ol><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x_{ij} = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>â€ƒâ‡’â€ƒ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> ä¸Ž <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> åŒèº«ä»½ï¼ˆæ”¾åœ¨åŒä¸€ç°‡ï¼‰</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x_{ij} = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>â€ƒâ‡’â€ƒ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> ä¸Ž <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> ä¸åŒèº«ä»½ï¼ˆåˆ†å±žä¸¤ç°‡ï¼‰<br />æ•´æ•°è§„åˆ’å°±æ˜¯</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>a</mi><mi>x</mi><mi mathvariant="normal">Î£</mi><msub><mi>w</mi><mi>i</mi></msub><mi>j</mi><msub><mi>x</mi><mi>i</mi></msub><mi>j</mi></mrow><annotation encoding="application/x-tex">max Î£ w_ij x_ij</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mord">Î£</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span><br />å°½é‡å¤šåœ°æŠŠæ­£å€¼è¾¹æ”¶è¿›ç°‡é‡Œï¼ŒæŠŠè´Ÿå€¼è¾¹è¸¢åˆ°ç°‡å¤–</li></ul><ol start="3"><li><strong>çº¦æŸæ¡ä»¶</strong>ï¼š</li></ol><ul><li>ä¼ é€’æ€§ï¼š<br />â€ƒâ€ƒ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>x</mi><mrow><mi>j</mi><mi>k</mi></mrow></msub><mo>â‰¤</mo><mn>1</mn><mo>+</mo><msub><mi>x</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">x_{ij} + x_{jk} â‰¤ 1 + x_{ik}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8694379999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.922078em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br />å³<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">i,j,k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> ä¸‰è€…ä¸­ï¼Œè‹¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i,j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> åŒèº«ä»½ï¼Œåˆ™ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo separator="true">,</mo><mi>k</mi><mo separator="true">,</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i,k,j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> åŒèº«ä»½ï¼Œå¿…é¡»æ»¡è¶³ä¼ é€’æ€§ã€‚</li></ul><ol start="4"><li><strong>æ±‚è§£æ–¹æ³•</strong>ï¼š<br />æ±‚è§£æ•´æ•°è§„åˆ’ï¼š</li></ol><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>X</mi><mo>âˆ—</mo><mo>=</mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>a</mi><msub><mi>x</mi><mrow><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>âˆˆ</mo><mrow><mn>0</mn><mo separator="true">,</mo><mn>1</mn></mrow></mrow></msub><munder><mo>âˆ‘</mo><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>âˆˆ</mo><mi>E</mi></mrow></munder><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mtext>â€ƒ</mtext><mi>s</mi><mi mathvariant="normal">.</mi><mi>t</mi><mi mathvariant="normal">.</mi><mtext>â€ƒ</mtext><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>x</mi><mrow><mi>j</mi><mi>k</mi></mrow></msub><mo>â‰¤</mo><mn>1</mn><mo>+</mo><msub><mi>x</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">X* = argmax_{x_{ij}âˆˆ{0,1}} âˆ‘_{(i,j)âˆˆE} w_{ij}x_{ij}  â€ƒs.t.â€ƒx_{ij}+x_{jk} â‰¤ 1+x_{ik}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mord">âˆ—</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.5660100000000003em;vertical-align:-1.516005em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">m</span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110800000000004em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span><span class="mrel mtight">âˆˆ</span><span class="mord mtight"><span class="mord mtight">0</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.34731999999999996em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.808995em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight">)</span><span class="mrel mtight">âˆˆ</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.516005em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord">â€ƒ</span><span class="mord mathnormal">s</span><span class="mord">.</span><span class="mord mathnormal">t</span><span class="mord">.</span><span class="mord">â€ƒ</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.922078em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>ç­‰ä»·äºŽæœ€å¤§ä¸€è‡´å­å›¾é—®é¢˜ï¼ŒNP-hardï¼Œä½†çŽ°æœ‰å¯å‘å¼ï¼ˆå¦‚ SAã€Greedy Agglomerativeï¼‰åœ¨åƒçº§èŠ‚ç‚¹ä¸Šè¶³å¤Ÿé«˜æ•ˆã€‚  è§£ä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">x_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>=1 è¡¨ç¤º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i,j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> åŒèº«ä»½ï¼Œç”±æ­¤å¾—åˆ°å…¨å±€èº«ä»½æ ‡ç­¾ã€‚</p><h3 id="35-åŽå¤„ç†"><a class="markdownIt-Anchor" href="#35-åŽå¤„ç†"></a> 3.5 åŽå¤„ç†</h3><ul><li>çº¿æ€§æ’å€¼ï¼šå¯¹åŒä¸€è½¨è¿¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><msub><mi>t</mi><mi>g</mi></msub><mi>a</mi><mi>p</mi><mo>â‰¤</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">0 &lt; t_gap â‰¤ 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68354em;vertical-align:-0.0391em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.922078em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord mathnormal">a</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span> s çš„æ¼æ£€åšçº¿æ€§æ’è¡¥ï¼›</li><li>ä½Žç½®ä¿¡ä¿®å‰ªï¼šè‹¥è½¨è¿¹æ£€æµ‹ç½®ä¿¡å‡å€¼ &lt; 0 æˆ–é•¿åº¦ &lt; 5 å¸§ï¼Œåˆ™ä¸¢å¼ƒã€‚</li></ul><h3 id="36-ä¸‰çº§å±‚æ¬¡æŽ¨ç†é™ä½Žå¤æ‚åº¦"><a class="markdownIt-Anchor" href="#36-ä¸‰çº§å±‚æ¬¡æŽ¨ç†é™ä½Žå¤æ‚åº¦"></a> 3.6 ä¸‰çº§å±‚æ¬¡æŽ¨ç†é™ä½Žå¤æ‚åº¦</h3><ol><li>Tracklet çº§ï¼š1 s ä¸é‡å æ»‘åŠ¨çª—å†…ç”¨è´ªå¿ƒæœ€è¿‘é‚»ç”ŸæˆçŸ­è½¨è¿¹ï¼›</li><li>å•ç›¸æœºçº§ï¼š10 s æ»‘åŠ¨çª—ï¼ˆ50 % é‡å ï¼‰å†…æŠŠ tracklet ä½œä¸ºèŠ‚ç‚¹ï¼Œé‡å¤ 3.3-3.4 æ­¥éª¤ï¼›</li><li>è·¨ç›¸æœºçº§ï¼š1.5 min æ»‘åŠ¨çª—ï¼ŒæŠŠå•ç›¸æœºè½¨è¿¹ä½œä¸ºèŠ‚ç‚¹ï¼Œé‡å¤ 3.3-3.4 æ­¥éª¤ï¼Œå¾—åˆ°æœ€ç»ˆè·¨ç›¸æœº IDã€‚</li></ol><hr />]]></content>
    
    
    <summary type="html">&lt;p&gt;æ¢³ç†MTMCé—®é¢˜ç»å…¸è®ºæ–‡Features for Multi-Target Multi-Camera Tracking and Re-Identificationä¸­çš„æ–¹æ³•ã€‚&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>åŸºäºŽä¸‰ç»´æ¨¡åž‹çš„ç›‘æŽ§ç”»é¢æ¨¡æ‹Ÿä¸Žæ·±åº¦æ ‡å®šå·¥å…·å¼€å‘</title>
    <link href="https://atffang.github.io/2025/11/05/%E5%9F%BA%E4%BA%8E%E4%B8%89%E7%BB%B4%E6%A8%A1%E5%9E%8B%E7%9A%84%E7%9B%91%E6%8E%A7%E7%94%BB%E9%9D%A2%E6%A8%A1%E6%8B%9F%E4%B8%8E%E6%B7%B1%E5%BA%A6%E6%A0%87%E5%AE%9A%E5%B7%A5%E5%85%B7%E5%BC%80%E5%8F%91/"/>
    <id>https://atffang.github.io/2025/11/05/%E5%9F%BA%E4%BA%8E%E4%B8%89%E7%BB%B4%E6%A8%A1%E5%9E%8B%E7%9A%84%E7%9B%91%E6%8E%A7%E7%94%BB%E9%9D%A2%E6%A8%A1%E6%8B%9F%E4%B8%8E%E6%B7%B1%E5%BA%A6%E6%A0%87%E5%AE%9A%E5%B7%A5%E5%85%B7%E5%BC%80%E5%8F%91/</id>
    <published>2025-11-05T11:07:07.000Z</published>
    <updated>2025-11-05T11:42:30.444Z</updated>
    
    <content type="html"><![CDATA[<p>åŸºäºŽä¸‰ç»´æ¨¡åž‹çš„ç›‘æŽ§ç”»é¢æ¨¡æ‹Ÿä¸Žæ·±åº¦æ ‡å®šå·¥å…·å¼€å‘ã€‚åŸºäºŽVue + vite + electron + cesiumçš„æ¡Œé¢ç«¯è½¯ä»¶ã€‚</p><span id="more"></span><p>æœ€è¿‘åšçš„æ–¹å‘æœ‰è¿™æ ·ä¸€ä¸ªéœ€æ±‚ï¼šè®¡ç®—ç ”ç©¶åŒºåŸŸçš„ä¼—å¤šç›‘æŽ§æ‘„åƒå¤´ç”»é¢å¯¹åº”çš„æ·±åº¦å›¾ï¼Œå³èƒ½å¤Ÿå¾—åˆ°ç”»é¢ä¸Šåƒç´ ç‚¹å¯¹åº”çš„çœŸå®žä¸–ç•Œåæ ‡ã€‚å› æ­¤ï¼Œå¼€å‘äº†ä¸€æ¬¾åŸºäºŽElectron+Vueçš„ï¼Œä¾èµ–Cesiumå¯è§†åŒ–ç ”ç©¶åŒºåŸŸä¸‰ç»´æ¨¡åž‹ï¼ˆ3dtilesï¼‰çš„æ¡Œé¢ç«¯è½¯ä»¶Oculusï¼Œå¹¶æ¨¡æ‹Ÿç›‘æŽ§ç”»é¢ä¸Žè§†é”¥ï¼Œä»¥æ­¤åšåˆ°çœŸå®žç”»é¢ä¸Žä¸‰ç»´æ¨¡åž‹åŒ¹é…ï¼Œä»Žè€Œå¾—åˆ°çœŸå®žç”»é¢æ·±åº¦ã€‚</p><img src="https://atffang.github.io/2025/11/05/åŸºäºŽä¸‰ç»´æ¨¡åž‹çš„ç›‘æŽ§ç”»é¢æ¨¡æ‹Ÿä¸Žæ·±åº¦æ ‡å®šå·¥å…·å¼€å‘/æ“ä½œè¿‡ç¨‹.gif"/><p>Oculusçš„ä¸»é¡µé¢å¦‚ä¸‹ï¼š<br /><img src="https://atffang.github.io/2025/11/05/åŸºäºŽä¸‰ç»´æ¨¡åž‹çš„ç›‘æŽ§ç”»é¢æ¨¡æ‹Ÿä¸Žæ·±åº¦æ ‡å®šå·¥å…·å¼€å‘/ä¸»é¡µ.jpg"/></p><p>é€šè¿‡æŸ¥è¯¢å¹¶ç‚¹å‡»å³ä¾§çš„æ‘„åƒå¤´ä¿¡æ¯æ»šåŠ¨æ æˆ–è€…ç‚¹å‡»å·¦ä¾§åœ°å›¾ä¸­çš„æ‘„åƒå¤´å›¾æ ‡ï¼Œå¯ä»¥ç´¢å¼•åˆ°è¯¥æ‘„åƒå¤´çš„ä½ç½®ï¼Œå¹¶åœ¨åœ°å›¾å³ä¸Šè§’å¼¹å‡ºå…·ä½“ä¿¡æ¯ï¼Œè½¯ä»¶å³ä¸Šè§’å‡ºçŽ°æ‘„åƒå¤´ç”»é¢ã€‚</p><p>ç»§ç»­ç‚¹å‡»å³ä¾§æ çš„ç›¸åº”æ‘„åƒå¤´ç¼–è¾‘æŒ‰é’®ï¼Œæ‰“å¼€ç¼–è¾‘çª—å£å¦‚ä¸‹ã€‚<br /><img src="https://atffang.github.io/2025/11/05/åŸºäºŽä¸‰ç»´æ¨¡åž‹çš„ç›‘æŽ§ç”»é¢æ¨¡æ‹Ÿä¸Žæ·±åº¦æ ‡å®šå·¥å…·å¼€å‘/è§†é”¥ç”»é¢.png"/></p><p>å·¦ä¾§ä¸ºæ‘„åƒå¤´åŸºç¡€å‚æ•°ç¼–è¾‘åŒºåŸŸï¼ŒåŒ…æ‹¬ç»çº¬åº¦ä¸Žé«˜ç¨‹ï¼Œèˆªå‘è§’ã€ä¿¯ä»°è§’ï¼Œåž‚ç›´è§†åœºè§’ï¼Œå®½é«˜æ¯”ï¼Œè¿œè¿‘å¹³é¢è·ç¦»ã€‚ä¿®æ”¹åŽï¼Œå³ä¾§è§†é”¥ä¹Ÿä¼šéšç€å‚æ•°å˜åŒ–å®žæ—¶æ¸²æŸ“ã€‚</p><p>ç‚¹å‡»åˆ‡æ¢ä¸ºç›‘æŽ§è§†è§’ï¼Œå³å¯è§‚å¯Ÿåˆ°æ¨¡æ‹Ÿç›‘æŽ§è§†è§’ç”»é¢ï¼Œé€šè¿‡è°ƒæ•´å‚æ•°ï¼Œè¾¾åˆ°å’Œç›‘æŽ§ç”»é¢å‡ ä¹Žä¸€æ ·çš„è§†åŸŸï¼ŒåŒæ—¶ï¼Œä¸ºäº†è¾…åŠ©å¯¹æ¯”ï¼ŒçœŸå®žç”»é¢ä¸Žæ¨¡æ‹Ÿç”»é¢ç›¸åº”çš„ä½ç½®å­˜åœ¨äº”ä¸ªè¾…åŠ©é”šå®šç‚¹ã€‚<br /><img src="https://atffang.github.io/2025/11/05/åŸºäºŽä¸‰ç»´æ¨¡åž‹çš„ç›‘æŽ§ç”»é¢æ¨¡æ‹Ÿä¸Žæ·±åº¦æ ‡å®šå·¥å…·å¼€å‘/æ¨¡æ‹Ÿç”»é¢.png"/></p><p>åœ¨è°ƒæ•´å¥½å‚æ•°åŽï¼Œå¯ä»¥ç‚¹å‡»ç”Ÿæˆç¨€ç–æ·±åº¦æŒ‰é’®ï¼Œè½¯ä»¶å°†é€‰å–ç”»é¢ä¸Š2000ä¸ªç‚¹ï¼Œè®¡ç®—å…¶çœŸå®žçš„ä¸‰ç»´åæ ‡ï¼Œå¹¶ä¸‹è½½ï¼ŒåŒæ—¶ä¸‹è½½çš„è¿˜æœ‰çœŸå®žæ‘„åƒå¤´ç”»é¢ã€‚<br /><img src="https://atffang.github.io/2025/11/05/åŸºäºŽä¸‰ç»´æ¨¡åž‹çš„ç›‘æŽ§ç”»é¢æ¨¡æ‹Ÿä¸Žæ·±åº¦æ ‡å®šå·¥å…·å¼€å‘/æ·±åº¦æ ‡å®š.png"/></p><p>ä¸ºäº†æ£€æµ‹ç”Ÿæˆçš„ç‚¹æ˜¯å¦æ­£ç¡®ï¼Œæˆ‘ä»¬å°†å…¶å€’å…¥cesiumä¸­ï¼ŒåŒæ—¶åŠ è½½å’Œä¸Šæ–‡ç›¸åŒçš„ä¸‰ç»´æ¨¡åž‹ï¼Œæ•ˆæžœå¦‚ä¸‹ï¼š<br /><img src="https://atffang.github.io/2025/11/05/åŸºäºŽä¸‰ç»´æ¨¡åž‹çš„ç›‘æŽ§ç”»é¢æ¨¡æ‹Ÿä¸Žæ·±åº¦æ ‡å®šå·¥å…·å¼€å‘/æ ‡å®šç‚¹01.png"/></p><img src="https://atffang.github.io/2025/11/05/åŸºäºŽä¸‰ç»´æ¨¡åž‹çš„ç›‘æŽ§ç”»é¢æ¨¡æ‹Ÿä¸Žæ·±åº¦æ ‡å®šå·¥å…·å¼€å‘/æ ‡å®šç‚¹02.png"/><p>è¿™æ ·çš„æ•ˆæžœè¯æ˜Žï¼Œæˆ‘ä»¬æ ‡å®šçš„åæ ‡åŸºæœ¬ä¸Šæ˜¯æ­£ç¡®çš„ï¼ŒåŽç»­å¯ä»¥é€šè¿‡é«˜ç¨‹ç­›é€‰zå€¼ï¼Œæˆ–è€…é€šè¿‡åˆ†å¸ƒç­›é€‰ï¼Œä»¥é€‰å–ç¬¦åˆç›®çš„çš„ç‚¹ã€‚<br /><img src="https://atffang.github.io/2025/11/05/åŸºäºŽä¸‰ç»´æ¨¡åž‹çš„ç›‘æŽ§ç”»é¢æ¨¡æ‹Ÿä¸Žæ·±åº¦æ ‡å®šå·¥å…·å¼€å‘/zå€¼åŒºé—´.png"/></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;åŸºäºŽä¸‰ç»´æ¨¡åž‹çš„ç›‘æŽ§ç”»é¢æ¨¡æ‹Ÿä¸Žæ·±åº¦æ ‡å®šå·¥å…·å¼€å‘ã€‚åŸºäºŽVue + vite + electron + cesiumçš„æ¡Œé¢ç«¯è½¯ä»¶ã€‚&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>Datahader.Networks ç»˜åˆ¶bundling flow</title>
    <link href="https://atffang.github.io/2025/11/01/Datahader.Networks%20%E7%BB%98%E5%88%B6bundling%20flow/"/>
    <id>https://atffang.github.io/2025/11/01/Datahader.Networks%20%E7%BB%98%E5%88%B6bundling%20flow/</id>
    <published>2025-11-01T11:16:07.000Z</published>
    <updated>2025-11-05T11:00:19.610Z</updated>
    
    <content type="html"><![CDATA[<p>Datahader.Networks ç»˜åˆ¶bundling flow</p><span id="more"></span><p>è¯¦ç»†æ–‡æ¡£å‚è§ <a href="https://datashader.org/user_guide/Networks.html">https://datashader.org/user_guide/Networks.html</a></p><p>æˆ‘ä»¬æ›¾ç»ä»‹ç»äº†ç»˜åˆ¶æ™®é€šæµçš„æ–¹å¼ï¼Œå®žé™…ä¸Šä»…ä»…æ˜¯åŸºäºŽè´å¡žå°”æ›²çº¿åšäº†æ’å€¼ï¼Œç»˜åˆ¶äº†ç±»ä¼¼äºŽâ€œé£žæœºèˆªçº¿â€çš„æµçº¿ã€‚ä½¿ç”¨ç®€å•çš„arcgisæ’ä»¶ï¼Œä¹Ÿå¯ä»¥ç»˜åˆ¶å¾ˆä¸é”™ç›´è§‚çš„æµå›¾ï¼Œæ¯”å¦‚ä¸‹é¢æˆ‘ç”»çš„ä¸­å›½äººå£æµåŠ¨å›¾ï¼š<br /><img src="https://atffang.github.io/2025/11/01/Datahader.Networks ç»˜åˆ¶bundling flow/ä¸­å›½äººå£æµåŠ¨.png"/></p><p>ä½†æ˜¯è¿™ç§æµç»˜åˆ¶æ–¹å¼è™½ç„¶æœ€ä¸ºç›´è§‚ã€è¡¨è¾¾æœ€ä¸ºå‡†ç¡®ï¼Œä½†æœ‰æ—¶å€™ï¼ˆç‰¹åˆ«æ˜¯è¾¹æƒå·®å¼‚ä¸å¤§çš„æ—¶å€™ï¼‰åƒè¿›äº†ç›˜ä¸æ´žï¼Œä»Žå›¾ä¸Šæ— æ³•æç‚¼å‡ºå¤ªå¤šçš„ä¿¡æ¯ï¼Œå› æ­¤ï¼Œç”²æ–¹è¦æ±‚æˆ‘å¯¹å°çº¢ä¹¦ä¸Šä¸€ä¸ªåšä¸»ç»˜åˆ¶çš„å…·æœ‰èšé›†æ•ˆåº”çš„æµå›¾è¿›è¡Œå¤çŽ°ï¼Œæˆ‘å…ˆè¯•äº†jsåº“d3:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">generateSegments</span>(<span class="params">nodes, links</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> bundle = &#123; <span class="attr">nodes</span>: [], <span class="attr">links</span>: [], <span class="attr">paths</span>: [] &#125;;</span><br><span class="line">  bundle.<span class="property">nodes</span> = nodes.<span class="title function_">map</span>(<span class="function"><span class="params">d</span> =&gt;</span> &#123; d.<span class="property">fx</span> = d.<span class="property">x</span>; d.<span class="property">fy</span> = d.<span class="property">y</span>; <span class="keyword">return</span> d; &#125;);</span><br><span class="line"></span><br><span class="line">  links.<span class="title function_">forEach</span>(<span class="function"><span class="params">d</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> length = <span class="title function_">distance</span>(d.<span class="property">source</span>, d.<span class="property">target</span>);</span><br><span class="line">    <span class="keyword">let</span> total = <span class="title class_">Math</span>.<span class="title function_">round</span>(scales.<span class="title function_">segments</span>(length));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> xscale = d3.<span class="title function_">scaleLinear</span>().<span class="title function_">domain</span>([<span class="number">0</span>, total + <span class="number">1</span>]).<span class="title function_">range</span>([d.<span class="property">source</span>.<span class="property">x</span>, d.<span class="property">target</span>.<span class="property">x</span>]);</span><br><span class="line">    <span class="keyword">let</span> yscale = d3.<span class="title function_">scaleLinear</span>().<span class="title function_">domain</span>([<span class="number">0</span>, total + <span class="number">1</span>]).<span class="title function_">range</span>([d.<span class="property">source</span>.<span class="property">y</span>, d.<span class="property">target</span>.<span class="property">y</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> source = d.<span class="property">source</span>;</span><br><span class="line">    <span class="keyword">let</span> local = [source];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">1</span>; j &lt;= total; j++) &#123;</span><br><span class="line">      <span class="keyword">let</span> target = &#123; <span class="attr">x</span>: <span class="title function_">xscale</span>(j), <span class="attr">y</span>: <span class="title function_">yscale</span>(j) &#125;;</span><br><span class="line">      local.<span class="title function_">push</span>(target);</span><br><span class="line">      bundle.<span class="property">nodes</span>.<span class="title function_">push</span>(target);</span><br><span class="line">      bundle.<span class="property">links</span>.<span class="title function_">push</span>(&#123; source, target &#125;);</span><br><span class="line">      source = target;</span><br><span class="line">    &#125;</span><br><span class="line">    local.<span class="title function_">push</span>(d.<span class="property">target</span>);</span><br><span class="line">    bundle.<span class="property">links</span>.<span class="title function_">push</span>(&#123; source, <span class="attr">target</span>: d.<span class="property">target</span> &#125;);</span><br><span class="line">    bundle.<span class="property">paths</span>.<span class="title function_">push</span>(local);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> bundle;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¤§æ¦‚å®žçŽ°äº†ä¸‹é¢çš„åœºæ™¯ï¼š<br /><img src="https://atffang.github.io/2025/11/01/Datahader.Networks ç»˜åˆ¶bundling flow/js.png"/></p><p>ä¸è¿‡è¿™ç§ç»˜åˆ¶æ–¹æ³•ä»ç„¶æ— æ³•è¾¾åˆ°ç±»ä¼¼çš„æ•ˆæžœï¼Œé‚æŠ›å¼ƒä¹‹ï¼Œæ‰¾åˆ°äº†è¯¥åšä¸»å¤„ç†æµæ•°æ®çš„åº“ï¼š<strong>datashader</strong>ï¼ŒæŽ¥ä¸‹æ¥æˆ‘ä»¬è¯¦ç»†è®²è®²å¦‚ä½•åˆ©ç”¨datashader.Networksè¿›è¡Œç»˜åˆ¶ï¼Œå…ˆçœ‹çœ‹user guideä¸­å¯¹è¯¥éƒ¨åˆ†çš„ç®€ä»‹ï¼š</p><p>The point and line-segment plotting provided by Datashader can be put together in different ways to visualize specific types of data. For instance, network graph data, i.e., networks of nodes connected by edges, can very naturally be represented by points and lines. Here we will show examples of using Datashaderâ€™s graph-specific plotting tools, focusing on how to visualize very large graphs while allowing any portion of the rendering pipeline to replaced with components suitable for specific problems.</p><p>Datashader ä½¿ç”¨ <strong>Hammer et al. (2009)</strong> æå‡ºçš„ â€œForce-Directed Edge Bundling (FDEB)â€ ç®—æ³•çš„æ”¹è¿›ç‰ˆï¼Œè®©ç›¸ä¼¼æˆ–ç©ºé—´ä¸Šé‚»è¿‘çš„è¾¹â€œé æ‹¢â€æˆå¹³æ»‘çš„æµçº¿ï¼ˆbundlesï¼‰ï¼Œæ—¢ä¿æŒç»“æž„å…³ç³»ï¼Œåˆæå‡å¯è¯»æ€§ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œå¯¹äºŽæ¯æ¡è¾¹ï¼Œä»–ä»¬ä¼šè¢«æ‹†åˆ†ä¸ºå¤šä¸ªå°æ®µï¼ˆsegmentsï¼‰ï¼Œæ¯ä¸ª segment æ˜¯ä¸€ä¸ªå¯ç§»åŠ¨çš„æŽ§åˆ¶ç‚¹ã€‚æ¯ä¸ªæŽ§åˆ¶ç‚¹ä¼šå—åˆ°å‡ ç§åŠ›çš„ä½œç”¨ï¼š</p><ul><li><ol><li><strong>å†…éƒ¨å¼ åŠ› (Tension)</strong></li></ol></li><li><ol start="2"><li><strong>ç›¸ä¼¼è¾¹å¸å¼•åŠ› (Attractive force)</strong></li></ol></li><li><ol start="3"><li><strong>å¸¦å®½æŽ§åˆ¶ (Bandwidth)</strong></li></ol></li></ul><p>é€šè¿‡å¤šæ¬¡è¿­ä»£ï¼Œæ–¹æ³•ä½¿å¾—å¸¦å®½é€æ¬¡å˜å°ï¼Œä½¿å¾—æµäº’ç›¸é è¿‘ï¼Œå½¢æˆæŸçŠ¶ç»“æž„ã€‚</p><p>æˆ‘ä»¬æ¥å¤çŽ°ä¸€ä¸‹user guideæä¾›çš„ç¤ºä¾‹ä»£ç <br />å¯¼å…¥åŒ…</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> datashader <span class="keyword">as</span> ds</span><br><span class="line"><span class="keyword">import</span> datashader.transfer_functions <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">from</span> datashader.layout <span class="keyword">import</span> random_layout, circular_layout, forceatlas2_layout</span><br><span class="line"><span class="keyword">from</span> datashader.bundling <span class="keyword">import</span> connect_edges, hammer_bundle</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> chain</span><br></pre></td></tr></table></figure><p>éšæœºç”Ÿæˆè¾¹ä¸ŽèŠ‚ç‚¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">np.random.seed(<span class="number">0</span>)</span><br><span class="line">n=<span class="number">100</span></span><br><span class="line">m=<span class="number">20000</span></span><br><span class="line"></span><br><span class="line">nodes = pd.DataFrame([<span class="string">&quot;node&quot;</span>+<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)], columns=[<span class="string">&#x27;name&#x27;</span>])</span><br><span class="line">edges = pd.DataFrame(np.random.randint(<span class="number">0</span>,<span class="built_in">len</span>(nodes), size=(m, <span class="number">2</span>)), columns=[<span class="string">&#x27;source&#x27;</span>, <span class="string">&#x27;target&#x27;</span>])</span><br><span class="line"></span><br><span class="line">circular = circular_layout(nodes, uniform=<span class="literal">False</span>)</span><br><span class="line">randomloc = random_layout(nodes)</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆå¸ƒå±€ä¸Žå®šä¹‰ä¸€äº›ç»˜åˆ¶å‡½æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">cvsopts = <span class="built_in">dict</span>(plot_height=<span class="number">400</span>, plot_width=<span class="number">400</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nodesplot</span>(<span class="params">nodes, name=<span class="literal">None</span>, canvas=<span class="literal">None</span>, cat=<span class="literal">None</span></span>):</span><br><span class="line">    canvas = ds.Canvas(**cvsopts) <span class="keyword">if</span> canvas <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">else</span> canvas</span><br><span class="line">    aggregator=<span class="literal">None</span> <span class="keyword">if</span> cat <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">else</span> ds.count_cat(cat)</span><br><span class="line">    agg=canvas.points(nodes,<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;y&#x27;</span>,aggregator)</span><br><span class="line">    <span class="keyword">return</span> tf.spread(tf.shade(agg, cmap=[<span class="string">&quot;#FF3333&quot;</span>]), px=<span class="number">3</span>, name=name)</span><br><span class="line">    </span><br><span class="line">forcedirected = forceatlas2_layout(nodes, edges)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edgesplot</span>(<span class="params">edges, name=<span class="literal">None</span>, canvas=<span class="literal">None</span></span>):</span><br><span class="line">    canvas = ds.Canvas(**cvsopts) <span class="keyword">if</span> canvas <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">else</span> canvas</span><br><span class="line">    <span class="keyword">return</span> tf.shade(canvas.line(edges, <span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;y&#x27;</span>, agg=ds.count()), name=name)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">graphplot</span>(<span class="params">nodes, edges, name=<span class="string">&quot;&quot;</span>, canvas=<span class="literal">None</span>, cat=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> canvas <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        xr = nodes.x.<span class="built_in">min</span>(), nodes.x.<span class="built_in">max</span>()</span><br><span class="line">        yr = nodes.y.<span class="built_in">min</span>(), nodes.y.<span class="built_in">max</span>()</span><br><span class="line">        canvas = ds.Canvas(x_range=xr, y_range=yr, **cvsopts)</span><br><span class="line"></span><br><span class="line">    np = nodesplot(nodes, name + <span class="string">&quot; nodes&quot;</span>, canvas, cat)</span><br><span class="line">    ep = edgesplot(edges, name + <span class="string">&quot; edges&quot;</span>, canvas)</span><br><span class="line">    <span class="keyword">return</span> tf.stack(ep, np, how=<span class="string">&quot;over&quot;</span>, name=name)</span><br></pre></td></tr></table></figure><p>ç»˜åˆ¶ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cd = circular</span><br><span class="line">fd = forcedirected</span><br><span class="line"></span><br><span class="line">cd_d = graphplot(cd, connect_edges(cd,edges), <span class="string">&quot;Circular layout&quot;</span>)</span><br><span class="line">fd_d = graphplot(fd, connect_edges(fd,edges), <span class="string">&quot;Force-directed&quot;</span>)</span><br><span class="line">cd_b = graphplot(cd, hammer_bundle(cd,edges), <span class="string">&quot;Circular layout, bundled&quot;</span>)</span><br><span class="line">fd_b = graphplot(fd, hammer_bundle(fd,edges), <span class="string">&quot;Force-directed, bundled&quot;</span>)</span><br><span class="line"></span><br><span class="line">tf.Images(cd_d,fd_d,cd_b,fd_b).cols(<span class="number">2</span>)</span><br></pre></td></tr></table></figure><img src="https://atffang.github.io/2025/11/01/Datahader.Networks ç»˜åˆ¶bundling flow/exam.png"/><p>è¿˜æ˜¯æŒºæ–¹ä¾¿çš„ã€‚æŽ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨è‡ªå·±çš„æ•°æ®è¿›è¡Œç»˜åˆ¶ã€‚å¿…è¦çš„æ•°æ®åŒ…æ‹¬nodeï¼ˆåŒ…å«nameä¸Žxyåæ ‡ï¼‰å’Œedgeï¼ˆåŒ…å«ä»£è¡¨odçš„sourceå’Œtargetï¼Œå¯è‡ªè¡Œé€‰æ‹©æ˜¯å¦åŠ ä¸Šweightï¼‰ã€‚<br />å¯¼å…¥åŒ…ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> datashader.bundling <span class="keyword">import</span> hammer_bundle</span><br><span class="line"><span class="keyword">import</span> pyproj</span><br><span class="line"><span class="keyword">import</span> geopandas <span class="keyword">as</span> gpd</span><br><span class="line"><span class="keyword">from</span> shapely.geometry <span class="keyword">import</span> LineString</span><br></pre></td></tr></table></figure><p>åŠ è½½æ•°æ®ï¼Œå¹¶æ˜ å°„ä¸€ä¸‹å­—æ®µååˆ°å…¶è¦æ±‚çš„å€¼ï¼Œå¹¶ä¸”æŠ•å½±åæ ‡ä»¥ç»˜åˆ¶ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªéžå¸¸å‘çš„è¦ç‚¹ï¼š<br /><strong>node çš„ indexï¼ˆpandas.dataframeçš„indexï¼‰æ‰æ˜¯å’Œ edge çš„ source ä¸Ž target åŒ¹é…çš„ key ï¼Œè€Œä¸æ˜¯ name å­—æ®µã€‚</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">china_edge = pd.read_csv(<span class="string">&quot;/Users/fangtianyao/Desktop/å…¶ä»–/flowdata/edge_1.csv&quot;</span>)</span><br><span class="line">china_node = pd.read_csv(<span class="string">&quot;/Users/fangtianyao/Desktop/å…¶ä»–/flowdata/node_with_name.csv&quot;</span>)</span><br><span class="line">nodes = china_node[[<span class="string">&#x27;iata&#x27;</span>, <span class="string">&#x27;longitude&#x27;</span>, <span class="string">&#x27;latitude&#x27;</span>]].rename(</span><br><span class="line">    columns=&#123;<span class="string">&#x27;iata&#x27;</span>: <span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;longitude&#x27;</span>: <span class="string">&#x27;x84&#x27;</span>, <span class="string">&#x27;latitude&#x27;</span>: <span class="string">&#x27;y84&#x27;</span>&#125;</span><br><span class="line">)</span><br><span class="line">edges = china_edge[[<span class="string">&#x27;origin&#x27;</span>, <span class="string">&#x27;destination&#x27;</span>, <span class="string">&#x27;count&#x27;</span>]].rename(</span><br><span class="line">    columns=&#123;<span class="string">&#x27;origin&#x27;</span>: <span class="string">&#x27;source&#x27;</span>, <span class="string">&#x27;destination&#x27;</span>: <span class="string">&#x27;target&#x27;</span>, <span class="string">&#x27;count&#x27;</span>: <span class="string">&#x27;weight&#x27;</span>&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">proj = pyproj.Transformer.from_crs(<span class="string">&quot;EPSG:4326&quot;</span>, <span class="string">&quot;EPSG:3857&quot;</span>, always_xy=<span class="literal">True</span>)</span><br><span class="line">nodes[<span class="string">&#x27;x&#x27;</span>], nodes[<span class="string">&#x27;y&#x27;</span>] = proj.transform(nodes[<span class="string">&#x27;x84&#x27;</span>], nodes[<span class="string">&#x27;y84&#x27;</span>])</span><br><span class="line">layout = nodes.copy()</span><br><span class="line">layout.index = layout[<span class="string">&#x27;name&#x27;</span>].astype(<span class="built_in">int</span>)</span><br><span class="line">layout.index.name = <span class="literal">None</span></span><br></pre></td></tr></table></figure><p>è°ƒç”¨<code>hammer_bundle</code>è®¡ç®—ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bundled_edges = hammer_bundle(layout, edges, decay=decay, initial_bandwidth=bw)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„ <code>decay</code> å’Œ <code>bw</code> æ˜¯ä¸¤ä¸ª0-1çš„å‚æ•°ï¼Œè¿™é‡Œæˆ‘ä»¬å…ˆåˆ†åˆ«å–0.5ã€‚</p><p>è®¡ç®—å¾—åˆ°çš„ <code>bundled_edges </code> æ˜¯ä¸€ä¸ªåŒ…å«æ‰€æœ‰æ‰­æ›²è¿‡åŽçš„è¾¹çš„æ‰€æœ‰æž„æˆç‚¹çš„dfï¼Œæ¯æ¡è¾¹çš„ç‚¹ä¹‹é—´ç”¨ä¸€ä¸ªç©ºè¡Œç›¸éš”ã€‚æ‰“å°ç»™ä½ çœ‹çœ‹ã€‚</p><table><thead><tr><th></th><th>x</th><th>y</th><th>weight</th></tr></thead><tbody><tr><td>1301138</td><td>1.257390e+07</td><td>2.951534e+06</td><td>7.0</td></tr><tr><td>1301139</td><td>1.258085e+07</td><td>2.914048e+06</td><td>7.0</td></tr><tr><td>1301140</td><td>1.258971e+07</td><td>2.877599e+06</td><td>7.0</td></tr><tr><td>1301141</td><td>1.264494e+07</td><td>2.852891e+06</td><td>7.0</td></tr><tr><td>1301142</td><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><td></td><td></td><td></td><td></td></tr></tbody></table><p>ä¸ºäº†ç»˜åˆ¶ï¼Œæˆ‘ä»¬ä½¿ç”¨è¯¥æ•°æ®åˆ›å»º GeoDataFrameï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">lines = []</span><br><span class="line">current_points = []</span><br><span class="line">current_weight = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> idx, row <span class="keyword">in</span> bundled_edges.iterrows():</span><br><span class="line">    <span class="keyword">if</span> pd.isna(row[<span class="string">&#x27;x&#x27;</span>]) <span class="keyword">or</span> pd.isna(row[<span class="string">&#x27;y&#x27;</span>]):</span><br><span class="line">        <span class="comment"># é‡åˆ°ç©ºè¡Œï¼Œç”Ÿæˆä¸Šä¸€æ¡è¾¹</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(current_points) &gt;= <span class="number">2</span>:</span><br><span class="line">            line = LineString(current_points)</span><br><span class="line">            lines.append(&#123;<span class="string">&#x27;weight&#x27;</span>: current_weight, <span class="string">&#x27;geometry&#x27;</span>: line&#125;)</span><br><span class="line">        current_points = []</span><br><span class="line">        current_weight = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        current_points.append((row[<span class="string">&#x27;x&#x27;</span>], row[<span class="string">&#x27;y&#x27;</span>]))</span><br><span class="line">        <span class="comment"># å‡è®¾ weight ç›¸åŒï¼Œå–ç¬¬ä¸€ä¸ªç‚¹çš„ weight</span></span><br><span class="line">        <span class="keyword">if</span> current_weight <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            current_weight = row[<span class="string">&#x27;weight&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(current_points) &gt;= <span class="number">2</span>:</span><br><span class="line">    line = LineString(current_points)</span><br><span class="line">    lines.append(&#123;<span class="string">&#x27;weight&#x27;</span>: current_weight, <span class="string">&#x27;geometry&#x27;</span>: line&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»º GeoDataFrame</span></span><br><span class="line">gdf = gpd.GeoDataFrame(lines, crs=<span class="string">&quot;EPSG:3857&quot;</span>)</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ç”¨è¿™ä¸ªæ•°æ®ç»˜åˆ¶æµåœ¨åœ°å›¾ä¸Šï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> geopandas <span class="keyword">as</span> gpd</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> shapely.geometry <span class="keyword">import</span> Point</span><br><span class="line"><span class="keyword">import</span> contextily <span class="keyword">as</span> ctx</span><br><span class="line"></span><br><span class="line">nodes_gdf = gpd.GeoDataFrame(</span><br><span class="line">    nodes,</span><br><span class="line">    geometry=[Point(xy) <span class="keyword">for</span> xy <span class="keyword">in</span> <span class="built_in">zip</span>(nodes[<span class="string">&#x27;x&#x27;</span>], nodes[<span class="string">&#x27;y&#x27;</span>])],</span><br><span class="line">    crs=<span class="string">&quot;EPSG:3857&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">edges_gdf = gdf.copy()</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—çº¿å®½</span></span><br><span class="line">min_width = <span class="number">0.2</span></span><br><span class="line">max_width = <span class="number">5.0</span></span><br><span class="line">weights = edges_gdf[<span class="string">&#x27;weight&#x27;</span>].astype(<span class="built_in">float</span>)</span><br><span class="line">line_widths = min_width + (weights - weights.<span class="built_in">min</span>()) / (weights.<span class="built_in">max</span>() - weights.<span class="built_in">min</span>()) * (max_width - min_width)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»˜å›¾</span></span><br><span class="line">fig, ax = plt.subplots(figsize=(<span class="number">12</span>, <span class="number">10</span>), dpi=<span class="number">300</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”»è¾¹</span></span><br><span class="line">edges_gdf.plot(ax=ax, linewidth=line_widths, edgecolor=<span class="string">&#x27;#305669&#x27;</span>, alpha=<span class="number">0.6</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”»èŠ‚ç‚¹</span></span><br><span class="line">nodes_gdf.plot(ax=ax, color=<span class="string">&#x27;#0C2B4E&#x27;</span>, markersize=<span class="number">15</span>, alpha=<span class="number">0.9</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ åº•å›¾</span></span><br><span class="line">ctx.add_basemap(ax, source=ctx.providers.OpenStreetMap.Mapnik, crs=nodes_gdf.crs)</span><br><span class="line"></span><br><span class="line">ax.set_title(<span class="string">&quot;fty&quot;</span>, fontsize=<span class="number">16</span>)</span><br><span class="line">ax.set_xlabel(<span class="string">&quot;Longitude&quot;</span>)</span><br><span class="line">ax.set_ylabel(<span class="string">&quot;Latitude&quot;</span>)</span><br><span class="line">plt.axis(<span class="string">&#x27;equal&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><img src="https://atffang.github.io/2025/11/01/Datahader.Networks ç»˜åˆ¶bundling flow/part.png"/><p>ä¸ºäº†æ¯”è¾ƒä¸åŒ <code>decay</code> å’Œ <code>bw</code> å‚æ•°ç»„åˆçš„æ•ˆæžœï¼Œæˆ‘åšäº†ä¸€ä¸ªå°ç»„åˆæµ‹è¯•ï¼Œè¯»è€…å¯ä»¥è‡ªå·±è¿›è¡Œæµ‹è¯•ï¼Œäº¦å¯ä»¥å‚è€ƒä¸‹user guideé‡Œé¢åŸºäºŽéšæœºæ•°æ®åšçš„æµ‹è¯•ã€‚<br /><img src="https://atffang.github.io/2025/11/01/Datahader.Networks ç»˜åˆ¶bundling flow/final.png"/></p><p>è¿˜æ˜¯ä¸é”™çš„å§ðŸ˜Œ</p><p>æœ€åŽç»™å‡ºå°è£…å¥½çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°ç”¨äºŽå¯¹ç©ºé—´ç½‘ç»œæ•°æ®æ‰§è¡ŒåŸºäºŽ Hammer ç®—æ³• çš„è¾¹æ†ç»‘ï¼ˆEdge Bundlingï¼‰æ“ä½œï¼Œä»¥å‡å°‘è¾¹çš„è§†è§‰äº¤å‰å¹¶å¢žå¼ºæ•´ä½“ç»“æž„çš„ç©ºé—´å¯è¯»æ€§ã€‚<br />è¾“å…¥å‚æ•°<br />â€¢edge_path (str)ï¼šè¾¹æ•°æ®æ–‡ä»¶è·¯å¾„ï¼Œè¦æ±‚ä¸º CSV æ ¼å¼ï¼ŒåŒ…å«æºèŠ‚ç‚¹ã€ç›®æ ‡èŠ‚ç‚¹åŠæƒé‡ç­‰å­—æ®µã€‚<br />â€¢node_path (str)ï¼šèŠ‚ç‚¹æ•°æ®æ–‡ä»¶è·¯å¾„ï¼Œè¦æ±‚ä¸º CSV æ ¼å¼ï¼ŒåŒ…å«èŠ‚ç‚¹å”¯ä¸€æ ‡è¯†åŠç»çº¬åº¦åæ ‡å­—æ®µã€‚<br />â€¢nodes_id_col (str)ï¼šèŠ‚ç‚¹æ–‡ä»¶ä¸­è¡¨ç¤ºèŠ‚ç‚¹å”¯ä¸€ç¼–å·çš„åˆ—åï¼Œé»˜è®¤ â€œnode_idâ€ <strong>åŠ¡å¿…æ˜¯intç±»åž‹ï¼ï¼ï¼</strong>ã€‚<br />â€¢node_lon_col (str)ï¼šèŠ‚ç‚¹ç»åº¦åˆ—åï¼Œé»˜è®¤ â€œlonâ€ã€‚<br />â€¢node_lat_col (str)ï¼šèŠ‚ç‚¹çº¬åº¦åˆ—åï¼Œé»˜è®¤ â€œlatâ€ã€‚<br />â€¢edge_source_col (str)ï¼šè¾¹æ–‡ä»¶ä¸­è¡¨ç¤ºèµ·ç‚¹èŠ‚ç‚¹çš„åˆ—åï¼Œé»˜è®¤ â€œsourceâ€ å’Œä¸Šé¢çš„node_idåŒ¹é…ï¼Œ<strong>åŠ¡å¿…æ˜¯intç±»åž‹ï¼ï¼ï¼</strong>ã€‚<br />â€¢edge_target_col (str)ï¼šè¾¹æ–‡ä»¶ä¸­è¡¨ç¤ºç»ˆç‚¹èŠ‚ç‚¹çš„åˆ—åï¼Œé»˜è®¤ â€œtargetâ€ å’Œä¸Šé¢çš„node_idåŒ¹é…ï¼Œ<strong>åŠ¡å¿…æ˜¯intç±»åž‹ï¼ï¼ï¼</strong>ã€‚<br />â€¢weight_col (str)ï¼šè¾¹æ–‡ä»¶ä¸­è¡¨ç¤ºæƒé‡ï¼ˆå¦‚æµé‡ã€å¼ºåº¦ï¼‰çš„åˆ—åï¼Œé»˜è®¤ â€œweightâ€ã€‚<br />â€¢decay (float)ï¼šHammer ç®—æ³•çš„è¡°å‡å‚æ•°ï¼ŒæŽ§åˆ¶è¾¹çš„æ”¶æ•›é€Ÿåº¦ï¼ˆ0â€“1ä¹‹é—´ï¼‰ã€‚<br />â€¢bw (float)ï¼šåˆå§‹å¸¦å®½å‚æ•°ï¼ŒæŽ§åˆ¶æ†ç»‘çš„ç´§å¯†ç¨‹åº¦ï¼ˆ0â€“1ä¹‹é—´ï¼‰ã€‚<br />â€¢input_crs (str)ï¼šè¾“å…¥æ•°æ®çš„åæ ‡å‚è€ƒç³»ï¼Œé»˜è®¤ â€œEPSG:4326â€ï¼ˆWGS84ï¼‰ã€‚<br />â€¢output (bool)ï¼šæ˜¯å¦è¾“å‡ºæ–‡ä»¶ï¼Œé»˜è®¤ Trueã€‚<br />â€¢output_format (Literal[â€œgeojsonâ€, â€œshpâ€])ï¼šè¾“å‡ºæ–‡ä»¶æ ¼å¼ï¼Œé»˜è®¤ â€œgeojsonâ€ã€‚<br />â€¢output_path (Optional[str])ï¼šè¾“å‡ºæ–‡ä»¶ä¿å­˜è·¯å¾„ï¼Œè‹¥ä¸º Noneï¼Œåˆ™ä»…è¿”å›žç»“æžœä¸ä¿å­˜ã€‚<br />è¾“å‡ºç»“æžœ<br />â€¢è¿”å›žå€¼ (geopandas.GeoDataFrame)ï¼š<br />å‡½æ•°è¿”å›žä¸€ä¸ªåŒ…å«è¾¹æ†ç»‘åŽå‡ ä½•ç»“æžœçš„ GeoDataFrameï¼Œå…¶å±žæ€§åŒ…æ‹¬åŽŸå§‹è¾¹çš„å…¨éƒ¨å­—æ®µåŠå¯¹åº”çš„ç©ºé—´å‡ ä½• (LineString)ã€‚ç»“æžœçš„åæ ‡å‚è€ƒç³»ä¸º â€œEPSG:4326â€ï¼Œå¯ç›´æŽ¥ç”¨äºŽ GIS å¯è§†åŒ–æˆ–ç©ºé—´åˆ†æžã€‚<br />è‹¥è®¾ç½® output=Trueï¼Œåˆ™å‡½æ•°è¿˜ä¼šåœ¨æŒ‡å®šè·¯å¾„ä¸‹å¯¼å‡ºç›¸åº”çš„ GeoJSON æˆ– Shapefile æ–‡ä»¶ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> geopandas <span class="keyword">as</span> gpd</span><br><span class="line"><span class="keyword">import</span> pyproj</span><br><span class="line"><span class="keyword">from</span> datashader.bundling <span class="keyword">import</span> hammer_bundle</span><br><span class="line"><span class="keyword">from</span> shapely.geometry <span class="keyword">import</span> LineString</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Literal</span>, <span class="type">Optional</span></span><br><span class="line"><span class="keyword">import</span> copy</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line">def <span class="title function_">perform_edge_bundling</span><span class="params">(</span></span><br><span class="line"><span class="params">    edge_path: str,</span></span><br><span class="line"><span class="params">    node_path: str,</span></span><br><span class="line"><span class="params">    nodes_id_col: str = <span class="string">&quot;node_id&quot;</span>,</span></span><br><span class="line"><span class="params">    node_lon_col: str = <span class="string">&quot;lon&quot;</span>,</span></span><br><span class="line"><span class="params">    node_lat_col: str = <span class="string">&quot;lat&quot;</span>,</span></span><br><span class="line"><span class="params">    edge_source_col: str = <span class="string">&quot;source&quot;</span>,</span></span><br><span class="line"><span class="params">    edge_target_col: str = <span class="string">&quot;target&quot;</span>,</span></span><br><span class="line"><span class="params">    weight_col: str = <span class="string">&quot;weight&quot;</span>,</span></span><br><span class="line"><span class="params">    decay: <span class="type">float</span> = <span class="number">0.5</span>,</span></span><br><span class="line"><span class="params">    bw: <span class="type">float</span> = <span class="number">0.5</span>,</span></span><br><span class="line"><span class="params">    input_crs: str = <span class="string">&quot;EPSG:4326&quot;</span>,</span></span><br><span class="line"><span class="params">    output: bool = True,</span></span><br><span class="line"><span class="params">    output_format: Literal[<span class="string">&quot;geojson&quot;</span>, <span class="string">&quot;shp&quot;</span>] = <span class="string">&quot;geojson&quot;</span>,</span></span><br><span class="line"><span class="params">    output_path: Optional[str] = None,</span></span><br><span class="line"><span class="params">)</span> -&gt; gpd.GeoDataFrame:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Perform force-directed edge bundling using the Hammer algorithm</span></span><br><span class="line"><span class="string">    on spatial graph data, and export the result as a geospatial file.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Parameters</span></span><br><span class="line"><span class="string">    ----------</span></span><br><span class="line"><span class="string">    edge_path : str</span></span><br><span class="line"><span class="string">        Path to the CSV file containing edge data.</span></span><br><span class="line"><span class="string">    node_path : str</span></span><br><span class="line"><span class="string">        Path to the CSV file containing node data.</span></span><br><span class="line"><span class="string">    nodes_id_col : str, default &quot;node_id&quot;</span></span><br><span class="line"><span class="string">        Column name for node identifiers in the node CSV.</span></span><br><span class="line"><span class="string">    node_lon_col : str, default &quot;lon&quot;</span></span><br><span class="line"><span class="string">        Column name for node longitude.</span></span><br><span class="line"><span class="string">    node_lat_col : str, default &quot;lat&quot;</span></span><br><span class="line"><span class="string">        Column name for node latitude.</span></span><br><span class="line"><span class="string">    edge_source_col : str, default &quot;source&quot;</span></span><br><span class="line"><span class="string">        Column name for edge source node ID.</span></span><br><span class="line"><span class="string">    edge_target_col : str, default &quot;target&quot;</span></span><br><span class="line"><span class="string">        Column name for edge target node ID.</span></span><br><span class="line"><span class="string">    weight_col : str, default &quot;weight&quot;</span></span><br><span class="line"><span class="string">        Column name for edge weights.</span></span><br><span class="line"><span class="string">    decay : float, default 0.5</span></span><br><span class="line"><span class="string">        Decay parameter of the hammer_bundle algorithm (0 &lt; decay &lt; 1).</span></span><br><span class="line"><span class="string">    bw : float, default 0.5</span></span><br><span class="line"><span class="string">        Initial bandwidth parameter of hammer_bundle (controls bundle tightness).</span></span><br><span class="line"><span class="string">    input_crs : str, default &quot;EPSG:4326&quot;</span></span><br><span class="line"><span class="string">        Coordinate reference system (CRS) of the input node coordinates.</span></span><br><span class="line"><span class="string">        Usually &quot;EPSG:4326&quot; for WGS84 or &quot;EPSG:3857&quot; for Web Mercator.</span></span><br><span class="line"><span class="string">    output : bool, default True</span></span><br><span class="line"><span class="string">        Whether to save the output file.</span></span><br><span class="line"><span class="string">    output_format : &#123;&quot;geojson&quot;, &quot;shp&quot;&#125;, default &quot;geojson&quot;</span></span><br><span class="line"><span class="string">        Desired output file format.</span></span><br><span class="line"><span class="string">    output_path : str, optional</span></span><br><span class="line"><span class="string">        Path to save the output file. If None, the file will not be written.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns</span></span><br><span class="line"><span class="string">    -------</span></span><br><span class="line"><span class="string">    gdf : geopandas.GeoDataFrame</span></span><br><span class="line"><span class="string">        GeoDataFrame containing bundled edge geometries and their weights,</span></span><br><span class="line"><span class="string">        projected in WGS84 (EPSG:4326).</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Raises</span></span><br><span class="line"><span class="string">    ------</span></span><br><span class="line"><span class="string">    FileNotFoundError</span></span><br><span class="line"><span class="string">        If either `edge_path` or `node_path` does not exist.</span></span><br><span class="line"><span class="string">    ValueError</span></span><br><span class="line"><span class="string">        If required columns are missing in the provided CSVs.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    print(<span class="string">&quot;[1/6] è¯»å–èŠ‚ç‚¹ä¸Žè¾¹æ–‡ä»¶...&quot;</span>)</span><br><span class="line">    edges = pd.read_csv(edge_path)</span><br><span class="line">    edges_copy = copy.deepcopy(edges)</span><br><span class="line">    nodes = pd.read_csv(node_path)</span><br><span class="line"></span><br><span class="line">    print(f<span class="string">&quot;èŠ‚ç‚¹æ•°: &#123;len(nodes)&#125;, è¾¹æ•°: &#123;len(edges)&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">&quot;[2/6] æ£€æŸ¥è¾“å…¥å­—æ®µæœ‰æ•ˆæ€§...&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> col in [nodes_id_col, node_lon_col, node_lat_col]:</span><br><span class="line">        <span class="keyword">if</span> col not in nodes.columns:</span><br><span class="line">            raise <span class="title function_">ValueError</span><span class="params">(f<span class="string">&quot;Missing required column &#x27;&#123;col&#125;&#x27; in node file.&quot;</span>)</span></span><br><span class="line">    <span class="keyword">for</span> col in [edge_source_col, edge_target_col, weight_col]:</span><br><span class="line">        <span class="keyword">if</span> col not in edges.columns:</span><br><span class="line">            raise <span class="title function_">ValueError</span><span class="params">(f<span class="string">&quot;Missing required column &#x27;&#123;col&#125;&#x27; in edge file.&quot;</span>)</span></span><br><span class="line"></span><br><span class="line">    edges = edges[[edge_source_col, edge_target_col, weight_col]].rename(</span><br><span class="line">        columns=&#123;edge_source_col: <span class="string">&#x27;source&#x27;</span>, edge_target_col: <span class="string">&#x27;target&#x27;</span>, weight_col: <span class="string">&#x27;weight&#x27;</span>&#125;</span><br><span class="line">    )</span><br><span class="line">    nodes = nodes[[nodes_id_col, node_lon_col, node_lat_col]]</span><br><span class="line"></span><br><span class="line">    edges[<span class="string">&quot;source&quot;</span>] = edges[<span class="string">&quot;source&quot;</span>].astype(<span class="type">int</span>)</span><br><span class="line">    edges[<span class="string">&quot;target&quot;</span>] = edges[<span class="string">&quot;target&quot;</span>].astype(<span class="type">int</span>)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">&quot;[3/6] åæ ‡è½¬æ¢ä¸º EPSG:3857 ...&quot;</span>)</span><br><span class="line">    proj_to_3857 = pyproj.Transformer.from_crs(input_crs, <span class="string">&quot;EPSG:3857&quot;</span>, always_xy=True)</span><br><span class="line">    nodes[<span class="string">&quot;x&quot;</span>], nodes[<span class="string">&quot;y&quot;</span>] = proj_to_3857.transform(nodes[node_lon_col], nodes[node_lat_col])</span><br><span class="line"></span><br><span class="line">    layout = nodes.rename(columns=&#123;nodes_id_col: <span class="string">&quot;name&quot;</span>&#125;)[[<span class="string">&quot;name&quot;</span>, <span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>]]</span><br><span class="line">    layout.index = layout[<span class="string">&quot;name&quot;</span>].astype(<span class="type">int</span>)</span><br><span class="line">    layout.index.name = None</span><br><span class="line"></span><br><span class="line">    <span class="title function_">print</span><span class="params">(<span class="string">&quot;[4/6] æ‰§è¡Œ Hammer è¾¹æ†ç»‘ç®—æ³• ...&quot;</span>)</span></span><br><span class="line">    bundled = hammer_bundle(layout, edges, decay=decay, initial_bandwidth=bw)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">&quot;[5/6] æž„é€ æ†ç»‘çº¿æ®µ ...&quot;</span>)</span><br><span class="line">    lines = []</span><br><span class="line">    current_points = []</span><br><span class="line">    edge_index = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> _, row in bundled.iterrows():</span><br><span class="line">        <span class="keyword">if</span> pd.isna(row[<span class="string">&quot;x&quot;</span>]) or pd.isna(row[<span class="string">&quot;y&quot;</span>]):</span><br><span class="line">            <span class="keyword">if</span> <span class="title function_">len</span><span class="params">(current_points)</span> &gt;= <span class="number">2</span> and edge_index &lt; len(edges_copy):</span><br><span class="line">                edge_attrs = edges_copy.iloc[edge_index].to_dict()</span><br><span class="line">                edge_attrs[<span class="string">&quot;geometry&quot;</span>] = LineString(current_points)</span><br><span class="line">                lines.append(edge_attrs)</span><br><span class="line">            current_points = []</span><br><span class="line">            edge_index += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            current_points.append((row[<span class="string">&quot;x&quot;</span>], row[<span class="string">&quot;y&quot;</span>]))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="title function_">len</span><span class="params">(current_points)</span> &gt;= <span class="number">2</span> and edge_index &lt; len(edges_copy):</span><br><span class="line">        edge_attrs = edges_copy.iloc[edge_index].to_dict()</span><br><span class="line">        edge_attrs[<span class="string">&quot;geometry&quot;</span>] = LineString(current_points)</span><br><span class="line">        lines.append(edge_attrs)</span><br><span class="line"></span><br><span class="line">    gdf = gpd.GeoDataFrame(lines, crs=<span class="string">&quot;EPSG:3857&quot;</span>)</span><br><span class="line">    gdf = gdf.to_crs(<span class="string">&quot;EPSG:4326&quot;</span>)</span><br><span class="line"></span><br><span class="line">    print(f<span class="string">&quot;ç”Ÿæˆ GeoDataFrameï¼Œå…± &#123;len(gdf)&#125; æ¡è¾¹ã€‚&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> output:</span><br><span class="line">        print(<span class="string">&quot;[6/6] è¾“å‡ºç»“æžœæ–‡ä»¶&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> output_path:</span><br><span class="line">            <span class="keyword">if</span> output_format == <span class="string">&quot;geojson&quot;</span>:</span><br><span class="line">                gdf.to_file(output_path, driver=<span class="string">&quot;GeoJSON&quot;</span>)</span><br><span class="line">            elif output_format == <span class="string">&quot;shp&quot;</span>:</span><br><span class="line">                gdf.to_file(output_path, driver=<span class="string">&quot;ESRI Shapefile&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                raise <span class="title function_">ValueError</span><span class="params">(<span class="string">&quot;Unsupported output format. Use &#x27;geojson&#x27; or &#x27;shp&#x27;.&quot;</span>)</span></span><br><span class="line">            </span><br><span class="line">            print(f<span class="string">&quot;æ–‡ä»¶å·²ä¿å­˜è‡³: &#123;output_path&#125;&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">&quot;æœªæä¾›è¾“å‡ºè·¯å¾„ï¼Œæœªä¿å­˜æ–‡ä»¶ã€‚&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> gdf</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;Datahader.Networks ç»˜åˆ¶bundling flow&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>obsidainåŸºäºŽs3çš„å¤šç«¯åŒæ­¥</title>
    <link href="https://atffang.github.io/2025/10/18/obsidain%E5%9F%BA%E4%BA%8Es3%E7%9A%84%E5%A4%9A%E7%AB%AF%E5%90%8C%E6%AD%A5/"/>
    <id>https://atffang.github.io/2025/10/18/obsidain%E5%9F%BA%E4%BA%8Es3%E7%9A%84%E5%A4%9A%E7%AB%AF%E5%90%8C%E6%AD%A5/</id>
    <published>2025-10-18T13:44:05.000Z</published>
    <updated>2025-10-19T00:50:11.759Z</updated>
    
    <content type="html"><![CDATA[<p>obsidainåŸºäºŽs3çš„å¤šç«¯åŒæ­¥ã€‚</p><span id="more"></span><p>å®‰åˆ©å¤§å®¶ä¸€ä¸ªobsidianéžå¸¸å¥½ç”¨çš„æ’ä»¶ <strong>Remotely save</strong> ï¼Œä»–å¯ä»¥åŸºäºŽå¤šä¸ªäº‘æœåŠ¡åŽ‚å•†ï¼Œæ¯”å¦‚ onedrive ä¸Ž google drvie è¿›è¡Œå¤šç«¯åŒæ­¥ï¼Œå°±ä¸éœ€è¦ä¹°obsidianè‡ªå·±çš„äº‘æœåŠ¡äº†ã€‚ä¸è¿‡æˆ‘åœ¨ä½¿ç”¨å­¦æ ¡é‚®ç®±çš„onedriveè¿›è¡ŒéªŒè¯çš„æ—¶å€™å‡ºçŽ°äº†ä¸€äº›é—®é¢˜å¯¼è‡´æ— æ³•ç»§ç»­ï¼Œä¸å¾—å·²ä½¿ç”¨æœ€åŸºç¡€çš„s3æœåŠ¡ã€‚</p><p>é¦–å…ˆï¼Œåœ¨obsidiançš„ç¬¬ä¸‰æ–¹åº“ä»“åº“ä¸­ä¸‹è½½Remotely saveï¼ŒæŸ¥çœ‹å…¶è®¾ç½®ï¼Œåœ¨ç¬¬ä¸€ä¸ªé€‰æ‹©è¿œç¨‹é€‰é¡¹ä¸­å¯ä»¥é€‰æ‹©å¤šç§äº‘å­˜å‚¨çš„æ–¹å¼ï¼Œç”±äºŽæˆ‘ä½¿ç”¨è‡ªå·±çš„äº‘æœåŠ¡å™¨è¿›è¡Œå­˜å‚¨ä¸ŽåŒæ­¥ï¼Œé€‰æ‹©ç¬¬ä¸€é¡¹S3æˆ–å…¼å®¹S3çš„æœåŠ¡ã€‚</p><p>å­˜å‚¨ä½ç½®æˆ‘ä½¿ç”¨äº†ä¹‹å‰99ä¸€å¹´ä¹°çš„é˜¿é‡Œäº‘æŒ‚å£å¤§å­¦ç”ŸæœåŠ¡å™¨ï¼Œé˜¿é‡Œå¯¹å¤§å­¦ç”Ÿæ²¡å¾—è¯´ï¼Œä»ŽæœåŠ¡å™¨åˆ°å¤§æ¨¡åž‹tokené¢åº¦ï¼Œéƒ½å¯¹å­¦ç”Ÿå¼€æ”¾äº†ä¼˜æƒ ç”šè‡³éƒ¨åˆ†å…è´¹çš„ç¦åˆ©ã€‚</p><p>åœ¨linuxäº‘æœåŠ¡å™¨ä¸Šå®‰è£…minioï¼Œå¼€æ”¾9000ç«¯å£ï¼Œå¹¶æ–°å»ºbucketï¼Œä¿å­˜IDå’ŒKeyï¼Œå°†ä¸Šè¿°ä¿¡æ¯å¡«å…¥Remotely saveçš„ï¼ŒåŒ…æ‹¬æœåŠ¡åœ°å€ï¼ˆ<a href="http://xxx.xxx.xxx.xxx:9000">http://xxx.xxx.xxx.xxx:9000</a>ï¼‰ï¼ŒåŒºåŸŸï¼ˆå¡«us-east-1å°±okï¼‰ï¼ŒAccess Key IDï¼ŒSecret Access Keyï¼ŒBucket nameï¼Œç‚¹å‡»æ£€æŸ¥æµ‹è¯•è¿žæŽ¥å³å¯ã€‚</p><p>ç‚¹å‡»Remotely saveçš„åˆ·æ–°æŒ‰é’®ï¼Œå³å¯ä¾¿æ·çš„ä¸Šä¼ æˆ–ä¸‹æ‹‰è¿™ä¸ªä»“åº“äº†ï¼Œè¶…çº§æ–¹ä¾¿ï¼Œå¹¶ä¸”å¯ä»¥åœ¨é€‰é¡¹ä¸­è®¾ç½®æ‰“å¼€è‡ªåŠ¨æ›´æ–°ï¼Œå…³é—­è‡ªåŠ¨æ›´æ–°å’Œæ¯éš”ä¸€æ®µæ—¶é—´è‡ªåŠ¨æ›´æ–°ã€‚</p><img src="https://atffang.github.io/2025/10/18/obsidainåŸºäºŽs3çš„å¤šç«¯åŒæ­¥/å¤šç«¯åŒæ­¥.jpg"/>]]></content>
    
    
    <summary type="html">&lt;p&gt;obsidainåŸºäºŽs3çš„å¤šç«¯åŒæ­¥ã€‚&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>åŸºäºŽAISæ•°æ®è¿›è¡Œèˆ¹èˆ¶è½¨è¿¹åˆ†æ®µåˆæˆçš„ä¸€ç‚¹æ€è·¯</title>
    <link href="https://atffang.github.io/2025/08/29/%E5%9F%BA%E4%BA%8EAIS%E6%95%B0%E6%8D%AE%E8%BF%9B%E8%A1%8C%E8%88%B9%E8%88%B6%E8%BD%A8%E8%BF%B9%E5%88%86%E6%AE%B5%E5%90%88%E6%88%90%E7%9A%84%E4%B8%80%E7%82%B9%E6%80%9D%E8%B7%AF/"/>
    <id>https://atffang.github.io/2025/08/29/%E5%9F%BA%E4%BA%8EAIS%E6%95%B0%E6%8D%AE%E8%BF%9B%E8%A1%8C%E8%88%B9%E8%88%B6%E8%BD%A8%E8%BF%B9%E5%88%86%E6%AE%B5%E5%90%88%E6%88%90%E7%9A%84%E4%B8%80%E7%82%B9%E6%80%9D%E8%B7%AF/</id>
    <published>2025-08-29T02:33:07.000Z</published>
    <updated>2025-09-01T04:57:47.052Z</updated>
    
    <content type="html"><![CDATA[<p>ä»‹ç»ä¸€ä¸‹æœ¬ç§‘æ¯•è®¾é‡Œå…³äºŽåŸºäºŽAISæ•°æ®è¿›è¡Œèˆ¹èˆ¶è½¨è¿¹åˆæˆéƒ¨åˆ†çš„ä¸€ç‚¹æ€è·¯ï¼Œéžä¸“ä¸šï¼Œä»…åˆ†äº«</p><span id="more"></span><h3 id="å†™åœ¨å‰é¢"><a class="markdownIt-Anchor" href="#å†™åœ¨å‰é¢"></a> å†™åœ¨å‰é¢</h3><p>å¥‘æœºæ˜¯æˆ‘ä¸€ä½è€å¸ˆæœ€è¿‘ä¸­äº†å…³äºŽæµ·è¿çš„é¢ä¸Šï¼Œçªç„¶æƒ³èµ·æˆ‘æœ¬ç§‘æ¯•ä¸šè®ºæ–‡åšçš„ä¹Ÿæ˜¯ç›¸å…³çš„æ•°æ®åˆ†æžã€‚å½“ç„¶åªæ˜¯ä¸€ç‚¹å¾ˆç®€å•çš„å·¥ä½œï¼Œæ¯•ç«Ÿåªæ˜¯æœ¬ç§‘çš„æ¯•ä¸šè®¾è®¡ã€‚</p><h3 id="aisæ•°æ®èŽ·å–"><a class="markdownIt-Anchor" href="#aisæ•°æ®èŽ·å–"></a> AISæ•°æ®èŽ·å–</h3><p>è‡ªåŠ¨è¯†åˆ«ç³»ç»Ÿï¼ˆAutomatic Identification Systemï¼ŒAISï¼‰æ˜¯å®‰è£…åœ¨èˆ¹èˆ¶ä¸Šçš„ä¸€å¥—è‡ªåŠ¨è¿½è¸ªç³»ç»Ÿï¼Œé€šè¿‡å²¸åŸºæˆ–æ˜ŸåŸºè®¾å¤‡æŽ¥æ”¶èˆ¹èˆ¶å”¯ä¸€æ ‡è¯†ç¬¦å·ã€åæ ‡ã€ç±»åž‹ä»¥åŠèˆªè¡ŒçŠ¶æ€ç­‰æ•°æ®ï¼Œå¹¶ä¸”ç”±è¿žç»­çš„èˆ¹èˆ¶AISæ•°æ®å¯åˆæˆèˆ¹èˆ¶è½¨è¿¹ã€‚</p><p>ç¬¬ä¸€æ­¥æ•°æ®èŽ·å–å°±å¡äº†å¾ˆä¹…ã€‚å®šæ¯•è®¾é¢˜ç›®é‚£ä¼šå„¿ï¼Œå³2023å¹´å†¬å¤©ï¼Œæœ‰å¹¸å‚åŠ äº†ç¬¬ä¸€å±Šçš„ä¿¡æ¯åœ°ç†å­¦å¤§ä¼šï¼Œå¬äº†ä¸‰å››ä¸ªå…³äºŽAISæ•°æ®å’Œèˆ¹èˆ¶è½¨è¿¹åˆ†æžçš„æŠ¥å‘Šï¼Œéƒ½æœ‰æåˆ°ä»–ä»¬èŽ·å–çš„AISæ•°æ®ï¼Œä¸€äº›ç ”ç©¶äººå‘˜æ‰‹é‡Œä¸€å¹´çš„æ•°æ®é‡éƒ½æ˜¯åäº¿çº§åˆ«çš„ï¼Œè®©æˆ‘æœ‰ç§èŽ«åçš„é”™è§‰ï¼Œè§‰å¾—èŽ·å–å±€éƒ¨ä¸€æ®µæ—¶é—´å†…çš„AISæ•°æ®å¹¶ä¸æ˜¯ä»€ä¹ˆéš¾äº‹ã€‚<br /><img src="https://atffang.github.io/2025/08/29/åŸºäºŽAISæ•°æ®è¿›è¡Œèˆ¹èˆ¶è½¨è¿¹åˆ†æ®µåˆæˆçš„ä¸€ç‚¹æ€è·¯/001.jpg"/><br /><img src="https://atffang.github.io/2025/08/29/åŸºäºŽAISæ•°æ®è¿›è¡Œèˆ¹èˆ¶è½¨è¿¹åˆ†æ®µåˆæˆçš„ä¸€ç‚¹æ€è·¯/002.jpg"/><br />äº‹å®žè¯æ˜Žï¼Œæˆ‘æƒ³çš„å¤ªç®€å•äº†ã€‚å…ˆæ˜¯å°è¯•å¯»æ‰¾å¼€æºæ•°æ®æœªæžœï¼Œå¼€å§‹å’¨è¯¢æ•°æ®ä¾›åº”å•†ã€‚ä½†æ˜¯è¿™äº›å•†ä¸šå…¬å¸çš„æœåŠ¡å¯¹è±¡ä¸€èˆ¬æ˜¯èˆ¹è¿ç›¸å…³ä¼ä¸šå’Œå°‘é‡çš„ç§‘ç ”äººå‘˜ï¼Œå¯¹æˆ‘è¿™æ ·çš„ä¸ªä½“æˆ·ï¼Œä¸Šåƒä¸Šä¸‡çš„èµ·æ­¥ä»·å°šä¸”ä¸èƒ½æŽ¥å—ï¼Œä½•å†µæ•°æ®éœ€æ±‚åœ¨èµ·æ­¥ä»·å†…æ— æ³•æ»¡è¶³ã€‚å…œå…œè½¬è½¬åå¤©ï¼Œç»ˆäºŽè®©æˆ‘æ‰¾åˆ°äº†æ´»è©è¨ç½‘ç«™<a href="https://datalastic.com/">https://datalastic.com/</a></p><p>å…¶å®žä»–ä»¬çš„å®šä»·åŒæ ·è´µçš„ç¦»è°±ï¼Œæœˆè®¢é˜…è´¹ç”¨é«˜è¾¾æ•°åƒæ¬§å…ƒï¼Œä½†ä»–æä¾›äº†ä¸€ä¸ªå‡ åæ¬§å…ƒçš„ä¸€å‘¨ä½“éªŒè®¡åˆ’ï¼Œæˆ‘æ²¡æœ‰çŠ¹è±«å°±ä¹°äº†è¿™æ ¹æ•‘å‘½ç¨»è‰ã€‚æœ‰äº†apiä¸€åˆ‡éƒ½å¥½è¯´ï¼Œå”¯ä¸€çš„é—®é¢˜æ˜¯å…¶ç›¸å…³APIåªèƒ½è¯·æ±‚ä¸€ä¸ªåæ ‡ç‰¹å®šèŒƒå›´å†…çš„AISæ•°æ®ï¼Œè¿™ç»™æ•°æ®èŽ·å–çš„ç­–ç•¥ä¸ŽåŽæœŸæ•°æ®åˆæˆéƒ½å¢žåŠ äº†ä¸å°çš„éš¾åº¦ã€‚æˆ‘åªèƒ½å…ˆå°†ç ”ç©¶åŒºåŸŸåˆ’åˆ†ä¸ºå‡ åä¸ªåœ†ï¼Œåœ¨èŽ·å–è¿™äº›åœ†å¿ƒèŒƒå›´å†…çš„æ•°æ®ã€‚å¤§æ¦‚çˆ¬å–äº†3-4å¤©åŽï¼Œä»Ždatalasticç½‘ç«™èŽ·å–äº†åŒºåŸŸå†…AISè®°å½•72,9499æ¡ï¼ŒåŒ…å«èˆ¹èˆ¶çš„uuidï¼ˆå”¯ä¸€æ ‡è¯†ç¬¦ï¼‰ã€mmsiã€åæ ‡ä»¥åŠé€Ÿåº¦ç­‰æœ‰æ•ˆä¿¡æ¯ï¼Œå¹¶æ±‡æ€»æ•°æ®é›†åŒ…å«çš„èˆ¹èˆ¶ï¼ŒèŽ·å–äº†æ¯æ¡èˆ¹èˆ¶çš„å›½ç±ã€ç±»åž‹ã€æŽ’æ°´é‡ç­‰ä¿¡æ¯ï¼Œå…·ä½“ä¸‹è¡¨æ‰€ç¤ºã€‚</p><table><thead><tr><th>AISè®°å½•å­—æ®µ</th><th>AISè®°å½•å­—æ®µå«ä¹‰</th><th><strong>èˆ¹èˆ¶ä¿¡æ¯å­—æ®µ</strong></th><th><strong>èˆ¹èˆ¶ä¿¡æ¯å­—æ®µå«ä¹‰</strong></th></tr></thead><tbody><tr><td>uuid</td><td>é€šç”¨å”¯ä¸€è¯†åˆ«ç </td><td>uuid</td><td>é€šç”¨å”¯ä¸€è¯†åˆ«ç </td></tr><tr><td>lat</td><td>çº¬åº¦ï¼ˆåº¦ï¼‰</td><td>name</td><td>åç§°</td></tr><tr><td>lon</td><td>ç»åº¦ï¼ˆåº¦ï¼‰</td><td>mmsi</td><td>æµ·äº‹æœåŠ¡èº«ä»½ç </td></tr><tr><td>speed</td><td>é€Ÿåº¦ï¼ˆèŠ‚ï¼‰</td><td>imo</td><td>å›½é™…æµ·äº‹ç»„ç»‡å·ç </td></tr><tr><td>course</td><td>èˆªå‘</td><td>country_iso</td><td>æ³¨å†Œå›½ä»£ç </td></tr><tr><td>heading</td><td>èˆ¹é¦–å‘</td><td>type</td><td>ç±»åž‹</td></tr><tr><td>destination</td><td>ç›®çš„åœ°</td><td>gross_tonnage</td><td>æ€»å¨ä½</td></tr><tr><td>last_pos_epoch</td><td>æ—¶é—´æˆ³</td><td>deadweight</td><td>æœ€å¤§è½½è¿é‡</td></tr><tr><td>last_pos_utc</td><td>æ—¶é—´æˆ³ï¼ˆä¸–ç•Œæ—¶é—´ï¼‰</td><td>length</td><td>èˆ¹ä½“é•¿åº¦</td></tr><tr><td></td><td></td><td>speed_max</td><td>æœ€å¤§èˆªé€Ÿï¼ˆèŠ‚ï¼‰</td></tr><tr><td>navstat</td><td>å¯¼èˆªçŠ¶æ€</td><td>home_port</td><td>æ³¨å†Œæ¸¯</td></tr><tr><td>distance_nm</td><td>è·ç›®çš„åœ°è·ç¦»ï¼ˆæµ·é‡Œï¼‰</td><td>year_built</td><td>å»ºé€ å¹´ä»½</td></tr><tr><td></td><td></td><td>breadth</td><td>èˆ¹ä½“å®½åº¦</td></tr></tbody></table><p>å¤§æ¦‚åˆ†å¸ƒå¦‚ä¸‹å›¾ï¼š<br /><img src="https://atffang.github.io/2025/08/29/åŸºäºŽAISæ•°æ®è¿›è¡Œèˆ¹èˆ¶è½¨è¿¹åˆ†æ®µåˆæˆçš„ä¸€ç‚¹æ€è·¯/003.jpg"/><br />å°†å…¶æ³¨å…¥æ•°æ®åº“ï¼Œå¹¶é€šè¿‡uuidå­—æ®µä¸Žèˆ¹èˆ¶ä¿¡æ¯æ•°æ®åº“å»ºç«‹è¿žæŽ¥ã€‚</p><h3 id="èˆ¹èˆ¶è½¨è¿¹åˆæˆ"><a class="markdownIt-Anchor" href="#èˆ¹èˆ¶è½¨è¿¹åˆæˆ"></a> èˆ¹èˆ¶è½¨è¿¹åˆæˆ</h3><p>ç”±äºŽç”¨äºŽåˆæˆèˆ¹èˆ¶è½¨è¿¹çš„AISè®°å½•æ—¶é—´è·¨åº¦è¾ƒé•¿ï¼Œç»å¤§å¤šæ•°èˆ¹èˆ¶åœ¨åŒºåŸŸå†…å¹¶ä¸ä»…å®Œæˆäº†ä¸€æ¬¡èˆªè¡Œä»»åŠ¡ï¼Œè€Œæ˜¯æ¶µç›–äº†å¤šæ¡èˆªçº¿ã€‚å› æ­¤ï¼Œé€šè¿‡AISè®°å½•ç›´æŽ¥åˆæˆçš„èˆ¹èˆ¶è½¨è¿¹å­˜åœ¨èˆªè¿¹å¤æ‚ã€é‡å¤ç­‰é—®é¢˜ã€‚ä¸ºäº†æ›´å¥½åœ°èŽ·å¾—èˆªè¡Œç‰¹å¾ï¼Œç ”ç©¶å°†è½¨è¿¹ä»Žæ¸¯å£å‡ºå‘ï¼Œç›´è‡³åˆ°è¾¾å¦ä¸€æ¸¯å£çš„èˆªæ®µå®šä¹‰ä¸ºèˆ¹èˆ¶çš„ä¸€æ¡åˆ†æ®µè½¨è¿¹ã€‚è€Œåœ¨ç»™å®šçš„æ—¶é—´å†…ï¼Œå¯èƒ½æ— æ³•æ•æ‰åˆ°ä¸€äº›èˆ¹èˆ¶çš„èµ·å§‹æ¸¯å£æˆ–ç»ˆç‚¹æ¸¯å£ï¼Œå› æ­¤è¢«èµ·å§‹æ—¶é—´æˆ–ç»ˆæ­¢æ—¶é—´æˆªæ–­çš„è½¨è¿¹ï¼Œä¹Ÿè¢«ç§°ä¸ºè¯¥èˆ¹èˆ¶çš„ä¸€æ¡åˆ†æ®µè½¨è¿¹ã€‚</p><p>å› æ­¤ï¼Œé€šè¿‡AISè®°å½•åˆæˆåˆ†æ®µè½¨è¿¹çš„å‰ææ˜¯åŒºåˆ†èˆ¹èˆ¶çš„çŠ¶æ€ï¼Œå³èˆªè¡ŒçŠ¶æ€æˆ–é©»ç•™çŠ¶æ€ã€‚åœ¨æŸä¸€èˆ¹èˆ¶çš„ä¸€ç»„æ ¹æ®æ—¶é—´æŽ’åºçš„AISè®°å½•ä¸­ï¼Œæœ‰å››ç§å¯èƒ½çš„åˆ†æ®µè½¨è¿¹ï¼š</p><ul><li>ç”±è¯¥ç»„æ•°æ®æœ€æ—©çš„AISè®°å½•ç‚¹å¼€å§‹ï¼Œè‡³ä¸‹ä¸€ä¸ªå¤„äºŽé©»ç•™çŠ¶æ€çš„AISè®°å½•ç‚¹ç»“æŸçš„åˆ†æ®µè½¨è¿¹ã€‚</li><li>ç”±è¯¥ç»„æ•°æ®æœ€æ—©çš„AISè®°å½•ç‚¹å¼€å§‹ï¼Œè‡³è¯¥ç»„æ•°æ®æœ€æ™šçš„AISè®°å½•ç‚¹ç»“æŸçš„åˆ†æ®µè½¨è¿¹ã€‚</li><li>è¯¥ç»„æŸä¸ªå¤„äºŽé©»ç•™çŠ¶æ€ï¼Œä¸”ä¸‹ä¸€ä¸ªè®°å½•ç‚¹å¤„äºŽèˆªè¡ŒçŠ¶æ€çš„AISè®°å½•ç‚¹å¼€å§‹ï¼Œè‡³ä¸‹ä¸€ä¸ªå¤„äºŽé©»ç•™çŠ¶æ€çš„AISè®°å½•ç‚¹ç»“æŸçš„åˆ†æ®µè½¨è¿¹ã€‚</li><li>è¯¥ç»„æŸä¸ªå¤„äºŽé©»ç•™çŠ¶æ€ï¼Œä¸”ä¸‹ä¸€ä¸ªè®°å½•ç‚¹å¤„äºŽèˆªè¡ŒçŠ¶æ€çš„AISè®°å½•ç‚¹å¼€å§‹ï¼Œè‡³è¯¥ç»„æ•°æ®æœ€æ™šçš„AISè®°å½•ç‚¹ç»“æŸçš„åˆ†æ®µè½¨è¿¹ã€‚<br /><img src="https://atffang.github.io/2025/08/29/åŸºäºŽAISæ•°æ®è¿›è¡Œèˆ¹èˆ¶è½¨è¿¹åˆ†æ®µåˆæˆçš„ä¸€ç‚¹æ€è·¯/004.jpg"/><br />ä¸Šå›¾å±•ç¤ºäº†é€šè¿‡åˆ¤æ–­æŸä¸€èˆ¹èˆ¶AISè®°å½•ç‚¹èˆªè¡ŒçŠ¶æ€ï¼Œä»Žè€Œåˆæˆèˆ¹èˆ¶åˆ†æ®µè½¨è¿¹çš„æ­¥éª¤ã€‚è™½ç„¶AISè®°å½•æä¾›äº†å¯¼èˆªçŠ¶æ€å­—æ®µï¼Œç”¨ä»¥åˆ¤æ–­èˆ¹èˆ¶æ˜¯å¦å¤„äºŽèˆªè¡ŒçŠ¶æ€ï¼Œä½†è¯¥å­—æ®µå­˜åœ¨å¤§é‡æ•°æ®ç¼ºå¤±ã€é”™è¯¯é—®é¢˜ã€‚æ­¤å¤–ï¼Œç ”ç©¶è®¤ä¸ºï¼Œè™½ç„¶åœ¨æ¸¯å£é™„è¿‘çš„ä¸Šä¼ çš„AISè®°å½•ç‚¹æ˜¾ç¤ºèˆ¹èˆ¶å¤„äºŽèˆªè¡ŒçŠ¶æ€ï¼Œä½†è¯¥èˆ¹èˆ¶çš„å®žé™…è¡Œä¸ºå¤šè¡¨çŽ°ä¸ºåœç•™æˆ–åœ¨è¾ƒå°çš„èŒƒå›´å†…å¾˜å¾Šï¼Œå› æ­¤åº”å½“è¢«å½’ç±»ä¸ºé©»ç•™ã€‚å› æ­¤ï¼ŒAISè®°å½•çš„å¯¼èˆªçŠ¶æ€å­—æ®µå¹¶ä¸èƒ½æä¾›å‡†ç¡®çš„åˆ¤åˆ«ä¾æ®ï¼Œç ”ç©¶é‡‡ç”¨æ”¯æŒå‘é‡æœºï¼ˆSupport Vector Machine, ä¸‹æ–‡ç®€ç§°SVMï¼‰æ–¹æ³•åˆ¤å®šAISè®°å½•ç‚¹çš„çŠ¶æ€ã€‚</li></ul><p>SVMæ˜¯ä¸€ç§å¯ä»¥æœ‰æ•ˆå¤„ç†åˆ†ç±»é—®é¢˜çš„æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œç›®æ ‡æ˜¯åœ¨æ•°æ®é›†ä¸­æ‰¾åˆ°ä¸€ä¸ªæœ€ä¼˜çš„å†³ç­–è¾¹ç•Œï¼ˆäº¦ç§°ä¸ºè¶…å¹³é¢ï¼‰ï¼Œè¿™ä¸ªå†³ç­–è¾¹ç•Œèƒ½å¤Ÿä»¥æœ€å¤§é—´éš”åˆ†å¼€ä¸åŒç±»åˆ«çš„æ•°æ®ç‚¹ã€‚</p><p>ç”±äºŽSVMæ˜¯ä¸€ç§ç›‘ç£åˆ†ç±»æ–¹æ³•ï¼Œå› æ­¤ï¼Œç ”ç©¶æ‰‹åŠ¨æ ‡æ³¨äº†2000ä¸ªAISæ•°æ®ç‚¹çš„èˆªè¡ŒçŠ¶æ€ï¼Œå¹¶ä½¿ç”¨åæ ‡ã€èˆªé€Ÿã€èˆªå‘ä»¥åŠèˆ¹é¦–å‘ä½œä¸ºç‰¹å¾å‘é‡ï¼Œä½¿ç”¨70%çš„æ ‡æ³¨æ•°æ®é›†ä½œä¸ºè®­ç»ƒé›†è®­ç»ƒSVMæ¨¡åž‹ï¼ŒåŒæ—¶é€šè¿‡æ¯”è¾ƒå‰©ä¸‹30%çš„æ•°æ®æž„æˆçš„æµ‹è¯•é›†æ£€æµ‹å„ä¸ªæ ¸å‡½æ•°çš„åŒºåˆ†æ•ˆæžœï¼ŒåŒ…æ‹¬çº¿æ€§æ ¸å‡½æ•°ã€å¤šé¡¹å¼æ ¸å‡½æ•°ã€å¾„å‘åŸºå‡½æ•°æ ¸ä»¥åŠSigmoidæ ¸å‡½æ•°ï¼Œå¹¶ç¡®å®šäº†æœ€ä½³æ ¸å‡½æ•°ã€‚<br /><img src="https://atffang.github.io/2025/08/29/åŸºäºŽAISæ•°æ®è¿›è¡Œèˆ¹èˆ¶è½¨è¿¹åˆ†æ®µåˆæˆçš„ä¸€ç‚¹æ€è·¯/005.jpg"/><br />ä»Žå›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œèˆ¹èˆ¶é©»ç•™è®°å½•ç‚¹å¤šèšé›†äºŽæµ·å²¸æ¸¯å£ï¼Œä¸Žå®žé™…æƒ…å†µç›¸ç¬¦ã€‚ç„¶è€Œï¼Œç”±äºŽæ¨¡åž‹ä»å­˜åœ¨ä¸€äº›è¯¯å·®ï¼Œå¯èƒ½å°†ä¸€äº›å¤„äºŽèˆªè¡ŒçŠ¶æ€çš„AISè®°å½•ç‚¹è¢«è¯†åˆ«ä¸ºé©»ç•™çŠ¶æ€ï¼Œè€Œä¸€äº›å¤„äºŽé©»ç•™çŠ¶æ€çš„èˆªè¡Œç‚¹è¢«è¯†åˆ«ä¸ºèˆªè¡ŒçŠ¶æ€ï¼Œå¯¼è‡´åŽŸæœ¬è¿žç»­çš„èˆªè¡ŒAISè®°å½•è¢«æ‰“æ–­ï¼Œå¯¼è‡´èˆ¹èˆ¶çš„åˆ†æ®µè½¨è¿¹é”™è¯¯åœ°åœ¨è¯¥èŠ‚ç‚¹ä¸Šåˆ†è£‚ï¼Œæˆ–æ˜¯ä»Žèˆ¹èˆ¶é©»ç•™åœ¨æ¸¯å£åŠå‘¨è¾¹åŒºåŸŸæ—¶è¯†åˆ«å‡ºå¤šä½™è½¨è¿¹ã€‚å› æ­¤ï¼Œç ”ç©¶éœ€è¦è¯†åˆ«å¹¶ä¿®æ­£è¿™äº›é”™è¯¯çš„çŠ¶æ€ç‚¹ã€‚ç ”ç©¶ä½¿ç”¨ä¸€ä¸ªå¤§å°ä¸º3x1çš„æ»‘åŠ¨çª—å£éåŽ†æŒ‰æ—¶é—´æŽ’åºçš„èˆ¹èˆ¶çŠ¶æ€è®°å½•ç‚¹ï¼Œå¦‚æžœçª—å£å†…ç¬¬ä¸€ä¸ªçŠ¶æ€è®°å½•ä¸Žç¬¬ä¸‰ä¸ªçŠ¶æ€è®°å½•ç›¸åŒï¼Œä½†ç¬¬äºŒä¸ªçŠ¶æ€è®°å½•ä¸Žå‰åŽéƒ½ä¸åŒï¼Œåˆ™ä¿®æ­£è¯¥è®°å½•ã€‚</p><p>åœ¨å®Œæˆæ•°æ®ä¿®æ­£åŽï¼Œå³å¯åˆæˆèˆ¹èˆ¶è½¨è¿¹,å³åˆ†æ®µçš„åæ ‡æ—¶é—´åºåˆ—ã€‚å›¾ä¸­Â©å±•ç¤ºäº†æŸèˆ¹èˆ¶çš„AISè®°å½•åˆ†æ®µè½¨è¿¹åˆæˆï¼Œåœ¨åˆæˆè¿‡ç¨‹ä¸­ï¼Œç ”ç©¶åˆ é™¤äº†èˆ¹èˆ¶çŠ¶æ€ä¸ºé©»ç•™çš„è®°å½•ï¼Œå¹¶è¿žæŽ¥è¿žç»­çš„èˆ¹èˆ¶çŠ¶æ€ä¸ºèˆªè¡Œçš„è®°å½•ï¼Œå®Œæˆäº†ä¸€æ®µå®Œæ•´è½¨è¿¹çš„åˆ†å‰²ã€‚ä½¿ç”¨è¯¥æ–¹æ³•å®Œæˆ2023å¹´9æœˆ27æ—¥è‡³10æœˆ6æ—¥ï¼Œä»¥åŠ10æœˆ10æ—¥è‡³10æœˆ19æ—¥åŒºåŸŸçš„å…¨éƒ¨AISè®°å½•åˆ†æ®µè½¨è¿¹åˆæˆï¼Œå…¶æ•ˆæžœå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚<br /><img src="https://atffang.github.io/2025/08/29/åŸºäºŽAISæ•°æ®è¿›è¡Œèˆ¹èˆ¶è½¨è¿¹åˆ†æ®µåˆæˆçš„ä¸€ç‚¹æ€è·¯/006.png"/></p><h3 id="èˆ¹èˆ¶è½¨è¿¹åŽ‹ç¼©"><a class="markdownIt-Anchor" href="#èˆ¹èˆ¶è½¨è¿¹åŽ‹ç¼©"></a> èˆ¹èˆ¶è½¨è¿¹åŽ‹ç¼©</h3><p>Douglas-Peuckerç®—æ³•ï¼ˆä»¥ä¸‹ç®€ç§°DPç®—æ³•ï¼‰æ˜¯ä¸€ç§ç”¨äºŽæ›²çº¿è¿‘ä¼¼å’ŒæŠ½ç¨€çš„ç®—æ³•ã€‚å®ƒçš„ä¸»è¦æ€æƒ³æ˜¯åœ¨ç»™å®šçš„æ›²çº¿ä¸­ï¼Œé€šè¿‡ä¿ç•™ä¸€äº›é‡è¦çš„æ•°æ®ç‚¹ï¼Œæ¥è¿‘ä¼¼è¡¨ç¤ºåŽŸå§‹æ›²çº¿ï¼Œä»Žè€Œå®žçŽ°æ›²çº¿çš„ç®€åŒ–ã€‚ç”±äºŽç ”ç©¶æä¾›çš„è½¨è¿¹æ•°æ®é›†æ•°æ®é‡è¾ƒå¤§ï¼Œè½¨è¿¹èŠ‚ç‚¹è¾ƒå¤šï¼Œå› æ­¤åœ¨è½¨è¿¹èšç±»å‰ï¼Œå¯¹è½¨è¿¹æ•°æ®é›†è¿›è¡ŒåŽ‹ç¼©å¤„ç†èƒ½å¤Ÿæœ‰æ•ˆæé«˜èšç±»æ•ˆçŽ‡ï¼Œè€Œå¤§é‡å®žéªŒè¯æ˜Žï¼ŒDPç®—æ³•é€‚ç”¨äºŽè½¨è¿¹æ•°æ®çš„åŽ‹ç¼©ã€‚ä¸‹å›¾å±•ç¤ºäº†DPç®—æ³•å¯¹äºŽä¸€æ¡è½¨è¿¹åŽ‹ç¼©çš„è¿‡ç¨‹ã€‚<br /><img src="https://atffang.github.io/2025/08/29/åŸºäºŽAISæ•°æ®è¿›è¡Œèˆ¹èˆ¶è½¨è¿¹åˆ†æ®µåˆæˆçš„ä¸€ç‚¹æ€è·¯/007.png"/><br />DPç®—æ³•çš„åŸºæœ¬æ€è·¯å¦‚ä¸‹ï¼š</p><ul><li>åœ¨ç›®æ ‡æ›²çº¿çš„èµ·ç‚¹å’Œç»ˆç‚¹ä¹‹é—´ï¼Œæ‰¾åˆ°ä¸€æ¡ç›´çº¿ï¼Œä½œä¸ºæ›²çº¿çš„åˆå§‹è¿‘ä¼¼ã€‚</li><li>è®¡ç®—å…¶ä»–æ‰€æœ‰ç‚¹åˆ°è¯¥ç›´çº¿çš„è·ç¦»ï¼Œæ‰¾åˆ°è·ç¦»æœ€å¤§çš„ç‚¹ï¼ˆå³åž‚ç›´è·ç¦»æœ€å¤§çš„ç‚¹ï¼‰ã€‚</li><li>å¦‚æžœè¿™ä¸ªæœ€å¤§è·ç¦»è¶…è¿‡äº†é¢„å…ˆè®¾å®šçš„é˜ˆå€¼ï¼ˆå³æ‰€è°“çš„æŠ½ç¨€é˜ˆå€¼ï¼‰ï¼Œåˆ™å°†è¯¥ç‚¹åŠ å…¥åˆ°ç»“æžœé›†åˆä¸­ï¼Œå¹¶å°†æ›²çº¿åˆ’åˆ†ä¸ºä¸¤ä¸ªå­æ›²çº¿ã€‚</li><li>å¯¹ä¸¤ä¸ªå­æ›²çº¿åˆ†åˆ«é€’å½’åœ°åº”ç”¨ä¸Šè¿°è¿‡ç¨‹ï¼Œç›´åˆ°æ‰€æœ‰ç‚¹éƒ½è¢«å¤„ç†å®Œæ¯•ã€‚</li><li></li></ul><p>é€šè¿‡è¿™ä¸ªè¿‡ç¨‹ï¼ŒDPç®—æ³•å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šä¿ç•™æ›²çº¿çš„å½¢çŠ¶ç‰¹å¾ï¼ŒåŒæ—¶å‡å°‘æ•°æ®ç‚¹çš„æ•°é‡ï¼Œä»Žè€Œå®žçŽ°æ›²çº¿çš„ç®€åŒ–ã€‚DPç®—æ³•çš„é˜ˆå€¼å†³å®šäº†ç®€åŒ–åŽçš„æ›²çº¿ä¸ŽåŽŸå§‹æ›²çº¿ä¹‹é—´çš„æœ€å¤§å…è®¸è¯¯å·®ï¼Œæ˜¯å½±å“ç®—æ³•åŽ‹ç¼©ç»“æžœçš„å”¯ä¸€å‚æ•°ã€‚</p><p>Zhaoç­‰äººçš„å®žéªŒ]è¡¨æ˜Žï¼Œå¯¹äºŽç»Ÿä¸€é˜ˆå€¼åŽ‹ç¼©è€Œè¨€ï¼Œåœ¨ä»¥ä¸€ä¸ªå›ºå®šçš„æ­¥é•¿å¢žåŠ é˜ˆå€¼çš„è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨è½¨è¿¹èŠ‚ç‚¹æ•°å˜åŒ–çŽ‡ç›¸å¯¹è¾ƒä½Žã€è¾ƒä¸ºå¹³ç¨³çš„ä¸€å®šèŒƒå›´å†…çš„é˜ˆå€¼ï¼Œå¯¹ç›¸ä¼¼åº¦é‡æ€§èƒ½æœ‰ä¸€å®šç¨‹åº¦çš„æå‡ï¼Œä»–ä»¬ç§°è¯¥èŒƒå›´ä¸ºâ€œç¨³å®šé˜¶æ®µâ€ã€‚ä¸ºæ­¤ï¼Œç ”ç©¶è®¡ç®—äº†0-1000ç±³é˜ˆå€¼èŒƒå›´å†…ï¼Œä»¥10ç±³ä¸ºæ­¥é•¿çš„è½¨è¿¹å¹³å‡èŠ‚ç‚¹æ•°è´Ÿå¢žé•¿çŽ‡ä»¥åŠè½¨è¿¹å¹³å‡é•¿åº¦è´Ÿå¢žé•¿çŽ‡ï¼Œå¾—åˆ°æ•°æ®é›†çš„6ä¸ªâ€œç¨³å®šé˜¶æ®µâ€ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚<br /><img src="https://atffang.github.io/2025/08/29/åŸºäºŽAISæ•°æ®è¿›è¡Œèˆ¹èˆ¶è½¨è¿¹åˆ†æ®µåˆæˆçš„ä¸€ç‚¹æ€è·¯/008.jpg"/><br />ä¸ºäº†å°½å¯èƒ½ä¿å…¨è½¨è¿¹ç»“æž„ï¼Œç ”ç©¶é€‰å–äº†å¤„äºŽç¬¬ä¸€ä¸ªç¨³å®šé˜¶æ®µçš„åŽ‹ç¼©é˜ˆå€¼350mã€‚åœ¨è¯¥é˜ˆå€¼ä¸‹ï¼Œç»åŽ‹ç¼©ï¼Œæ•°æ®é›†ä¸­æ¯æ¡è½¨è¿¹çš„å¹³å‡èŠ‚ç‚¹æ•°å‡å°‘è‡³åŽŸæ¥çš„44%ï¼Œä½†å¹³å‡è½¨è¿¹é•¿åº¦ä»ä¿æŒåœ¨åŽŸæ¥çš„98%ï¼Œè¿™è¯´æ˜Žè¯¥åŽ‹ç¼©ç®—æ³•åœ¨å¤§å¹…åº¦å‡å°‘è½¨è¿¹èŠ‚ç‚¹æ•°é‡çš„åŒæ—¶ï¼Œè¾ƒå¥½åœ°ä¿å­˜äº†è½¨è¿¹åŽŸæœ‰çš„å½¢æ€ç‰¹å¾ã€‚</p><h3 id="åŽè®°"><a class="markdownIt-Anchor" href="#åŽè®°"></a> åŽè®°</h3><p>ä¸Šè¿°çš„AISæ•°æ®èŽ·å–-åˆ†æ®µè½¨è¿¹åˆæˆ-è½¨è¿¹åŽ‹ç¼©æž„æˆæ˜¯å½“æ—¶æ¯•ä¸šè®¾è®¡çš„æ•°æ®é¢„å¤„ç†éƒ¨åˆ†ï¼ŒåŽç»­ç»§ç»­è¿›è¡Œäº†èšç±»ã€åˆ†æžç­‰æ“ä½œï¼Œè¿™éƒ¨åˆ†ä»¥åŽæœ‰æœºä¼šå†è®²å§ã€‚çŽ°åœ¨å›žçœ‹æˆ‘çš„æ¯•ä¸šè®¾è®¡çš„åŽç»­éƒ¨åˆ†ä¹Ÿæ˜¯ç¨€å¥‡å¤æ€ªçš„ï¼Œè­¬å¦‚ä¿®æ”¹DTWè·ç¦»è®¡ç®—æ–¹å¼æ¥æ¶ˆé™¤é•¿åº¦å¯¼è‡´çš„ç›¸å…³æ€§ï¼Œç”¨ä¸€å †æ¦‚çŽ‡åˆ†å¸ƒæ‹Ÿåˆè®¡ç®—æœ€ä¼˜èšç±»å‚æ•°ç­‰ç­‰ï¼ŒçŽ°åœ¨è§‰å¾—ä¼¼ä¹Žä¸å¤Ÿä¸¥è°¨ï¼Œä½†ä¹Ÿä¸å¤ªæ¸…æ¥šæœ‰ä»€ä¹ˆæ›´å¥½çš„æ”¹è¿›æ–¹æ³•ï¼Œçœ‹æ¥æ°´å¹³æ²¡æœ‰è¿›æ­¥ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ä»‹ç»ä¸€ä¸‹æœ¬ç§‘æ¯•è®¾é‡Œå…³äºŽåŸºäºŽAISæ•°æ®è¿›è¡Œèˆ¹èˆ¶è½¨è¿¹åˆæˆéƒ¨åˆ†çš„ä¸€ç‚¹æ€è·¯ï¼Œéžä¸“ä¸šï¼Œä»…åˆ†äº«&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>å®žéªŒå®¤å®‰å…¨æ£€æµ‹ç³»ç»Ÿ</title>
    <link href="https://atffang.github.io/2025/07/19/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%AE%89%E5%85%A8%E6%A3%80%E6%B5%8B%E7%B3%BB%E7%BB%9F/"/>
    <id>https://atffang.github.io/2025/07/19/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%AE%89%E5%85%A8%E6%A3%80%E6%B5%8B%E7%B3%BB%E7%BB%9F/</id>
    <published>2025-07-19T02:25:37.000Z</published>
    <updated>2025-07-19T08:39:55.980Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘å‚ä¸Žäº†ä¸€ä¸ªæ¨ªå‘ï¼Œé¡¹ç›®æž¶æž„ä¸ŽåŸºç¡€ä»£ç å¤§æ¦‚ç¨³å®šä¸‹æ¥äº†ï¼Œæµ…æµ…è®°å½•ä¸€ä¸‹ã€‚</p><span id="more"></span><h3 id="å†™åœ¨å‰é¢"><a class="markdownIt-Anchor" href="#å†™åœ¨å‰é¢"></a> å†™åœ¨å‰é¢</h3><p>å®žé™…ä¸Šè¿™ä¸ªé¡¹ç›®åœ¨æŠ€æœ¯ä¸Šå¹¶ä¸éš¾ï¼Œç”šè‡³æ¯”è®¸å¤šå·¥ä½œç®€å•çš„å¤šï¼Œä½†è®©äººå¤´ç–¼çš„ä¸»è¦æ˜¯ä¸‰ç‚¹ï¼š</p><ul><li>å…¸åž‹å°ä½œåŠåšæ´¾ï¼Œå‰ç«¯ã€æ•°æ®åº“ã€è¯†åˆ«ç³»ç»Ÿã€æ¨¡åž‹å…¨è¦åšï¼Œæ²¡æœ‰æ˜Žç¡®çš„èŒè´£åˆ†å·¥</li><li>å†…ç½‘å¼€å‘ï¼Œæµ‹è¯•ä¹Ÿå¾ˆå›°éš¾ï¼Œæ¯å¤©è¦éª‘ä¸ªç”µç“¶è½¦åŽ»update</li><li>éœ€æ±‚å«æ··ä¸æ¸…ï¼Œä¸€ä¼šè¯´ç”¨è¿™ä¸ªä¸€ä¼šè¯´ç”¨é‚£ä¸ªï¼Œä¸ºæ­¤æŽ¥å…¥æ•°æ®çš„é€»è¾‘æ”¹äº†né</li></ul><h3 id="ç³»ç»Ÿéœ€æ±‚ä¸Žæž¶æž„"><a class="markdownIt-Anchor" href="#ç³»ç»Ÿéœ€æ±‚ä¸Žæž¶æž„"></a> ç³»ç»Ÿéœ€æ±‚ä¸Žæž¶æž„</h3><p>é¢†å¯¼éœ€è¦ä¸€ä¸ªæŽ¥å…¥ç›‘æŽ§ç³»ç»Ÿï¼Œå®žæ–½ç›‘æµ‹å„ä¸ªå®žéªŒå®¤å®žéªŒäººå‘˜æ“ä½œè§„èŒƒæ€§ï¼Œå¹¶å½’çº³æ€»ç»“çš„ç³»ç»Ÿï¼ŒçŽ°åœ¨å·²åœ¨æŽ¥å…¥äº†ä¸€ç™¾ä½™ä¸ªç›‘æŽ§è®¾å¤‡ï¼ŒåŽç»­å°†æŽ¨å¹¿è‡³ä¸€åƒä½™ä¸ªè®¾å¤‡ï¼Œå…¶å¤§è‡´æž¶æž„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br /><img src="https://atffang.github.io/2025/07/19/å®žéªŒå®¤å®‰å…¨æ£€æµ‹ç³»ç»Ÿ/æž¶æž„.png"/><br />æŒ‰ç…§è¯¥æž¶æž„ï¼Œé‡ç‚¹çš„å†…å®¹ä¸ºç›‘æŽ§è½®è¯¢ä¸Žå¸§è¯†åˆ«ä¸¤éƒ¨åˆ†ï¼Œç¨‹åºå°†ä»¥è®¾å®šçš„è½®è¯¢é—´éš”ä¾æ¬¡é€šè¿‡åŽ‚å•†æä¾›çš„SDKè®¿é—®æ‘„åƒå¤´å¹¶æˆªå›¾ï¼Œå°†æˆªå›¾ä¸ŽåŒ…æ‹¬æ‘„åƒå¤´åŸºç¡€ä¿¡æ¯ã€æ—¶é—´ç­‰çš„å…ƒæ•°æ®äº¤äºˆæ¶ˆæ¯é˜Ÿåˆ—å¹¶åˆ†å‘ç»™å¤šä¸ªè¯†åˆ«è®¾å¤‡è¿›è¡Œå›¾åƒè¯†åˆ«ã€‚åœ¨è¯•è¿è¡Œç‰ˆæœ¬ä¸­ï¼Œæ•´ä¸ªä½“ç³»éƒ½åœ¨ä¸€å°ä¸€å¼ gpuçš„è®¾å¤‡ä¸Šè¿è¡Œã€‚å›¾åƒè¯†åˆ«å®ŒæˆåŽï¼Œå°†è¯†åˆ«ç»“æžœæ±‡æ€»åŽå­˜å…¥æ•°æ®åº“ä¸­ã€‚</p><h3 id="ä»»åŠ¡æ¨¡åž‹è®­ç»ƒ"><a class="markdownIt-Anchor" href="#ä»»åŠ¡æ¨¡åž‹è®­ç»ƒ"></a> ä»»åŠ¡æ¨¡åž‹è®­ç»ƒ</h3><p>ç”²æ–¹æå‡ºäº†è¯†åˆ«å®žéªŒå®¤å®žéªŒäººå‘˜ä¸ç©¿ç™½å¤§è¤‚ã€å¤œé—´å•äººåšå®žéªŒã€æ¶ˆé˜²é€šé“å ç”¨ã€åºŸæ¶²æ¡¶æ˜¯å¦ç›–ç›–å­ã€é€šé£Žæ©±å¼€å¯æ˜¯å¦è§„èŒƒç­‰ç­‰ã€‚è¿™äº›éœ€æ±‚æœ‰çš„å¯ä»¥ç›´æŽ¥è°ƒç”¨YOLOæ¨¡åž‹ï¼Œæœ‰çš„åˆ™éœ€è¦è‡ªè¡Œè®­ç»ƒæ¨¡åž‹ã€‚</p><p>ä»¥<strong>å®žéªŒäººå‘˜ç©¿ç€</strong>ä¸ºä¾‹ï¼Œé¦–å…ˆåŸºäºŽYOLOv11æ¨¡åž‹æå–å¤šå¼ ç›‘æŽ§æˆªå›¾ä¸­çš„äººç‰©è¾¹æ¡†å¹¶è£å‡ï¼Œä½¿ç”¨è‡ªå·±è®¾è®¡çš„æ ‡æ³¨å·¥å…·è¿›è¡Œæ˜¯å¦ç©¿ç€å®žéªŒæœè£…çš„æ­£è´Ÿæ ·æœ¬æ ‡æ³¨ï¼Œçº¦ä¸¤åƒä½™å¼ ã€‚ä½¿ç”¨è¯¥æ•°æ®ï¼ŒåŸºäºŽ<strong>MobileNetV2</strong>æ¨¡åž‹è®­ç»ƒæˆ‘ä»¬éœ€æ±‚çš„åˆ†ç±»æ¨¡åž‹ã€‚</p><p><strong>MobileNetV2</strong> æ˜¯ Google åœ¨ 2018 å¹´æå‡ºçš„ä¸€ç§è½»é‡çº§å·ç§¯ç¥žç»ç½‘ç»œæž¶æž„ï¼Œæˆ‘ä»¬å°†å…¶è¿ç§»è‡³æˆ‘ä»¬çš„ä»»åŠ¡ä¸Šã€‚å…·ä½“ä»»åŠ¡æµç¨‹ä¸Žè¦ç‚¹å¦‚ä¸‹ï¼š</p><ol><li>æŒ‰ç…§8ï¼š2åˆ’åˆ†æ•°æ®é›†</li><li>åŠ è½½ ImageNet ä¸Šé¢„è®­ç»ƒå¥½çš„æƒé‡</li><li>å°†MobileNetV2 çš„æœ€åŽä¸€å±‚ <code>nn.Sequential</code>æ›¿æ¢ä¸ºè¾“å‡º 2 ç±»</li><li>ä»»åŠ¡é‡‡ç”¨äº¤å‰ç†µæŸå¤±å‡½æ•°ï¼Œ Adamä¼˜åŒ–å™¨ï¼Œè®­ç»ƒ epochs=10, batchsize=32, lr=1e-4<br />æœ€ç»ˆï¼Œåˆ†ç±»æ¨¡åž‹çš„Accuracyä¸º0.9850ï¼Œè¾¾åˆ°äº†é¢„æœŸéœ€æ±‚ã€‚</li></ol><p>æ•´ä½“æ¨¡åž‹é¦–å…ˆä½¿ç”¨yolo11sè¯†åˆ«äººï¼Œç½®ä¿¡é˜ˆå€¼è®¾ç½®ä¸º0.4ï¼ŒéšåŽä½¿ç”¨è‡ªå·±è®­ç»ƒçš„äºŒåˆ†ç±»æ¨¡åž‹è¿›è¡Œæ˜¯å¦ç©¿ç™½å¤§è¤‚çš„åˆ¤åˆ«ï¼Œåœ¨åŽç»­çš„æµ‹è¯•ä¸­ï¼Œå‘çŽ°å…¶åŸºæœ¬å¯ä»¥æ»¡è¶³éœ€æ±‚ï¼Œä½†ä»å¯¹ç©¿ç€ç™½è‰²Tæ¤çš„å®žéªŒäººå‘˜æœ‰æ¼æ£€æƒ…å†µï¼Œéœ€è¦åŽç»­å¯¹æ¨¡åž‹è¿›è¡Œæ”¹è¿›ã€‚</p><h3 id="produceræ¨¡å—è®¾è®¡"><a class="markdownIt-Anchor" href="#produceræ¨¡å—è®¾è®¡"></a> Produceræ¨¡å—è®¾è®¡</h3><p>è¯»å–æ•°æ®åº“ä¸­å½“æ—¥éœ€è¦è®¿é—®çš„æ‘„åƒå¤´çš„idï¼ŒåŸºäºŽæ‘„åƒå¤´åŽ‚å•†æä¾›çš„ç›‘æŽ§rtspè§†é¢‘æµPython SDKï¼Œè½®è¯¢æ‘„åƒå¤´èŽ·å–rtsp urlã€‚ä¸€å¼€å§‹ä½¿ç”¨opencvé“¾æŽ¥æµå¹¶æˆªå–å¸§ï¼Œä½†æ˜¯æˆªå–æ•ˆçŽ‡å’Œå†…å­˜å ç”¨éƒ½å¾ˆä¸ç†æƒ³ï¼ŒåŽæ¥å°±ç›´æŽ¥æ”¹ç”¨äº†<strong>ffmpeg</strong>æˆªå–ï¼Œåœ¨å¤„ç†é€Ÿåº¦å’Œå†…å­˜å ç”¨ä¸Šéƒ½ä¼˜åŒ–äº†è®¸å¤šã€‚</p><p>ç”±äºŽä»å­˜åœ¨ä¸€å®šçš„ç­‰å¾…æ—¶é—´ï¼Œé‡‡ç”¨çº¿ç¨‹æ± æäº¤ä»»åŠ¡ï¼Œå¤§æ¦‚é€»è¾‘å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨çº¿ç¨‹æ± æäº¤ä»»åŠ¡</span></span><br><span class="line"><span class="keyword">with</span> concurrent.futures.ThreadPoolExecutor(max_workers=<span class="number">4</span>) <span class="keyword">as</span> executor:</span><br><span class="line">Â  Â  futures = [executor.submit(ffmpeg_cut, *task) <span class="keyword">for</span> task <span class="keyword">in</span> tasks]</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">for</span> future <span class="keyword">in</span> concurrent.futures.as_completed(futures):</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">try</span>:</span><br><span class="line">Â  Â  Â  Â  Â  Â  result = future.result()Â </span><br><span class="line">Â  Â  Â  Â  <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="built_in">print</span>(<span class="string">f&quot;Task raised an exception: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>åœ¨æˆªå–å®Œæˆå›¾åƒåŽï¼Œä¿å­˜è‡³æœ¬åœ°å¹¶å°†å…ƒæ•°æ®åŠ å…¥æ¶ˆæ¯é˜Ÿåˆ—ã€‚</p><h3 id="æ¶ˆæ¯é˜Ÿåˆ—è®¾è®¡"><a class="markdownIt-Anchor" href="#æ¶ˆæ¯é˜Ÿåˆ—è®¾è®¡"></a> æ¶ˆæ¯é˜Ÿåˆ—è®¾è®¡</h3><p>åœ¨å•æœºä»»åŠ¡ä¸­ï¼Œä»»åŠ¡é˜Ÿåˆ—ç”±Pythonç»´æŠ¤ï¼Œè®¾è®¡ä¸€ä¸ªPhotoMessageç±»å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@dataclass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PhotoMessage</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Attributes:</span></span><br><span class="line"><span class="string">        photo_id: å¸§çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆé»˜è®¤ä½¿ç”¨ UUIDï¼‰</span></span><br><span class="line"><span class="string">camera_id: æ‘„åƒå¤´çš„æ ‡è¯†ç¬¦</span></span><br><span class="line"><span class="string">room_id: ç‰©ç†ä½ç½®çš„æ ‡è¯†ç¬¦</span></span><br><span class="line"><span class="string">photo_path: å¸§åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­çš„è·¯å¾„æˆ–å†…å­˜å¼•ç”¨</span></span><br><span class="line"><span class="string">timestamp: å¸§çš„æ•èŽ·æ—¶é—´ï¼ˆå¦‚æžœæœªæä¾›åˆ™è‡ªåŠ¨ç”Ÿæˆï¼‰</span></span><br><span class="line"><span class="string">metadata: é™„åŠ çš„å¤„ç†ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ˆå¦‚æ¨¡åž‹è¾“å‡ºç­‰ï¼‰</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    camera_id: <span class="built_in">str</span></span><br><span class="line">    room_id: <span class="built_in">str</span></span><br><span class="line">    photo_path: Path</span><br><span class="line">    photo_id: <span class="built_in">str</span> = field(default_factory=<span class="keyword">lambda</span>: <span class="built_in">str</span>(uuid.uuid4()))</span><br><span class="line">    timestamp: datetime = field(default_factory=datetime.now)</span><br><span class="line">    metadata: <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="type">Any</span>] = field(default_factory=<span class="built_in">dict</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">to_json</span>(<span class="params">self</span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="comment"># â€¦â€¦</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œæœ‰å¦‚ photo_id æ˜¯è¿è¡Œæ—¶ç”Ÿæˆä¸€ä¸ªå”¯ä¸€å€¼ï¼ˆä¸èƒ½æå‰å›ºå®šæˆæŸä¸ªé»˜è®¤å­—ç¬¦ä¸²ï¼‰ã€‚å¦‚æžœä½ å†™ photo_id: str = str(uuid.uuid4())ï¼Œé‚£ä¹ˆæ‰€æœ‰å¯¹è±¡éƒ½ä¼šé»˜è®¤ç”¨<strong>åŒä¸€ä¸ª UUID</strong>ï¼ˆå› ä¸ºé»˜è®¤å€¼åªä¼šåœ¨ç±»å®šä¹‰æ—¶æ±‚ä¸€æ¬¡å€¼ï¼‰ã€‚è€Œdefault_factory ä¼šåœ¨æ¯æ¬¡åˆ›å»ºå¯¹è±¡æ—¶è°ƒç”¨ lambda ç”Ÿæˆæ–°çš„å€¼ã€‚åœ¨ dataclass ä¸­ï¼Œ<strong>å‡¡æ˜¯å¸¦å‰¯ä½œç”¨çš„é»˜è®¤å€¼ï¼ˆå½“å‰æ—¶é—´ã€UUIDã€åˆ—è¡¨ã€å­—å…¸ç­‰ï¼‰éƒ½åº”ä½¿ç”¨ default_factory</strong>ï¼Œå¦åˆ™ä¼šå¼•å‘ä¸å¯é¢„æµ‹çš„è¡Œä¸ºæˆ–å…±äº«çŠ¶æ€ã€‚</p><p>ä¸ºäº†è¡¨ç¤ºé˜Ÿåˆ—ï¼Œè®¾è®¡ä¸€ä¸ªGlobalMessageQueueç±»å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">GlobalMessageQueue</span>():</span><br><span class="line">    _instance = <span class="literal">None</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__new__</span>(<span class="params">cls</span>):</span><br><span class="line">        <span class="keyword">if</span> cls._instance <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            cls._instance = <span class="built_in">super</span>().__new__(cls)</span><br><span class="line">            cls._instance._queue = queue.LifoQueue(maxsize=<span class="number">10000</span>)</span><br><span class="line">            cls._instance._persist_file = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">return</span> cls._instance</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">put_message</span>(<span class="params">self, msg: PhotoMessage</span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        å­˜å…¥æ¶ˆæ¯åˆ°é˜Ÿåˆ—</span></span><br><span class="line"><span class="string">        :param msg: PhotoMessageå®žä¾‹</span></span><br><span class="line"><span class="string">        :return: æ˜¯å¦æˆåŠŸå…¥é˜Ÿ</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            self._queue.put_nowait(msg)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">except</span> queue.Full:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;WARNING: æ¶ˆæ¯é˜Ÿåˆ—å·²æ»¡ï¼Œä¸¢å¼ƒæœ€æ—©çš„æ¶ˆæ¯&quot;</span>)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                self._queue.get_nowait()  <span class="comment"># ä¸¢å¼ƒæœ€æ—§æ¶ˆæ¯</span></span><br><span class="line">                self._queue.put_nowait(msg)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            <span class="keyword">except</span> queue.Empty:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_message</span>(<span class="params">self</span>) -&gt; <span class="type">Optional</span>[PhotoMessage]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        éžé˜»å¡žèŽ·å–æ¶ˆæ¯</span></span><br><span class="line"><span class="string">        :return: PhotoMessageå®žä¾‹æˆ–None</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">return</span> self._queue.get_nowait()</span><br><span class="line">        <span class="keyword">except</span> queue.Empty:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">persist_messages</span>(<span class="params">self, file_path: Path</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        æŒä¹…åŒ–é˜Ÿåˆ—åˆ°ç£ç›˜</span></span><br><span class="line"><span class="string">        :param file_path: å­˜å‚¨æ–‡ä»¶è·¯å¾„</span></span><br><span class="line"><span class="string">        :return: æŒä¹…åŒ–çš„æ¶ˆæ¯æ•°é‡</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># â€¦â€¦</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">load_messages</span>(<span class="params">self, file_path: Path</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        ä»Žç£ç›˜åŠ è½½æ¶ˆæ¯åˆ°é˜Ÿåˆ—</span></span><br><span class="line"><span class="string">        :param file_path: å­˜å‚¨æ–‡ä»¶è·¯å¾„</span></span><br><span class="line"><span class="string">        :return: åŠ è½½çš„æ¶ˆæ¯æ•°é‡</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># â€¦â€¦</span></span><br><span class="line">        <span class="keyword">return</span> count</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">set_persist_file</span>(<span class="params">self, file_path: Path</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;è®¾ç½®è‡ªåŠ¨æŒä¹…åŒ–æ–‡ä»¶è·¯å¾„&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># â€¦â€¦</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__del__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;æžæž„æ—¶è‡ªåŠ¨æŒä¹…åŒ–&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># â€¦â€¦</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">size</span>(<span class="params">self</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        èŽ·å–å½“å‰é˜Ÿåˆ—çš„å¤§å°</span></span><br><span class="line"><span class="string">        :return: é˜Ÿåˆ—ä¸­æ¶ˆæ¯çš„æ•°é‡</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># â€¦â€¦</span></span><br></pre></td></tr></table></figure><p>è¯¥ç±» GlobalMessageQueue å®žçŽ°äº†çº¿ç¨‹å®‰å…¨çš„<strong>å…¨å±€å•ä¾‹æ¶ˆæ¯é˜Ÿåˆ—</strong>ï¼Œä½¿ç”¨ LifoQueue å­˜å‚¨ PhotoMessage å®žä¾‹ï¼Œæ”¯æŒæ¶ˆæ¯çš„å…¥é˜Ÿã€å‡ºé˜Ÿã€ç£ç›˜æŒä¹…åŒ–å’ŒåŠ è½½ï¼Œå¹¶åœ¨å¯¹è±¡é”€æ¯æ—¶è‡ªåŠ¨ä¿å­˜é˜Ÿåˆ—å†…å®¹ï¼Œé˜²æ­¢æ•°æ®ä¸¢å¤±ã€‚</p><p>å½“ç„¶ï¼Œåœ¨å¤šè®¾å¤‡å¹¶è¡Œå¤„ç†ä¸­ï¼Œå¯ä½¿ç”¨Redisä½œä¸ºå¤šè®¾å¤‡å…±äº«çš„æ¶ˆæ¯é˜Ÿåˆ—ã€‚</p><h3 id="consumeræ¨¡å—è®¾è®¡"><a class="markdownIt-Anchor" href="#consumeræ¨¡å—è®¾è®¡"></a> Consumeræ¨¡å—è®¾è®¡</h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªçˆ¶ç±»BaseModelï¼Œè§„èŒƒäº†æ¨¡åž‹å¯¹äºŽå›¾åƒè¾“å…¥çš„é¢„å¤„ç†æ–¹å¼ã€‚é…ç½®ä»ŽæŒ‡å®šconfigä¸­è¯»å–ï¼Œè§„èŒƒæ¨¡åž‹çš„åç§°ã€æƒé‡æ–‡ä»¶ä½ç½®ã€é¢„å¤„ç†æ–¹æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">BaseModel</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, config: <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="type">Any</span>]</span>):</span><br><span class="line">        self.device = torch.device(<span class="string">&quot;cuda&quot;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&quot;cpu&quot;</span>)</span><br><span class="line">        self.name = config[<span class="string">&quot;name&quot;</span>]</span><br><span class="line">        self.preprocess = config[<span class="string">&quot;preprocess&quot;</span>]</span><br><span class="line">        self.pipeline = config[<span class="string">&quot;pipeline&quot;</span>]</span><br><span class="line"></span><br><span class="line">        self._build_preprocess_method()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># é¢„å¤„ç†ç±»</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_build_preprocess_method</span>(<span class="params">self</span>):</span><br><span class="line">        preprocess = self.preprocess</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">preprocess_image</span>(<span class="params">self, message: PhotoMessage</span>):</span><br><span class="line">            <span class="comment"># è°ƒç”¨_cropå’Œ_resizeçš„é€»è¾‘</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> image</span><br><span class="line">        </span><br><span class="line">        self.preprocess_image = MethodType(preprocess_image, self)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_crop</span>(<span class="params">self, message: PhotoMessage, image: Image.Image</span>):</span><br><span class="line">        <span class="comment"># â€¦â€¦</span></span><br><span class="line">        <span class="keyword">return</span> image</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_resize</span>(<span class="params">self, message: PhotoMessage, image: Image.Image</span>):</span><br><span class="line">        <span class="keyword">return</span> image.resize(self.preprocess[<span class="string">&quot;size&quot;</span>])</span><br></pre></td></tr></table></figure><p>éšåŽç»§æ‰¿è¯¥ç±»ï¼Œå®šä¹‰ä¸€ä¸ªIdentificationModelå­ç±»ï¼Œæ–°å¢žä¸€ä¸ª_loadmodelåŠŸèƒ½ï¼Œéœ€è¦è¿”å›žä¸€ä¸ªpredictæ–¹æ³•ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">IdentificationModel</span>(<span class="title class_ inherited__">BaseModel</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, config: <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="type">Any</span>]</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__(config)</span><br><span class="line">        self.predict = self._loadmodel()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_loadmodel</span>(<span class="params">self</span>):</span><br><span class="line">        predict = ModelLoader.loader(self.name, self.pipeline, self.device)</span><br><span class="line">        <span class="keyword">return</span> predict</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.name</span><br></pre></td></tr></table></figure><p>ç”±äºŽå½“å‰æ¨¡åž‹éƒ½æš‚æ—¶åªéœ€è¦ä¸€ä¸ªpredictæ–¹æ³•ï¼Œå› æ­¤ï¼Œæš‚æ—¶åªä½¿ç”¨è¯¥å­ç±»ã€‚å¯ä»¥æ³¨æ„åˆ°ï¼ŒIdentificationModelç±»ä½¿ç”¨äº†ä¸€ä¸ªModelLoaderç±»ï¼Œè¯¥ç±»è´Ÿè´£æ¯ä¸ªå…·ä½“çš„è¯†åˆ«æ¨¡åž‹çš„predicté€»è¾‘ï¼Œè¿”å›žæ¯ä¸ªæ¨¡åž‹ä¸­æˆ‘ä»¬éœ€è¦çš„predictå‡½æ•°ï¼Œç”±äºŽè¿‡äºŽå†—é•¿ï¼Œä¸åšå±•ç¤ºã€‚</p><p>åŸºäºŽä¸Šè¿°ç±»ï¼Œconsumerçº¿ç¨‹å¯ä»¥å¾ˆè½»æ¾çš„ä»Žé…ç½®æ–‡ä»¶ä¸­åŠ è½½æ¨¡åž‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">self.modellist = []</span><br><span class="line"><span class="keyword">for</span> config <span class="keyword">in</span> config_list:</span><br><span class="line">    self.modellist.append(IdentificationModel(config))</span><br></pre></td></tr></table></figure><p>å¹¶é€ä¸ªè°ƒç”¨æ¨¡åž‹å¯¹å›¾ç‰‡è¿›è¡Œè¯†åˆ«ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> model <span class="keyword">in</span> self.modellist:                </span><br><span class="line">    photo = model.preprocess_image(message)</span><br><span class="line">    output = model.predict(message, photo)</span><br></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œåœ¨consumerå†…éƒ¨ä¹Ÿé‡‡ç”¨äº†å¤šçº¿ç¨‹çš„è®¾è®¡ï¼Œæ­¤å¤„ä¸å†èµ˜è¿°ã€‚</p><h3 id="å­˜å‚¨æ¨¡å—è®¾è®¡"><a class="markdownIt-Anchor" href="#å­˜å‚¨æ¨¡å—è®¾è®¡"></a> å­˜å‚¨æ¨¡å—è®¾è®¡</h3><p>å­˜å‚¨æ¨¡å—è´Ÿè´£å°†è¯†åˆ«ç»“æžœæ•´ç†åŽå­˜å…¥Postgresqlæ•°æ®åº“ï¼Œè¯†åˆ«ç»“æžœå›¾ç‰‡å­˜å…¥Minioæ¡¶å®¹å™¨ï¼Œä¹‹é—´é€šè¿‡å”¯ä¸€çš„uuidç›¸å…³è”ï¼Œæ­¤å¤„ä¸å¤šèµ˜è¿°ã€‚</p><h3 id="å®¹å™¨åŒ–éƒ¨ç½²"><a class="markdownIt-Anchor" href="#å®¹å™¨åŒ–éƒ¨ç½²"></a> å®¹å™¨åŒ–éƒ¨ç½²</h3><p>ç”±äºŽæœ¬é¡¹ç›®æ¶‰åŠåˆ°æ·±åº¦å­¦ä¹ çŽ¯å¢ƒä»¥åŠredisã€minioã€psqlç­‰å·¥å…·ï¼Œå› æ­¤ï¼Œä½¿ç”¨dockeréƒ¨ç½²æ˜¯æœ€å¿«é€Ÿæœ€å®‰å…¨çš„æ–¹å¼ã€‚ä½†æ˜¯è¿™é‡Œæœ‰ä¸ªå¤§å‘ï¼æˆ‘åŽŸæœ¬åŸºäºŽdockerfileæž„å»ºäº†å¸¦cudaé©±åŠ¨ã€nvccã€pythonçŽ¯å¢ƒä»¥åŠffmpegç­‰çš„å®¹å™¨ï¼Œä½†æ˜¯å‘çŽ°ï¼Œç”±äºŽwindowsä¸Šçš„dockeræ˜¯æœºé‡wslå®žçŽ°çš„ï¼Œå’Œæœ¬æœºä¹‹é—´å­˜åœ¨ç½‘ç»œçš„éš”ç¦»ï¼Œåœ¨å®¹å™¨å†…è¿è¡Œçš„pythonç¨‹åºè¯»ä¸åˆ°å±€åŸŸç½‘ä¸‹çš„rtspæµã€‚æœ¬äººå½“å³è¡¨ç¤ºçƒ¦ã€‚<br />æ— å¥ˆï¼Œåªèƒ½æš‚æ—¶çº¿æŠŠä¸»è¦ç¨‹åºæ”¾åœ¨å®¿ä¸»æœºä¸Šæ‰§è¡Œï¼Œredisã€minioã€psqlä½¿ç”¨dockeréƒ¨ç½²ã€‚è¯¥é¡¹ç›®çš„docker-composeå¦‚ä¸‹ï¼š</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.8&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis:7</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">labsecurity_redis</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;6379:6379&quot;</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">minio:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">minio/minio</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">labsecurity_minio</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;9000:9000&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;9001:9001&quot;</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">MINIO_ROOT_USER:</span> <span class="string">minioadmin</span></span><br><span class="line">      <span class="attr">MINIO_ROOT_PASSWORD:</span> <span class="string">minioadmin</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">server</span> <span class="string">/data</span> <span class="string">--console-address</span> <span class="string">&quot;:9001&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">minio_data:/data</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">minio-init:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">minio/mc</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">minio</span></span><br><span class="line">    <span class="attr">entrypoint:</span> <span class="string">&gt;</span></span><br><span class="line"><span class="string">      /bin/sh -c &quot;</span></span><br><span class="line"><span class="string">      sleep 5;</span></span><br><span class="line"><span class="string">      mc alias set local http://minio:9000 minioadmin minioadmin;</span></span><br><span class="line"><span class="string">      mc mb -p local/detection-results;</span></span><br><span class="line"><span class="string">      mc policy set public local/detection-results;</span></span><br><span class="line"><span class="string">      exit 0;</span></span><br><span class="line"><span class="string">      &quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">  <span class="attr">postgres:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">postgres:17</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">labsecurity_postgres</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">POSTGRES_DB:</span> <span class="string">labcamera</span></span><br><span class="line">      <span class="attr">POSTGRES_USER:</span> <span class="string">postgres</span></span><br><span class="line">      <span class="attr">POSTGRES_PASSWORD:</span> <span class="string">postgres</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;5434:5432&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./initdb:/docker-entrypoint-initdb.d</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">pgdata:</span></span><br><span class="line">  <span class="attr">minio_data:</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œåœ¨labsecurity_postgreså®¹å™¨ä¸­ï¼Œæˆ‘æŒ‡å®šäº†æ•°æ®åº“åˆå§‹åŒ–çš„æ–‡ä»¶ä½ç½®ï¼Œå³/initdbï¼Œåªè¦åœ¨è¯¥æ–‡ä»¶å¤¹ä¸‹æ”¾ç½®.sqlï¼Œå®¹å™¨åˆå§‹åŒ–æ—¶å³å¯æ ¹æ®è¯¥sqlæ–‡ä»¶å»ºç«‹æ•°æ®åº“ï¼Œä¸è¦å¤ªæ–¹ä¾¿ã€‚è€Œå®¹å™¨é—´ã€å®¿ä¸»æœºå’Œå®¹å™¨é—´ä¹Ÿå¯ä»¥é€šè¿‡ç«¯å£ç›¸äº’è®¿é—®ï¼Œä¾‹å¦‚ï¼Œåœ¨å…¶ä»–å®¹å™¨å†…é€šè¿‡<code>minio:9000</code>ï¼Œåœ¨æœ¬æœºä¸­å¯ä»¥é€šè¿‡<code>http://localhost:9001/</code>è®¿é—®ã€‚</p><p>é€šè¿‡ <code>docker compose up -d</code> å¯ä»¥ä¸€é”®éƒ¨ç½²å®¹å™¨ï¼Œé€šè¿‡ <code>docker ps` -a</code> æŸ¥çœ‹éƒ¨ç½²æƒ…å†µã€‚æ­¤å¤–ï¼ŒæŒ‰ç…§åŽŸè®¡åˆ’ï¼Œæ·±åº¦å­¦ä¹ çŽ¯å¢ƒä¹Ÿä¼šéƒ¨ç½²åœ¨å®¹å™¨å†…ï¼Œè¿™é‡Œåšä¸ªè®°å½•ï¼Œé¦–å…ˆï¼Œæž„å»º .Dockerfile:</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> nvidia/cuda:<span class="number">12.8</span>.<span class="number">0</span>-cudnn-runtime-ubuntu22.<span class="number">04</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get update &amp;&amp; apt-get install -y python3 python3-pip</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> requirements.txt .</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> pip install torch==2.6.0 torchvision==0.21.0 torchaudio==2.6.0 --index-url https://download.pytorch.org/whl/cu126</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> pip install --no-cache-dir -r requirements.txt</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> ./app /app</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;python3&quot;</span>, <span class="string">&quot;main.py&quot;</span>]</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œè¯¥æ–‡ä»¶æŒ‡å®šäº†å®‰è£…cudaé©±åŠ¨å’Œpythonï¼Œå¹¶æ ¹æ®requirementså®‰è£…å¥½éœ€è¦çš„pythonåŒ…ã€‚åœ¨docker- composeä¸­åŠ ä¸Šï¼š</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">app:</span></span><br><span class="line">    <span class="attr">build:</span> <span class="string">.</span>  </span><br><span class="line">    <span class="attr">runtime:</span> <span class="string">nvidia</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">labsecurity_app</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">postgres</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">minio</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./app:/app</span></span><br><span class="line">    <span class="attr">working_dir:</span> <span class="string">/app</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8888:8888&quot;</span></span><br><span class="line">    <span class="attr">command:</span> [<span class="string">&quot;tail&quot;</span>, <span class="string">&quot;-f&quot;</span>, <span class="string">&quot;/dev/null&quot;</span>]</span><br></pre></td></tr></table></figure><p>å®¹å™¨èƒ½çœ‹åˆ°æœ¬æœºçš„ <code>./app</code> ç›®å½•ï¼Œç‚¹å‡»vscodeå·¦ä¸‹æ–¹çš„&gt;&lt;ï¼Œé€‰æ‹©Attach to Running Containerï¼Œè¿›å…¥pythonå®¹å™¨ï¼Œå°±å¯ä»¥æ„‰å¿«çš„å¼€å‘äº†ã€‚</p><h3 id="æ€»ç»“"><a class="markdownIt-Anchor" href="#æ€»ç»“"></a> æ€»ç»“</h3><p>è¿™ç®—æ˜¯æˆ‘å‚ä¸Žçš„ç®—æ˜¯æ¯”è¾ƒå®Œæ•´çš„æ¨ªå‘äº†ï¼Œä½†æ˜¯ä¹Ÿæ²¡ä»€ä¹ˆå¥½æ€»ç»“çš„ï¼Œæ‡’å¾—æ€»ç»“ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;æœ€è¿‘å‚ä¸Žäº†ä¸€ä¸ªæ¨ªå‘ï¼Œé¡¹ç›®æž¶æž„ä¸ŽåŸºç¡€ä»£ç å¤§æ¦‚ç¨³å®šä¸‹æ¥äº†ï¼Œæµ…æµ…è®°å½•ä¸€ä¸‹ã€‚&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>ä»Ž0å¼€å§‹å­¦java 03 ï¼šè§‚å¯Ÿè€…æ¨¡å¼</title>
    <link href="https://atffang.github.io/2025/07/09/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6java3/"/>
    <id>https://atffang.github.io/2025/07/09/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6java3/</id>
    <published>2025-07-09T08:24:45.000Z</published>
    <updated>2025-07-09T08:26:01.376Z</updated>
    
    <content type="html"><![CDATA[<p>ç”Ÿæ´»æ‰€è¿«å‘€ã€‚</p><span id="more"></span><p><strong>è§‚å¯Ÿè€…æ¨¡å¼</strong>æ˜¯ä¸€ç§è¡Œä¸ºåž‹è®¾è®¡æ¨¡å¼ï¼Œå®ƒå®šä¹‰äº†ä¸€ç§<strong>å¯¹è±¡ä¹‹é—´ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»</strong>ï¼Œä½¿å¾—å½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–å®ƒçš„å¯¹è±¡éƒ½ä¼šè‡ªåŠ¨æ”¶åˆ°é€šçŸ¥å¹¶æ›´æ–°ã€‚</p><p>ä¸ºä»€ä¹ˆè¦ç”¨è§‚å¯Ÿè€…æ¨¡å¼ï¼Ÿæˆ‘ä»¬æœ‰ä¸‹é¢å‡ ä¸ªåŽŸå› ï¼š</p><ul><li><strong>è§£è€¦é€šçŸ¥é€»è¾‘</strong>ï¼šè§‚å¯Ÿè€…æ¨¡å¼çš„æ ¸å¿ƒä»·å€¼åœ¨äºŽï¼š<strong>å‘å¸ƒè€…ï¼ˆè¢«è§‚å¯Ÿè€…ï¼‰å’Œè®¢é˜…è€…ï¼ˆè§‚å¯Ÿè€…ï¼‰ä¹‹é—´æ˜¯è§£è€¦çš„</strong>ã€‚  å‘å¸ƒè€…æ— éœ€çŸ¥é“è§‚å¯Ÿè€…æ˜¯è°ã€åšä»€ä¹ˆï¼Œåªéœ€è¦åœ¨çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶â€œé€šçŸ¥å¤§å®¶â€ï¼›è§‚å¯Ÿè€…åˆ™åªå…³å¿ƒâ€œæ˜¯å¦è®¢é˜…äº†è¯¥å¯¹è±¡â€ï¼Œæ— éœ€çŸ¥é“å‘å¸ƒè€…çš„å…·ä½“ä¸šåŠ¡é€»è¾‘ã€‚</li><li><strong>è‡ªåŠ¨é€šçŸ¥ï¼Œé¿å…è½®è¯¢</strong>ï¼šåœ¨æ²¡æœ‰è§‚å¯Ÿè€…æ¨¡å¼çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦è®©æ¯ä¸ªç»„ä»¶ä¸æ–­æ£€æŸ¥ï¼ˆè½®è¯¢ï¼‰çŠ¶æ€çš„å˜åŒ–ã€‚è¿™ä¸ä»…æ•ˆçŽ‡ä½Žï¼Œè¿˜å®¹æ˜“å†™å‡ºé‡å¤ã€æ··ä¹±çš„ä»£ç ã€‚</li><li><strong>äº‹ä»¶é©±åŠ¨æž¶æž„çš„åŸºç¡€</strong>ï¼šçŽ°ä»£å‰åŽç«¯æ¡†æž¶ï¼ˆå¦‚ Reactã€Vueã€Java Swingã€Springï¼‰ä¸­å¤§é‡ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼æˆ–å…¶å˜ç§ï¼ˆå‘å¸ƒ-è®¢é˜…æ¨¡å¼ï¼‰æ¥æž„å»ºå“åº”å¼ç³»ç»Ÿã€‚</li></ul><h3 id="ç¤ºä¾‹"><a class="markdownIt-Anchor" href="#ç¤ºä¾‹"></a> ç¤ºä¾‹</h3><p>æˆ‘ä»¬è¿˜æ˜¯ä»¥å®žé™…çš„éœ€æ±‚å…¥æ‰‹ï¼Œä¸¾ä¸€ä¸ªæœ€ç»å…¸çš„ä¾‹å­ï¼š</p><p>ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªæ°”è±¡ç«™ç³»ç»Ÿï¼Œå®ƒèƒ½å®žæ—¶ç›‘æµ‹æ¸©åº¦ã€æ¹¿åº¦ã€æ°”åŽ‹ç­‰æ•°æ®ã€‚çŽ°åœ¨æœ‰å¤šä¸ªå¸ƒå‘Šæ¿ï¼ˆæ˜¾ç¤ºé¢æ¿ï¼‰å¸Œæœ›<strong>è‡ªåŠ¨æŽ¥æ”¶åˆ°æœ€æ–°çš„å¤©æ°”æ•°æ®å¹¶æ˜¾ç¤º</strong>ï¼Œæ¯”å¦‚ï¼š</p><ul><li>å½“å‰å¤©æ°”å¸ƒå‘Šæ¿ï¼ˆCurrentConditionsDisplayï¼‰</li><li>ç»Ÿè®¡å¸ƒå‘Šæ¿ï¼ˆStatisticsDisplayï¼‰</li><li>é¢„æŠ¥å¸ƒå‘Šæ¿ï¼ˆForecastDisplayï¼‰<br />ä¸€æ—¦æ°”è±¡ç«™æ›´æ–°æ•°æ®ï¼Œ<strong>æ‰€æœ‰å¸ƒå‘Šæ¿éƒ½åº”ç«‹å³æ›´æ–°å¹¶å±•ç¤ºæœ€æ–°ä¿¡æ¯</strong>ã€‚</li></ul><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ªè¢«è§‚å¯Ÿè€…æŽ¥å£<strong>Subject</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Subject</span> &#123;  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">registerObserver</span><span class="params">(Observer o)</span>;  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">removeObserver</span><span class="params">(Observer o)</span>;  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">notifyObservers</span><span class="params">()</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶è§„èŒƒäº†ä¸‰é¡¹åŠŸèƒ½ï¼š</p><ul><li>æ³¨å†Œè§‚å¯Ÿè€…</li><li>åˆ é™¤è§‚å¯Ÿè€…</li><li>é€šçŸ¥æ‰€æœ‰çš„è§‚å¯Ÿè€…</li></ul><p>å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦å®šä¹‰å¸ƒå‘Šæ¿è§‚å¯Ÿè€…æŽ¥å£<strong>Observer</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Observer</span> &#123;  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(<span class="type">float</span> temp, <span class="type">float</span> humidity, <span class="type">float</span> pressure)</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¢å¤–çš„ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå±•ç¤ºæŽ¥å£<strong>DisplayElement</strong>ï¼Œå½“å¸ƒå‘Šæ¿éœ€è¦æ˜¾ç¤ºæ—¶ï¼Œè°ƒç”¨æ–¹æ³•<strong>display()</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DisplayElement</span> &#123;  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">display</span><span class="params">()</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®šä¹‰å®ŒæŽ¥å£åŽï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰ç±»æ¥å®žçŽ°ä¸»é¢˜äº†ã€‚é¦–å…ˆï¼Œå®šä¹‰ä¸€ä¸ªå®žçŽ°<strong>è¢«è§‚å¯Ÿè€…</strong>æŽ¥å£<strong>Subject</strong>çš„ç±»<strong>WeatherData</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WeatherData</span> <span class="keyword">implements</span> <span class="title class_">Subject</span>&#123;  </span><br><span class="line">    <span class="keyword">private</span> ArrayList observers;  </span><br><span class="line">    <span class="keyword">private</span> <span class="type">float</span> temperature;  </span><br><span class="line">    <span class="keyword">private</span> <span class="type">float</span> humidity;  </span><br><span class="line">    <span class="keyword">private</span> <span class="type">float</span> pressure;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">WeatherData</span><span class="params">()</span>&#123;  </span><br><span class="line">        observers = <span class="keyword">new</span> <span class="title class_">ArrayList</span>();  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">registerObserver</span><span class="params">(Observer o)</span>&#123;  </span><br><span class="line">        observers.add(o);  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">removeObserver</span><span class="params">(Observer o)</span>&#123;  </span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> observers.indexOf(o);  </span><br><span class="line">        <span class="keyword">if</span> (i &gt; <span class="number">0</span>)&#123;  </span><br><span class="line">            observers.remove(i);  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">notifyObservers</span><span class="params">()</span>&#123;  </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i&lt;observers.size(); i++)&#123;  </span><br><span class="line">            <span class="type">Observer</span> <span class="variable">observer</span> <span class="operator">=</span> (Observer) observers.get(i);  </span><br><span class="line">            observer.update(temperature, humidity, pressure);  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">// ä¸€æ—¦æ–°æ•°æ®æ¥äº†ï¼Œè°ƒç”¨æ­¤æ–¹æ³•  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMeasurements</span><span class="params">(<span class="type">float</span> temperature, <span class="type">float</span> humidity, <span class="type">float</span> pressure)</span>&#123;  </span><br><span class="line">        <span class="built_in">this</span>.temperature = temperature;  </span><br><span class="line">        <span class="built_in">this</span>.humidity = humidity;  </span><br><span class="line">        <span class="built_in">this</span>.pressure = pressure;  </span><br><span class="line">        notifyObservers();  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éšåŽï¼Œå®šä¹‰<strong>å¸ƒå‘Šæ¿ï¼ˆè§‚å¯Ÿè€…ï¼‰</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CurrentConditionsDisplay</span> <span class="keyword">implements</span> <span class="title class_">Observer</span>, DisplayElement &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">float</span> temperature;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">float</span> humidity;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">CurrentConditionsDisplay</span><span class="params">(Subject weatherData)</span> &#123;</span><br><span class="line">        weatherData.registerObserver(<span class="built_in">this</span>); <span class="comment">// æ³¨å†Œè‡ªå·±</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(<span class="type">float</span> temperature, <span class="type">float</span> humidity, <span class="type">float</span> pressure)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.temperature = temperature;</span><br><span class="line">        <span class="built_in">this</span>.humidity = humidity;</span><br><span class="line">        display();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">display</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å½“å‰å¤©æ°”ï¼šæ¸©åº¦ = &quot;</span> + temperature + <span class="string">&quot;Â°Cï¼Œæ¹¿åº¦ = &quot;</span> + humidity + <span class="string">&quot;%&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ä¸€ä¸‹è¿™ä¸ªç¨‹åºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WeatherStation</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">WeatherData</span> <span class="variable">weatherData</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WeatherData</span>();</span><br><span class="line"></span><br><span class="line">        <span class="type">CurrentConditionsDisplay</span> <span class="variable">currentDisplay</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CurrentConditionsDisplay</span>(weatherData);</span><br><span class="line"></span><br><span class="line">        weatherData.setMeasurements(<span class="number">30.4f</span>, <span class="number">65.2f</span>, <span class="number">1013.1f</span>);</span><br><span class="line">        weatherData.setMeasurements(<span class="number">28.9f</span>, <span class="number">70.1f</span>, <span class="number">1012.5f</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="javaå†…ç½®å†™æ³•"><a class="markdownIt-Anchor" href="#javaå†…ç½®å†™æ³•"></a> javaå†…ç½®å†™æ³•</h3><p>Java åœ¨æ—©æœŸï¼ˆJDK 1.0ï¼‰å°±å†…ç½®äº†å¯¹è§‚å¯Ÿè€…æ¨¡å¼çš„æ”¯æŒï¼š</p><ul><li><code>java.util.Observable</code>ï¼šè¢«è§‚å¯Ÿè€…ï¼ˆSubjectï¼‰</li><li><code>java.util.Observer</code>ï¼šè§‚å¯Ÿè€…ï¼ˆObserverï¼‰</li></ul><p>è¿˜æ˜¯ä½¿ç”¨ä¸Šé¢æ°”è±¡ç«™çš„ä¾‹å­ï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬ç»§æ‰¿å†…ç½®çš„ç±»<strong>Observable</strong>å®šä¹‰ä¸€ä¸ª<strong>è¢«è§‚å¯Ÿè€…ï¼ˆWeatherDataï¼‰</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Observable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WeatherData</span> <span class="keyword">extends</span> <span class="title class_">Observable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">float</span> temperature;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">float</span> humidity;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">float</span> pressure;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMeasurements</span><span class="params">(<span class="type">float</span> temperature, <span class="type">float</span> humidity, <span class="type">float</span> pressure)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.temperature = temperature;</span><br><span class="line">        <span class="built_in">this</span>.humidity = humidity;</span><br><span class="line">        <span class="built_in">this</span>.pressure = pressure;</span><br><span class="line"></span><br><span class="line">        setChanged(); <span class="comment">// æ ‡è®°çŠ¶æ€å·²æ›´æ–°</span></span><br><span class="line">        notifyObservers(); <span class="comment">// é€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…ï¼ˆæ— å‚æ•°ç‰ˆæœ¬ï¼‰</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">float</span> <span class="title function_">getTemperature</span><span class="params">()</span> &#123; <span class="keyword">return</span> temperature; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">float</span> <span class="title function_">getHumidity</span><span class="params">()</span> &#123; <span class="keyword">return</span> humidity; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">float</span> <span class="title function_">getPressure</span><span class="params">()</span> &#123; <span class="keyword">return</span> pressure; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>setChanged()</code>æ˜¯ <code>Observable</code> æä¾›çš„æ–¹æ³•ï¼Œ<strong>å¿…é¡»è°ƒç”¨</strong>è¿™ä¸ªæ–¹æ³•ï¼Œå‘Šè¯‰ç³»ç»Ÿâ€œæˆ‘å‡†å¤‡å¥½é€šçŸ¥åˆ«äººäº†â€ã€‚å¦‚æžœä¸è°ƒç”¨ <code>setChanged()</code>ï¼ŒåŽç»­çš„ <code>notifyObservers()</code> ä»€ä¹ˆéƒ½ä¸ä¼šå‘ç”Ÿã€‚<br /><code>notifyObservers()</code>ï¼šéåŽ†å½“å‰æ³¨å†Œçš„æ‰€æœ‰è§‚å¯Ÿè€…ï¼ˆé€šè¿‡ <code>addObserver()</code> æ·»åŠ çš„ï¼‰ï¼Œå¹¶ä¾æ¬¡è°ƒç”¨å®ƒä»¬çš„ <code>update()</code> æ–¹æ³•ã€‚é»˜è®¤å‚æ•°ä¸º <code>null</code>ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ <code>notifyObservers(Object arg)</code> ä¼ é€’æ•°æ®ã€‚</p><p>éšåŽï¼Œç»§æ‰¿å†…ç½®ç±»<strong>Observer</strong>å®šä¹‰ä¸€ä¸ª<strong>è§‚å¯Ÿè€…ï¼ˆå¸ƒå‘Šæ¿ï¼‰</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Observer;</span><br><span class="line"><span class="keyword">import</span> java.util.Observable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CurrentConditionsDisplay</span> <span class="keyword">implements</span> <span class="title class_">Observer</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Observable o, Object arg)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (o <span class="keyword">instanceof</span> WeatherData) &#123;</span><br><span class="line">            <span class="type">WeatherData</span> <span class="variable">wd</span> <span class="operator">=</span> (WeatherData) o;</span><br><span class="line">            System.out.println(<span class="string">&quot;å½“å‰å¤©æ°”ï¼šæ¸©åº¦ = &quot;</span> + wd.getTemperature() + <span class="string">&quot;Â°Cï¼Œæ¹¿åº¦ = &quot;</span> + wd.getHumidity() + <span class="string">&quot;%&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>update(Observable o, Object arg)</code>ï¼š å½“è¢«è§‚å¯Ÿè€…è°ƒç”¨ <code>notifyObservers()</code> æ—¶ï¼Œ<strong>æ¯ä¸ªæ³¨å†Œçš„è§‚å¯Ÿè€…çš„ <code>update()</code> æ–¹æ³•éƒ½ä¼šè¢«æ‰§è¡Œ</strong>ã€‚å‚æ•° <code>o</code> æ˜¯è¢«è§‚å¯Ÿè€…å¯¹è±¡æœ¬èº«ï¼ˆå³ <code>WeatherData</code>ï¼‰ã€‚å‚æ•° <code>arg</code> æ˜¯é€šè¿‡ <code>notifyObservers(arg)</code> ä¼ é€’çš„é™„åŠ æ•°æ®ï¼ˆå¦‚æžœè°ƒç”¨çš„æ˜¯ <code>notifyObservers()</code>ï¼Œåˆ™ä¸º <code>null</code>ï¼‰ã€‚</p><p>æ³¨å†Œè§‚å¯Ÿè€…ã€æ›´æ–°æ•°æ®ã€è§¦å‘é€šçŸ¥ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WeatherStation</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">WeatherData</span> <span class="variable">weatherData</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WeatherData</span>();  <span class="comment">// åˆ›å»ºè¢«è§‚å¯Ÿè€…</span></span><br><span class="line">        <span class="type">CurrentConditionsDisplay</span> <span class="variable">display</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CurrentConditionsDisplay</span>(); <span class="comment">// åˆ›å»ºè§‚å¯Ÿè€…</span></span><br><span class="line"></span><br><span class="line">        weatherData.addObserver(display);  <span class="comment">// æ³¨å†Œè§‚å¯Ÿè€…åˆ°è¢«è§‚å¯Ÿè€…å†…éƒ¨åˆ—è¡¨</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ¨¡æ‹Ÿä¸€æ¬¡å¤©æ°”æ•°æ®æ›´æ–°</span></span><br><span class="line">        weatherData.setMeasurements(<span class="number">25.6f</span>, <span class="number">65.0f</span>, <span class="number">1012.0f</span>);  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è™½ç„¶ Java æä¾›äº†è¿™ä¸ªå†…ç½®æœºåˆ¶ï¼Œä½†å®ƒæœ‰ä¸€äº›æ˜Žæ˜¾ç¼ºé™·ï¼Œå› æ­¤åœ¨ JDK 9 åŽå·²æ ‡è®°ä¸ºè¿‡æ—¶ï¼ˆDeprecatedï¼‰ã€‚ ç¼ºç‚¹å¦‚ä¸‹ï¼š</p><ul><li><code>Observable</code> æ˜¯ä¸€ä¸ªç±»ï¼Œä¸æ˜¯æŽ¥å£ï¼Œ<strong>é™åˆ¶äº†ç»§æ‰¿</strong>ï¼ˆJava ä¸æ”¯æŒå¤šç»§æ‰¿ï¼‰</li><li>å†…éƒ¨æ–¹æ³•å¦‚ <code>setChanged()</code> å¹¶éžè‡ªåŠ¨è°ƒç”¨ï¼Œå®¹æ˜“é—æ¼</li><li><code>update()</code> æ–¹æ³•ä¼ å‚è®¾è®¡ä¸çµæ´»</li><li>ä¸æ”¯æŒæ³›åž‹</li></ul><p>å› æ­¤ï¼Œå®žé™…ä¸Šç”¨æˆ‘ä»¬ä¸€å¼€å§‹å†™çš„æ–¹å¼è‡ªå®šä¹‰ <code>Subject</code> å’Œ <code>Observer</code> æŽ¥å£æ˜¯æœ€æ¸…æ™°å’Œé€šç”¨çš„æ–¹å¼ã€‚å“ˆå“ˆã€‚<br />å½“æˆ‘ä»¬åœ¨å¤§åž‹é¡¹ç›®ä¸­ï¼Œé¢ä¸´è¶Šæ¥è¶Šå¤æ‚çš„æ¨¡å—é€šä¿¡ã€å¼‚æ­¥å“åº”ã€æ•°æ®æµå¤„ç†éœ€æ±‚æ—¶ï¼Œä¼ ç»Ÿçš„è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆæ— è®ºæ˜¯è‡ªå®šä¹‰æŽ¥å£è¿˜æ˜¯ Java åŽŸç”Ÿçš„ <code>Observer/Observable</code>ï¼‰éƒ½å¯èƒ½æ˜¾å¾—ä¸å¤Ÿçµæ´»ã€ä¸å¤Ÿå¼ºå¤§ï¼Œå¯èƒ½éœ€è¦æ¶‰åŠåˆ°äº‹ä»¶é©±åŠ¨æž¶æž„ï¼ˆEDAï¼‰æˆ–å“åº”å¼ç¼–ç¨‹ï¼Œåœ¨åŽé¢çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä¼šè®²åˆ°ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ç”Ÿæ´»æ‰€è¿«å‘€ã€‚&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>è¿›ç¨‹å®ˆæŠ¤</title>
    <link href="https://atffang.github.io/2025/07/08/%E8%BF%9B%E7%A8%8B%E5%AE%88%E6%8A%A4/"/>
    <id>https://atffang.github.io/2025/07/08/%E8%BF%9B%E7%A8%8B%E5%AE%88%E6%8A%A4/</id>
    <published>2025-07-08T07:34:03.000Z</published>
    <updated>2025-07-08T11:28:56.028Z</updated>
    
    <content type="html"><![CDATA[<p>æŒä¹…åŒ–çš„pythonæœåŠ¡</p><span id="more"></span><p><strong>è¿›ç¨‹å®ˆæŠ¤</strong>æŒ‡çš„æ˜¯è®©ä¸€ä¸ªç¨‹åº<strong>åœ¨åŽå°æŒç»­è¿è¡Œ</strong>ï¼Œ<strong>å…·æœ‰è‡ªæˆ‘æ¢å¤èƒ½åŠ›</strong>ï¼ˆå´©æºƒè‡ªåŠ¨é‡å¯ï¼‰ï¼Œ<strong>éšç³»ç»Ÿå¯åŠ¨è‡ªåŠ¨å¯åŠ¨</strong>ï¼Œå¹¶å¯é€šè¿‡å‘½ä»¤è¿›è¡ŒæŽ§åˆ¶ã€‚</p><h3 id="1-linuxä¸‹systemd-æŒä¹…å®ˆæŠ¤-python-ç¨‹åº"><a class="markdownIt-Anchor" href="#1-linuxä¸‹systemd-æŒä¹…å®ˆæŠ¤-python-ç¨‹åº"></a> 1. linuxä¸‹systemd æŒä¹…å®ˆæŠ¤ Python ç¨‹åº</h3><p>åˆ›å»ºsystemdæœåŠ¡é…ç½®æ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nano /etc/systemd/system/myscript.service</span><br></pre></td></tr></table></figure><p>å†…å®¹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=My Persistent Python Script</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">ExecStart=/usr/bin/python3 /home/user/run_my_job.py</span><br><span class="line">WorkingDirectory=/home/user</span><br><span class="line">Restart=always</span><br><span class="line">RestartSec=5</span><br><span class="line">User=your_linux_username</span><br><span class="line">StandardOutput=append:/var/log/myscript.log</span><br><span class="line">StandardError=append:/var/log/myscript.err</span><br><span class="line">Environment=PYTHONUNBUFFERED=1</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure><p>å¯ç”¨å¹¶å¯åŠ¨æœåŠ¡ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl daemon-reexec</span><br><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl enable myscript.service</span><br><span class="line">sudo systemctl start myscript.service</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æ—¥å¿—å’ŒçŠ¶æ€ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl status myscript.service</span><br><span class="line">sudo <span class="built_in">tail</span> -f /var/log/myscript.log</span><br></pre></td></tr></table></figure><p>é€šè¿‡å‘½ä»¤è¿›è¡ŒæŽ§åˆ¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl stop myscript.service</span><br><span class="line">sudo systemctl restart myscript.service</span><br><span class="line">sudo systemctl <span class="built_in">disable</span> myscript.service</span><br></pre></td></tr></table></figure><h3 id="2-è·¨å¹³å°pythonè¿›ç¨‹ç®¡ç†å·¥å…·supervisord"><a class="markdownIt-Anchor" href="#2-è·¨å¹³å°pythonè¿›ç¨‹ç®¡ç†å·¥å…·supervisord"></a> 2. è·¨å¹³å°pythonè¿›ç¨‹ç®¡ç†å·¥å…·supervisord</h3><p><strong>supervisord</strong> æ˜¯ä¸€ä¸ªç”¨ Python ç¼–å†™çš„è¿›ç¨‹ç®¡ç†å·¥å…·ï¼Œ å®ƒå¯ä»¥ç›‘æŽ§ã€å¯åŠ¨ã€åœæ­¢ã€é‡å¯ä½ pythonè„šæœ¬åœ¨å†…çš„è¿›ç¨‹ã€‚å¯ä»¥ç›´æŽ¥åˆ©ç”¨pipä¸‹è½½ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install supervisor</span><br></pre></td></tr></table></figure><p>Supervisor ç”±ä¸¤ä¸ªæ ¸å¿ƒç»„ä»¶ç»„æˆï¼š</p><ul><li>supervisordå®ˆæŠ¤è¿›ç¨‹ï¼šè´Ÿè´£è¯»å–é…ç½®ã€å¯åŠ¨/ç›‘æŽ§ä»»åŠ¡</li><li>supervisorctlå‘½ä»¤è¡Œå®¢æˆ·ç«¯ï¼šç”¨äºŽæŸ¥çœ‹çŠ¶æ€ã€é‡å¯ä»»åŠ¡ç­‰</li></ul><p>ä½¿ç”¨æ—¶ï¼Œé¦–å…ˆç”Ÿæˆä¸€ä¸ªé»˜è®¤çš„é…ç½®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo_supervisord_conf &gt; supervisord.conf</span><br></pre></td></tr></table></figure><p>å°†éœ€è¦å®ˆæŠ¤çš„è¿›ç¨‹æ·»åŠ åˆ°é…ç½®æ–‡ä»¶ä¸­ï¼š</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[program:my_script]</span></span><br><span class="line"><span class="attr">command</span>=python3 /home/user/scripts/my_script.py</span><br><span class="line"><span class="attr">directory</span>=/home/user/scripts</span><br><span class="line"><span class="attr">autostart</span>=<span class="literal">true</span></span><br><span class="line"><span class="attr">autorestart</span>=<span class="literal">true</span></span><br><span class="line"><span class="attr">startsecs</span>=<span class="number">5</span></span><br><span class="line"><span class="attr">stdout_logfile</span>=/var/log/my_script.out.log</span><br><span class="line"><span class="attr">stderr_logfile</span>=/var/log/my_script.err.log</span><br></pre></td></tr></table></figure><table><thead><tr><th><strong>å‚æ•°</strong></th><th><strong>å«ä¹‰</strong></th></tr></thead><tbody><tr><td>command</td><td>è¦æ‰§è¡Œçš„å‘½ä»¤</td></tr><tr><td>directory</td><td>å·¥ä½œç›®å½•</td></tr><tr><td>autostart</td><td>å¯åŠ¨ supervisord æ—¶è‡ªåŠ¨å¯åŠ¨</td></tr><tr><td>autorestart</td><td>å¼‚å¸¸é€€å‡ºåŽæ˜¯å¦è‡ªåŠ¨é‡å¯</td></tr><tr><td>startsecs</td><td>å¯åŠ¨åŽè¿è¡Œå¤šå°‘ç§’æ‰ç®—æˆåŠŸ</td></tr><tr><td>stdout_logfile</td><td>æ ‡å‡†è¾“å‡ºæ—¥å¿—è·¯å¾„</td></tr><tr><td>stderr_logfile</td><td>é”™è¯¯æ—¥å¿—è·¯å¾„</td></tr><tr><td>å¯åŠ¨supervisordå®ˆæŠ¤è¿›ç¨‹ï¼š</td><td></td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">supervisord -c supervisord.conf</span><br></pre></td></tr></table></figure><p>å’Œsystemdä¸€æ ·ï¼Œsupervisordä¹Ÿæœ‰ä¸€äº›ç®¡ç†ä»»åŠ¡çš„å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">supervisorctl -c supervisord.conf status</span><br><span class="line">supervisorctl -c supervisord.conf restart my_script</span><br><span class="line">supervisorctl -c supervisord.conf stop my_script</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥åˆ©ç”¨supervisordè¿›è¡Œä¸åŒgpuä»»åŠ¡åˆ†å‘ï¼Œä¸åŒgpuä¸Šè¿è¡Œä¸åŒè¿›ç¨‹å¹¶å®ˆæŠ¤çš„éªšæ“ä½œï¼Œé¦–å…ˆï¼Œåœ¨ä½ çš„æ¨¡åž‹ä»»åŠ¡ä»£ç ä¸­åŠ ä¸Šé€šè¿‡å‚æ•°æŒ‡å®šgpuçš„é€»è¾‘ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"></span><br><span class="line">parser = argparse.ArgumentParser()</span><br><span class="line">parser.add_argument(<span class="string">&#x27;--gpu&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">int</span>, default=<span class="number">0</span>)</span><br><span class="line">args = parser.parse_args()</span><br><span class="line"></span><br><span class="line">device = torch.device(<span class="string">f&quot;cuda:<span class="subst">&#123;args.gpu&#125;</span>&quot;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&quot;cpu&quot;</span>)</span><br><span class="line">model.to(device)</span><br></pre></td></tr></table></figure><p>ç„¶åŽï¼ŒæŒ‡å®šä¸åŒçš„gpuè¿›è¡Œè¿›ç¨‹å®ˆæŠ¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[program:worker1]</span><br><span class="line"><span class="built_in">command</span>=python3 /opt/scripts/train_model.py --gpu 0</span><br><span class="line"></span><br><span class="line">[program:worker2]</span><br><span class="line"><span class="built_in">command</span>=python3 /opt/scripts/train_model.py --gpu 1</span><br></pre></td></tr></table></figure><h3 id="3-docker-restart-policy"><a class="markdownIt-Anchor" href="#3-docker-restart-policy"></a> 3. Docker + restart policy</h3><p>Docker æä¾›äº†ä¸€ç§æœºåˆ¶å«åš restart policyï¼ˆé‡å¯ç­–ç•¥ï¼‰ï¼Œç”¨æ¥æŽ§åˆ¶å½“å®¹å™¨é€€å‡ºæˆ–ç³»ç»Ÿé‡å¯æ—¶ï¼Œæ˜¯å¦è‡ªåŠ¨é‡å¯è¯¥å®¹å™¨ã€‚<br />å¯¹äºŽä¸€ä¸ªDockerfileï¼Œå¯ä»¥åŠ ä¸Š --restart alwaysè¿è¡Œã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker build -t my-capture .</span><br><span class="line">docker run -d --name my_capture_container --restart always my-capture</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå®¹å™¨ä¸­çš„ Python è„šæœ¬å´©æºƒæ—¶è‡ªåŠ¨é‡å¯ã€‚</p><p>å½“ç„¶ï¼Œåœ¨docker-compose.yml ä¸­å¯ä»¥è¿™æ ·é…ç½®ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">camera_worker:</span></span><br><span class="line">    <span class="attr">build:</span> <span class="string">.</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./logs:/app/logs</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8000:8000&quot;</span></span><br></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œå¦‚æžœæƒ³è¦åœ¨linuxä¸­å¼€æœºè‡ªå¯åŠ¨å®¹å™¨ï¼Œé™¤äº†ä¸Šé¢çš„ï¼Œåªè¦å†ä½¿å¾—dockerè‡ªåŠ¨å¯åŠ¨å³å¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl <span class="built_in">enable</span> docker</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå‘½ä»¤ä¼šæŠŠ Docker æœåŠ¡æ³¨å†Œåˆ° systemd ä¸­ï¼Œä¸‹æ¬¡ç³»ç»Ÿå¯åŠ¨æ—¶ä¼šè‡ªåŠ¨å¯åŠ¨ Docker æœåŠ¡, ä¹Ÿå°±è‡ªåŠ¨æ‹‰èµ·äº† --restart always çš„å®¹å™¨ã€‚</p><p>è®¾ç½®å®Œä¹‹åŽï¼Œä½ å¯ä»¥æ£€æŸ¥ä¸€ä¸‹é‡å¯ç­–ç•¥æ˜¯å¦é…ç½®å¥½ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect your_container_name | grep -i restart</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;æŒä¹…åŒ–çš„pythonæœåŠ¡&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>æµ…è¯•dockerï¼šä¸º AI é¡¹ç›®æž„å»ºé«˜å¯ç»´æŠ¤çš„å¼€å‘çŽ¯å¢ƒ</title>
    <link href="https://atffang.github.io/2025/06/30/%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E9%AB%98%E5%8F%AF%E7%BB%B4%E6%8A%A4%E7%9A%84%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/"/>
    <id>https://atffang.github.io/2025/06/30/%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E9%AB%98%E5%8F%AF%E7%BB%B4%E6%8A%A4%E7%9A%84%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/</id>
    <published>2025-06-30T12:49:55.000Z</published>
    <updated>2025-06-30T13:14:28.909Z</updated>
    
    <content type="html"><![CDATA[<p>æµ…è¯•dockerï¼šä¸º AI é¡¹ç›®æž„å»ºé«˜å¯ç»´æŠ¤çš„å¼€å‘çŽ¯å¢ƒ</p><span id="more"></span><p>æˆ‘çš„éœ€æ±‚æ˜¯ä¸€ä¸ªå¸¦cudaé©±åŠ¨çš„pythonå®¹å™¨ï¼Œrediså®¹å™¨ã€psqlå®¹å™¨ã€minioå®¹å™¨ï¼Œå› æ­¤ï¼Œæˆ‘æŒ‡å®šdocker-composeå’Œdockerfileï¼Œä»–ä»¬ä¹‹é—´çš„åŒºåˆ«å¦‚ä¸‹è¡¨ï¼š</p><table><thead><tr><th>æ–¹é¢</th><th>Dockerfile</th><th>Docker Compose</th></tr></thead><tbody><tr><td>æ ¸å¿ƒä½œç”¨</td><td>å®šä¹‰å•ä¸ªé•œåƒçš„æž„å»ºè¿‡ç¨‹ï¼Œæè¿°ä»ŽåŸºç¡€é•œåƒå¼€å§‹ï¼Œå®‰è£…è½¯ä»¶ã€æ‹·è´æ–‡ä»¶ã€é…ç½®çŽ¯å¢ƒç­‰æ­¥éª¤ï¼Œç”Ÿæˆè‡ªå®šä¹‰é•œåƒã€‚</td><td>å®šä¹‰å¤šä¸ªå®¹å™¨çš„ç¼–æŽ’å’Œè¿è¡Œï¼ŒæŒ‡å®šå“ªäº›é•œåƒæˆ– Dockerfile è¦å¯åŠ¨ï¼Œå®¹å™¨ä¹‹é—´å¦‚ä½•è¿žæŽ¥ã€æŒ‚è½½å·ã€ç«¯å£æ˜ å°„ç­‰ã€‚</td></tr><tr><td>å·¥ä½œæ–¹å¼</td><td>é€šè¿‡ docker build ä»Ž Dockerfile æž„å»ºé•œåƒã€‚</td><td>é€šè¿‡ docker-compose up æ ¹æ®é…ç½®å¯åŠ¨ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ã€‚</td></tr><tr><td>æ˜¯å¦æ‹‰å–é•œåƒ</td><td>å¯ä»¥åŸºäºŽå·²æœ‰é•œåƒï¼ˆFROM xxxï¼‰ï¼Œä¹Ÿå¯ä»¥ä»Žå¤´å¼€å§‹æž„å»ºã€‚</td><td>å¯ä»¥ä½¿ç”¨å·²æœ‰é•œåƒï¼ˆimage: xxxï¼‰æˆ–åŸºäºŽ Dockerfile æž„å»ºé•œåƒï¼ˆbuild: xxxï¼‰ã€‚</td></tr><tr><td>åŠŸèƒ½èŒƒå›´</td><td>åªè´Ÿè´£é•œåƒæž„å»ºï¼ˆé™æ€ï¼‰ï¼Œé•œåƒé‡ŒåŒ…å«è¿è¡ŒçŽ¯å¢ƒå’Œæ–‡ä»¶ã€‚</td><td>è´Ÿè´£å¤šå®¹å™¨åº”ç”¨çš„å¯åŠ¨ä¸Žç®¡ç†ï¼ˆåŠ¨æ€ï¼‰ï¼ŒåŒ…æ‹¬ç½‘ç»œã€ä¾èµ–å…³ç³»ã€çŽ¯å¢ƒå˜é‡ç­‰ã€‚</td></tr><tr><td>ç¤ºä¾‹</td><td>å†™ä¸€ä¸ª Python é•œåƒï¼Œå®‰è£…ä¾èµ–ï¼Œæ‹·è´ä»£ç ã€‚</td><td>å¯åŠ¨æ•°æ®åº“ã€ç¼“å­˜ã€Python æœåŠ¡å®¹å™¨ï¼Œå¹¶è®©å®ƒä»¬ååŒå·¥ä½œã€‚</td></tr></tbody></table><p>ç¼–å†™<strong>Docker-compose:</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.8&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">app:</span></span><br><span class="line">    <span class="attr">build:</span> <span class="string">.</span>  </span><br><span class="line">    <span class="attr">runtime:</span> <span class="string">nvidia</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">labsecurity_app</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">postgres</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">minio</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./app:/app</span></span><br><span class="line">    <span class="attr">working_dir:</span> <span class="string">/app</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8888:8888&quot;</span></span><br><span class="line">    <span class="attr">command:</span> [<span class="string">&quot;tail&quot;</span>, <span class="string">&quot;-f&quot;</span>, <span class="string">&quot;/dev/null&quot;</span>]</span><br><span class="line"></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis:7</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">labsecurity_redis</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;6379:6379&quot;</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">minio:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">minio/minio</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">labsecurity_minio</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;9000:9000&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;9001:9001&quot;</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">MINIO_ROOT_USER:</span> <span class="string">minioadmin</span></span><br><span class="line">      <span class="attr">MINIO_ROOT_PASSWORD:</span> <span class="string">minioadmin</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">server</span> <span class="string">/data</span> <span class="string">--console-address</span> <span class="string">&quot;:9001&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">minio_data:/data</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">postgres:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">postgres:17</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">labsecurity_postgres</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">POSTGRES_DB:</span> <span class="string">labdb</span></span><br><span class="line">      <span class="attr">POSTGRES_USER:</span> <span class="string">labuser</span></span><br><span class="line">      <span class="attr">POSTGRES_PASSWORD:</span> <span class="string">labpass</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;5432:5432&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">pgdata:/var/lib/postgresql/data</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">pgdata:</span></span><br><span class="line">  <span class="attr">minio_data:</span></span><br></pre></td></tr></table></figure><p>ç¼–å†™<strong>Dockerfile:</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> nvidia<span class="operator">/</span>cuda:<span class="number">12.8</span><span class="number">.0</span><span class="operator">-</span>cudnn<span class="operator">-</span>runtime<span class="operator">-</span>ubuntu22<span class="number">.04</span></span><br><span class="line"></span><br><span class="line">RUN apt<span class="operator">-</span><span class="keyword">get</span> <span class="keyword">update</span> <span class="operator">&amp;&amp;</span> apt<span class="operator">-</span><span class="keyword">get</span> install <span class="operator">-</span>y python3 python3<span class="operator">-</span>pip</span><br><span class="line"></span><br><span class="line">WORKDIR <span class="operator">/</span>app</span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span> requirements.txt .</span><br><span class="line"></span><br><span class="line">RUN pip install torch<span class="operator">=</span><span class="operator">=</span><span class="number">2.6</span><span class="number">.0</span> torchvision<span class="operator">=</span><span class="operator">=</span><span class="number">0.21</span><span class="number">.0</span> torchaudio<span class="operator">=</span><span class="operator">=</span><span class="number">2.6</span><span class="number">.0</span> <span class="comment">--index-url https://download.pytorch.org/whl/cu126</span></span><br><span class="line">RUN pip install <span class="comment">--no-cache-dir -r requirements.txt</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span> .<span class="operator">/</span>app <span class="operator">/</span>app</span><br><span class="line"></span><br><span class="line">CMD [&quot;python3&quot;, &quot;main.py&quot;]</span><br></pre></td></tr></table></figure><p>ä¾‹å¦‚ï¼Œåœ¨pythonä¸­é€šè¿‡<code>minio:9000</code>ï¼Œåœ¨æœ¬æœºä¸­å¯ä»¥é€šè¿‡<code>http://localhost:9001/</code>è®¿é—®ã€‚</p><h3 id="dockerå¿«é€Ÿæž„å»º"><a class="markdownIt-Anchor" href="#dockerå¿«é€Ÿæž„å»º"></a> dockerå¿«é€Ÿæž„å»º</h3><ol><li>ä¸‹è½½docker desktopï¼Œå¯¹äºŽåˆ†ç›˜çš„windowsç”µè„‘ï¼Œå»ºè®®è¿ç§»ä¸€ä¸‹dockerä½ç½®</li><li>æ¢æºï¼Œæˆ‘è¿™é‡Œä¿®æ”¹é…ç½®æ–‡ä»¶ä¸ºï¼š</li></ol><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;builder&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;gc&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;defaultKeepStorage&quot;</span><span class="punctuation">:</span> <span class="string">&quot;20GB&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;enabled&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;experimental&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;registry-mirrors&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;https://docker.xuanyuan.me&quot;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><ol start="3"><li><p>æž„å»ºé•œåƒï¼š<code>docker compose build</code></p></li><li><p>å¯åŠ¨å®¹å™¨æœåŠ¡ï¼š<code>docker compose up -d</code> æ²¡æœ‰ä¸‹è½½è¿‡dockert-composeä¸­çš„å®¹å™¨çš„ä¼šå…ˆä¸‹è½½</p></li><li><p>æŸ¥çœ‹æœåŠ¡çŠ¶æ€ï¼š<code>docker ps</code> -a<br /><img src="https://gcnaq17oc64n.feishu.cn/space/api/box/stream/download/asynccode/?code=NGI2NTJlZWU1OTExOGMzODgwMjAzZTM1NGJiMjhkNWNfZnA5ZE9tZHlwdWdhT3BOZjVtcVhzckd2Uk9Ma2pwdVRfVG9rZW46T2hBc2JGaHRHbzAyMEV4ZjAwZWMzSFYxbkloXzE3NTEyODkwNzk6MTc1MTI5MjY3OV9WNA" alt="" /></p></li><li><p>è¿›å…¥pythonå®¹å™¨ï¼š<code>docker exec -it labsecurity_app bash</code></p></li><li><p>æµ‹è¯•ä¸€ä¸‹cudaçŽ¯å¢ƒæ˜¯å¦å¯ç”¨ï¼Œè¿è¡Œè„šæœ¬ï¼š</p></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="built_in">print</span>(torch.cuda.is_available())</span><br><span class="line"><span class="built_in">print</span>(torch.cuda.get_device_name(<span class="number">0</span>))</span><br></pre></td></tr></table></figure><ol start="8"><li>ç»“æŸæ‰€æœ‰æœåŠ¡ï¼š <code>docker-compose stop</code> å¼€å§‹æ‰€æœ‰æœåŠ¡ï¼š<code>docker-compose start</code></li><li>æˆ‘åœ¨docker-composeé‡Œé¢æŒ‚è½½äº†ï¼š</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">volumes:</span><br><span class="line">    - ./app:/app</span><br></pre></td></tr></table></figure><p>å®¹å™¨èƒ½çœ‹åˆ°æœ¬æœºçš„ <code>./app</code> ç›®å½•ï¼Œç‚¹å‡»vscodeå·¦ä¸‹æ–¹çš„&gt;&lt;ï¼Œé€‰æ‹©Attach to Running Containerï¼Œè¿›å…¥pythonå®¹å™¨ï¼Œå°±å¯ä»¥æ„‰å¿«çš„å¼€å‘äº†</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;æµ…è¯•dockerï¼šä¸º AI é¡¹ç›®æž„å»ºé«˜å¯ç»´æŠ¤çš„å¼€å‘çŽ¯å¢ƒ&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>ä»Ž0å¼€å§‹å­¦java 02 ï¼šå§”æ‰˜ä¸Žç­–ç•¥æ¨¡å¼</title>
    <link href="https://atffang.github.io/2025/06/29/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6java2/"/>
    <id>https://atffang.github.io/2025/06/29/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6java2/</id>
    <published>2025-06-29T07:46:42.000Z</published>
    <updated>2025-06-29T08:44:50.335Z</updated>
    
    <content type="html"><![CDATA[<p>ç”Ÿæ´»æ‰€è¿«å‘€ã€‚</p><span id="more"></span><p>ä¸Šä¸€æœŸä¸­ï¼Œæˆ‘ä»¬é€šè¿‡æŽ¥å£ï¼ˆinterfaceï¼‰å’ŒæŠ½è±¡ç±»ï¼ˆabstract classï¼‰ç†è§£äº†å¦‚ä½•å®šä¹‰è¡Œä¸ºè§„èŒƒã€å¦‚ä½•å®žçŽ°å¤šæ€ç­‰ç­‰ã€‚ç„¶è€Œï¼Œåœ¨ä¼ ç»Ÿçš„ç»§æ‰¿æ–¹å¼ä¸­ï¼Œå­ç±»é€šè¿‡è¦†ç›–æ–¹æ³•æ¥æ”¹å˜è¡Œä¸ºï¼Œä½†è¿™ç§æ–¹å¼åœ¨é¢å¯¹è¡Œä¸ºåˆ‡æ¢ã€è¡Œä¸ºå¤ç”¨æ—¶æ˜¾å¾—åƒµç¡¬ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¸Œæœ›æœ‰ä¸€ç§æ–¹å¼ï¼Œä¸ç”¨ç»§æ‰¿ï¼Œä¹Ÿèƒ½æ”¹å˜å¯¹è±¡çš„è¡Œä¸ºï¼Œæ›´é€‚åˆâ€œæ’ä»¶å¼â€çš„è¡Œä¸ºç»“æž„ã€‚</p><p>è¿™ä¸ªæ—¶å€™ï¼Œå°±éœ€è¦ä¸€ç§æ–°çš„æ¨¡å¼<strong>å§”æ‰˜</strong>ï¼ŒæŠŠè¡Œä¸ºäº¤ç»™å¦ä¸€ä¸ªå¯¹è±¡æ¥å®Œæˆã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å…ˆå®šä¹‰ä¸€ä¸ªæŽ¥å£ï¼Œæ¥è§„èŒƒè¦å¹²çš„äº‹æƒ…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">FlyBehavior</span>&#123;</span><br><span class="line"><span class="keyword">void</span> <span class="title function_">fly</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®žçŽ°æŽ¥å£çš„ç±»å¿…é¡»è¦å®žçŽ°flyè¿™ä¸€ä¸ªåŠ¨ä½œï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå®žçŽ°FlyBehavioræŽ¥å£çš„ç±»FlyWithWingsï¼Œæ¥å®žçŽ°æœ‰ç¿…è†€å¯ä»¥é£žçš„åŠ¨ä½œï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FlyWithWings</span> <span class="keyword">implements</span> <span class="title class_">FlyBehavior</span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">fly</span><span class="params">()</span>&#123;</span><br><span class="line">System.out.println(<span class="string">&quot;fly!!!!&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å†å®šä¹‰ä¸€ä¸ªå®žçŽ°FlyBehavioræŽ¥å£çš„ç±»FlyNoWingsï¼Œæ¥å®žçŽ°æ²¡ç¿…è†€ä¸èƒ½é£žçš„åŠ¨ä½œï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FlyNoWings</span> <span class="keyword">implements</span> <span class="title class_">FlyBehavior</span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">fly</span><span class="params">()</span>&#123;</span><br><span class="line">System.out.println(<span class="string">&quot;cannot fly!!!!&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®šä¹‰çŽ©æŽ¥å£å’ŒæŽ¥å£çš„å®žçŽ°ä¹‹åŽï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ªé£žè¡ŒåŠ¨ä½œï¼ŒçŽ°åœ¨ï¼Œæˆ‘ä»¬æ¥å®šä¹‰å®žçŽ°é£žè¡ŒåŠ¨ä½œçš„å¯¹è±¡ã€‚<br />æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªé¸­å­æŠ½è±¡ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Duck</span>&#123;</span><br><span class="line"><span class="comment">// å£°æ˜Žå¼•ç”¨å˜é‡</span></span><br><span class="line">FlyBehavior flyBehavior;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æž„é€ å‡½æ•°</span></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">Duck</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠ½è±¡ç±»çš„å‡½æ•°ï¼Œå­ç±»å¿…é¡»å®žçŽ°</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">display</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å§”æ‰˜ç»™è¡Œä¸ºç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">performFly</span><span class="params">()</span> &#123;</span><br><span class="line">flyBehavior.fly();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œé¦–å…ˆå£°æ˜Žäº†ä¸€ä¸ªFlyBehaviorç±»åž‹çš„å¼•ç”¨å˜é‡ï¼Œè¡¨ç¤ºé¸­å­çš„é£žè¡Œè¡Œä¸ºï¼Œå½“è°ƒç”¨performFly()æ—¶ï¼Œå®žé™…ä¸Šè°ƒç”¨çš„æ˜¯flyBehaviorå¯¹è±¡çš„fly()æ–¹æ³•ã€‚</p><p>å¥½çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ–°å»ºä¸€ä¸ªå­ç±»äº†ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MallardDuck</span> <span class="keyword">extends</span> <span class="title class_">Duck</span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="title function_">MallardDuck</span><span class="params">()</span>&#123;</span><br><span class="line">flyBehavior = <span class="keyword">new</span> <span class="title class_">FlyNoWings</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">display</span><span class="params">()</span> &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;im MallardDuck&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ MallardDuck æž„é€ å‡½æ•°é‡Œï¼Œç»™ç»§æ‰¿è‡ªçˆ¶ç±»çš„ flyBehavior å˜é‡èµ‹å€¼ä¸º new FlyWithWings() å®žä¾‹ã€‚è¿™æ ·è°ƒç”¨ performFly() å°±ä¼šè°ƒç”¨ FlyWithWings ç±»çš„ fly() æ–¹æ³•ï¼Œå®žçŽ°â€œé£žâ€çš„åŠ¨ä½œã€‚<br />å…¥å£ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RunDuck</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line"><span class="type">Duck</span> <span class="variable">mallard</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MallardDuck</span>();</span><br><span class="line">mallard.performFly();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š cannot fly!!!</p><p><strong>ä½†æ˜¯</strong>ï¼Œè¿™æ ·è¿˜æ˜¯ä¸å¤Ÿçµæ´»ï¼Œæˆ‘ä»¬è¿˜æƒ³è¦è®©é¸­å­å…·æœ‰åŠ¨æ€è¡Œä¸ºã€‚ä¸ºäº†å®žçŽ°è¿™ä¸ªç›®çš„ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æŠ½è±¡ç±»ä¸­åŠ å…¥ä¸€ä¸ªè®¾å®šæ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Duck</span>&#123;</span><br><span class="line">FlyBehavior flyBehavior;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">Duck</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">display</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">performFly</span><span class="params">()</span> &#123;</span><br><span class="line">flyBehavior.fly();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–°åŠ å…¥çš„æ–¹æ³•</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setFlyBehavior</span><span class="params">(FlyBehavior fb)</span>&#123;</span><br><span class="line">flyBehavior = fb;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éšåŽï¼Œåœ¨å®žçŽ°æ—¶ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RunDuck</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line"><span class="type">Duck</span> <span class="variable">mallard</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MallardDuck</span>();</span><br><span class="line">mallard.performFly();</span><br><span class="line">mallard.setFlyBehavior(<span class="keyword">new</span> <span class="title class_">FlyWithWings</span>());</span><br><span class="line">mallard.performFly();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å³å¯åŠ¨æ€è®¾å®šå…¶è¡Œä¸ºï¼Œè¾“å‡ºä¸ºï¼š<br />cannot fly!!!<br />fly!!!</p><p><strong>è¿™ç§é€šè¿‡ç»„åˆè¡Œä¸ºæŽ¥å£çš„æ–¹å¼å®žçŽ°åŠ¨æ€åˆ‡æ¢è¡Œä¸ºçš„è®¾è®¡æ¨¡å¼ï¼Œç§°ä¸ºç­–ç•¥æ¨¡å¼ï¼ˆStrategy Patternï¼‰ï¼Œæ˜¯é¢å‘å¯¹è±¡è®¾è®¡ä¸­çš„é‡è¦æ€æƒ³</strong>ã€‚<br /><img src="https://atffang.github.io/2025/06/29/ä»Ž0å¼€å§‹å­¦java2/ç­–ç•¥æ¨¡å¼.png"/></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ç”Ÿæ´»æ‰€è¿«å‘€ã€‚&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>ç¾Žå›¢å•†ä¸šåˆ†æžç²¾è‹±å¤§èµ›äºšå†›</title>
    <link href="https://atffang.github.io/2025/06/25/%E7%BE%8E%E5%9B%A2%E5%95%86%E4%B8%9A%E5%88%86%E6%9E%90%E7%B2%BE%E8%8B%B1%E5%A4%A7%E8%B5%9B%E4%BA%9A%E5%86%9B/"/>
    <id>https://atffang.github.io/2025/06/25/%E7%BE%8E%E5%9B%A2%E5%95%86%E4%B8%9A%E5%88%86%E6%9E%90%E7%B2%BE%E8%8B%B1%E5%A4%A7%E8%B5%9B%E4%BA%9A%E5%86%9B/</id>
    <published>2025-06-25T01:29:59.000Z</published>
    <updated>2025-06-25T02:13:11.955Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸€èµ·èšâ€”â€”é¢å‘èšé¤åœºæ™¯çš„æ™ºèƒ½é¤åŽ…æŽ¨èç³»ç»Ÿ</p><span id="more"></span><p>ä»Ž1206æ”¯é˜Ÿä¼é‡Œæ€åˆ°äº†ç¬¬äºŒï¼ŒèŽ·æ­¤æ®Šè£ç¡®å®žåœ¨æˆ‘ä»¬æ„æ–™ä¹‹å¤–ã€‚æ„Ÿè°¢ç¾Žå›¢æä¾›çš„æœºä¼šä¸Žmoneyã€‚<br /><img src="https://atffang.github.io/2025/06/25/ç¾Žå›¢å•†ä¸šåˆ†æžç²¾è‹±å¤§èµ›äºšå†›/å†³èµ›-ç»ˆç¨¿2.5_01.png"/><br /><img src="https://atffang.github.io/2025/06/25/ç¾Žå›¢å•†ä¸šåˆ†æžç²¾è‹±å¤§èµ›äºšå†›/å†³èµ›-ç»ˆç¨¿2.5_02.png"/><br /><img src="https://atffang.github.io/2025/06/25/ç¾Žå›¢å•†ä¸šåˆ†æžç²¾è‹±å¤§èµ›äºšå†›/å†³èµ›-ç»ˆç¨¿2.5_03.png"/><br /><img src="https://atffang.github.io/2025/06/25/ç¾Žå›¢å•†ä¸šåˆ†æžç²¾è‹±å¤§èµ›äºšå†›/å†³èµ›-ç»ˆç¨¿2.5_04.png"/><br /><img src="https://atffang.github.io/2025/06/25/ç¾Žå›¢å•†ä¸šåˆ†æžç²¾è‹±å¤§èµ›äºšå†›/å†³èµ›-ç»ˆç¨¿2.5_05.png"/><br /><img src="https://atffang.github.io/2025/06/25/ç¾Žå›¢å•†ä¸šåˆ†æžç²¾è‹±å¤§èµ›äºšå†›/å†³èµ›-ç»ˆç¨¿2.5_06.png"/><br /><img src="https://atffang.github.io/2025/06/25/ç¾Žå›¢å•†ä¸šåˆ†æžç²¾è‹±å¤§èµ›äºšå†›/å†³èµ›-ç»ˆç¨¿2.5_07.png"/><br /><img src="https://atffang.github.io/2025/06/25/ç¾Žå›¢å•†ä¸šåˆ†æžç²¾è‹±å¤§èµ›äºšå†›/å†³èµ›-ç»ˆç¨¿2.5_08.png"/><br /><img src="https://atffang.github.io/2025/06/25/ç¾Žå›¢å•†ä¸šåˆ†æžç²¾è‹±å¤§èµ›äºšå†›/å†³èµ›-ç»ˆç¨¿2.5_09.png"/><br /><img src="https://atffang.github.io/2025/06/25/ç¾Žå›¢å•†ä¸šåˆ†æžç²¾è‹±å¤§èµ›äºšå†›/å†³èµ›-ç»ˆç¨¿2.5_10.png"/><br /><img src="https://atffang.github.io/2025/06/25/ç¾Žå›¢å•†ä¸šåˆ†æžç²¾è‹±å¤§èµ›äºšå†›/å†³èµ›-ç»ˆç¨¿2.5_11.png"/><br /><img src="https://atffang.github.io/2025/06/25/ç¾Žå›¢å•†ä¸šåˆ†æžç²¾è‹±å¤§èµ›äºšå†›/å†³èµ›-ç»ˆç¨¿2.5_12.png"/><br /><img src="https://atffang.github.io/2025/06/25/ç¾Žå›¢å•†ä¸šåˆ†æžç²¾è‹±å¤§èµ›äºšå†›/å†³èµ›-ç»ˆç¨¿2.5_13.png"/><br /><img src="https://atffang.github.io/2025/06/25/ç¾Žå›¢å•†ä¸šåˆ†æžç²¾è‹±å¤§èµ›äºšå†›/å†³èµ›-ç»ˆç¨¿2.5_14.png"/></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ä¸€èµ·èšâ€”â€”é¢å‘èšé¤åœºæ™¯çš„æ™ºèƒ½é¤åŽ…æŽ¨èç³»ç»Ÿ&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
</feed>
